(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function Hv(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Vv={exports:{}},Tc={},Kv={exports:{}},ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wo=Symbol.for("react.element"),dx=Symbol.for("react.portal"),hx=Symbol.for("react.fragment"),fx=Symbol.for("react.strict_mode"),mx=Symbol.for("react.profiler"),px=Symbol.for("react.provider"),gx=Symbol.for("react.context"),vx=Symbol.for("react.forward_ref"),Ex=Symbol.for("react.suspense"),yx=Symbol.for("react.memo"),Tx=Symbol.for("react.lazy"),Mp=Symbol.iterator;function _x(i){return i===null||typeof i!="object"?null:(i=Mp&&i[Mp]||i["@@iterator"],typeof i=="function"?i:null)}var Wv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qv=Object.assign,Yv={};function Xs(i,e,t){this.props=i,this.context=e,this.refs=Yv,this.updater=t||Wv}Xs.prototype.isReactComponent={};Xs.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};Xs.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function jv(){}jv.prototype=Xs.prototype;function $f(i,e,t){this.props=i,this.context=e,this.refs=Yv,this.updater=t||Wv}var Bf=$f.prototype=new jv;Bf.constructor=$f;qv(Bf,Xs.prototype);Bf.isPureReactComponent=!0;var Op=Array.isArray,zv=Object.prototype.hasOwnProperty,Gf={current:null},Qv={key:!0,ref:!0,__self:!0,__source:!0};function Xv(i,e,t){var n,r={},s=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)zv.call(e,n)&&!Qv.hasOwnProperty(n)&&(r[n]=e[n]);var o=arguments.length-2;if(o===1)r.children=t;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];r.children=l}if(i&&i.defaultProps)for(n in o=i.defaultProps,o)r[n]===void 0&&(r[n]=o[n]);return{$$typeof:wo,type:i,key:s,ref:a,props:r,_owner:Gf.current}}function Sx(i,e){return{$$typeof:wo,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function Hf(i){return typeof i=="object"&&i!==null&&i.$$typeof===wo}function Ax(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(t){return e[t]})}var Np=/\/+/g;function zc(i,e){return typeof i=="object"&&i!==null&&i.key!=null?Ax(""+i.key):e.toString(36)}function bl(i,e,t,n,r){var s=typeof i;(s==="undefined"||s==="boolean")&&(i=null);var a=!1;if(i===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(i.$$typeof){case wo:case dx:a=!0}}if(a)return a=i,r=r(a),i=n===""?"."+zc(a,0):n,Op(r)?(t="",i!=null&&(t=i.replace(Np,"$&/")+"/"),bl(r,e,t,"",function(u){return u})):r!=null&&(Hf(r)&&(r=Sx(r,t+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(Np,"$&/")+"/")+i)),e.push(r)),1;if(a=0,n=n===""?".":n+":",Op(i))for(var o=0;o<i.length;o++){s=i[o];var l=n+zc(s,o);a+=bl(s,e,t,l,r)}else if(l=_x(i),typeof l=="function")for(i=l.call(i),o=0;!(s=i.next()).done;)s=s.value,l=n+zc(s,o++),a+=bl(s,e,t,l,r);else if(s==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Mo(i,e,t){if(i==null)return i;var n=[],r=0;return bl(i,n,"","",function(s){return e.call(t,s,r++)}),n}function xx(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(t){(i._status===0||i._status===-1)&&(i._status=1,i._result=t)},function(t){(i._status===0||i._status===-1)&&(i._status=2,i._result=t)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var Mt={current:null},Rl={transition:null},bx={ReactCurrentDispatcher:Mt,ReactCurrentBatchConfig:Rl,ReactCurrentOwner:Gf};function Zv(){throw Error("act(...) is not supported in production builds of React.")}ce.Children={map:Mo,forEach:function(i,e,t){Mo(i,function(){e.apply(this,arguments)},t)},count:function(i){var e=0;return Mo(i,function(){e++}),e},toArray:function(i){return Mo(i,function(e){return e})||[]},only:function(i){if(!Hf(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};ce.Component=Xs;ce.Fragment=hx;ce.Profiler=mx;ce.PureComponent=$f;ce.StrictMode=fx;ce.Suspense=Ex;ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bx;ce.act=Zv;ce.cloneElement=function(i,e,t){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var n=qv({},i.props),r=i.key,s=i.ref,a=i._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Gf.current),e.key!==void 0&&(r=""+e.key),i.type&&i.type.defaultProps)var o=i.type.defaultProps;for(l in e)zv.call(e,l)&&!Qv.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=t;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:wo,type:i.type,key:r,ref:s,props:n,_owner:a}};ce.createContext=function(i){return i={$$typeof:gx,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:px,_context:i},i.Consumer=i};ce.createElement=Xv;ce.createFactory=function(i){var e=Xv.bind(null,i);return e.type=i,e};ce.createRef=function(){return{current:null}};ce.forwardRef=function(i){return{$$typeof:vx,render:i}};ce.isValidElement=Hf;ce.lazy=function(i){return{$$typeof:Tx,_payload:{_status:-1,_result:i},_init:xx}};ce.memo=function(i,e){return{$$typeof:yx,type:i,compare:e===void 0?null:e}};ce.startTransition=function(i){var e=Rl.transition;Rl.transition={};try{i()}finally{Rl.transition=e}};ce.unstable_act=Zv;ce.useCallback=function(i,e){return Mt.current.useCallback(i,e)};ce.useContext=function(i){return Mt.current.useContext(i)};ce.useDebugValue=function(){};ce.useDeferredValue=function(i){return Mt.current.useDeferredValue(i)};ce.useEffect=function(i,e){return Mt.current.useEffect(i,e)};ce.useId=function(){return Mt.current.useId()};ce.useImperativeHandle=function(i,e,t){return Mt.current.useImperativeHandle(i,e,t)};ce.useInsertionEffect=function(i,e){return Mt.current.useInsertionEffect(i,e)};ce.useLayoutEffect=function(i,e){return Mt.current.useLayoutEffect(i,e)};ce.useMemo=function(i,e){return Mt.current.useMemo(i,e)};ce.useReducer=function(i,e,t){return Mt.current.useReducer(i,e,t)};ce.useRef=function(i){return Mt.current.useRef(i)};ce.useState=function(i){return Mt.current.useState(i)};ce.useSyncExternalStore=function(i,e,t){return Mt.current.useSyncExternalStore(i,e,t)};ce.useTransition=function(){return Mt.current.useTransition()};ce.version="18.3.1";Kv.exports=ce;var re=Kv.exports;const ye=Hv(re);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rx=re,wx=Symbol.for("react.element"),Ix=Symbol.for("react.fragment"),Lx=Object.prototype.hasOwnProperty,kx=Rx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Dx={key:!0,ref:!0,__self:!0,__source:!0};function Jv(i,e,t){var n,r={},s=null,a=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)Lx.call(e,n)&&!Dx.hasOwnProperty(n)&&(r[n]=e[n]);if(i&&i.defaultProps)for(n in e=i.defaultProps,e)r[n]===void 0&&(r[n]=e[n]);return{$$typeof:wx,type:i,key:s,ref:a,props:r,_owner:kx.current}}Tc.Fragment=Ix;Tc.jsx=Jv;Tc.jsxs=Jv;Vv.exports=Tc;var V=Vv.exports,eE={exports:{}},ei={},tE={exports:{}},iE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(F,O){var M=F.length;F.push(O);e:for(;0<M;){var G=M-1>>>1,Y=F[G];if(0<r(Y,O))F[G]=O,F[M]=Y,M=G;else break e}}function t(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var O=F[0],M=F.pop();if(M!==O){F[0]=M;e:for(var G=0,Y=F.length,le=Y>>>1;G<le;){var me=2*(G+1)-1,we=F[me],be=me+1,ze=F[be];if(0>r(we,M))be<Y&&0>r(ze,we)?(F[G]=ze,F[be]=M,G=be):(F[G]=we,F[me]=M,G=me);else if(be<Y&&0>r(ze,M))F[G]=ze,F[be]=M,G=be;else break e}}return O}function r(F,O){var M=F.sortIndex-O.sortIndex;return M!==0?M:F.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();i.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,d=null,h=3,f=!1,m=!1,p=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(F){for(var O=t(u);O!==null;){if(O.callback===null)n(u);else if(O.startTime<=F)n(u),O.sortIndex=O.expirationTime,e(l,O);else break;O=t(u)}}function _(F){if(p=!1,y(F),!m)if(t(l)!==null)m=!0,W(S);else{var O=t(u);O!==null&&oe(_,O.startTime-F)}}function S(F,O){m=!1,p&&(p=!1,g(w),w=-1),f=!0;var M=h;try{for(y(O),d=t(l);d!==null&&(!(d.expirationTime>O)||F&&!D());){var G=d.callback;if(typeof G=="function"){d.callback=null,h=d.priorityLevel;var Y=G(d.expirationTime<=O);O=i.unstable_now(),typeof Y=="function"?d.callback=Y:d===t(l)&&n(l),y(O)}else n(l);d=t(l)}if(d!==null)var le=!0;else{var me=t(u);me!==null&&oe(_,me.startTime-O),le=!1}return le}finally{d=null,h=M,f=!1}}var b=!1,A=null,w=-1,P=5,R=-1;function D(){return!(i.unstable_now()-R<P)}function j(){if(A!==null){var F=i.unstable_now();R=F;var O=!0;try{O=A(!0,F)}finally{O?$():(b=!1,A=null)}}else b=!1}var $;if(typeof E=="function")$=function(){E(j)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,q=X.port2;X.port1.onmessage=j,$=function(){q.postMessage(null)}}else $=function(){v(j,0)};function W(F){A=F,b||(b=!0,$())}function oe(F,O){w=v(function(){F(i.unstable_now())},O)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(F){F.callback=null},i.unstable_continueExecution=function(){m||f||(m=!0,W(S))},i.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<F?Math.floor(1e3/F):5},i.unstable_getCurrentPriorityLevel=function(){return h},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(F){switch(h){case 1:case 2:case 3:var O=3;break;default:O=h}var M=h;h=O;try{return F()}finally{h=M}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(F,O){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var M=h;h=F;try{return O()}finally{h=M}},i.unstable_scheduleCallback=function(F,O,M){var G=i.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?G+M:G):M=G,F){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=M+Y,F={id:c++,callback:O,priorityLevel:F,startTime:M,expirationTime:Y,sortIndex:-1},M>G?(F.sortIndex=M,e(u,F),t(l)===null&&F===t(u)&&(p?(g(w),w=-1):p=!0,oe(_,M-G))):(F.sortIndex=Y,e(l,F),m||f||(m=!0,W(S))),F},i.unstable_shouldYield=D,i.unstable_wrapCallback=function(F){var O=h;return function(){var M=h;h=O;try{return F.apply(this,arguments)}finally{h=M}}}})(iE);tE.exports=iE;var Cx=tE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Px=re,Jt=Cx;function U(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nE=new Set,ja={};function Br(i,e){Fs(i,e),Fs(i+"Capture",e)}function Fs(i,e){for(ja[i]=e,i=0;i<e.length;i++)nE.add(e[i])}var yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eh=Object.prototype.hasOwnProperty,Mx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Fp={},Up={};function Ox(i){return eh.call(Up,i)?!0:eh.call(Fp,i)?!1:Mx.test(i)?Up[i]=!0:(Fp[i]=!0,!1)}function Nx(i,e,t,n){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:t!==null?!t.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function Fx(i,e,t,n){if(e===null||typeof e>"u"||Nx(i,e,t,n))return!0;if(n)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ot(i,e,t,n,r,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=i,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var At={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){At[i]=new Ot(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];At[e]=new Ot(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){At[i]=new Ot(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){At[i]=new Ot(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){At[i]=new Ot(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){At[i]=new Ot(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){At[i]=new Ot(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){At[i]=new Ot(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){At[i]=new Ot(i,5,!1,i.toLowerCase(),null,!1,!1)});var Vf=/[\-:]([a-z])/g;function Kf(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(Vf,Kf);At[e]=new Ot(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(Vf,Kf);At[e]=new Ot(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(Vf,Kf);At[e]=new Ot(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){At[i]=new Ot(i,1,!1,i.toLowerCase(),null,!1,!1)});At.xlinkHref=new Ot("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){At[i]=new Ot(i,1,!1,i.toLowerCase(),null,!0,!0)});function Wf(i,e,t,n){var r=At.hasOwnProperty(e)?At[e]:null;(r!==null?r.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Fx(e,t,r,n)&&(t=null),n||r===null?Ox(e)&&(t===null?i.removeAttribute(e):i.setAttribute(e,""+t)):r.mustUseProperty?i[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,n=r.attributeNamespace,t===null?i.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,n?i.setAttributeNS(n,e,t):i.setAttribute(e,t))))}var xn=Px.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oo=Symbol.for("react.element"),ms=Symbol.for("react.portal"),ps=Symbol.for("react.fragment"),qf=Symbol.for("react.strict_mode"),th=Symbol.for("react.profiler"),rE=Symbol.for("react.provider"),sE=Symbol.for("react.context"),Yf=Symbol.for("react.forward_ref"),ih=Symbol.for("react.suspense"),nh=Symbol.for("react.suspense_list"),jf=Symbol.for("react.memo"),On=Symbol.for("react.lazy"),aE=Symbol.for("react.offscreen"),$p=Symbol.iterator;function na(i){return i===null||typeof i!="object"?null:(i=$p&&i[$p]||i["@@iterator"],typeof i=="function"?i:null)}var He=Object.assign,Qc;function Ea(i){if(Qc===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Qc=e&&e[1]||""}return`
`+Qc+i}var Xc=!1;function Zc(i,e){if(!i||Xc)return"";Xc=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(i,[],e)}else{try{e.call()}catch(u){n=u}i.call(e.prototype)}else{try{throw Error()}catch(u){n=u}i()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),s=n.stack.split(`
`),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||r[a]!==s[o]){var l=`
`+r[a].replace(" at new "," at ");return i.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",i.displayName)),l}while(1<=a&&0<=o);break}}}finally{Xc=!1,Error.prepareStackTrace=t}return(i=i?i.displayName||i.name:"")?Ea(i):""}function Ux(i){switch(i.tag){case 5:return Ea(i.type);case 16:return Ea("Lazy");case 13:return Ea("Suspense");case 19:return Ea("SuspenseList");case 0:case 2:case 15:return i=Zc(i.type,!1),i;case 11:return i=Zc(i.type.render,!1),i;case 1:return i=Zc(i.type,!0),i;default:return""}}function rh(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case ps:return"Fragment";case ms:return"Portal";case th:return"Profiler";case qf:return"StrictMode";case ih:return"Suspense";case nh:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case sE:return(i.displayName||"Context")+".Consumer";case rE:return(i._context.displayName||"Context")+".Provider";case Yf:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case jf:return e=i.displayName||null,e!==null?e:rh(i.type)||"Memo";case On:e=i._payload,i=i._init;try{return rh(i(e))}catch{}}return null}function $x(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rh(e);case 8:return e===qf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function er(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function oE(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Bx(i){var e=oE(i)?"checked":"value",t=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),n=""+i[e];if(!i.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(i,e,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function No(i){i._valueTracker||(i._valueTracker=Bx(i))}function lE(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var t=e.getValue(),n="";return i&&(n=oE(i)?i.checked?"true":"false":i.value),i=n,i!==t?(e.setValue(i),!0):!1}function _u(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function sh(i,e){var t=e.checked;return He({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??i._wrapperState.initialChecked})}function Bp(i,e){var t=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;t=er(e.value!=null?e.value:t),i._wrapperState={initialChecked:n,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function uE(i,e){e=e.checked,e!=null&&Wf(i,"checked",e,!1)}function ah(i,e){uE(i,e);var t=er(e.value),n=e.type;if(t!=null)n==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+t):i.value!==""+t&&(i.value=""+t);else if(n==="submit"||n==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?oh(i,e.type,t):e.hasOwnProperty("defaultValue")&&oh(i,e.type,er(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function Gp(i,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,t||e===i.value||(i.value=e),i.defaultValue=e}t=i.name,t!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,t!==""&&(i.name=t)}function oh(i,e,t){(e!=="number"||_u(i.ownerDocument)!==i)&&(t==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+t&&(i.defaultValue=""+t))}var ya=Array.isArray;function Ls(i,e,t,n){if(i=i.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<i.length;t++)r=e.hasOwnProperty("$"+i[t].value),i[t].selected!==r&&(i[t].selected=r),r&&n&&(i[t].defaultSelected=!0)}else{for(t=""+er(t),e=null,r=0;r<i.length;r++){if(i[r].value===t){i[r].selected=!0,n&&(i[r].defaultSelected=!0);return}e!==null||i[r].disabled||(e=i[r])}e!==null&&(e.selected=!0)}}function lh(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return He({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Hp(i,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(U(92));if(ya(t)){if(1<t.length)throw Error(U(93));t=t[0]}e=t}e==null&&(e=""),t=e}i._wrapperState={initialValue:er(t)}}function cE(i,e){var t=er(e.value),n=er(e.defaultValue);t!=null&&(t=""+t,t!==i.value&&(i.value=t),e.defaultValue==null&&i.defaultValue!==t&&(i.defaultValue=t)),n!=null&&(i.defaultValue=""+n)}function Vp(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function dE(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function uh(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?dE(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Fo,hE=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return i(e,t,n,r)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(Fo=Fo||document.createElement("div"),Fo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fo.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function za(i,e){if(e){var t=i.firstChild;if(t&&t===i.lastChild&&t.nodeType===3){t.nodeValue=e;return}}i.textContent=e}var Ca={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gx=["Webkit","ms","Moz","O"];Object.keys(Ca).forEach(function(i){Gx.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),Ca[e]=Ca[i]})});function fE(i,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Ca.hasOwnProperty(i)&&Ca[i]?(""+e).trim():e+"px"}function mE(i,e){i=i.style;for(var t in e)if(e.hasOwnProperty(t)){var n=t.indexOf("--")===0,r=fE(t,e[t],n);t==="float"&&(t="cssFloat"),n?i.setProperty(t,r):i[t]=r}}var Hx=He({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ch(i,e){if(e){if(Hx[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function dh(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hh=null;function zf(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var fh=null,ks=null,Ds=null;function Kp(i){if(i=ko(i)){if(typeof fh!="function")throw Error(U(280));var e=i.stateNode;e&&(e=bc(e),fh(i.stateNode,i.type,e))}}function pE(i){ks?Ds?Ds.push(i):Ds=[i]:ks=i}function gE(){if(ks){var i=ks,e=Ds;if(Ds=ks=null,Kp(i),e)for(i=0;i<e.length;i++)Kp(e[i])}}function vE(i,e){return i(e)}function EE(){}var Jc=!1;function yE(i,e,t){if(Jc)return i(e,t);Jc=!0;try{return vE(i,e,t)}finally{Jc=!1,(ks!==null||Ds!==null)&&(EE(),gE())}}function Qa(i,e){var t=i.stateNode;if(t===null)return null;var n=bc(t);if(n===null)return null;t=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(i=i.type,n=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!n;break e;default:i=!1}if(i)return null;if(t&&typeof t!="function")throw Error(U(231,e,typeof t));return t}var mh=!1;if(yn)try{var ra={};Object.defineProperty(ra,"passive",{get:function(){mh=!0}}),window.addEventListener("test",ra,ra),window.removeEventListener("test",ra,ra)}catch{mh=!1}function Vx(i,e,t,n,r,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var Pa=!1,Su=null,Au=!1,ph=null,Kx={onError:function(i){Pa=!0,Su=i}};function Wx(i,e,t,n,r,s,a,o,l){Pa=!1,Su=null,Vx.apply(Kx,arguments)}function qx(i,e,t,n,r,s,a,o,l){if(Wx.apply(this,arguments),Pa){if(Pa){var u=Su;Pa=!1,Su=null}else throw Error(U(198));Au||(Au=!0,ph=u)}}function Gr(i){var e=i,t=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(t=e.return),i=e.return;while(i)}return e.tag===3?t:null}function TE(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function Wp(i){if(Gr(i)!==i)throw Error(U(188))}function Yx(i){var e=i.alternate;if(!e){if(e=Gr(i),e===null)throw Error(U(188));return e!==i?null:i}for(var t=i,n=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(n=r.return,n!==null){t=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return Wp(r),i;if(s===n)return Wp(r),e;s=s.sibling}throw Error(U(188))}if(t.return!==n.return)t=r,n=s;else{for(var a=!1,o=r.child;o;){if(o===t){a=!0,t=r,n=s;break}if(o===n){a=!0,n=r,t=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===t){a=!0,t=s,n=r;break}if(o===n){a=!0,n=s,t=r;break}o=o.sibling}if(!a)throw Error(U(189))}}if(t.alternate!==n)throw Error(U(190))}if(t.tag!==3)throw Error(U(188));return t.stateNode.current===t?i:e}function _E(i){return i=Yx(i),i!==null?SE(i):null}function SE(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=SE(i);if(e!==null)return e;i=i.sibling}return null}var AE=Jt.unstable_scheduleCallback,qp=Jt.unstable_cancelCallback,jx=Jt.unstable_shouldYield,zx=Jt.unstable_requestPaint,je=Jt.unstable_now,Qx=Jt.unstable_getCurrentPriorityLevel,Qf=Jt.unstable_ImmediatePriority,xE=Jt.unstable_UserBlockingPriority,xu=Jt.unstable_NormalPriority,Xx=Jt.unstable_LowPriority,bE=Jt.unstable_IdlePriority,_c=null,Ji=null;function Zx(i){if(Ji&&typeof Ji.onCommitFiberRoot=="function")try{Ji.onCommitFiberRoot(_c,i,void 0,(i.current.flags&128)===128)}catch{}}var Li=Math.clz32?Math.clz32:tb,Jx=Math.log,eb=Math.LN2;function tb(i){return i>>>=0,i===0?32:31-(Jx(i)/eb|0)|0}var Uo=64,$o=4194304;function Ta(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function bu(i,e){var t=i.pendingLanes;if(t===0)return 0;var n=0,r=i.suspendedLanes,s=i.pingedLanes,a=t&268435455;if(a!==0){var o=a&~r;o!==0?n=Ta(o):(s&=a,s!==0&&(n=Ta(s)))}else a=t&~r,a!==0?n=Ta(a):s!==0&&(n=Ta(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&r)&&(r=n&-n,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(n&4&&(n|=t&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=n;0<e;)t=31-Li(e),r=1<<t,n|=i[t],e&=~r;return n}function ib(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nb(i,e){for(var t=i.suspendedLanes,n=i.pingedLanes,r=i.expirationTimes,s=i.pendingLanes;0<s;){var a=31-Li(s),o=1<<a,l=r[a];l===-1?(!(o&t)||o&n)&&(r[a]=ib(o,e)):l<=e&&(i.expiredLanes|=o),s&=~o}}function gh(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function RE(){var i=Uo;return Uo<<=1,!(Uo&4194240)&&(Uo=64),i}function ed(i){for(var e=[],t=0;31>t;t++)e.push(i);return e}function Io(i,e,t){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-Li(e),i[e]=t}function rb(i,e){var t=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var n=i.eventTimes;for(i=i.expirationTimes;0<t;){var r=31-Li(t),s=1<<r;e[r]=0,n[r]=-1,i[r]=-1,t&=~s}}function Xf(i,e){var t=i.entangledLanes|=e;for(i=i.entanglements;t;){var n=31-Li(t),r=1<<n;r&e|i[n]&e&&(i[n]|=e),t&=~r}}var xe=0;function wE(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var IE,Zf,LE,kE,DE,vh=!1,Bo=[],Kn=null,Wn=null,qn=null,Xa=new Map,Za=new Map,Un=[],sb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yp(i,e){switch(i){case"focusin":case"focusout":Kn=null;break;case"dragenter":case"dragleave":Wn=null;break;case"mouseover":case"mouseout":qn=null;break;case"pointerover":case"pointerout":Xa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Za.delete(e.pointerId)}}function sa(i,e,t,n,r,s){return i===null||i.nativeEvent!==s?(i={blockedOn:e,domEventName:t,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},e!==null&&(e=ko(e),e!==null&&Zf(e)),i):(i.eventSystemFlags|=n,e=i.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),i)}function ab(i,e,t,n,r){switch(e){case"focusin":return Kn=sa(Kn,i,e,t,n,r),!0;case"dragenter":return Wn=sa(Wn,i,e,t,n,r),!0;case"mouseover":return qn=sa(qn,i,e,t,n,r),!0;case"pointerover":var s=r.pointerId;return Xa.set(s,sa(Xa.get(s)||null,i,e,t,n,r)),!0;case"gotpointercapture":return s=r.pointerId,Za.set(s,sa(Za.get(s)||null,i,e,t,n,r)),!0}return!1}function CE(i){var e=Er(i.target);if(e!==null){var t=Gr(e);if(t!==null){if(e=t.tag,e===13){if(e=TE(t),e!==null){i.blockedOn=e,DE(i.priority,function(){LE(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){i.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}i.blockedOn=null}function wl(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var t=Eh(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(t===null){t=i.nativeEvent;var n=new t.constructor(t.type,t);hh=n,t.target.dispatchEvent(n),hh=null}else return e=ko(t),e!==null&&Zf(e),i.blockedOn=t,!1;e.shift()}return!0}function jp(i,e,t){wl(i)&&t.delete(e)}function ob(){vh=!1,Kn!==null&&wl(Kn)&&(Kn=null),Wn!==null&&wl(Wn)&&(Wn=null),qn!==null&&wl(qn)&&(qn=null),Xa.forEach(jp),Za.forEach(jp)}function aa(i,e){i.blockedOn===e&&(i.blockedOn=null,vh||(vh=!0,Jt.unstable_scheduleCallback(Jt.unstable_NormalPriority,ob)))}function Ja(i){function e(r){return aa(r,i)}if(0<Bo.length){aa(Bo[0],i);for(var t=1;t<Bo.length;t++){var n=Bo[t];n.blockedOn===i&&(n.blockedOn=null)}}for(Kn!==null&&aa(Kn,i),Wn!==null&&aa(Wn,i),qn!==null&&aa(qn,i),Xa.forEach(e),Za.forEach(e),t=0;t<Un.length;t++)n=Un[t],n.blockedOn===i&&(n.blockedOn=null);for(;0<Un.length&&(t=Un[0],t.blockedOn===null);)CE(t),t.blockedOn===null&&Un.shift()}var Cs=xn.ReactCurrentBatchConfig,Ru=!0;function lb(i,e,t,n){var r=xe,s=Cs.transition;Cs.transition=null;try{xe=1,Jf(i,e,t,n)}finally{xe=r,Cs.transition=s}}function ub(i,e,t,n){var r=xe,s=Cs.transition;Cs.transition=null;try{xe=4,Jf(i,e,t,n)}finally{xe=r,Cs.transition=s}}function Jf(i,e,t,n){if(Ru){var r=Eh(i,e,t,n);if(r===null)cd(i,e,n,wu,t),Yp(i,n);else if(ab(r,i,e,t,n))n.stopPropagation();else if(Yp(i,n),e&4&&-1<sb.indexOf(i)){for(;r!==null;){var s=ko(r);if(s!==null&&IE(s),s=Eh(i,e,t,n),s===null&&cd(i,e,n,wu,t),s===r)break;r=s}r!==null&&n.stopPropagation()}else cd(i,e,n,null,t)}}var wu=null;function Eh(i,e,t,n){if(wu=null,i=zf(n),i=Er(i),i!==null)if(e=Gr(i),e===null)i=null;else if(t=e.tag,t===13){if(i=TE(e),i!==null)return i;i=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return wu=i,null}function PE(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qx()){case Qf:return 1;case xE:return 4;case xu:case Xx:return 16;case bE:return 536870912;default:return 16}default:return 16}}var Hn=null,em=null,Il=null;function ME(){if(Il)return Il;var i,e=em,t=e.length,n,r="value"in Hn?Hn.value:Hn.textContent,s=r.length;for(i=0;i<t&&e[i]===r[i];i++);var a=t-i;for(n=1;n<=a&&e[t-n]===r[s-n];n++);return Il=r.slice(i,1<n?1-n:void 0)}function Ll(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function Go(){return!0}function zp(){return!1}function ti(i){function e(t,n,r,s,a){this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in i)i.hasOwnProperty(o)&&(t=i[o],this[o]=t?t(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Go:zp,this.isPropagationStopped=zp,this}return He(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Go)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Go)},persist:function(){},isPersistent:Go}),e}var Zs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tm=ti(Zs),Lo=He({},Zs,{view:0,detail:0}),cb=ti(Lo),td,id,oa,Sc=He({},Lo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:im,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==oa&&(oa&&i.type==="mousemove"?(td=i.screenX-oa.screenX,id=i.screenY-oa.screenY):id=td=0,oa=i),td)},movementY:function(i){return"movementY"in i?i.movementY:id}}),Qp=ti(Sc),db=He({},Sc,{dataTransfer:0}),hb=ti(db),fb=He({},Lo,{relatedTarget:0}),nd=ti(fb),mb=He({},Zs,{animationName:0,elapsedTime:0,pseudoElement:0}),pb=ti(mb),gb=He({},Zs,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),vb=ti(gb),Eb=He({},Zs,{data:0}),Xp=ti(Eb),yb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_b={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sb(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=_b[i])?!!e[i]:!1}function im(){return Sb}var Ab=He({},Lo,{key:function(i){if(i.key){var e=yb[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=Ll(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Tb[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:im,charCode:function(i){return i.type==="keypress"?Ll(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ll(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),xb=ti(Ab),bb=He({},Sc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zp=ti(bb),Rb=He({},Lo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:im}),wb=ti(Rb),Ib=He({},Zs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lb=ti(Ib),kb=He({},Sc,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Db=ti(kb),Cb=[9,13,27,32],nm=yn&&"CompositionEvent"in window,Ma=null;yn&&"documentMode"in document&&(Ma=document.documentMode);var Pb=yn&&"TextEvent"in window&&!Ma,OE=yn&&(!nm||Ma&&8<Ma&&11>=Ma),Jp=" ",eg=!1;function NE(i,e){switch(i){case"keyup":return Cb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FE(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var gs=!1;function Mb(i,e){switch(i){case"compositionend":return FE(e);case"keypress":return e.which!==32?null:(eg=!0,Jp);case"textInput":return i=e.data,i===Jp&&eg?null:i;default:return null}}function Ob(i,e){if(gs)return i==="compositionend"||!nm&&NE(i,e)?(i=ME(),Il=em=Hn=null,gs=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return OE&&e.locale!=="ko"?null:e.data;default:return null}}var Nb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tg(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!Nb[i.type]:e==="textarea"}function UE(i,e,t,n){pE(n),e=Iu(e,"onChange"),0<e.length&&(t=new tm("onChange","change",null,t,n),i.push({event:t,listeners:e}))}var Oa=null,eo=null;function Fb(i){zE(i,0)}function Ac(i){var e=ys(i);if(lE(e))return i}function Ub(i,e){if(i==="change")return e}var $E=!1;if(yn){var rd;if(yn){var sd="oninput"in document;if(!sd){var ig=document.createElement("div");ig.setAttribute("oninput","return;"),sd=typeof ig.oninput=="function"}rd=sd}else rd=!1;$E=rd&&(!document.documentMode||9<document.documentMode)}function ng(){Oa&&(Oa.detachEvent("onpropertychange",BE),eo=Oa=null)}function BE(i){if(i.propertyName==="value"&&Ac(eo)){var e=[];UE(e,eo,i,zf(i)),yE(Fb,e)}}function $b(i,e,t){i==="focusin"?(ng(),Oa=e,eo=t,Oa.attachEvent("onpropertychange",BE)):i==="focusout"&&ng()}function Bb(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Ac(eo)}function Gb(i,e){if(i==="click")return Ac(e)}function Hb(i,e){if(i==="input"||i==="change")return Ac(e)}function Vb(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Di=typeof Object.is=="function"?Object.is:Vb;function to(i,e){if(Di(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),n=Object.keys(e);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var r=t[n];if(!eh.call(e,r)||!Di(i[r],e[r]))return!1}return!0}function rg(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function sg(i,e){var t=rg(i);i=0;for(var n;t;){if(t.nodeType===3){if(n=i+t.textContent.length,i<=e&&n>=e)return{node:t,offset:e-i};i=n}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=rg(t)}}function GE(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?GE(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function HE(){for(var i=window,e=_u();e instanceof i.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)i=e.contentWindow;else break;e=_u(i.document)}return e}function rm(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function Kb(i){var e=HE(),t=i.focusedElem,n=i.selectionRange;if(e!==t&&t&&t.ownerDocument&&GE(t.ownerDocument.documentElement,t)){if(n!==null&&rm(t)){if(e=n.start,i=n.end,i===void 0&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if(i=(e=t.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var r=t.textContent.length,s=Math.min(n.start,r);n=n.end===void 0?s:Math.min(n.end,r),!i.extend&&s>n&&(r=n,n=s,s=r),r=sg(t,s);var a=sg(t,n);r&&a&&(i.rangeCount!==1||i.anchorNode!==r.node||i.anchorOffset!==r.offset||i.focusNode!==a.node||i.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),i.removeAllRanges(),s>n?(i.addRange(e),i.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),i.addRange(e)))}}for(e=[],i=t;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)i=e[t],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Wb=yn&&"documentMode"in document&&11>=document.documentMode,vs=null,yh=null,Na=null,Th=!1;function ag(i,e,t){var n=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Th||vs==null||vs!==_u(n)||(n=vs,"selectionStart"in n&&rm(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Na&&to(Na,n)||(Na=n,n=Iu(yh,"onSelect"),0<n.length&&(e=new tm("onSelect","select",null,e,t),i.push({event:e,listeners:n}),e.target=vs)))}function Ho(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit"+i]="webkit"+e,t["Moz"+i]="moz"+e,t}var Es={animationend:Ho("Animation","AnimationEnd"),animationiteration:Ho("Animation","AnimationIteration"),animationstart:Ho("Animation","AnimationStart"),transitionend:Ho("Transition","TransitionEnd")},ad={},VE={};yn&&(VE=document.createElement("div").style,"AnimationEvent"in window||(delete Es.animationend.animation,delete Es.animationiteration.animation,delete Es.animationstart.animation),"TransitionEvent"in window||delete Es.transitionend.transition);function xc(i){if(ad[i])return ad[i];if(!Es[i])return i;var e=Es[i],t;for(t in e)if(e.hasOwnProperty(t)&&t in VE)return ad[i]=e[t];return i}var KE=xc("animationend"),WE=xc("animationiteration"),qE=xc("animationstart"),YE=xc("transitionend"),jE=new Map,og="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function nr(i,e){jE.set(i,e),Br(e,[i])}for(var od=0;od<og.length;od++){var ld=og[od],qb=ld.toLowerCase(),Yb=ld[0].toUpperCase()+ld.slice(1);nr(qb,"on"+Yb)}nr(KE,"onAnimationEnd");nr(WE,"onAnimationIteration");nr(qE,"onAnimationStart");nr("dblclick","onDoubleClick");nr("focusin","onFocus");nr("focusout","onBlur");nr(YE,"onTransitionEnd");Fs("onMouseEnter",["mouseout","mouseover"]);Fs("onMouseLeave",["mouseout","mouseover"]);Fs("onPointerEnter",["pointerout","pointerover"]);Fs("onPointerLeave",["pointerout","pointerover"]);Br("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Br("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Br("onBeforeInput",["compositionend","keypress","textInput","paste"]);Br("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Br("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Br("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _a="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jb=new Set("cancel close invalid load scroll toggle".split(" ").concat(_a));function lg(i,e,t){var n=i.type||"unknown-event";i.currentTarget=t,qx(n,e,void 0,i),i.currentTarget=null}function zE(i,e){e=(e&4)!==0;for(var t=0;t<i.length;t++){var n=i[t],r=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;lg(r,o,u),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;lg(r,o,u),s=l}}}if(Au)throw i=ph,Au=!1,ph=null,i}function Pe(i,e){var t=e[bh];t===void 0&&(t=e[bh]=new Set);var n=i+"__bubble";t.has(n)||(QE(e,i,2,!1),t.add(n))}function ud(i,e,t){var n=0;e&&(n|=4),QE(t,i,n,e)}var Vo="_reactListening"+Math.random().toString(36).slice(2);function io(i){if(!i[Vo]){i[Vo]=!0,nE.forEach(function(t){t!=="selectionchange"&&(jb.has(t)||ud(t,!1,i),ud(t,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[Vo]||(e[Vo]=!0,ud("selectionchange",!1,e))}}function QE(i,e,t,n){switch(PE(e)){case 1:var r=lb;break;case 4:r=ub;break;default:r=Jf}t=r.bind(null,e,t,i),r=void 0,!mh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),n?r!==void 0?i.addEventListener(e,t,{capture:!0,passive:r}):i.addEventListener(e,t,!0):r!==void 0?i.addEventListener(e,t,{passive:r}):i.addEventListener(e,t,!1)}function cd(i,e,t,n,r){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;a=a.return}for(;o!==null;){if(a=Er(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}yE(function(){var u=s,c=zf(t),d=[];e:{var h=jE.get(i);if(h!==void 0){var f=tm,m=i;switch(i){case"keypress":if(Ll(t)===0)break e;case"keydown":case"keyup":f=xb;break;case"focusin":m="focus",f=nd;break;case"focusout":m="blur",f=nd;break;case"beforeblur":case"afterblur":f=nd;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Qp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=hb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=wb;break;case KE:case WE:case qE:f=pb;break;case YE:f=Lb;break;case"scroll":f=cb;break;case"wheel":f=Db;break;case"copy":case"cut":case"paste":f=vb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=Zp}var p=(e&4)!==0,v=!p&&i==="scroll",g=p?h!==null?h+"Capture":null:h;p=[];for(var E=u,y;E!==null;){y=E;var _=y.stateNode;if(y.tag===5&&_!==null&&(y=_,g!==null&&(_=Qa(E,g),_!=null&&p.push(no(E,_,y)))),v)break;E=E.return}0<p.length&&(h=new f(h,m,null,t,c),d.push({event:h,listeners:p}))}}if(!(e&7)){e:{if(h=i==="mouseover"||i==="pointerover",f=i==="mouseout"||i==="pointerout",h&&t!==hh&&(m=t.relatedTarget||t.fromElement)&&(Er(m)||m[Tn]))break e;if((f||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,f?(m=t.relatedTarget||t.toElement,f=u,m=m?Er(m):null,m!==null&&(v=Gr(m),m!==v||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=u),f!==m)){if(p=Qp,_="onMouseLeave",g="onMouseEnter",E="mouse",(i==="pointerout"||i==="pointerover")&&(p=Zp,_="onPointerLeave",g="onPointerEnter",E="pointer"),v=f==null?h:ys(f),y=m==null?h:ys(m),h=new p(_,E+"leave",f,t,c),h.target=v,h.relatedTarget=y,_=null,Er(c)===u&&(p=new p(g,E+"enter",m,t,c),p.target=y,p.relatedTarget=v,_=p),v=_,f&&m)t:{for(p=f,g=m,E=0,y=p;y;y=qr(y))E++;for(y=0,_=g;_;_=qr(_))y++;for(;0<E-y;)p=qr(p),E--;for(;0<y-E;)g=qr(g),y--;for(;E--;){if(p===g||g!==null&&p===g.alternate)break t;p=qr(p),g=qr(g)}p=null}else p=null;f!==null&&ug(d,h,f,p,!1),m!==null&&v!==null&&ug(d,v,m,p,!0)}}e:{if(h=u?ys(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var S=Ub;else if(tg(h))if($E)S=Hb;else{S=Bb;var b=$b}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=Gb);if(S&&(S=S(i,u))){UE(d,S,t,c);break e}b&&b(i,h,u),i==="focusout"&&(b=h._wrapperState)&&b.controlled&&h.type==="number"&&oh(h,"number",h.value)}switch(b=u?ys(u):window,i){case"focusin":(tg(b)||b.contentEditable==="true")&&(vs=b,yh=u,Na=null);break;case"focusout":Na=yh=vs=null;break;case"mousedown":Th=!0;break;case"contextmenu":case"mouseup":case"dragend":Th=!1,ag(d,t,c);break;case"selectionchange":if(Wb)break;case"keydown":case"keyup":ag(d,t,c)}var A;if(nm)e:{switch(i){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else gs?NE(i,t)&&(w="onCompositionEnd"):i==="keydown"&&t.keyCode===229&&(w="onCompositionStart");w&&(OE&&t.locale!=="ko"&&(gs||w!=="onCompositionStart"?w==="onCompositionEnd"&&gs&&(A=ME()):(Hn=c,em="value"in Hn?Hn.value:Hn.textContent,gs=!0)),b=Iu(u,w),0<b.length&&(w=new Xp(w,i,null,t,c),d.push({event:w,listeners:b}),A?w.data=A:(A=FE(t),A!==null&&(w.data=A)))),(A=Pb?Mb(i,t):Ob(i,t))&&(u=Iu(u,"onBeforeInput"),0<u.length&&(c=new Xp("onBeforeInput","beforeinput",null,t,c),d.push({event:c,listeners:u}),c.data=A))}zE(d,e)})}function no(i,e,t){return{instance:i,listener:e,currentTarget:t}}function Iu(i,e){for(var t=e+"Capture",n=[];i!==null;){var r=i,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Qa(i,t),s!=null&&n.unshift(no(i,s,r)),s=Qa(i,e),s!=null&&n.push(no(i,s,r))),i=i.return}return n}function qr(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function ug(i,e,t,n,r){for(var s=e._reactName,a=[];t!==null&&t!==n;){var o=t,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,r?(l=Qa(t,s),l!=null&&a.unshift(no(t,l,o))):r||(l=Qa(t,s),l!=null&&a.push(no(t,l,o)))),t=t.return}a.length!==0&&i.push({event:e,listeners:a})}var zb=/\r\n?/g,Qb=/\u0000|\uFFFD/g;function cg(i){return(typeof i=="string"?i:""+i).replace(zb,`
`).replace(Qb,"")}function Ko(i,e,t){if(e=cg(e),cg(i)!==e&&t)throw Error(U(425))}function Lu(){}var _h=null,Sh=null;function Ah(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var xh=typeof setTimeout=="function"?setTimeout:void 0,Xb=typeof clearTimeout=="function"?clearTimeout:void 0,dg=typeof Promise=="function"?Promise:void 0,Zb=typeof queueMicrotask=="function"?queueMicrotask:typeof dg<"u"?function(i){return dg.resolve(null).then(i).catch(Jb)}:xh;function Jb(i){setTimeout(function(){throw i})}function dd(i,e){var t=e,n=0;do{var r=t.nextSibling;if(i.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(n===0){i.removeChild(r),Ja(e);return}n--}else t!=="$"&&t!=="$?"&&t!=="$!"||n++;t=r}while(t);Ja(e)}function Yn(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function hg(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i.previousSibling}return null}var Js=Math.random().toString(36).slice(2),zi="__reactFiber$"+Js,ro="__reactProps$"+Js,Tn="__reactContainer$"+Js,bh="__reactEvents$"+Js,e1="__reactListeners$"+Js,t1="__reactHandles$"+Js;function Er(i){var e=i[zi];if(e)return e;for(var t=i.parentNode;t;){if(e=t[Tn]||t[zi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(i=hg(i);i!==null;){if(t=i[zi])return t;i=hg(i)}return e}i=t,t=i.parentNode}return null}function ko(i){return i=i[zi]||i[Tn],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function ys(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(U(33))}function bc(i){return i[ro]||null}var Rh=[],Ts=-1;function rr(i){return{current:i}}function Oe(i){0>Ts||(i.current=Rh[Ts],Rh[Ts]=null,Ts--)}function Ce(i,e){Ts++,Rh[Ts]=i.current,i.current=e}var tr={},kt=rr(tr),Gt=rr(!1),Pr=tr;function Us(i,e){var t=i.type.contextTypes;if(!t)return tr;var n=i.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return n&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=r),r}function Ht(i){return i=i.childContextTypes,i!=null}function ku(){Oe(Gt),Oe(kt)}function fg(i,e,t){if(kt.current!==tr)throw Error(U(168));Ce(kt,e),Ce(Gt,t)}function XE(i,e,t){var n=i.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return t;n=n.getChildContext();for(var r in n)if(!(r in e))throw Error(U(108,$x(i)||"Unknown",r));return He({},t,n)}function Du(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||tr,Pr=kt.current,Ce(kt,i),Ce(Gt,Gt.current),!0}function mg(i,e,t){var n=i.stateNode;if(!n)throw Error(U(169));t?(i=XE(i,e,Pr),n.__reactInternalMemoizedMergedChildContext=i,Oe(Gt),Oe(kt),Ce(kt,i)):Oe(Gt),Ce(Gt,t)}var pn=null,Rc=!1,hd=!1;function ZE(i){pn===null?pn=[i]:pn.push(i)}function i1(i){Rc=!0,ZE(i)}function sr(){if(!hd&&pn!==null){hd=!0;var i=0,e=xe;try{var t=pn;for(xe=1;i<t.length;i++){var n=t[i];do n=n(!0);while(n!==null)}pn=null,Rc=!1}catch(r){throw pn!==null&&(pn=pn.slice(i+1)),AE(Qf,sr),r}finally{xe=e,hd=!1}}return null}var _s=[],Ss=0,Cu=null,Pu=0,oi=[],li=0,Mr=null,gn=1,vn="";function cr(i,e){_s[Ss++]=Pu,_s[Ss++]=Cu,Cu=i,Pu=e}function JE(i,e,t){oi[li++]=gn,oi[li++]=vn,oi[li++]=Mr,Mr=i;var n=gn;i=vn;var r=32-Li(n)-1;n&=~(1<<r),t+=1;var s=32-Li(e)+r;if(30<s){var a=r-r%5;s=(n&(1<<a)-1).toString(32),n>>=a,r-=a,gn=1<<32-Li(e)+r|t<<r|n,vn=s+i}else gn=1<<s|t<<r|n,vn=i}function sm(i){i.return!==null&&(cr(i,1),JE(i,1,0))}function am(i){for(;i===Cu;)Cu=_s[--Ss],_s[Ss]=null,Pu=_s[--Ss],_s[Ss]=null;for(;i===Mr;)Mr=oi[--li],oi[li]=null,vn=oi[--li],oi[li]=null,gn=oi[--li],oi[li]=null}var Zt=null,Xt=null,Fe=!1,bi=null;function ey(i,e){var t=ci(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=i,e=i.deletions,e===null?(i.deletions=[t],i.flags|=16):e.push(t)}function pg(i,e){switch(i.tag){case 5:var t=i.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,Zt=i,Xt=Yn(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,Zt=i,Xt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Mr!==null?{id:gn,overflow:vn}:null,i.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ci(18,null,null,0),t.stateNode=e,t.return=i,i.child=t,Zt=i,Xt=null,!0):!1;default:return!1}}function wh(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Ih(i){if(Fe){var e=Xt;if(e){var t=e;if(!pg(i,e)){if(wh(i))throw Error(U(418));e=Yn(t.nextSibling);var n=Zt;e&&pg(i,e)?ey(n,t):(i.flags=i.flags&-4097|2,Fe=!1,Zt=i)}}else{if(wh(i))throw Error(U(418));i.flags=i.flags&-4097|2,Fe=!1,Zt=i}}}function gg(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Zt=i}function Wo(i){if(i!==Zt)return!1;if(!Fe)return gg(i),Fe=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!Ah(i.type,i.memoizedProps)),e&&(e=Xt)){if(wh(i))throw ty(),Error(U(418));for(;e;)ey(i,e),e=Yn(e.nextSibling)}if(gg(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(U(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="/$"){if(e===0){Xt=Yn(i.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}Xt=null}}else Xt=Zt?Yn(i.stateNode.nextSibling):null;return!0}function ty(){for(var i=Xt;i;)i=Yn(i.nextSibling)}function $s(){Xt=Zt=null,Fe=!1}function om(i){bi===null?bi=[i]:bi.push(i)}var n1=xn.ReactCurrentBatchConfig;function la(i,e,t){if(i=t.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(U(309));var n=t.stateNode}if(!n)throw Error(U(147,i));var r=n,s=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=r.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof i!="string")throw Error(U(284));if(!t._owner)throw Error(U(290,i))}return i}function qo(i,e){throw i=Object.prototype.toString.call(e),Error(U(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function vg(i){var e=i._init;return e(i._payload)}function iy(i){function e(g,E){if(i){var y=g.deletions;y===null?(g.deletions=[E],g.flags|=16):y.push(E)}}function t(g,E){if(!i)return null;for(;E!==null;)e(g,E),E=E.sibling;return null}function n(g,E){for(g=new Map;E!==null;)E.key!==null?g.set(E.key,E):g.set(E.index,E),E=E.sibling;return g}function r(g,E){return g=Xn(g,E),g.index=0,g.sibling=null,g}function s(g,E,y){return g.index=y,i?(y=g.alternate,y!==null?(y=y.index,y<E?(g.flags|=2,E):y):(g.flags|=2,E)):(g.flags|=1048576,E)}function a(g){return i&&g.alternate===null&&(g.flags|=2),g}function o(g,E,y,_){return E===null||E.tag!==6?(E=yd(y,g.mode,_),E.return=g,E):(E=r(E,y),E.return=g,E)}function l(g,E,y,_){var S=y.type;return S===ps?c(g,E,y.props.children,_,y.key):E!==null&&(E.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===On&&vg(S)===E.type)?(_=r(E,y.props),_.ref=la(g,E,y),_.return=g,_):(_=Nl(y.type,y.key,y.props,null,g.mode,_),_.ref=la(g,E,y),_.return=g,_)}function u(g,E,y,_){return E===null||E.tag!==4||E.stateNode.containerInfo!==y.containerInfo||E.stateNode.implementation!==y.implementation?(E=Td(y,g.mode,_),E.return=g,E):(E=r(E,y.children||[]),E.return=g,E)}function c(g,E,y,_,S){return E===null||E.tag!==7?(E=wr(y,g.mode,_,S),E.return=g,E):(E=r(E,y),E.return=g,E)}function d(g,E,y){if(typeof E=="string"&&E!==""||typeof E=="number")return E=yd(""+E,g.mode,y),E.return=g,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Oo:return y=Nl(E.type,E.key,E.props,null,g.mode,y),y.ref=la(g,null,E),y.return=g,y;case ms:return E=Td(E,g.mode,y),E.return=g,E;case On:var _=E._init;return d(g,_(E._payload),y)}if(ya(E)||na(E))return E=wr(E,g.mode,y,null),E.return=g,E;qo(g,E)}return null}function h(g,E,y,_){var S=E!==null?E.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return S!==null?null:o(g,E,""+y,_);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Oo:return y.key===S?l(g,E,y,_):null;case ms:return y.key===S?u(g,E,y,_):null;case On:return S=y._init,h(g,E,S(y._payload),_)}if(ya(y)||na(y))return S!==null?null:c(g,E,y,_,null);qo(g,y)}return null}function f(g,E,y,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(y)||null,o(E,g,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Oo:return g=g.get(_.key===null?y:_.key)||null,l(E,g,_,S);case ms:return g=g.get(_.key===null?y:_.key)||null,u(E,g,_,S);case On:var b=_._init;return f(g,E,y,b(_._payload),S)}if(ya(_)||na(_))return g=g.get(y)||null,c(E,g,_,S,null);qo(E,_)}return null}function m(g,E,y,_){for(var S=null,b=null,A=E,w=E=0,P=null;A!==null&&w<y.length;w++){A.index>w?(P=A,A=null):P=A.sibling;var R=h(g,A,y[w],_);if(R===null){A===null&&(A=P);break}i&&A&&R.alternate===null&&e(g,A),E=s(R,E,w),b===null?S=R:b.sibling=R,b=R,A=P}if(w===y.length)return t(g,A),Fe&&cr(g,w),S;if(A===null){for(;w<y.length;w++)A=d(g,y[w],_),A!==null&&(E=s(A,E,w),b===null?S=A:b.sibling=A,b=A);return Fe&&cr(g,w),S}for(A=n(g,A);w<y.length;w++)P=f(A,g,w,y[w],_),P!==null&&(i&&P.alternate!==null&&A.delete(P.key===null?w:P.key),E=s(P,E,w),b===null?S=P:b.sibling=P,b=P);return i&&A.forEach(function(D){return e(g,D)}),Fe&&cr(g,w),S}function p(g,E,y,_){var S=na(y);if(typeof S!="function")throw Error(U(150));if(y=S.call(y),y==null)throw Error(U(151));for(var b=S=null,A=E,w=E=0,P=null,R=y.next();A!==null&&!R.done;w++,R=y.next()){A.index>w?(P=A,A=null):P=A.sibling;var D=h(g,A,R.value,_);if(D===null){A===null&&(A=P);break}i&&A&&D.alternate===null&&e(g,A),E=s(D,E,w),b===null?S=D:b.sibling=D,b=D,A=P}if(R.done)return t(g,A),Fe&&cr(g,w),S;if(A===null){for(;!R.done;w++,R=y.next())R=d(g,R.value,_),R!==null&&(E=s(R,E,w),b===null?S=R:b.sibling=R,b=R);return Fe&&cr(g,w),S}for(A=n(g,A);!R.done;w++,R=y.next())R=f(A,g,w,R.value,_),R!==null&&(i&&R.alternate!==null&&A.delete(R.key===null?w:R.key),E=s(R,E,w),b===null?S=R:b.sibling=R,b=R);return i&&A.forEach(function(j){return e(g,j)}),Fe&&cr(g,w),S}function v(g,E,y,_){if(typeof y=="object"&&y!==null&&y.type===ps&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Oo:e:{for(var S=y.key,b=E;b!==null;){if(b.key===S){if(S=y.type,S===ps){if(b.tag===7){t(g,b.sibling),E=r(b,y.props.children),E.return=g,g=E;break e}}else if(b.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===On&&vg(S)===b.type){t(g,b.sibling),E=r(b,y.props),E.ref=la(g,b,y),E.return=g,g=E;break e}t(g,b);break}else e(g,b);b=b.sibling}y.type===ps?(E=wr(y.props.children,g.mode,_,y.key),E.return=g,g=E):(_=Nl(y.type,y.key,y.props,null,g.mode,_),_.ref=la(g,E,y),_.return=g,g=_)}return a(g);case ms:e:{for(b=y.key;E!==null;){if(E.key===b)if(E.tag===4&&E.stateNode.containerInfo===y.containerInfo&&E.stateNode.implementation===y.implementation){t(g,E.sibling),E=r(E,y.children||[]),E.return=g,g=E;break e}else{t(g,E);break}else e(g,E);E=E.sibling}E=Td(y,g.mode,_),E.return=g,g=E}return a(g);case On:return b=y._init,v(g,E,b(y._payload),_)}if(ya(y))return m(g,E,y,_);if(na(y))return p(g,E,y,_);qo(g,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,E!==null&&E.tag===6?(t(g,E.sibling),E=r(E,y),E.return=g,g=E):(t(g,E),E=yd(y,g.mode,_),E.return=g,g=E),a(g)):t(g,E)}return v}var Bs=iy(!0),ny=iy(!1),Mu=rr(null),Ou=null,As=null,lm=null;function um(){lm=As=Ou=null}function cm(i){var e=Mu.current;Oe(Mu),i._currentValue=e}function Lh(i,e,t){for(;i!==null;){var n=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),i===t)break;i=i.return}}function Ps(i,e){Ou=i,lm=As=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(Bt=!0),i.firstContext=null)}function hi(i){var e=i._currentValue;if(lm!==i)if(i={context:i,memoizedValue:e,next:null},As===null){if(Ou===null)throw Error(U(308));As=i,Ou.dependencies={lanes:0,firstContext:i}}else As=As.next=i;return e}var yr=null;function dm(i){yr===null?yr=[i]:yr.push(i)}function ry(i,e,t,n){var r=e.interleaved;return r===null?(t.next=t,dm(e)):(t.next=r.next,r.next=t),e.interleaved=t,_n(i,n)}function _n(i,e){i.lanes|=e;var t=i.alternate;for(t!==null&&(t.lanes|=e),t=i,i=i.return;i!==null;)i.childLanes|=e,t=i.alternate,t!==null&&(t.childLanes|=e),t=i,i=i.return;return t.tag===3?t.stateNode:null}var Nn=!1;function hm(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sy(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function En(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function jn(i,e,t){var n=i.updateQueue;if(n===null)return null;if(n=n.shared,Ee&2){var r=n.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),n.pending=e,_n(i,t)}return r=n.interleaved,r===null?(e.next=e,dm(n)):(e.next=r.next,r.next=e),n.interleaved=e,_n(i,t)}function kl(i,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var n=e.lanes;n&=i.pendingLanes,t|=n,e.lanes=t,Xf(i,t)}}function Eg(i,e){var t=i.updateQueue,n=i.alternate;if(n!==null&&(n=n.updateQueue,t===n)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=a:s=s.next=a,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},i.updateQueue=t;return}i=t.lastBaseUpdate,i===null?t.firstBaseUpdate=e:i.next=e,t.lastBaseUpdate=e}function Nu(i,e,t,n){var r=i.updateQueue;Nn=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=i.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var d=r.baseState;a=0,c=u=l=null,o=s;do{var h=o.lane,f=o.eventTime;if((n&h)===h){c!==null&&(c=c.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=i,p=o;switch(h=e,f=t,p.tag){case 1:if(m=p.payload,typeof m=="function"){d=m.call(f,d,h);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=p.payload,h=typeof m=="function"?m.call(f,d,h):m,h==null)break e;d=He({},d,h);break e;case 2:Nn=!0}}o.callback!==null&&o.lane!==0&&(i.flags|=64,h=r.effects,h===null?r.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=f,l=d):c=c.next=f,a|=h;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;h=o,o=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(!0);if(c===null&&(l=d),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Nr|=a,i.lanes=a,i.memoizedState=d}}function yg(i,e,t){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var n=i[e],r=n.callback;if(r!==null){if(n.callback=null,n=t,typeof r!="function")throw Error(U(191,r));r.call(n)}}}var Do={},en=rr(Do),so=rr(Do),ao=rr(Do);function Tr(i){if(i===Do)throw Error(U(174));return i}function fm(i,e){switch(Ce(ao,e),Ce(so,i),Ce(en,Do),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:uh(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=uh(e,i)}Oe(en),Ce(en,e)}function Gs(){Oe(en),Oe(so),Oe(ao)}function ay(i){Tr(ao.current);var e=Tr(en.current),t=uh(e,i.type);e!==t&&(Ce(so,i),Ce(en,t))}function mm(i){so.current===i&&(Oe(en),Oe(so))}var Be=rr(0);function Fu(i){for(var e=i;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var fd=[];function pm(){for(var i=0;i<fd.length;i++)fd[i]._workInProgressVersionPrimary=null;fd.length=0}var Dl=xn.ReactCurrentDispatcher,md=xn.ReactCurrentBatchConfig,Or=0,Ge=null,st=null,ft=null,Uu=!1,Fa=!1,oo=0,r1=0;function xt(){throw Error(U(321))}function gm(i,e){if(e===null)return!1;for(var t=0;t<e.length&&t<i.length;t++)if(!Di(i[t],e[t]))return!1;return!0}function vm(i,e,t,n,r,s){if(Or=s,Ge=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Dl.current=i===null||i.memoizedState===null?l1:u1,i=t(n,r),Fa){s=0;do{if(Fa=!1,oo=0,25<=s)throw Error(U(301));s+=1,ft=st=null,e.updateQueue=null,Dl.current=c1,i=t(n,r)}while(Fa)}if(Dl.current=$u,e=st!==null&&st.next!==null,Or=0,ft=st=Ge=null,Uu=!1,e)throw Error(U(300));return i}function Em(){var i=oo!==0;return oo=0,i}function qi(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ft===null?Ge.memoizedState=ft=i:ft=ft.next=i,ft}function fi(){if(st===null){var i=Ge.alternate;i=i!==null?i.memoizedState:null}else i=st.next;var e=ft===null?Ge.memoizedState:ft.next;if(e!==null)ft=e,st=i;else{if(i===null)throw Error(U(310));st=i,i={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},ft===null?Ge.memoizedState=ft=i:ft=ft.next=i}return ft}function lo(i,e){return typeof e=="function"?e(i):e}function pd(i){var e=fi(),t=e.queue;if(t===null)throw Error(U(311));t.lastRenderedReducer=i;var n=st,r=n.baseQueue,s=t.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}n.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,n=n.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((Or&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:i(n,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,a=n):l=l.next=d,Ge.lanes|=c,Nr|=c}u=u.next}while(u!==null&&u!==s);l===null?a=n:l.next=o,Di(n,e.memoizedState)||(Bt=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=l,t.lastRenderedState=n}if(i=t.interleaved,i!==null){r=i;do s=r.lane,Ge.lanes|=s,Nr|=s,r=r.next;while(r!==i)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function gd(i){var e=fi(),t=e.queue;if(t===null)throw Error(U(311));t.lastRenderedReducer=i;var n=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var a=r=r.next;do s=i(s,a.action),a=a.next;while(a!==r);Di(s,e.memoizedState)||(Bt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,n]}function oy(){}function ly(i,e){var t=Ge,n=fi(),r=e(),s=!Di(n.memoizedState,r);if(s&&(n.memoizedState=r,Bt=!0),n=n.queue,ym(dy.bind(null,t,n,i),[i]),n.getSnapshot!==e||s||ft!==null&&ft.memoizedState.tag&1){if(t.flags|=2048,uo(9,cy.bind(null,t,n,r,e),void 0,null),gt===null)throw Error(U(349));Or&30||uy(t,e,r)}return r}function uy(i,e,t){i.flags|=16384,i={getSnapshot:e,value:t},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.stores=[i]):(t=e.stores,t===null?e.stores=[i]:t.push(i))}function cy(i,e,t,n){e.value=t,e.getSnapshot=n,hy(e)&&fy(i)}function dy(i,e,t){return t(function(){hy(e)&&fy(i)})}function hy(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!Di(i,t)}catch{return!0}}function fy(i){var e=_n(i,1);e!==null&&ki(e,i,1,-1)}function Tg(i){var e=qi();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:lo,lastRenderedState:i},e.queue=i,i=i.dispatch=o1.bind(null,Ge,i),[e.memoizedState,i]}function uo(i,e,t,n){return i={tag:i,create:e,destroy:t,deps:n,next:null},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.lastEffect=i.next=i):(t=e.lastEffect,t===null?e.lastEffect=i.next=i:(n=t.next,t.next=i,i.next=n,e.lastEffect=i)),i}function my(){return fi().memoizedState}function Cl(i,e,t,n){var r=qi();Ge.flags|=i,r.memoizedState=uo(1|e,t,void 0,n===void 0?null:n)}function wc(i,e,t,n){var r=fi();n=n===void 0?null:n;var s=void 0;if(st!==null){var a=st.memoizedState;if(s=a.destroy,n!==null&&gm(n,a.deps)){r.memoizedState=uo(e,t,s,n);return}}Ge.flags|=i,r.memoizedState=uo(1|e,t,s,n)}function _g(i,e){return Cl(8390656,8,i,e)}function ym(i,e){return wc(2048,8,i,e)}function py(i,e){return wc(4,2,i,e)}function gy(i,e){return wc(4,4,i,e)}function vy(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function Ey(i,e,t){return t=t!=null?t.concat([i]):null,wc(4,4,vy.bind(null,e,i),t)}function Tm(){}function yy(i,e){var t=fi();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&gm(e,n[1])?n[0]:(t.memoizedState=[i,e],i)}function Ty(i,e){var t=fi();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&gm(e,n[1])?n[0]:(i=i(),t.memoizedState=[i,e],i)}function _y(i,e,t){return Or&21?(Di(t,e)||(t=RE(),Ge.lanes|=t,Nr|=t,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,Bt=!0),i.memoizedState=t)}function s1(i,e){var t=xe;xe=t!==0&&4>t?t:4,i(!0);var n=md.transition;md.transition={};try{i(!1),e()}finally{xe=t,md.transition=n}}function Sy(){return fi().memoizedState}function a1(i,e,t){var n=Qn(i);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},Ay(i))xy(e,t);else if(t=ry(i,e,t,n),t!==null){var r=Pt();ki(t,i,n,r),by(t,e,n)}}function o1(i,e,t){var n=Qn(i),r={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(Ay(i))xy(e,r);else{var s=i.alternate;if(i.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,t);if(r.hasEagerState=!0,r.eagerState=o,Di(o,a)){var l=e.interleaved;l===null?(r.next=r,dm(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}t=ry(i,e,r,n),t!==null&&(r=Pt(),ki(t,i,n,r),by(t,e,n))}}function Ay(i){var e=i.alternate;return i===Ge||e!==null&&e===Ge}function xy(i,e){Fa=Uu=!0;var t=i.pending;t===null?e.next=e:(e.next=t.next,t.next=e),i.pending=e}function by(i,e,t){if(t&4194240){var n=e.lanes;n&=i.pendingLanes,t|=n,e.lanes=t,Xf(i,t)}}var $u={readContext:hi,useCallback:xt,useContext:xt,useEffect:xt,useImperativeHandle:xt,useInsertionEffect:xt,useLayoutEffect:xt,useMemo:xt,useReducer:xt,useRef:xt,useState:xt,useDebugValue:xt,useDeferredValue:xt,useTransition:xt,useMutableSource:xt,useSyncExternalStore:xt,useId:xt,unstable_isNewReconciler:!1},l1={readContext:hi,useCallback:function(i,e){return qi().memoizedState=[i,e===void 0?null:e],i},useContext:hi,useEffect:_g,useImperativeHandle:function(i,e,t){return t=t!=null?t.concat([i]):null,Cl(4194308,4,vy.bind(null,e,i),t)},useLayoutEffect:function(i,e){return Cl(4194308,4,i,e)},useInsertionEffect:function(i,e){return Cl(4,2,i,e)},useMemo:function(i,e){var t=qi();return e=e===void 0?null:e,i=i(),t.memoizedState=[i,e],i},useReducer:function(i,e,t){var n=qi();return e=t!==void 0?t(e):e,n.memoizedState=n.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},n.queue=i,i=i.dispatch=a1.bind(null,Ge,i),[n.memoizedState,i]},useRef:function(i){var e=qi();return i={current:i},e.memoizedState=i},useState:Tg,useDebugValue:Tm,useDeferredValue:function(i){return qi().memoizedState=i},useTransition:function(){var i=Tg(!1),e=i[0];return i=s1.bind(null,i[1]),qi().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,t){var n=Ge,r=qi();if(Fe){if(t===void 0)throw Error(U(407));t=t()}else{if(t=e(),gt===null)throw Error(U(349));Or&30||uy(n,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,_g(dy.bind(null,n,s,i),[i]),n.flags|=2048,uo(9,cy.bind(null,n,s,t,e),void 0,null),t},useId:function(){var i=qi(),e=gt.identifierPrefix;if(Fe){var t=vn,n=gn;t=(n&~(1<<32-Li(n)-1)).toString(32)+t,e=":"+e+"R"+t,t=oo++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=r1++,e=":"+e+"r"+t.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},u1={readContext:hi,useCallback:yy,useContext:hi,useEffect:ym,useImperativeHandle:Ey,useInsertionEffect:py,useLayoutEffect:gy,useMemo:Ty,useReducer:pd,useRef:my,useState:function(){return pd(lo)},useDebugValue:Tm,useDeferredValue:function(i){var e=fi();return _y(e,st.memoizedState,i)},useTransition:function(){var i=pd(lo)[0],e=fi().memoizedState;return[i,e]},useMutableSource:oy,useSyncExternalStore:ly,useId:Sy,unstable_isNewReconciler:!1},c1={readContext:hi,useCallback:yy,useContext:hi,useEffect:ym,useImperativeHandle:Ey,useInsertionEffect:py,useLayoutEffect:gy,useMemo:Ty,useReducer:gd,useRef:my,useState:function(){return gd(lo)},useDebugValue:Tm,useDeferredValue:function(i){var e=fi();return st===null?e.memoizedState=i:_y(e,st.memoizedState,i)},useTransition:function(){var i=gd(lo)[0],e=fi().memoizedState;return[i,e]},useMutableSource:oy,useSyncExternalStore:ly,useId:Sy,unstable_isNewReconciler:!1};function Si(i,e){if(i&&i.defaultProps){e=He({},e),i=i.defaultProps;for(var t in i)e[t]===void 0&&(e[t]=i[t]);return e}return e}function kh(i,e,t,n){e=i.memoizedState,t=t(n,e),t=t==null?e:He({},e,t),i.memoizedState=t,i.lanes===0&&(i.updateQueue.baseState=t)}var Ic={isMounted:function(i){return(i=i._reactInternals)?Gr(i)===i:!1},enqueueSetState:function(i,e,t){i=i._reactInternals;var n=Pt(),r=Qn(i),s=En(n,r);s.payload=e,t!=null&&(s.callback=t),e=jn(i,s,r),e!==null&&(ki(e,i,r,n),kl(e,i,r))},enqueueReplaceState:function(i,e,t){i=i._reactInternals;var n=Pt(),r=Qn(i),s=En(n,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=jn(i,s,r),e!==null&&(ki(e,i,r,n),kl(e,i,r))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var t=Pt(),n=Qn(i),r=En(t,n);r.tag=2,e!=null&&(r.callback=e),e=jn(i,r,n),e!==null&&(ki(e,i,n,t),kl(e,i,n))}};function Sg(i,e,t,n,r,s,a){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(n,s,a):e.prototype&&e.prototype.isPureReactComponent?!to(t,n)||!to(r,s):!0}function Ry(i,e,t){var n=!1,r=tr,s=e.contextType;return typeof s=="object"&&s!==null?s=hi(s):(r=Ht(e)?Pr:kt.current,n=e.contextTypes,s=(n=n!=null)?Us(i,r):tr),e=new e(t,s),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ic,i.stateNode=e,e._reactInternals=i,n&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=r,i.__reactInternalMemoizedMaskedChildContext=s),e}function Ag(i,e,t,n){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,n),e.state!==i&&Ic.enqueueReplaceState(e,e.state,null)}function Dh(i,e,t,n){var r=i.stateNode;r.props=t,r.state=i.memoizedState,r.refs={},hm(i);var s=e.contextType;typeof s=="object"&&s!==null?r.context=hi(s):(s=Ht(e)?Pr:kt.current,r.context=Us(i,s)),r.state=i.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(kh(i,e,s,t),r.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Ic.enqueueReplaceState(r,r.state,null),Nu(i,t,r,n),r.state=i.memoizedState),typeof r.componentDidMount=="function"&&(i.flags|=4194308)}function Hs(i,e){try{var t="",n=e;do t+=Ux(n),n=n.return;while(n);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:i,source:e,stack:r,digest:null}}function vd(i,e,t){return{value:i,source:null,stack:t??null,digest:e??null}}function Ch(i,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var d1=typeof WeakMap=="function"?WeakMap:Map;function wy(i,e,t){t=En(-1,t),t.tag=3,t.payload={element:null};var n=e.value;return t.callback=function(){Gu||(Gu=!0,Hh=n),Ch(i,e)},t}function Iy(i,e,t){t=En(-1,t),t.tag=3;var n=i.type.getDerivedStateFromError;if(typeof n=="function"){var r=e.value;t.payload=function(){return n(r)},t.callback=function(){Ch(i,e)}}var s=i.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Ch(i,e),typeof n!="function"&&(zn===null?zn=new Set([this]):zn.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function xg(i,e,t){var n=i.pingCache;if(n===null){n=i.pingCache=new d1;var r=new Set;n.set(e,r)}else r=n.get(e),r===void 0&&(r=new Set,n.set(e,r));r.has(t)||(r.add(t),i=b1.bind(null,i,e,t),e.then(i,i))}function bg(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function Rg(i,e,t,n,r){return i.mode&1?(i.flags|=65536,i.lanes=r,i):(i===e?i.flags|=65536:(i.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=En(-1,1),e.tag=2,jn(t,e,1))),t.lanes|=1),i)}var h1=xn.ReactCurrentOwner,Bt=!1;function Dt(i,e,t,n){e.child=i===null?ny(e,null,t,n):Bs(e,i.child,t,n)}function wg(i,e,t,n,r){t=t.render;var s=e.ref;return Ps(e,r),n=vm(i,e,t,n,s,r),t=Em(),i!==null&&!Bt?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~r,Sn(i,e,r)):(Fe&&t&&sm(e),e.flags|=1,Dt(i,e,n,r),e.child)}function Ig(i,e,t,n,r){if(i===null){var s=t.type;return typeof s=="function"&&!Im(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,Ly(i,e,s,n,r)):(i=Nl(t.type,null,n,e,e.mode,r),i.ref=e.ref,i.return=e,e.child=i)}if(s=i.child,!(i.lanes&r)){var a=s.memoizedProps;if(t=t.compare,t=t!==null?t:to,t(a,n)&&i.ref===e.ref)return Sn(i,e,r)}return e.flags|=1,i=Xn(s,n),i.ref=e.ref,i.return=e,e.child=i}function Ly(i,e,t,n,r){if(i!==null){var s=i.memoizedProps;if(to(s,n)&&i.ref===e.ref)if(Bt=!1,e.pendingProps=n=s,(i.lanes&r)!==0)i.flags&131072&&(Bt=!0);else return e.lanes=i.lanes,Sn(i,e,r)}return Ph(i,e,t,n,r)}function ky(i,e,t){var n=e.pendingProps,r=n.children,s=i!==null?i.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(bs,Qt),Qt|=t;else{if(!(t&1073741824))return i=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,Ce(bs,Qt),Qt|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:t,Ce(bs,Qt),Qt|=n}else s!==null?(n=s.baseLanes|t,e.memoizedState=null):n=t,Ce(bs,Qt),Qt|=n;return Dt(i,e,r,t),e.child}function Dy(i,e){var t=e.ref;(i===null&&t!==null||i!==null&&i.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Ph(i,e,t,n,r){var s=Ht(t)?Pr:kt.current;return s=Us(e,s),Ps(e,r),t=vm(i,e,t,n,s,r),n=Em(),i!==null&&!Bt?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~r,Sn(i,e,r)):(Fe&&n&&sm(e),e.flags|=1,Dt(i,e,t,r),e.child)}function Lg(i,e,t,n,r){if(Ht(t)){var s=!0;Du(e)}else s=!1;if(Ps(e,r),e.stateNode===null)Pl(i,e),Ry(e,t,n),Dh(e,t,n,r),n=!0;else if(i===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=hi(u):(u=Ht(t)?Pr:kt.current,u=Us(e,u));var c=t.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==u)&&Ag(e,a,n,u),Nn=!1;var h=e.memoizedState;a.state=h,Nu(e,n,a,r),l=e.memoizedState,o!==n||h!==l||Gt.current||Nn?(typeof c=="function"&&(kh(e,t,c,n),l=e.memoizedState),(o=Nn||Sg(e,t,o,n,h,l,u))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),a.props=n,a.state=l,a.context=u,n=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,sy(i,e),o=e.memoizedProps,u=e.type===e.elementType?o:Si(e.type,o),a.props=u,d=e.pendingProps,h=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=hi(l):(l=Ht(t)?Pr:kt.current,l=Us(e,l));var f=t.getDerivedStateFromProps;(c=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||h!==l)&&Ag(e,a,n,l),Nn=!1,h=e.memoizedState,a.state=h,Nu(e,n,a,r);var m=e.memoizedState;o!==d||h!==m||Gt.current||Nn?(typeof f=="function"&&(kh(e,t,f,n),m=e.memoizedState),(u=Nn||Sg(e,t,u,n,h,m,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,m,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,m,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===i.memoizedProps&&h===i.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===i.memoizedProps&&h===i.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),a.props=n,a.state=m,a.context=l,n=u):(typeof a.componentDidUpdate!="function"||o===i.memoizedProps&&h===i.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===i.memoizedProps&&h===i.memoizedState||(e.flags|=1024),n=!1)}return Mh(i,e,t,n,s,r)}function Mh(i,e,t,n,r,s){Dy(i,e);var a=(e.flags&128)!==0;if(!n&&!a)return r&&mg(e,t,!1),Sn(i,e,s);n=e.stateNode,h1.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,i!==null&&a?(e.child=Bs(e,i.child,null,s),e.child=Bs(e,null,o,s)):Dt(i,e,o,s),e.memoizedState=n.state,r&&mg(e,t,!0),e.child}function Cy(i){var e=i.stateNode;e.pendingContext?fg(i,e.pendingContext,e.pendingContext!==e.context):e.context&&fg(i,e.context,!1),fm(i,e.containerInfo)}function kg(i,e,t,n,r){return $s(),om(r),e.flags|=256,Dt(i,e,t,n),e.child}var Oh={dehydrated:null,treeContext:null,retryLane:0};function Nh(i){return{baseLanes:i,cachePool:null,transitions:null}}function Py(i,e,t){var n=e.pendingProps,r=Be.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=i!==null&&i.memoizedState===null?!1:(r&2)!==0),o?(s=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(r|=1),Ce(Be,r&1),i===null)return Ih(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,i=n.fallback,s?(n=e.mode,s=e.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Dc(a,n,0,null),i=wr(i,n,t,null),s.return=e,i.return=e,s.sibling=i,e.child=s,e.child.memoizedState=Nh(t),e.memoizedState=Oh,i):_m(e,a));if(r=i.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return f1(i,e,a,n,o,r,t);if(s){s=n.fallback,a=e.mode,r=i.child,o=r.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&e.child!==r?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=Xn(r,l),n.subtreeFlags=r.subtreeFlags&14680064),o!==null?s=Xn(o,s):(s=wr(s,a,t,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,a=i.child.memoizedState,a=a===null?Nh(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=i.childLanes&~t,e.memoizedState=Oh,n}return s=i.child,i=s.sibling,n=Xn(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=t),n.return=e,n.sibling=null,i!==null&&(t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)),e.child=n,e.memoizedState=null,n}function _m(i,e){return e=Dc({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function Yo(i,e,t,n){return n!==null&&om(n),Bs(e,i.child,null,t),i=_m(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function f1(i,e,t,n,r,s,a){if(t)return e.flags&256?(e.flags&=-257,n=vd(Error(U(422))),Yo(i,e,a,n)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(s=n.fallback,r=e.mode,n=Dc({mode:"visible",children:n.children},r,0,null),s=wr(s,r,a,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Bs(e,i.child,null,a),e.child.memoizedState=Nh(a),e.memoizedState=Oh,s);if(!(e.mode&1))return Yo(i,e,a,null);if(r.data==="$!"){if(n=r.nextSibling&&r.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(U(419)),n=vd(s,n,void 0),Yo(i,e,a,n)}if(o=(a&i.childLanes)!==0,Bt||o){if(n=gt,n!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(n.suspendedLanes|a)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,_n(i,r),ki(n,i,r,-1))}return wm(),n=vd(Error(U(421))),Yo(i,e,a,n)}return r.data==="$?"?(e.flags|=128,e.child=i.child,e=R1.bind(null,i),r._reactRetry=e,null):(i=s.treeContext,Xt=Yn(r.nextSibling),Zt=e,Fe=!0,bi=null,i!==null&&(oi[li++]=gn,oi[li++]=vn,oi[li++]=Mr,gn=i.id,vn=i.overflow,Mr=e),e=_m(e,n.children),e.flags|=4096,e)}function Dg(i,e,t){i.lanes|=e;var n=i.alternate;n!==null&&(n.lanes|=e),Lh(i.return,e,t)}function Ed(i,e,t,n,r){var s=i.memoizedState;s===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=t,s.tailMode=r)}function My(i,e,t){var n=e.pendingProps,r=n.revealOrder,s=n.tail;if(Dt(i,e,n.children,t),n=Be.current,n&2)n=n&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Dg(i,t,e);else if(i.tag===19)Dg(i,t,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}n&=1}if(Ce(Be,n),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)i=t.alternate,i!==null&&Fu(i)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),Ed(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(i=r.alternate,i!==null&&Fu(i)===null){e.child=r;break}i=r.sibling,r.sibling=t,t=r,r=i}Ed(e,!0,t,null,s);break;case"together":Ed(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Pl(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function Sn(i,e,t){if(i!==null&&(e.dependencies=i.dependencies),Nr|=e.lanes,!(t&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(U(153));if(e.child!==null){for(i=e.child,t=Xn(i,i.pendingProps),e.child=t,t.return=e;i.sibling!==null;)i=i.sibling,t=t.sibling=Xn(i,i.pendingProps),t.return=e;t.sibling=null}return e.child}function m1(i,e,t){switch(e.tag){case 3:Cy(e),$s();break;case 5:ay(e);break;case 1:Ht(e.type)&&Du(e);break;case 4:fm(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,r=e.memoizedProps.value;Ce(Mu,n._currentValue),n._currentValue=r;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Ce(Be,Be.current&1),e.flags|=128,null):t&e.child.childLanes?Py(i,e,t):(Ce(Be,Be.current&1),i=Sn(i,e,t),i!==null?i.sibling:null);Ce(Be,Be.current&1);break;case 19:if(n=(t&e.childLanes)!==0,i.flags&128){if(n)return My(i,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ce(Be,Be.current),n)break;return null;case 22:case 23:return e.lanes=0,ky(i,e,t)}return Sn(i,e,t)}var Oy,Fh,Ny,Fy;Oy=function(i,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)i.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Fh=function(){};Ny=function(i,e,t,n){var r=i.memoizedProps;if(r!==n){i=e.stateNode,Tr(en.current);var s=null;switch(t){case"input":r=sh(i,r),n=sh(i,n),s=[];break;case"select":r=He({},r,{value:void 0}),n=He({},n,{value:void 0}),s=[];break;case"textarea":r=lh(i,r),n=lh(i,n),s=[];break;default:typeof r.onClick!="function"&&typeof n.onClick=="function"&&(i.onclick=Lu)}ch(t,n);var a;t=null;for(u in r)if(!n.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var o=r[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ja.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=r!=null?r[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(s||(s=[]),s.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ja.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Pe("scroll",i),s||o===l||(s=[])):(s=s||[]).push(u,l))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};Fy=function(i,e,t,n){t!==n&&(e.flags|=4)};function ua(i,e){if(!Fe)switch(i.tailMode){case"hidden":e=i.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?i.tail=null:t.sibling=null;break;case"collapsed":t=i.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:n.sibling=null}}function bt(i){var e=i.alternate!==null&&i.alternate.child===i.child,t=0,n=0;if(e)for(var r=i.child;r!==null;)t|=r.lanes|r.childLanes,n|=r.subtreeFlags&14680064,n|=r.flags&14680064,r.return=i,r=r.sibling;else for(r=i.child;r!==null;)t|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=i,r=r.sibling;return i.subtreeFlags|=n,i.childLanes=t,e}function p1(i,e,t){var n=e.pendingProps;switch(am(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(e),null;case 1:return Ht(e.type)&&ku(),bt(e),null;case 3:return n=e.stateNode,Gs(),Oe(Gt),Oe(kt),pm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(i===null||i.child===null)&&(Wo(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bi!==null&&(Wh(bi),bi=null))),Fh(i,e),bt(e),null;case 5:mm(e);var r=Tr(ao.current);if(t=e.type,i!==null&&e.stateNode!=null)Ny(i,e,t,n,r),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(U(166));return bt(e),null}if(i=Tr(en.current),Wo(e)){n=e.stateNode,t=e.type;var s=e.memoizedProps;switch(n[zi]=e,n[ro]=s,i=(e.mode&1)!==0,t){case"dialog":Pe("cancel",n),Pe("close",n);break;case"iframe":case"object":case"embed":Pe("load",n);break;case"video":case"audio":for(r=0;r<_a.length;r++)Pe(_a[r],n);break;case"source":Pe("error",n);break;case"img":case"image":case"link":Pe("error",n),Pe("load",n);break;case"details":Pe("toggle",n);break;case"input":Bp(n,s),Pe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Pe("invalid",n);break;case"textarea":Hp(n,s),Pe("invalid",n)}ch(t,s),r=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Ko(n.textContent,o,i),r=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Ko(n.textContent,o,i),r=["children",""+o]):ja.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Pe("scroll",n)}switch(t){case"input":No(n),Gp(n,s,!0);break;case"textarea":No(n),Vp(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Lu)}n=r,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=dE(t)),i==="http://www.w3.org/1999/xhtml"?t==="script"?(i=a.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof n.is=="string"?i=a.createElement(t,{is:n.is}):(i=a.createElement(t),t==="select"&&(a=i,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):i=a.createElementNS(i,t),i[zi]=e,i[ro]=n,Oy(i,e,!1,!1),e.stateNode=i;e:{switch(a=dh(t,n),t){case"dialog":Pe("cancel",i),Pe("close",i),r=n;break;case"iframe":case"object":case"embed":Pe("load",i),r=n;break;case"video":case"audio":for(r=0;r<_a.length;r++)Pe(_a[r],i);r=n;break;case"source":Pe("error",i),r=n;break;case"img":case"image":case"link":Pe("error",i),Pe("load",i),r=n;break;case"details":Pe("toggle",i),r=n;break;case"input":Bp(i,n),r=sh(i,n),Pe("invalid",i);break;case"option":r=n;break;case"select":i._wrapperState={wasMultiple:!!n.multiple},r=He({},n,{value:void 0}),Pe("invalid",i);break;case"textarea":Hp(i,n),r=lh(i,n),Pe("invalid",i);break;default:r=n}ch(t,r),o=r;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?mE(i,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&hE(i,l)):s==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&za(i,l):typeof l=="number"&&za(i,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ja.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Pe("scroll",i):l!=null&&Wf(i,s,l,a))}switch(t){case"input":No(i),Gp(i,n,!1);break;case"textarea":No(i),Vp(i);break;case"option":n.value!=null&&i.setAttribute("value",""+er(n.value));break;case"select":i.multiple=!!n.multiple,s=n.value,s!=null?Ls(i,!!n.multiple,s,!1):n.defaultValue!=null&&Ls(i,!!n.multiple,n.defaultValue,!0);break;default:typeof r.onClick=="function"&&(i.onclick=Lu)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return bt(e),null;case 6:if(i&&e.stateNode!=null)Fy(i,e,i.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(U(166));if(t=Tr(ao.current),Tr(en.current),Wo(e)){if(n=e.stateNode,t=e.memoizedProps,n[zi]=e,(s=n.nodeValue!==t)&&(i=Zt,i!==null))switch(i.tag){case 3:Ko(n.nodeValue,t,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Ko(n.nodeValue,t,(i.mode&1)!==0)}s&&(e.flags|=4)}else n=(t.nodeType===9?t:t.ownerDocument).createTextNode(n),n[zi]=e,e.stateNode=n}return bt(e),null;case 13:if(Oe(Be),n=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Fe&&Xt!==null&&e.mode&1&&!(e.flags&128))ty(),$s(),e.flags|=98560,s=!1;else if(s=Wo(e),n!==null&&n.dehydrated!==null){if(i===null){if(!s)throw Error(U(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(U(317));s[zi]=e}else $s(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;bt(e),s=!1}else bi!==null&&(Wh(bi),bi=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(n=n!==null,n!==(i!==null&&i.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(i===null||Be.current&1?ot===0&&(ot=3):wm())),e.updateQueue!==null&&(e.flags|=4),bt(e),null);case 4:return Gs(),Fh(i,e),i===null&&io(e.stateNode.containerInfo),bt(e),null;case 10:return cm(e.type._context),bt(e),null;case 17:return Ht(e.type)&&ku(),bt(e),null;case 19:if(Oe(Be),s=e.memoizedState,s===null)return bt(e),null;if(n=(e.flags&128)!==0,a=s.rendering,a===null)if(n)ua(s,!1);else{if(ot!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(a=Fu(i),a!==null){for(e.flags|=128,ua(s,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=t,t=e.child;t!==null;)s=t,i=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,i=a.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t=t.sibling;return Ce(Be,Be.current&1|2),e.child}i=i.sibling}s.tail!==null&&je()>Vs&&(e.flags|=128,n=!0,ua(s,!1),e.lanes=4194304)}else{if(!n)if(i=Fu(a),i!==null){if(e.flags|=128,n=!0,t=i.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),ua(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Fe)return bt(e),null}else 2*je()-s.renderingStartTime>Vs&&t!==1073741824&&(e.flags|=128,n=!0,ua(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(t=s.last,t!==null?t.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=je(),e.sibling=null,t=Be.current,Ce(Be,n?t&1|2:t&1),e):(bt(e),null);case 22:case 23:return Rm(),n=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Qt&1073741824&&(bt(e),e.subtreeFlags&6&&(e.flags|=8192)):bt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function g1(i,e){switch(am(e),e.tag){case 1:return Ht(e.type)&&ku(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return Gs(),Oe(Gt),Oe(kt),pm(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return mm(e),null;case 13:if(Oe(Be),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(U(340));$s()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return Oe(Be),null;case 4:return Gs(),null;case 10:return cm(e.type._context),null;case 22:case 23:return Rm(),null;case 24:return null;default:return null}}var jo=!1,It=!1,v1=typeof WeakSet=="function"?WeakSet:Set,H=null;function xs(i,e){var t=i.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(n){Ve(i,e,n)}else t.current=null}function Uh(i,e,t){try{t()}catch(n){Ve(i,e,n)}}var Cg=!1;function E1(i,e){if(_h=Ru,i=HE(),rm(i)){if("selectionStart"in i)var t={start:i.selectionStart,end:i.selectionEnd};else e:{t=(t=i.ownerDocument)&&t.defaultView||window;var n=t.getSelection&&t.getSelection();if(n&&n.rangeCount!==0){t=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,u=0,c=0,d=i,h=null;t:for(;;){for(var f;d!==t||r!==0&&d.nodeType!==3||(o=a+r),d!==s||n!==0&&d.nodeType!==3||(l=a+n),d.nodeType===3&&(a+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===i)break t;if(h===t&&++u===r&&(o=a),h===s&&++c===n&&(l=a),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Sh={focusedElem:i,selectionRange:t},Ru=!1,H=e;H!==null;)if(e=H,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,H=i;else for(;H!==null;){e=H;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var p=m.memoizedProps,v=m.memoizedState,g=e.stateNode,E=g.getSnapshotBeforeUpdate(e.elementType===e.type?p:Si(e.type,p),v);g.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(_){Ve(e,e.return,_)}if(i=e.sibling,i!==null){i.return=e.return,H=i;break}H=e.return}return m=Cg,Cg=!1,m}function Ua(i,e,t){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&i)===i){var s=r.destroy;r.destroy=void 0,s!==void 0&&Uh(e,t,s)}r=r.next}while(r!==n)}}function Lc(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&i)===i){var n=t.create;t.destroy=n()}t=t.next}while(t!==e)}}function $h(i){var e=i.ref;if(e!==null){var t=i.stateNode;switch(i.tag){case 5:i=t;break;default:i=t}typeof e=="function"?e(i):e.current=i}}function Uy(i){var e=i.alternate;e!==null&&(i.alternate=null,Uy(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[zi],delete e[ro],delete e[bh],delete e[e1],delete e[t1])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function $y(i){return i.tag===5||i.tag===3||i.tag===4}function Pg(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||$y(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Bh(i,e,t){var n=i.tag;if(n===5||n===6)i=i.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(i,e):t.insertBefore(i,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(i,t)):(e=t,e.appendChild(i)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Lu));else if(n!==4&&(i=i.child,i!==null))for(Bh(i,e,t),i=i.sibling;i!==null;)Bh(i,e,t),i=i.sibling}function Gh(i,e,t){var n=i.tag;if(n===5||n===6)i=i.stateNode,e?t.insertBefore(i,e):t.appendChild(i);else if(n!==4&&(i=i.child,i!==null))for(Gh(i,e,t),i=i.sibling;i!==null;)Gh(i,e,t),i=i.sibling}var Tt=null,xi=!1;function wn(i,e,t){for(t=t.child;t!==null;)By(i,e,t),t=t.sibling}function By(i,e,t){if(Ji&&typeof Ji.onCommitFiberUnmount=="function")try{Ji.onCommitFiberUnmount(_c,t)}catch{}switch(t.tag){case 5:It||xs(t,e);case 6:var n=Tt,r=xi;Tt=null,wn(i,e,t),Tt=n,xi=r,Tt!==null&&(xi?(i=Tt,t=t.stateNode,i.nodeType===8?i.parentNode.removeChild(t):i.removeChild(t)):Tt.removeChild(t.stateNode));break;case 18:Tt!==null&&(xi?(i=Tt,t=t.stateNode,i.nodeType===8?dd(i.parentNode,t):i.nodeType===1&&dd(i,t),Ja(i)):dd(Tt,t.stateNode));break;case 4:n=Tt,r=xi,Tt=t.stateNode.containerInfo,xi=!0,wn(i,e,t),Tt=n,xi=r;break;case 0:case 11:case 14:case 15:if(!It&&(n=t.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){r=n=n.next;do{var s=r,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Uh(t,e,a),r=r.next}while(r!==n)}wn(i,e,t);break;case 1:if(!It&&(xs(t,e),n=t.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(o){Ve(t,e,o)}wn(i,e,t);break;case 21:wn(i,e,t);break;case 22:t.mode&1?(It=(n=It)||t.memoizedState!==null,wn(i,e,t),It=n):wn(i,e,t);break;default:wn(i,e,t)}}function Mg(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var t=i.stateNode;t===null&&(t=i.stateNode=new v1),e.forEach(function(n){var r=w1.bind(null,i,n);t.has(n)||(t.add(n),n.then(r,r))})}}function gi(i,e){var t=e.deletions;if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];try{var s=i,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Tt=o.stateNode,xi=!1;break e;case 3:Tt=o.stateNode.containerInfo,xi=!0;break e;case 4:Tt=o.stateNode.containerInfo,xi=!0;break e}o=o.return}if(Tt===null)throw Error(U(160));By(s,a,r),Tt=null,xi=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(u){Ve(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Gy(e,i),e=e.sibling}function Gy(i,e){var t=i.alternate,n=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(gi(e,i),Pi(i),n&4){try{Ua(3,i,i.return),Lc(3,i)}catch(p){Ve(i,i.return,p)}try{Ua(5,i,i.return)}catch(p){Ve(i,i.return,p)}}break;case 1:gi(e,i),Pi(i),n&512&&t!==null&&xs(t,t.return);break;case 5:if(gi(e,i),Pi(i),n&512&&t!==null&&xs(t,t.return),i.flags&32){var r=i.stateNode;try{za(r,"")}catch(p){Ve(i,i.return,p)}}if(n&4&&(r=i.stateNode,r!=null)){var s=i.memoizedProps,a=t!==null?t.memoizedProps:s,o=i.type,l=i.updateQueue;if(i.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&uE(r,s),dh(o,a);var u=dh(o,s);for(a=0;a<l.length;a+=2){var c=l[a],d=l[a+1];c==="style"?mE(r,d):c==="dangerouslySetInnerHTML"?hE(r,d):c==="children"?za(r,d):Wf(r,c,d,u)}switch(o){case"input":ah(r,s);break;case"textarea":cE(r,s);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Ls(r,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?Ls(r,!!s.multiple,s.defaultValue,!0):Ls(r,!!s.multiple,s.multiple?[]:"",!1))}r[ro]=s}catch(p){Ve(i,i.return,p)}}break;case 6:if(gi(e,i),Pi(i),n&4){if(i.stateNode===null)throw Error(U(162));r=i.stateNode,s=i.memoizedProps;try{r.nodeValue=s}catch(p){Ve(i,i.return,p)}}break;case 3:if(gi(e,i),Pi(i),n&4&&t!==null&&t.memoizedState.isDehydrated)try{Ja(e.containerInfo)}catch(p){Ve(i,i.return,p)}break;case 4:gi(e,i),Pi(i);break;case 13:gi(e,i),Pi(i),r=i.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(xm=je())),n&4&&Mg(i);break;case 22:if(c=t!==null&&t.memoizedState!==null,i.mode&1?(It=(u=It)||c,gi(e,i),It=u):gi(e,i),Pi(i),n&8192){if(u=i.memoizedState!==null,(i.stateNode.isHidden=u)&&!c&&i.mode&1)for(H=i,c=i.child;c!==null;){for(d=H=c;H!==null;){switch(h=H,f=h.child,h.tag){case 0:case 11:case 14:case 15:Ua(4,h,h.return);break;case 1:xs(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){n=h,t=h.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(p){Ve(n,t,p)}}break;case 5:xs(h,h.return);break;case 22:if(h.memoizedState!==null){Ng(d);continue}}f!==null?(f.return=h,H=f):Ng(d)}c=c.sibling}e:for(c=null,d=i;;){if(d.tag===5){if(c===null){c=d;try{r=d.stateNode,u?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=fE("display",a))}catch(p){Ve(i,i.return,p)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(p){Ve(i,i.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===i)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===i)break e;for(;d.sibling===null;){if(d.return===null||d.return===i)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gi(e,i),Pi(i),n&4&&Mg(i);break;case 21:break;default:gi(e,i),Pi(i)}}function Pi(i){var e=i.flags;if(e&2){try{e:{for(var t=i.return;t!==null;){if($y(t)){var n=t;break e}t=t.return}throw Error(U(160))}switch(n.tag){case 5:var r=n.stateNode;n.flags&32&&(za(r,""),n.flags&=-33);var s=Pg(i);Gh(i,s,r);break;case 3:case 4:var a=n.stateNode.containerInfo,o=Pg(i);Bh(i,o,a);break;default:throw Error(U(161))}}catch(l){Ve(i,i.return,l)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function y1(i,e,t){H=i,Hy(i)}function Hy(i,e,t){for(var n=(i.mode&1)!==0;H!==null;){var r=H,s=r.child;if(r.tag===22&&n){var a=r.memoizedState!==null||jo;if(!a){var o=r.alternate,l=o!==null&&o.memoizedState!==null||It;o=jo;var u=It;if(jo=a,(It=l)&&!u)for(H=r;H!==null;)a=H,l=a.child,a.tag===22&&a.memoizedState!==null?Fg(r):l!==null?(l.return=a,H=l):Fg(r);for(;s!==null;)H=s,Hy(s),s=s.sibling;H=r,jo=o,It=u}Og(i)}else r.subtreeFlags&8772&&s!==null?(s.return=r,H=s):Og(i)}}function Og(i){for(;H!==null;){var e=H;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:It||Lc(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!It)if(t===null)n.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Si(e.type,t.memoizedProps);n.componentDidUpdate(r,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&yg(e,s,n);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}yg(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Ja(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}It||e.flags&512&&$h(e)}catch(h){Ve(e,e.return,h)}}if(e===i){H=null;break}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}}function Ng(i){for(;H!==null;){var e=H;if(e===i){H=null;break}var t=e.sibling;if(t!==null){t.return=e.return,H=t;break}H=e.return}}function Fg(i){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Lc(4,e)}catch(l){Ve(e,t,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var r=e.return;try{n.componentDidMount()}catch(l){Ve(e,r,l)}}var s=e.return;try{$h(e)}catch(l){Ve(e,s,l)}break;case 5:var a=e.return;try{$h(e)}catch(l){Ve(e,a,l)}}}catch(l){Ve(e,e.return,l)}if(e===i){H=null;break}var o=e.sibling;if(o!==null){o.return=e.return,H=o;break}H=e.return}}var T1=Math.ceil,Bu=xn.ReactCurrentDispatcher,Sm=xn.ReactCurrentOwner,di=xn.ReactCurrentBatchConfig,Ee=0,gt=null,tt=null,St=0,Qt=0,bs=rr(0),ot=0,co=null,Nr=0,kc=0,Am=0,$a=null,Ut=null,xm=0,Vs=1/0,dn=null,Gu=!1,Hh=null,zn=null,zo=!1,Vn=null,Hu=0,Ba=0,Vh=null,Ml=-1,Ol=0;function Pt(){return Ee&6?je():Ml!==-1?Ml:Ml=je()}function Qn(i){return i.mode&1?Ee&2&&St!==0?St&-St:n1.transition!==null?(Ol===0&&(Ol=RE()),Ol):(i=xe,i!==0||(i=window.event,i=i===void 0?16:PE(i.type)),i):1}function ki(i,e,t,n){if(50<Ba)throw Ba=0,Vh=null,Error(U(185));Io(i,t,n),(!(Ee&2)||i!==gt)&&(i===gt&&(!(Ee&2)&&(kc|=t),ot===4&&$n(i,St)),Vt(i,n),t===1&&Ee===0&&!(e.mode&1)&&(Vs=je()+500,Rc&&sr()))}function Vt(i,e){var t=i.callbackNode;nb(i,e);var n=bu(i,i===gt?St:0);if(n===0)t!==null&&qp(t),i.callbackNode=null,i.callbackPriority=0;else if(e=n&-n,i.callbackPriority!==e){if(t!=null&&qp(t),e===1)i.tag===0?i1(Ug.bind(null,i)):ZE(Ug.bind(null,i)),Zb(function(){!(Ee&6)&&sr()}),t=null;else{switch(wE(n)){case 1:t=Qf;break;case 4:t=xE;break;case 16:t=xu;break;case 536870912:t=bE;break;default:t=xu}t=Qy(t,Vy.bind(null,i))}i.callbackPriority=e,i.callbackNode=t}}function Vy(i,e){if(Ml=-1,Ol=0,Ee&6)throw Error(U(327));var t=i.callbackNode;if(Ms()&&i.callbackNode!==t)return null;var n=bu(i,i===gt?St:0);if(n===0)return null;if(n&30||n&i.expiredLanes||e)e=Vu(i,n);else{e=n;var r=Ee;Ee|=2;var s=Wy();(gt!==i||St!==e)&&(dn=null,Vs=je()+500,Rr(i,e));do try{A1();break}catch(o){Ky(i,o)}while(!0);um(),Bu.current=s,Ee=r,tt!==null?e=0:(gt=null,St=0,e=ot)}if(e!==0){if(e===2&&(r=gh(i),r!==0&&(n=r,e=Kh(i,r))),e===1)throw t=co,Rr(i,0),$n(i,n),Vt(i,je()),t;if(e===6)$n(i,n);else{if(r=i.current.alternate,!(n&30)&&!_1(r)&&(e=Vu(i,n),e===2&&(s=gh(i),s!==0&&(n=s,e=Kh(i,s))),e===1))throw t=co,Rr(i,0),$n(i,n),Vt(i,je()),t;switch(i.finishedWork=r,i.finishedLanes=n,e){case 0:case 1:throw Error(U(345));case 2:dr(i,Ut,dn);break;case 3:if($n(i,n),(n&130023424)===n&&(e=xm+500-je(),10<e)){if(bu(i,0)!==0)break;if(r=i.suspendedLanes,(r&n)!==n){Pt(),i.pingedLanes|=i.suspendedLanes&r;break}i.timeoutHandle=xh(dr.bind(null,i,Ut,dn),e);break}dr(i,Ut,dn);break;case 4:if($n(i,n),(n&4194240)===n)break;for(e=i.eventTimes,r=-1;0<n;){var a=31-Li(n);s=1<<a,a=e[a],a>r&&(r=a),n&=~s}if(n=r,n=je()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*T1(n/1960))-n,10<n){i.timeoutHandle=xh(dr.bind(null,i,Ut,dn),n);break}dr(i,Ut,dn);break;case 5:dr(i,Ut,dn);break;default:throw Error(U(329))}}}return Vt(i,je()),i.callbackNode===t?Vy.bind(null,i):null}function Kh(i,e){var t=$a;return i.current.memoizedState.isDehydrated&&(Rr(i,e).flags|=256),i=Vu(i,e),i!==2&&(e=Ut,Ut=t,e!==null&&Wh(e)),i}function Wh(i){Ut===null?Ut=i:Ut.push.apply(Ut,i)}function _1(i){for(var e=i;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var n=0;n<t.length;n++){var r=t[n],s=r.getSnapshot;r=r.value;try{if(!Di(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function $n(i,e){for(e&=~Am,e&=~kc,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var t=31-Li(e),n=1<<t;i[t]=-1,e&=~n}}function Ug(i){if(Ee&6)throw Error(U(327));Ms();var e=bu(i,0);if(!(e&1))return Vt(i,je()),null;var t=Vu(i,e);if(i.tag!==0&&t===2){var n=gh(i);n!==0&&(e=n,t=Kh(i,n))}if(t===1)throw t=co,Rr(i,0),$n(i,e),Vt(i,je()),t;if(t===6)throw Error(U(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,dr(i,Ut,dn),Vt(i,je()),null}function bm(i,e){var t=Ee;Ee|=1;try{return i(e)}finally{Ee=t,Ee===0&&(Vs=je()+500,Rc&&sr())}}function Fr(i){Vn!==null&&Vn.tag===0&&!(Ee&6)&&Ms();var e=Ee;Ee|=1;var t=di.transition,n=xe;try{if(di.transition=null,xe=1,i)return i()}finally{xe=n,di.transition=t,Ee=e,!(Ee&6)&&sr()}}function Rm(){Qt=bs.current,Oe(bs)}function Rr(i,e){i.finishedWork=null,i.finishedLanes=0;var t=i.timeoutHandle;if(t!==-1&&(i.timeoutHandle=-1,Xb(t)),tt!==null)for(t=tt.return;t!==null;){var n=t;switch(am(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ku();break;case 3:Gs(),Oe(Gt),Oe(kt),pm();break;case 5:mm(n);break;case 4:Gs();break;case 13:Oe(Be);break;case 19:Oe(Be);break;case 10:cm(n.type._context);break;case 22:case 23:Rm()}t=t.return}if(gt=i,tt=i=Xn(i.current,null),St=Qt=e,ot=0,co=null,Am=kc=Nr=0,Ut=$a=null,yr!==null){for(e=0;e<yr.length;e++)if(t=yr[e],n=t.interleaved,n!==null){t.interleaved=null;var r=n.next,s=t.pending;if(s!==null){var a=s.next;s.next=r,n.next=a}t.pending=n}yr=null}return i}function Ky(i,e){do{var t=tt;try{if(um(),Dl.current=$u,Uu){for(var n=Ge.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}Uu=!1}if(Or=0,ft=st=Ge=null,Fa=!1,oo=0,Sm.current=null,t===null||t.return===null){ot=1,co=e,tt=null;break}e:{var s=i,a=t.return,o=t,l=e;if(e=St,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=bg(a);if(f!==null){f.flags&=-257,Rg(f,a,o,s,e),f.mode&1&&xg(s,u,e),e=f,l=u;var m=e.updateQueue;if(m===null){var p=new Set;p.add(l),e.updateQueue=p}else m.add(l);break e}else{if(!(e&1)){xg(s,u,e),wm();break e}l=Error(U(426))}}else if(Fe&&o.mode&1){var v=bg(a);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Rg(v,a,o,s,e),om(Hs(l,o));break e}}s=l=Hs(l,o),ot!==4&&(ot=2),$a===null?$a=[s]:$a.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=wy(s,l,e);Eg(s,g);break e;case 1:o=l;var E=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof E.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(zn===null||!zn.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=Iy(s,o,e);Eg(s,_);break e}}s=s.return}while(s!==null)}Yy(t)}catch(S){e=S,tt===t&&t!==null&&(tt=t=t.return);continue}break}while(!0)}function Wy(){var i=Bu.current;return Bu.current=$u,i===null?$u:i}function wm(){(ot===0||ot===3||ot===2)&&(ot=4),gt===null||!(Nr&268435455)&&!(kc&268435455)||$n(gt,St)}function Vu(i,e){var t=Ee;Ee|=2;var n=Wy();(gt!==i||St!==e)&&(dn=null,Rr(i,e));do try{S1();break}catch(r){Ky(i,r)}while(!0);if(um(),Ee=t,Bu.current=n,tt!==null)throw Error(U(261));return gt=null,St=0,ot}function S1(){for(;tt!==null;)qy(tt)}function A1(){for(;tt!==null&&!jx();)qy(tt)}function qy(i){var e=zy(i.alternate,i,Qt);i.memoizedProps=i.pendingProps,e===null?Yy(i):tt=e,Sm.current=null}function Yy(i){var e=i;do{var t=e.alternate;if(i=e.return,e.flags&32768){if(t=g1(t,e),t!==null){t.flags&=32767,tt=t;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{ot=6,tt=null;return}}else if(t=p1(t,e,Qt),t!==null){tt=t;return}if(e=e.sibling,e!==null){tt=e;return}tt=e=i}while(e!==null);ot===0&&(ot=5)}function dr(i,e,t){var n=xe,r=di.transition;try{di.transition=null,xe=1,x1(i,e,t,n)}finally{di.transition=r,xe=n}return null}function x1(i,e,t,n){do Ms();while(Vn!==null);if(Ee&6)throw Error(U(327));t=i.finishedWork;var r=i.finishedLanes;if(t===null)return null;if(i.finishedWork=null,i.finishedLanes=0,t===i.current)throw Error(U(177));i.callbackNode=null,i.callbackPriority=0;var s=t.lanes|t.childLanes;if(rb(i,s),i===gt&&(tt=gt=null,St=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||zo||(zo=!0,Qy(xu,function(){return Ms(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=di.transition,di.transition=null;var a=xe;xe=1;var o=Ee;Ee|=4,Sm.current=null,E1(i,t),Gy(t,i),Kb(Sh),Ru=!!_h,Sh=_h=null,i.current=t,y1(t),zx(),Ee=o,xe=a,di.transition=s}else i.current=t;if(zo&&(zo=!1,Vn=i,Hu=r),s=i.pendingLanes,s===0&&(zn=null),Zx(t.stateNode),Vt(i,je()),e!==null)for(n=i.onRecoverableError,t=0;t<e.length;t++)r=e[t],n(r.value,{componentStack:r.stack,digest:r.digest});if(Gu)throw Gu=!1,i=Hh,Hh=null,i;return Hu&1&&i.tag!==0&&Ms(),s=i.pendingLanes,s&1?i===Vh?Ba++:(Ba=0,Vh=i):Ba=0,sr(),null}function Ms(){if(Vn!==null){var i=wE(Hu),e=di.transition,t=xe;try{if(di.transition=null,xe=16>i?16:i,Vn===null)var n=!1;else{if(i=Vn,Vn=null,Hu=0,Ee&6)throw Error(U(331));var r=Ee;for(Ee|=4,H=i.current;H!==null;){var s=H,a=s.child;if(H.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(H=u;H!==null;){var c=H;switch(c.tag){case 0:case 11:case 15:Ua(8,c,s)}var d=c.child;if(d!==null)d.return=c,H=d;else for(;H!==null;){c=H;var h=c.sibling,f=c.return;if(Uy(c),c===u){H=null;break}if(h!==null){h.return=f,H=h;break}H=f}}}var m=s.alternate;if(m!==null){var p=m.child;if(p!==null){m.child=null;do{var v=p.sibling;p.sibling=null,p=v}while(p!==null)}}H=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,H=a;else e:for(;H!==null;){if(s=H,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ua(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,H=g;break e}H=s.return}}var E=i.current;for(H=E;H!==null;){a=H;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,H=y;else e:for(a=E;H!==null;){if(o=H,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Lc(9,o)}}catch(S){Ve(o,o.return,S)}if(o===a){H=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,H=_;break e}H=o.return}}if(Ee=r,sr(),Ji&&typeof Ji.onPostCommitFiberRoot=="function")try{Ji.onPostCommitFiberRoot(_c,i)}catch{}n=!0}return n}finally{xe=t,di.transition=e}}return!1}function $g(i,e,t){e=Hs(t,e),e=wy(i,e,1),i=jn(i,e,1),e=Pt(),i!==null&&(Io(i,1,e),Vt(i,e))}function Ve(i,e,t){if(i.tag===3)$g(i,i,t);else for(;e!==null;){if(e.tag===3){$g(e,i,t);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(zn===null||!zn.has(n))){i=Hs(t,i),i=Iy(e,i,1),e=jn(e,i,1),i=Pt(),e!==null&&(Io(e,1,i),Vt(e,i));break}}e=e.return}}function b1(i,e,t){var n=i.pingCache;n!==null&&n.delete(e),e=Pt(),i.pingedLanes|=i.suspendedLanes&t,gt===i&&(St&t)===t&&(ot===4||ot===3&&(St&130023424)===St&&500>je()-xm?Rr(i,0):Am|=t),Vt(i,e)}function jy(i,e){e===0&&(i.mode&1?(e=$o,$o<<=1,!($o&130023424)&&($o=4194304)):e=1);var t=Pt();i=_n(i,e),i!==null&&(Io(i,e,t),Vt(i,t))}function R1(i){var e=i.memoizedState,t=0;e!==null&&(t=e.retryLane),jy(i,t)}function w1(i,e){var t=0;switch(i.tag){case 13:var n=i.stateNode,r=i.memoizedState;r!==null&&(t=r.retryLane);break;case 19:n=i.stateNode;break;default:throw Error(U(314))}n!==null&&n.delete(e),jy(i,t)}var zy;zy=function(i,e,t){if(i!==null)if(i.memoizedProps!==e.pendingProps||Gt.current)Bt=!0;else{if(!(i.lanes&t)&&!(e.flags&128))return Bt=!1,m1(i,e,t);Bt=!!(i.flags&131072)}else Bt=!1,Fe&&e.flags&1048576&&JE(e,Pu,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Pl(i,e),i=e.pendingProps;var r=Us(e,kt.current);Ps(e,t),r=vm(null,e,n,i,r,t);var s=Em();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ht(n)?(s=!0,Du(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,hm(e),r.updater=Ic,e.stateNode=r,r._reactInternals=e,Dh(e,n,i,t),e=Mh(null,e,n,!0,s,t)):(e.tag=0,Fe&&s&&sm(e),Dt(null,e,r,t),e=e.child),e;case 16:n=e.elementType;e:{switch(Pl(i,e),i=e.pendingProps,r=n._init,n=r(n._payload),e.type=n,r=e.tag=L1(n),i=Si(n,i),r){case 0:e=Ph(null,e,n,i,t);break e;case 1:e=Lg(null,e,n,i,t);break e;case 11:e=wg(null,e,n,i,t);break e;case 14:e=Ig(null,e,n,Si(n.type,i),t);break e}throw Error(U(306,n,""))}return e;case 0:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:Si(n,r),Ph(i,e,n,r,t);case 1:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:Si(n,r),Lg(i,e,n,r,t);case 3:e:{if(Cy(e),i===null)throw Error(U(387));n=e.pendingProps,s=e.memoizedState,r=s.element,sy(i,e),Nu(e,n,null,t);var a=e.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Hs(Error(U(423)),e),e=kg(i,e,n,t,r);break e}else if(n!==r){r=Hs(Error(U(424)),e),e=kg(i,e,n,t,r);break e}else for(Xt=Yn(e.stateNode.containerInfo.firstChild),Zt=e,Fe=!0,bi=null,t=ny(e,null,n,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if($s(),n===r){e=Sn(i,e,t);break e}Dt(i,e,n,t)}e=e.child}return e;case 5:return ay(e),i===null&&Ih(e),n=e.type,r=e.pendingProps,s=i!==null?i.memoizedProps:null,a=r.children,Ah(n,r)?a=null:s!==null&&Ah(n,s)&&(e.flags|=32),Dy(i,e),Dt(i,e,a,t),e.child;case 6:return i===null&&Ih(e),null;case 13:return Py(i,e,t);case 4:return fm(e,e.stateNode.containerInfo),n=e.pendingProps,i===null?e.child=Bs(e,null,n,t):Dt(i,e,n,t),e.child;case 11:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:Si(n,r),wg(i,e,n,r,t);case 7:return Dt(i,e,e.pendingProps,t),e.child;case 8:return Dt(i,e,e.pendingProps.children,t),e.child;case 12:return Dt(i,e,e.pendingProps.children,t),e.child;case 10:e:{if(n=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value,Ce(Mu,n._currentValue),n._currentValue=a,s!==null)if(Di(s.value,a)){if(s.children===r.children&&!Gt.current){e=Sn(i,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=En(-1,t&-t),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=t,l=s.alternate,l!==null&&(l.lanes|=t),Lh(s.return,t,e),o.lanes|=t;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(U(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),Lh(a,t,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Dt(i,e,r.children,t),e=e.child}return e;case 9:return r=e.type,n=e.pendingProps.children,Ps(e,t),r=hi(r),n=n(r),e.flags|=1,Dt(i,e,n,t),e.child;case 14:return n=e.type,r=Si(n,e.pendingProps),r=Si(n.type,r),Ig(i,e,n,r,t);case 15:return Ly(i,e,e.type,e.pendingProps,t);case 17:return n=e.type,r=e.pendingProps,r=e.elementType===n?r:Si(n,r),Pl(i,e),e.tag=1,Ht(n)?(i=!0,Du(e)):i=!1,Ps(e,t),Ry(e,n,r),Dh(e,n,r,t),Mh(null,e,n,!0,i,t);case 19:return My(i,e,t);case 22:return ky(i,e,t)}throw Error(U(156,e.tag))};function Qy(i,e){return AE(i,e)}function I1(i,e,t,n){this.tag=i,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ci(i,e,t,n){return new I1(i,e,t,n)}function Im(i){return i=i.prototype,!(!i||!i.isReactComponent)}function L1(i){if(typeof i=="function")return Im(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Yf)return 11;if(i===jf)return 14}return 2}function Xn(i,e){var t=i.alternate;return t===null?(t=ci(i.tag,e,i.key,i.mode),t.elementType=i.elementType,t.type=i.type,t.stateNode=i.stateNode,t.alternate=i,i.alternate=t):(t.pendingProps=e,t.type=i.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=i.flags&14680064,t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,e=i.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=i.sibling,t.index=i.index,t.ref=i.ref,t}function Nl(i,e,t,n,r,s){var a=2;if(n=i,typeof i=="function")Im(i)&&(a=1);else if(typeof i=="string")a=5;else e:switch(i){case ps:return wr(t.children,r,s,e);case qf:a=8,r|=8;break;case th:return i=ci(12,t,e,r|2),i.elementType=th,i.lanes=s,i;case ih:return i=ci(13,t,e,r),i.elementType=ih,i.lanes=s,i;case nh:return i=ci(19,t,e,r),i.elementType=nh,i.lanes=s,i;case aE:return Dc(t,r,s,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case rE:a=10;break e;case sE:a=9;break e;case Yf:a=11;break e;case jf:a=14;break e;case On:a=16,n=null;break e}throw Error(U(130,i==null?i:typeof i,""))}return e=ci(a,t,e,r),e.elementType=i,e.type=n,e.lanes=s,e}function wr(i,e,t,n){return i=ci(7,i,n,e),i.lanes=t,i}function Dc(i,e,t,n){return i=ci(22,i,n,e),i.elementType=aE,i.lanes=t,i.stateNode={isHidden:!1},i}function yd(i,e,t){return i=ci(6,i,null,e),i.lanes=t,i}function Td(i,e,t){return e=ci(4,i.children!==null?i.children:[],i.key,e),e.lanes=t,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function k1(i,e,t,n,r){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ed(0),this.expirationTimes=ed(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ed(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Lm(i,e,t,n,r,s,a,o,l){return i=new k1(i,e,t,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ci(3,null,null,e),i.current=s,s.stateNode=i,s.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},hm(s),i}function D1(i,e,t){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ms,key:n==null?null:""+n,children:i,containerInfo:e,implementation:t}}function Xy(i){if(!i)return tr;i=i._reactInternals;e:{if(Gr(i)!==i||i.tag!==1)throw Error(U(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ht(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(i.tag===1){var t=i.type;if(Ht(t))return XE(i,t,e)}return e}function Zy(i,e,t,n,r,s,a,o,l){return i=Lm(t,n,!0,i,r,s,a,o,l),i.context=Xy(null),t=i.current,n=Pt(),r=Qn(t),s=En(n,r),s.callback=e??null,jn(t,s,r),i.current.lanes=r,Io(i,r,n),Vt(i,n),i}function Cc(i,e,t,n){var r=e.current,s=Pt(),a=Qn(r);return t=Xy(t),e.context===null?e.context=t:e.pendingContext=t,e=En(s,a),e.payload={element:i},n=n===void 0?null:n,n!==null&&(e.callback=n),i=jn(r,e,a),i!==null&&(ki(i,r,a,s),kl(i,r,a)),a}function Ku(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Bg(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var t=i.retryLane;i.retryLane=t!==0&&t<e?t:e}}function km(i,e){Bg(i,e),(i=i.alternate)&&Bg(i,e)}function C1(){return null}var Jy=typeof reportError=="function"?reportError:function(i){console.error(i)};function Dm(i){this._internalRoot=i}Pc.prototype.render=Dm.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(U(409));Cc(i,e,null,null)};Pc.prototype.unmount=Dm.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;Fr(function(){Cc(null,i,null,null)}),e[Tn]=null}};function Pc(i){this._internalRoot=i}Pc.prototype.unstable_scheduleHydration=function(i){if(i){var e=kE();i={blockedOn:null,target:i,priority:e};for(var t=0;t<Un.length&&e!==0&&e<Un[t].priority;t++);Un.splice(t,0,i),t===0&&CE(i)}};function Cm(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Mc(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Gg(){}function P1(i,e,t,n,r){if(r){if(typeof n=="function"){var s=n;n=function(){var u=Ku(a);s.call(u)}}var a=Zy(e,n,i,0,null,!1,!1,"",Gg);return i._reactRootContainer=a,i[Tn]=a.current,io(i.nodeType===8?i.parentNode:i),Fr(),a}for(;r=i.lastChild;)i.removeChild(r);if(typeof n=="function"){var o=n;n=function(){var u=Ku(l);o.call(u)}}var l=Lm(i,0,!1,null,null,!1,!1,"",Gg);return i._reactRootContainer=l,i[Tn]=l.current,io(i.nodeType===8?i.parentNode:i),Fr(function(){Cc(e,l,t,n)}),l}function Oc(i,e,t,n,r){var s=t._reactRootContainer;if(s){var a=s;if(typeof r=="function"){var o=r;r=function(){var l=Ku(a);o.call(l)}}Cc(e,a,i,r)}else a=P1(t,e,i,r,n);return Ku(a)}IE=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ta(e.pendingLanes);t!==0&&(Xf(e,t|1),Vt(e,je()),!(Ee&6)&&(Vs=je()+500,sr()))}break;case 13:Fr(function(){var n=_n(i,1);if(n!==null){var r=Pt();ki(n,i,1,r)}}),km(i,1)}};Zf=function(i){if(i.tag===13){var e=_n(i,134217728);if(e!==null){var t=Pt();ki(e,i,134217728,t)}km(i,134217728)}};LE=function(i){if(i.tag===13){var e=Qn(i),t=_n(i,e);if(t!==null){var n=Pt();ki(t,i,e,n)}km(i,e)}};kE=function(){return xe};DE=function(i,e){var t=xe;try{return xe=i,e()}finally{xe=t}};fh=function(i,e,t){switch(e){case"input":if(ah(i,t),e=t.name,t.type==="radio"&&e!=null){for(t=i;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var n=t[e];if(n!==i&&n.form===i.form){var r=bc(n);if(!r)throw Error(U(90));lE(n),ah(n,r)}}}break;case"textarea":cE(i,t);break;case"select":e=t.value,e!=null&&Ls(i,!!t.multiple,e,!1)}};vE=bm;EE=Fr;var M1={usingClientEntryPoint:!1,Events:[ko,ys,bc,pE,gE,bm]},ca={findFiberByHostInstance:Er,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},O1={bundleType:ca.bundleType,version:ca.version,rendererPackageName:ca.rendererPackageName,rendererConfig:ca.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xn.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=_E(i),i===null?null:i.stateNode},findFiberByHostInstance:ca.findFiberByHostInstance||C1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qo.isDisabled&&Qo.supportsFiber)try{_c=Qo.inject(O1),Ji=Qo}catch{}}ei.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M1;ei.createPortal=function(i,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cm(e))throw Error(U(200));return D1(i,e,null,t)};ei.createRoot=function(i,e){if(!Cm(i))throw Error(U(299));var t=!1,n="",r=Jy;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Lm(i,1,!1,null,null,t,!1,n,r),i[Tn]=e.current,io(i.nodeType===8?i.parentNode:i),new Dm(e)};ei.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(U(188)):(i=Object.keys(i).join(","),Error(U(268,i)));return i=_E(e),i=i===null?null:i.stateNode,i};ei.flushSync=function(i){return Fr(i)};ei.hydrate=function(i,e,t){if(!Mc(e))throw Error(U(200));return Oc(null,i,e,!0,t)};ei.hydrateRoot=function(i,e,t){if(!Cm(i))throw Error(U(405));var n=t!=null&&t.hydratedSources||null,r=!1,s="",a=Jy;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=Zy(e,null,i,1,t??null,r,!1,s,a),i[Tn]=e.current,io(i),n)for(i=0;i<n.length;i++)t=n[i],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new Pc(e)};ei.render=function(i,e,t){if(!Mc(e))throw Error(U(200));return Oc(null,i,e,!1,t)};ei.unmountComponentAtNode=function(i){if(!Mc(i))throw Error(U(40));return i._reactRootContainer?(Fr(function(){Oc(null,null,i,!1,function(){i._reactRootContainer=null,i[Tn]=null})}),!0):!1};ei.unstable_batchedUpdates=bm;ei.unstable_renderSubtreeIntoContainer=function(i,e,t,n){if(!Mc(t))throw Error(U(200));if(i==null||i._reactInternals===void 0)throw Error(U(38));return Oc(i,e,t,!1,n)};ei.version="18.3.1-next-f1338f8080-20240426";function eT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(eT)}catch(i){console.error(i)}}eT(),eE.exports=ei;var N1=eE.exports,tT,Hg=N1;tT=Hg.createRoot,Hg.hydrateRoot;var iT={exports:{}},F1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",U1=F1,$1=U1;function nT(){}function rT(){}rT.resetWarningCache=nT;var B1=function(){function i(n,r,s,a,o,l){if(l!==$1){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}i.isRequired=i;function e(){return i}var t={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:e,element:i,elementType:i,instanceOf:e,node:i,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:rT,resetWarningCache:nT};return t.PropTypes=t,t};iT.exports=B1();var G1=iT.exports;const Re=Hv(G1);var H1=Object.create,sT=Object.defineProperty,V1=Object.getOwnPropertyDescriptor,K1=Object.getOwnPropertyNames,W1=Object.getPrototypeOf,q1=Object.prototype.hasOwnProperty,aT=function(i,e){return function(){return i&&(e=i(i=0)),e}},Kt=function(i,e){return function(){return e||i((e={exports:{}}).exports,e),e.exports}},Y1=function(i,e,t,n){if(e&&typeof e=="object"||typeof e=="function")for(var r=K1(e),s=0,a=r.length,o;s<a;s++)o=r[s],!q1.call(i,o)&&o!==t&&sT(i,o,{get:(function(l){return e[l]}).bind(null,o),enumerable:!(n=V1(e,o))||n.enumerable});return i},ii=function(i,e,t){return t=i!=null?H1(W1(i)):{},Y1(!i||!i.__esModule?sT(t,"default",{value:i,enumerable:!0}):t,i)},Ci=Kt(function(i,e){var t;typeof window<"u"?t=window:typeof global<"u"?t=global:typeof self<"u"?t=self:t={},e.exports=t});function Hr(i,e){return e!=null&&typeof Symbol<"u"&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](i):Hr(i,e)}var Vr=aT(function(){Vr()});function oT(i){"@swc/helpers - typeof";return i&&typeof Symbol<"u"&&i.constructor===Symbol?"symbol":typeof i}var lT=aT(function(){}),uT=Kt(function(i,e){var t=Array.prototype.slice;e.exports=n;function n(r,s){for(("length"in r)||(r=[r]),r=t.call(r);r.length;){var a=r.shift(),o=s(a);if(o)return o;a.childNodes&&a.childNodes.length&&(r=t.call(a.childNodes).concat(r))}}}),j1=Kt(function(i,e){Vr(),e.exports=t;function t(n,r){if(!Hr(this,t))return new t(n,r);this.data=n,this.nodeValue=n,this.length=n.length,this.ownerDocument=r||null}t.prototype.nodeType=8,t.prototype.nodeName="#comment",t.prototype.toString=function(){return"[object Comment]"}}),z1=Kt(function(i,e){Vr(),e.exports=t;function t(n,r){if(!Hr(this,t))return new t(n);this.data=n||"",this.length=this.data.length,this.ownerDocument=r||null}t.prototype.type="DOMTextNode",t.prototype.nodeType=3,t.prototype.nodeName="#text",t.prototype.toString=function(){return this.data},t.prototype.replaceData=function(n,r,s){var a=this.data,o=a.substring(0,n),l=a.substring(n+r,a.length);this.data=o+s+l,this.length=this.data.length}}),cT=Kt(function(i,e){e.exports=t;function t(n){var r=this,s=n.type;n.target||(n.target=r),r.listeners||(r.listeners={});var a=r.listeners[s];if(a)return a.forEach(function(o){n.currentTarget=r,typeof o=="function"?o(n):o.handleEvent(n)});r.parentNode&&r.parentNode.dispatchEvent(n)}}),dT=Kt(function(i,e){e.exports=t;function t(n,r){var s=this;s.listeners||(s.listeners={}),s.listeners[n]||(s.listeners[n]=[]),s.listeners[n].indexOf(r)===-1&&s.listeners[n].push(r)}}),hT=Kt(function(i,e){e.exports=t;function t(n,r){var s=this;if(s.listeners&&s.listeners[n]){var a=s.listeners[n],o=a.indexOf(r);o!==-1&&a.splice(o,1)}}}),Q1=Kt(function(i,e){lT(),e.exports=n;var t=["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"];function n(h){switch(h.nodeType){case 3:return c(h.data);case 8:return"<!--"+h.data+"-->";default:return r(h)}}function r(h){var f=[],m=h.tagName;return h.namespaceURI==="http://www.w3.org/1999/xhtml"&&(m=m.toLowerCase()),f.push("<"+m+u(h)+o(h)),t.indexOf(m)>-1?f.push(" />"):(f.push(">"),h.childNodes.length?f.push.apply(f,h.childNodes.map(n)):h.textContent||h.innerText?f.push(c(h.textContent||h.innerText)):h.innerHTML&&f.push(h.innerHTML),f.push("</"+m+">")),f.join("")}function s(h,f){var m=oT(h[f]);return f==="style"&&Object.keys(h.style).length>0?!0:h.hasOwnProperty(f)&&(m==="string"||m==="boolean"||m==="number")&&f!=="nodeName"&&f!=="className"&&f!=="tagName"&&f!=="textContent"&&f!=="innerText"&&f!=="namespaceURI"&&f!=="innerHTML"}function a(h){if(typeof h=="string")return h;var f="";return Object.keys(h).forEach(function(m){var p=h[m];m=m.replace(/[A-Z]/g,function(v){return"-"+v.toLowerCase()}),f+=m+":"+p+";"}),f}function o(h){var f=h.dataset,m=[];for(var p in f)m.push({name:"data-"+p,value:f[p]});return m.length?l(m):""}function l(h){var f=[];return h.forEach(function(m){var p=m.name,v=m.value;p==="style"&&(v=a(v)),f.push(p+'="'+d(v)+'"')}),f.length?" "+f.join(" "):""}function u(h){var f=[];for(var m in h)s(h,m)&&f.push({name:m,value:h[m]});for(var p in h._attributes)for(var v in h._attributes[p]){var g=h._attributes[p][v],E=(g.prefix?g.prefix+":":"")+v;f.push({name:E,value:g.value})}return h.className&&f.push({name:"class",value:h.className}),f.length?l(f):""}function c(h){var f="";return typeof h=="string"?f=h:h&&(f=h.toString()),f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function d(h){return c(h).replace(/"/g,"&quot;")}}),fT=Kt(function(i,e){Vr();var t=uT(),n=cT(),r=dT(),s=hT(),a=Q1(),o="http://www.w3.org/1999/xhtml";e.exports=l;function l(u,c,d){if(!Hr(this,l))return new l(u);var h=d===void 0?o:d||null;this.tagName=h===o?String(u).toUpperCase():u,this.nodeName=this.tagName,this.className="",this.dataset={},this.childNodes=[],this.parentNode=null,this.style={},this.ownerDocument=c||null,this.namespaceURI=h,this._attributes={},this.tagName==="INPUT"&&(this.type="text")}l.prototype.type="DOMElement",l.prototype.nodeType=1,l.prototype.appendChild=function(u){return u.parentNode&&u.parentNode.removeChild(u),this.childNodes.push(u),u.parentNode=this,u},l.prototype.replaceChild=function(u,c){u.parentNode&&u.parentNode.removeChild(u);var d=this.childNodes.indexOf(c);return c.parentNode=null,this.childNodes[d]=u,u.parentNode=this,c},l.prototype.removeChild=function(u){var c=this.childNodes.indexOf(u);return this.childNodes.splice(c,1),u.parentNode=null,u},l.prototype.insertBefore=function(u,c){u.parentNode&&u.parentNode.removeChild(u);var d=c==null?-1:this.childNodes.indexOf(c);return d>-1?this.childNodes.splice(d,0,u):this.childNodes.push(u),u.parentNode=this,u},l.prototype.setAttributeNS=function(u,c,d){var h=null,f=c,m=c.indexOf(":");if(m>-1&&(h=c.substr(0,m),f=c.substr(m+1)),this.tagName==="INPUT"&&c==="type")this.type=d;else{var p=this._attributes[u]||(this._attributes[u]={});p[f]={value:d,prefix:h}}},l.prototype.getAttributeNS=function(u,c){var d=this._attributes[u],h=d&&d[c]&&d[c].value;return this.tagName==="INPUT"&&c==="type"?this.type:typeof h!="string"?null:h},l.prototype.removeAttributeNS=function(u,c){var d=this._attributes[u];d&&delete d[c]},l.prototype.hasAttributeNS=function(u,c){var d=this._attributes[u];return!!d&&c in d},l.prototype.setAttribute=function(u,c){return this.setAttributeNS(null,u,c)},l.prototype.getAttribute=function(u){return this.getAttributeNS(null,u)},l.prototype.removeAttribute=function(u){return this.removeAttributeNS(null,u)},l.prototype.hasAttribute=function(u){return this.hasAttributeNS(null,u)},l.prototype.removeEventListener=s,l.prototype.addEventListener=r,l.prototype.dispatchEvent=n,l.prototype.focus=function(){},l.prototype.toString=function(){return a(this)},l.prototype.getElementsByClassName=function(u){var c=u.split(" "),d=[];return t(this,function(h){if(h.nodeType===1){var f=h.className||"",m=f.split(" ");c.every(function(p){return m.indexOf(p)!==-1})&&d.push(h)}}),d},l.prototype.getElementsByTagName=function(u){u=u.toLowerCase();var c=[];return t(this.childNodes,function(d){d.nodeType===1&&(u==="*"||d.tagName.toLowerCase()===u)&&c.push(d)}),c},l.prototype.contains=function(u){return t(this,function(c){return u===c})||!1}}),X1=Kt(function(i,e){Vr();var t=fT();e.exports=n;function n(r){if(!Hr(this,n))return new n;this.childNodes=[],this.parentNode=null,this.ownerDocument=r||null}n.prototype.type="DocumentFragment",n.prototype.nodeType=11,n.prototype.nodeName="#document-fragment",n.prototype.appendChild=t.prototype.appendChild,n.prototype.replaceChild=t.prototype.replaceChild,n.prototype.removeChild=t.prototype.removeChild,n.prototype.toString=function(){return this.childNodes.map(function(r){return String(r)}).join("")}}),Z1=Kt(function(i,e){e.exports=t;function t(n){}t.prototype.initEvent=function(n,r,s){this.type=n,this.bubbles=r,this.cancelable=s},t.prototype.preventDefault=function(){}}),J1=Kt(function(i,e){Vr();var t=uT(),n=j1(),r=z1(),s=fT(),a=X1(),o=Z1(),l=cT(),u=dT(),c=hT();e.exports=d;function d(){if(!Hr(this,d))return new d;this.head=this.createElement("head"),this.body=this.createElement("body"),this.documentElement=this.createElement("html"),this.documentElement.appendChild(this.head),this.documentElement.appendChild(this.body),this.childNodes=[this.documentElement],this.nodeType=9}var h=d.prototype;h.createTextNode=function(f){return new r(f,this)},h.createElementNS=function(f,m){var p=f===null?null:String(f);return new s(m,this,p)},h.createElement=function(f){return new s(f,this)},h.createDocumentFragment=function(){return new a(this)},h.createEvent=function(f){return new o(f)},h.createComment=function(f){return new n(f,this)},h.getElementById=function(f){f=String(f);var m=t(this.childNodes,function(p){if(String(p.id)===f)return p});return m||null},h.getElementsByClassName=s.prototype.getElementsByClassName,h.getElementsByTagName=s.prototype.getElementsByTagName,h.contains=s.prototype.contains,h.removeEventListener=c,h.addEventListener=u,h.dispatchEvent=l}),eR=Kt(function(i,e){var t=J1();e.exports=new t}),mT=Kt(function(i,e){var t=typeof global<"u"?global:typeof window<"u"?window:{},n=eR(),r;typeof document<"u"?r=document:(r=t["__GLOBAL_DOCUMENT_CACHE@4"],r||(r=t["__GLOBAL_DOCUMENT_CACHE@4"]=n)),e.exports=r});function tR(i){if(Array.isArray(i))return i}function iR(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n=[],r=!0,s=!1,a,o;try{for(t=t.call(i);!(r=(a=t.next()).done)&&(n.push(a.value),!(e&&n.length===e));r=!0);}catch(l){s=!0,o=l}finally{try{!r&&t.return!=null&&t.return()}finally{if(s)throw o}}return n}}function nR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qh(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=i[t];return n}function pT(i,e){if(i){if(typeof i=="string")return qh(i,e);var t=Object.prototype.toString.call(i).slice(8,-1);if(t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set")return Array.from(t);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return qh(i,e)}}function An(i,e){return tR(i)||iR(i,e)||pT(i,e)||nR()}var Ga=ii(Ci()),Vg=ii(Ci()),rR=ii(Ci()),sR={now:function(){var i=rR.default.performance,e=i&&i.timing,t=e&&e.navigationStart,n=typeof t=="number"&&typeof i.now=="function"?t+i.now():Date.now();return Math.round(n)}},it=sR,ho=function(){var i,e,t;if(typeof((i=Vg.default.crypto)===null||i===void 0?void 0:i.getRandomValues)=="function"){t=new Uint8Array(32),Vg.default.crypto.getRandomValues(t);for(var n=0;n<32;n++)t[n]=t[n]%16}else{t=[];for(var r=0;r<32;r++)t[r]=Math.random()*16|0}var s=0;e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){var u=l==="x"?t[s]:t[s]&3|8;return s++,u.toString(16)});var a=it.now(),o=a==null?void 0:a.toString(16).substring(3);return o?e.substring(0,28)+o:e},gT=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)},vi=function(i){if(i&&typeof i.nodeName<"u")return i.muxId||(i.muxId=gT()),i.muxId;var e;try{e=document.querySelector(i)}catch{}return e&&!e.muxId&&(e.muxId=i),(e==null?void 0:e.muxId)||i},Wu=function(i){var e;i&&typeof i.nodeName<"u"?(e=i,i=vi(e)):e=document.querySelector(i);var t=e&&e.nodeName?e.nodeName.toLowerCase():"";return[e,i,t]};function aR(i){if(Array.isArray(i))return qh(i)}function oR(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function lR(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ei(i){return aR(i)||oR(i)||pT(i)||lR()}var vr={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},uR=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:3,t,n,r,s,a,o=[console,i],l=(t=console.trace).bind.apply(t,Ei(o)),u=(n=console.info).bind.apply(n,Ei(o)),c=(r=console.debug).bind.apply(r,Ei(o)),d=(s=console.warn).bind.apply(s,Ei(o)),h=(a=console.error).bind.apply(a,Ei(o)),f=e;return{trace:function(){for(var m=arguments.length,p=new Array(m),v=0;v<m;v++)p[v]=arguments[v];if(!(f>vr.TRACE))return l.apply(void 0,Ei(p))},debug:function(){for(var m=arguments.length,p=new Array(m),v=0;v<m;v++)p[v]=arguments[v];if(!(f>vr.DEBUG))return c.apply(void 0,Ei(p))},info:function(){for(var m=arguments.length,p=new Array(m),v=0;v<m;v++)p[v]=arguments[v];if(!(f>vr.INFO))return u.apply(void 0,Ei(p))},warn:function(){for(var m=arguments.length,p=new Array(m),v=0;v<m;v++)p[v]=arguments[v];if(!(f>vr.WARN))return d.apply(void 0,Ei(p))},error:function(){for(var m=arguments.length,p=new Array(m),v=0;v<m;v++)p[v]=arguments[v];if(!(f>vr.ERROR))return h.apply(void 0,Ei(p))},get level(){return f},set level(m){m!==this.level&&(f=m??e)}}},Le=uR("[mux]"),_d=ii(Ci());function Yh(){var i=_d.default.doNotTrack||_d.default.navigator&&_d.default.navigator.doNotTrack;return i==="1"}function ne(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}Vr();function Et(i,e){if(!Hr(i,e))throw new TypeError("Cannot call a class as a function")}function cR(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,n.key,n)}}function sn(i,e,t){return e&&cR(i.prototype,e),i}function B(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ks(i){return Ks=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ks(i)}function dR(i,e){for(;!Object.prototype.hasOwnProperty.call(i,e)&&(i=Ks(i),i!==null););return i}function Fl(i,e,t){return typeof Reflect<"u"&&Reflect.get?Fl=Reflect.get:Fl=function(n,r,s){var a=dR(n,r);if(a){var o=Object.getOwnPropertyDescriptor(a,r);return o.get?o.get.call(s||n):o.value}},Fl(i,e,t||i)}function jh(i,e){return jh=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},jh(i,e)}function hR(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),e&&jh(i,e)}function fR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}lT();function mR(i,e){return e&&(oT(e)==="object"||typeof e=="function")?e:ne(i)}function pR(i){var e=fR();return function(){var t=Ks(i),n;if(e){var r=Ks(this).constructor;n=Reflect.construct(t,arguments,r)}else n=t.apply(this,arguments);return mR(this,n)}}var Ri=function(i){return fo(i)[0]},fo=function(i){if(typeof i!="string"||i==="")return["localhost"];var e=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,t=i.match(e)||[],n=t[4],r;return n&&(r=(n.match(/[^\.]+\.[^\.]+$/)||[])[0]),[n,r]},Sd=ii(Ci()),gR={exists:function(){var i=Sd.default.performance,e=i&&i.timing;return e!==void 0},domContentLoadedEventEnd:function(){var i=Sd.default.performance,e=i&&i.timing;return e&&e.domContentLoadedEventEnd},navigationStart:function(){var i=Sd.default.performance,e=i&&i.timing;return e&&e.navigationStart}},qu=gR;function et(i,e,t){t=t===void 0?1:t,i[e]=i[e]||0,i[e]+=t}function Yu(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),n.forEach(function(r){B(i,r,t[r])})}return i}function vR(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);t.push.apply(t,n)}return t}function Pm(i,e){return e=e??{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):vR(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))}),i}var ER=["x-cdn","content-type"],vT=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],yR=ER.concat(vT);function Mm(i){i=i||"";var e={},t=i.trim().split(/[\r\n]+/);return t.forEach(function(n){if(n){var r=n.split(": "),s=r.shift();s&&(yR.indexOf(s.toLowerCase())>=0||s.toLowerCase().indexOf("x-litix-")===0)&&(e[s]=r.join(": "))}}),e}function ju(i){if(i){var e=vT.find(function(t){return i[t]!==void 0});return e?i[e]:void 0}}var TR=function(i){var e={};for(var t in i){var n=i[t],r=n["DATA-ID"].search("io.litix.data.");if(r!==-1){var s=n["DATA-ID"].replace("io.litix.data.","");e[s]=n.VALUE}}return e},ET=TR,Xo=function(i){if(!i)return{};var e=qu.navigationStart(),t=i.loading,n=t?t.start:i.trequest,r=t?t.first:i.tfirst,s=t?t.end:i.tload;return{bytesLoaded:i.total,requestStart:Math.round(e+n),responseStart:Math.round(e+r),responseEnd:Math.round(e+s)}},da=function(i){if(!(!i||typeof i.getAllResponseHeaders!="function"))return Mm(i.getAllResponseHeaders())},_R=function(i,e,t){var n=arguments.length>4?arguments[4]:void 0,r=i.log,s=i.utils.secondsToMs,a=function(v){var g=parseInt(n.version),E;return g===1&&v.programDateTime!==null&&(E=v.programDateTime),g===0&&v.pdt!==null&&(E=v.pdt),E};if(!qu.exists()){r.warn("performance timing not supported. Not tracking HLS.js.");return}var o=function(v,g){return i.emit(e,v,g)},l=function(v,g){var E=g.levels,y=g.audioTracks,_=g.url,S=g.stats,b=g.networkDetails,A=g.sessionData,w={},P={};E.forEach(function(q,W){w[W]={width:q.width,height:q.height,bitrate:q.bitrate,attrs:q.attrs}}),y.forEach(function(q,W){P[W]={name:q.name,language:q.lang,bitrate:q.bitrate}});var R=Xo(S),D=R.bytesLoaded,j=R.requestStart,$=R.responseStart,X=R.responseEnd;o("requestcompleted",Pm(Yu({},ET(A)),{request_event_type:v,request_bytes_loaded:D,request_start:j,request_response_start:$,request_response_end:X,request_type:"manifest",request_hostname:Ri(_),request_response_headers:da(b),request_rendition_lists:{media:w,audio:P,video:{}}}))};t.on(n.Events.MANIFEST_LOADED,l);var u=function(v,g){var E=g.details,y=g.level,_=g.networkDetails,S=g.stats,b=Xo(S),A=b.bytesLoaded,w=b.requestStart,P=b.responseStart,R=b.responseEnd,D=E.fragments[E.fragments.length-1],j=a(D)+s(D.duration);o("requestcompleted",{request_event_type:v,request_bytes_loaded:A,request_start:w,request_response_start:P,request_response_end:R,request_current_level:y,request_type:"manifest",request_hostname:Ri(E.url),request_response_headers:da(_),video_holdback:E.holdBack&&s(E.holdBack),video_part_holdback:E.partHoldBack&&s(E.partHoldBack),video_part_target_duration:E.partTarget&&s(E.partTarget),video_target_duration:E.targetduration&&s(E.targetduration),video_source_is_live:E.live,player_manifest_newest_program_time:isNaN(j)?void 0:j})};t.on(n.Events.LEVEL_LOADED,u);var c=function(v,g){var E=g.details,y=g.networkDetails,_=g.stats,S=Xo(_),b=S.bytesLoaded,A=S.requestStart,w=S.responseStart,P=S.responseEnd;o("requestcompleted",{request_event_type:v,request_bytes_loaded:b,request_start:A,request_response_start:w,request_response_end:P,request_type:"manifest",request_hostname:Ri(E.url),request_response_headers:da(y)})};t.on(n.Events.AUDIO_TRACK_LOADED,c);var d=function(v,g){var E=g.stats,y=g.networkDetails,_=g.frag;E=E||_.stats;var S=Xo(E),b=S.bytesLoaded,A=S.requestStart,w=S.responseStart,P=S.responseEnd,R=y?da(y):void 0,D={request_event_type:v,request_bytes_loaded:b,request_start:A,request_response_start:w,request_response_end:P,request_hostname:y?Ri(y.responseURL):void 0,request_id:R?ju(R):void 0,request_response_headers:R,request_media_duration:_.duration,request_url:y==null?void 0:y.responseURL};_.type==="main"?(D.request_type="media",D.request_current_level=_.level,D.request_video_width=(t.levels[_.level]||{}).width,D.request_video_height=(t.levels[_.level]||{}).height,D.request_labeled_bitrate=(t.levels[_.level]||{}).bitrate):D.request_type=_.type,o("requestcompleted",D)};t.on(n.Events.FRAG_LOADED,d);var h=function(v,g){var E=g.frag,y=E.start,_=a(E),S={currentFragmentPDT:_,currentFragmentStart:s(y)};o("fragmentchange",S)};t.on(n.Events.FRAG_CHANGED,h);var f=function(v,g){var E=g.type,y=g.details,_=g.response,S=g.fatal,b=g.frag,A=g.networkDetails,w=(b==null?void 0:b.url)||g.url||"",P=A?da(A):void 0;if((y===n.ErrorDetails.MANIFEST_LOAD_ERROR||y===n.ErrorDetails.MANIFEST_LOAD_TIMEOUT||y===n.ErrorDetails.FRAG_LOAD_ERROR||y===n.ErrorDetails.FRAG_LOAD_TIMEOUT||y===n.ErrorDetails.LEVEL_LOAD_ERROR||y===n.ErrorDetails.LEVEL_LOAD_TIMEOUT||y===n.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||y===n.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT||y===n.ErrorDetails.SUBTITLE_LOAD_ERROR||y===n.ErrorDetails.SUBTITLE_LOAD_TIMEOUT||y===n.ErrorDetails.KEY_LOAD_ERROR||y===n.ErrorDetails.KEY_LOAD_TIMEOUT)&&o("requestfailed",{request_error:y,request_url:w,request_hostname:Ri(w),request_id:P?ju(P):void 0,request_type:y===n.ErrorDetails.FRAG_LOAD_ERROR||y===n.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":y===n.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||y===n.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":y===n.ErrorDetails.SUBTITLE_LOAD_ERROR||y===n.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":y===n.ErrorDetails.KEY_LOAD_ERROR||y===n.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:_==null?void 0:_.code,request_error_text:_==null?void 0:_.text}),S){var R,D="".concat(w?"url: ".concat(w,`
`):"")+"".concat(_&&(_.code||_.text)?"response: ".concat(_.code,", ").concat(_.text,`
`):"")+"".concat(g.reason?"failure reason: ".concat(g.reason,`
`):"")+"".concat(g.level?"level: ".concat(g.level,`
`):"")+"".concat(g.parent?"parent stream controller: ".concat(g.parent,`
`):"")+"".concat(g.buffer?"buffer length: ".concat(g.buffer,`
`):"")+"".concat(g.error?"error: ".concat(g.error,`
`):"")+"".concat(g.event?"event: ".concat(g.event,`
`):"")+"".concat(g.err?"error message: ".concat((R=g.err)===null||R===void 0?void 0:R.message,`
`):"");o("error",{player_error_code:E,player_error_message:y,player_error_context:D})}};t.on(n.Events.ERROR,f);var m=function(v,g){var E=g.frag,y=E&&E._url||"";o("requestcanceled",{request_event_type:v,request_url:y,request_type:"media",request_hostname:Ri(y)})};t.on(n.Events.FRAG_LOAD_EMERGENCY_ABORTED,m);var p=function(v,g){var E=g.level,y=t.levels[E];if(y&&y.attrs&&y.attrs.BANDWIDTH){var _=y.attrs.BANDWIDTH,S,b=parseFloat(y.attrs["FRAME-RATE"]);isNaN(b)||(S=b),_?o("renditionchange",{video_source_fps:S,video_source_bitrate:_,video_source_width:y.width,video_source_height:y.height,video_source_rendition_name:y.name,video_source_codec:y==null?void 0:y.videoCodec}):r.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};t.on(n.Events.LEVEL_SWITCHED,p),t._stopMuxMonitor=function(){t.off(n.Events.MANIFEST_LOADED,l),t.off(n.Events.LEVEL_LOADED,u),t.off(n.Events.AUDIO_TRACK_LOADED,c),t.off(n.Events.FRAG_LOADED,d),t.off(n.Events.FRAG_CHANGED,h),t.off(n.Events.ERROR,f),t.off(n.Events.FRAG_LOAD_EMERGENCY_ABORTED,m),t.off(n.Events.LEVEL_SWITCHED,p),t.off(n.Events.DESTROYING,t._stopMuxMonitor),delete t._stopMuxMonitor},t.on(n.Events.DESTROYING,t._stopMuxMonitor)},SR=function(i){i&&typeof i._stopMuxMonitor=="function"&&i._stopMuxMonitor()},Kg=function(i,e){if(!i||!i.requestEndDate)return{};var t=Ri(i.url),n=i.url,r=i.bytesLoaded,s=new Date(i.requestStartDate).getTime(),a=new Date(i.firstByteDate).getTime(),o=new Date(i.requestEndDate).getTime(),l=isNaN(i.duration)?0:i.duration,u=typeof e.getMetricsFor=="function"?e.getMetricsFor(i.mediaType).HttpList:e.getDashMetrics().getHttpRequests(i.mediaType),c;u.length>0&&(c=Mm(u[u.length-1]._responseHeaders||""));var d=c?ju(c):void 0;return{requestStart:s,requestResponseStart:a,requestResponseEnd:o,requestBytesLoaded:r,requestResponseHeaders:c,requestMediaDuration:l,requestHostname:t,requestUrl:n,requestId:d}},AR=function(i,e){var t=e.getQualityFor(i),n=e.getCurrentTrackFor(i).bitrateList;return n?{currentLevel:t,renditionWidth:n[t].width||null,renditionHeight:n[t].height||null,renditionBitrate:n[t].bandwidth}:{}},xR=function(i){var e;return(e=i.match(/.*codecs\*?="(.*)"/))===null||e===void 0?void 0:e[1]},bR=function(i){try{var e,t,n=(t=i.getVersion)===null||t===void 0||(e=t.call(i))===null||e===void 0?void 0:e.split(".").map(function(r){return parseInt(r)})[0];return n}catch{return!1}},RR=function(i,e,t){var n=i.log;if(!t||!t.on){n.warn("Invalid dash.js player reference. Monitoring blocked.");return}var r=bR(t),s=function(E,y){return i.emit(e,E,y)},a=function(E){var y=E.type,_=E.data,S=(_||{}).url;s("requestcompleted",{request_event_type:y,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:Ri(S),request_url:S})};t.on("manifestLoaded",a);var o={},l=function(E){if(typeof E.getRequests!="function")return null;var y=E.getRequests({state:"executed"});return y.length===0?null:y[y.length-1]},u=function(E){var y=E.type,_=E.fragmentModel,S=E.chunk,b=l(_);c({type:y,request:b,chunk:S})},c=function(E){var y=E.type,_=E.chunk,S=E.request,b=(_||{}).mediaInfo,A=b||{},w=A.type,P=A.bitrateList;P=P||[];var R={};P.forEach(function(M,G){R[G]={},R[G].width=M.width,R[G].height=M.height,R[G].bitrate=M.bandwidth,R[G].attrs={}}),w==="video"?o.video=R:w==="audio"?o.audio=R:o.media=R;var D=Kg(S,t),j=D.requestStart,$=D.requestResponseStart,X=D.requestResponseEnd,q=D.requestResponseHeaders,W=D.requestMediaDuration,oe=D.requestHostname,F=D.requestUrl,O=D.requestId;s("requestcompleted",{request_event_type:y,request_start:j,request_response_start:$,request_response_end:X,request_bytes_loaded:-1,request_type:w+"_init",request_response_headers:q,request_hostname:oe,request_id:O,request_url:F,request_media_duration:W,request_rendition_lists:o})};r>=4?t.on("initFragmentLoaded",c):t.on("initFragmentLoaded",u);var d=function(E){var y=E.type,_=E.fragmentModel,S=E.chunk,b=l(_);h({type:y,request:b,chunk:S})},h=function(E){var y=E.type,_=E.chunk,S=E.request,b=_||{},A=b.mediaInfo,w=b.start,P=A||{},R=P.type,D=Kg(S,t),j=D.requestStart,$=D.requestResponseStart,X=D.requestResponseEnd,q=D.requestBytesLoaded,W=D.requestResponseHeaders,oe=D.requestMediaDuration,F=D.requestHostname,O=D.requestUrl,M=D.requestId,G=AR(R,t),Y=G.currentLevel,le=G.renditionWidth,me=G.renditionHeight,we=G.renditionBitrate;s("requestcompleted",{request_event_type:y,request_start:j,request_response_start:$,request_response_end:X,request_bytes_loaded:q,request_type:R,request_response_headers:W,request_hostname:F,request_id:M,request_url:O,request_media_start_time:w,request_media_duration:oe,request_current_level:Y,request_labeled_bitrate:we,request_video_width:le,request_video_height:me})};r>=4?t.on("mediaFragmentLoaded",h):t.on("mediaFragmentLoaded",d);var f={video:void 0,audio:void 0,totalBitrate:void 0},m=function(){if(f.video&&typeof f.video.bitrate=="number"){if(!(f.video.width&&f.video.height)){n.warn("have bitrate info for video but missing width/height");return}var E=f.video.bitrate;if(f.audio&&typeof f.audio.bitrate=="number"&&(E+=f.audio.bitrate),E!==f.totalBitrate)return f.totalBitrate=E,{video_source_bitrate:E,video_source_height:f.video.height,video_source_width:f.video.width,video_source_codec:xR(f.video.codec)}}},p=function(E,y,_){if(typeof E.newQuality!="number"){n.warn("missing evt.newQuality in qualityChangeRendered event",E);return}var S=E.mediaType;if(S==="audio"||S==="video"){var b=t.getBitrateInfoListFor(S).find(function(w){var P=w.qualityIndex;return P===E.newQuality});if(!(b&&typeof b.bitrate=="number")){n.warn("missing bitrate info for ".concat(S));return}f[S]=Pm(Yu({},b),{codec:t.getCurrentTrackFor(S).codec});var A=m();A&&s("renditionchange",A)}};t.on("qualityChangeRendered",p);var v=function(E){var y=E.request,_=E.mediaType;y=y||{},s("requestcanceled",{request_event_type:y.type+"_"+y.action,request_url:y.url,request_type:_,request_hostname:Ri(y.url)})};t.on("fragmentLoadingAbandoned",v);var g=function(E){var y=E.error,_,S,b=(y==null||(_=y.data)===null||_===void 0?void 0:_.request)||{},A=(y==null||(S=y.data)===null||S===void 0?void 0:S.response)||{};(y==null?void 0:y.code)===27&&s("requestfailed",{request_error:b.type+"_"+b.action,request_url:b.url,request_hostname:Ri(b.url),request_type:b.mediaType,request_error_code:A.status,request_error_text:A.statusText});var w="".concat(b!=null&&b.url?"url: ".concat(b.url,`
`):"")+"".concat(A!=null&&A.status||A!=null&&A.statusText?"response: ".concat(A==null?void 0:A.status,", ").concat(A==null?void 0:A.statusText,`
`):"");s("error",{player_error_code:y==null?void 0:y.code,player_error_message:y==null?void 0:y.message,player_error_context:w})};t.on("error",g),t._stopMuxMonitor=function(){t.off("manifestLoaded",a),t.off("initFragmentLoaded",c),t.off("mediaFragmentLoaded",h),t.off("qualityChangeRendered",p),t.off("error",g),t.off("fragmentLoadingAbandoned",v),delete t._stopMuxMonitor}},wR=function(i){i&&typeof i._stopMuxMonitor=="function"&&i._stopMuxMonitor()},Wg=0,IR=function(){function i(){Et(this,i),B(this,"_listeners",void 0)}return sn(i,[{key:"on",value:function(e,t,n){return t._eventEmitterGuid=t._eventEmitterGuid||++Wg,this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],n&&(t=t.bind(n)),this._listeners[e].push(t),t}},{key:"off",value:function(e,t){var n=this._listeners&&this._listeners[e];n&&n.forEach(function(r,s){r._eventEmitterGuid===t._eventEmitterGuid&&n.splice(s,1)})}},{key:"one",value:function(e,t,n){var r=this;t._eventEmitterGuid=t._eventEmitterGuid||++Wg;var s=function(){r.off(e,s),t.apply(n||this,arguments)};s._eventEmitterGuid=t._eventEmitterGuid,this.on(e,s)}},{key:"emit",value:function(e,t){var n=this;if(this._listeners){t=t||{};var r=this._listeners["before*"]||[],s=this._listeners[e]||[],a=this._listeners["after"+e]||[],o=function(l,u){l=l.slice(),l.forEach(function(c){c.call(n,{type:e},u)})};o(r,t),o(s,t),o(a,t)}}}]),i}(),LR=IR,Ad=ii(Ci()),kR=function(){function i(e){var t=this;Et(this,i),B(this,"_playbackHeartbeatInterval",void 0),B(this,"_playheadShouldBeProgressing",void 0),B(this,"pm",void 0),this.pm=e,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,e.on("playing",function(){t._playheadShouldBeProgressing=!0}),e.on("play",this._startPlaybackHeartbeatInterval.bind(this)),e.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),e.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),e.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("seeked",function(){e.data.player_is_paused?t._stopPlaybackHeartbeatInterval():t._startPlaybackHeartbeatInterval()}),e.on("timeupdate",function(){t._playbackHeartbeatInterval!==null&&e.emit("playbackheartbeat")}),e.on("devicesleep",function(n,r){t._playbackHeartbeatInterval!==null&&(Ad.default.clearInterval(t._playbackHeartbeatInterval),e.emit("playbackheartbeatend",{viewer_time:r.viewer_time}),t._playbackHeartbeatInterval=null)})}return sn(i,[{key:"_startPlaybackHeartbeatInterval",value:function(){var e=this;this._playbackHeartbeatInterval===null&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=Ad.default.setInterval(function(){e.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,this._playbackHeartbeatInterval!==null&&(Ad.default.clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),i}(),DR=kR,CR=function i(e){var t=this;Et(this,i),B(this,"viewErrored",void 0),e.on("viewinit",function(){t.viewErrored=!1}),e.on("error",function(n,r){try{var s=e.errorTranslator({player_error_code:r.player_error_code,player_error_message:r.player_error_message,player_error_context:r.player_error_context,player_error_severity:r.player_error_severity,player_error_business_exception:r.player_error_business_exception});s&&(e.data.player_error_code=s.player_error_code||r.player_error_code,e.data.player_error_message=s.player_error_message||r.player_error_message,e.data.player_error_context=s.player_error_context||r.player_error_context,e.data.player_error_severity=s.player_error_severity||r.player_error_severity,e.data.player_error_business_exception=s.player_error_business_exception||r.player_error_business_exception,t.viewErrored=!0)}catch(a){e.mux.log.warn("Exception in error translator callback.",a),t.viewErrored=!0}}),e.on("aftererror",function(){var n,r,s,a,o;(n=e.data)===null||n===void 0||delete n.player_error_code,(r=e.data)===null||r===void 0||delete r.player_error_message,(s=e.data)===null||s===void 0||delete s.player_error_context,(a=e.data)===null||a===void 0||delete a.player_error_severity,(o=e.data)===null||o===void 0||delete o.player_error_business_exception})},PR=CR,MR=function(){function i(e){Et(this,i),B(this,"_watchTimeTrackerLastCheckedTime",void 0),B(this,"pm",void 0),this.pm=e,this._watchTimeTrackerLastCheckedTime=null,e.on("playbackheartbeat",this._updateWatchTime.bind(this)),e.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return sn(i,[{key:"_updateWatchTime",value:function(e,t){var n=t.viewer_time;this._watchTimeTrackerLastCheckedTime===null&&(this._watchTimeTrackerLastCheckedTime=n),et(this.pm.data,"view_watch_time",n-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=n}},{key:"_clearWatchTimeState",value:function(e,t){this._updateWatchTime(e,t),this._watchTimeTrackerLastCheckedTime=null}}]),i}(),OR=MR,NR=function(){function i(e){var t=this;Et(this,i),B(this,"_playbackTimeTrackerLastPlayheadPosition",void 0),B(this,"_lastTime",void 0),B(this,"_isAdPlaying",void 0),B(this,"_callbackUpdatePlaybackTime",void 0),B(this,"pm",void 0),this.pm=e,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=it.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null;var n=this._startPlaybackTimeTracking.bind(this);e.on("playing",n),e.on("adplaying",n),e.on("seeked",n);var r=this._stopPlaybackTimeTracking.bind(this);e.on("playbackheartbeatend",r),e.on("seeking",r),e.on("adplaying",function(){t._isAdPlaying=!0}),e.on("adended",function(){t._isAdPlaying=!1}),e.on("adpause",function(){t._isAdPlaying=!1}),e.on("adbreakstart",function(){t._isAdPlaying=!1}),e.on("adbreakend",function(){t._isAdPlaying=!1}),e.on("adplay",function(){t._isAdPlaying=!1}),e.on("viewinit",function(){t._playbackTimeTrackerLastPlayheadPosition=-1,t._lastTime=it.now(),t._isAdPlaying=!1,t._callbackUpdatePlaybackTime=null})}return sn(i,[{key:"_startPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime===null&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var e=this.pm.data.player_playhead_time,t=it.now(),n=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&e>this._playbackTimeTrackerLastPlayheadPosition?n=e-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(n=t-this._lastTime),n>0&&n<=1e3&&et(this.pm.data,"view_content_playback_time",n),this._playbackTimeTrackerLastPlayheadPosition=e,this._lastTime=t}}]),i}(),FR=NR,UR=function(){function i(e){Et(this,i),B(this,"pm",void 0),this.pm=e;var t=this._updatePlayheadTime.bind(this);e.on("playbackheartbeat",t),e.on("playbackheartbeatend",t),e.on("timeupdate",t),e.on("destroy",function(){e.off("timeupdate",t)})}return sn(i,[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=typeof this.pm.data.view_max_playhead_position>"u"?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(e,t){var n=this,r=function(){n.pm.currentFragmentPDT&&n.pm.currentFragmentStart&&(n.pm.data.player_program_time=n.pm.currentFragmentPDT+n.pm.data.player_playhead_time-n.pm.currentFragmentStart)};if(t&&t.player_playhead_time)this.pm.data.player_playhead_time=t.player_playhead_time,r(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var s=this.pm.getPlayheadTime();typeof s<"u"&&(this.pm.data.player_playhead_time=s,r(),this._updateMaxPlayheadPosition())}}}]),i}(),$R=UR,qg=5*60*1e3,BR=function i(e){if(Et(this,i),!e.disableRebufferTracking){var t,n=function(s,a){r(a),t=void 0},r=function(s){if(t){var a=s.viewer_time-t;et(e.data,"view_rebuffer_duration",a),t=s.viewer_time,e.data.view_rebuffer_duration>qg&&(e.emit("viewend"),e.send("viewend"),e.mux.log.warn("Ending view after rebuffering for longer than ".concat(qg,"ms, future events will be ignored unless a programchange or videochange occurs.")))}e.data.view_watch_time>=0&&e.data.view_rebuffer_count>0&&(e.data.view_rebuffer_frequency=e.data.view_rebuffer_count/e.data.view_watch_time,e.data.view_rebuffer_percentage=e.data.view_rebuffer_duration/e.data.view_watch_time)};e.on("playbackheartbeat",function(s,a){return r(a)}),e.on("rebufferstart",function(s,a){t||(et(e.data,"view_rebuffer_count",1),t=a.viewer_time,e.one("rebufferend",n))}),e.on("viewinit",function(){t=void 0,e.off("rebufferend",n)})}},GR=BR,HR=function(){function i(e){var t=this;Et(this,i),B(this,"_lastCheckedTime",void 0),B(this,"_lastPlayheadTime",void 0),B(this,"_lastPlayheadTimeUpdatedTime",void 0),B(this,"_rebuffering",void 0),B(this,"pm",void 0),this.pm=e,!(e.disableRebufferTracking||e.disablePlayheadRebufferTracking)&&(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,e.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),e.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),e.on("seeking",function(){t._cleanupRebufferTracker(null,{viewer_time:it.now()})}))}return sn(i,[{key:"_checkIfRebuffering",value:function(e,t){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing){this._cleanupRebufferTracker(e,t);return}if(this._lastCheckedTime===null){this._prepareRebufferTrackerState(t.viewer_time);return}if(this._lastPlayheadTime!==this.pm.data.player_playhead_time){this._cleanupRebufferTracker(e,t,!0);return}var n=t.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.sustainedRebufferThreshold=="number"&&n>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=t.viewer_time}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(e){this._lastCheckedTime=e,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=e}},{key:"_cleanupRebufferTracker",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:t.viewer_time});else{if(this._lastCheckedTime===null)return;var r=this.pm.data.player_playhead_time-this._lastPlayheadTime,s=t.viewer_time-this._lastPlayheadTimeUpdatedTime;typeof this.pm.minimumRebufferDuration=="number"&&r>0&&s-r>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+s-r}))}n?this._prepareRebufferTrackerState(t.viewer_time):this._clearRebufferTrackerState()}}]),i}(),VR=HR,KR=function(){function i(e){var t=this;Et(this,i),B(this,"NAVIGATION_START",void 0),B(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){var n=e.data,r=n.view_id;if(!n.view_program_changed){var s=function(a,o){var l=o.viewer_time;(a.type==="playing"&&typeof e.data.view_time_to_first_frame>"u"||a.type==="adplaying"&&(typeof e.data.view_time_to_first_frame>"u"||t._inPrerollPosition()))&&t.calculateTimeToFirstFrame(l||it.now(),r)};e.one("playing",s),e.one("adplaying",s),e.one("viewend",function(){e.off("playing",s),e.off("adplaying",s)})}})}return sn(i,[{key:"_inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time>"u"||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(e,t){t===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:e}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.NAVIGATION_START))}}]),i}(),WR=KR,qR=function i(e){var t=this;Et(this,i),B(this,"_lastPlayerHeight",void 0),B(this,"_lastPlayerWidth",void 0),B(this,"_lastPlayheadPosition",void 0),B(this,"_lastSourceHeight",void 0),B(this,"_lastSourceWidth",void 0),e.on("viewinit",function(){t._lastPlayheadPosition=-1});var n=["pause","rebufferstart","seeking","error","adbreakstart","hb"],r=["playing","hb"];n.forEach(function(s){e.on(s,function(){if(t._lastPlayheadPosition>=0&&e.data.player_playhead_time>=0&&t._lastPlayerWidth>=0&&t._lastSourceWidth>0&&t._lastPlayerHeight>=0&&t._lastSourceHeight>0){var a=e.data.player_playhead_time-t._lastPlayheadPosition;if(a<0){t._lastPlayheadPosition=-1;return}var o=Math.min(t._lastPlayerWidth/t._lastSourceWidth,t._lastPlayerHeight/t._lastSourceHeight),l=Math.max(0,o-1),u=Math.max(0,1-o);e.data.view_max_upscale_percentage=Math.max(e.data.view_max_upscale_percentage||0,l),e.data.view_max_downscale_percentage=Math.max(e.data.view_max_downscale_percentage||0,u),et(e.data,"view_total_content_playback_time",a),et(e.data,"view_total_upscaling",l*a),et(e.data,"view_total_downscaling",u*a)}t._lastPlayheadPosition=-1})}),r.forEach(function(s){e.on(s,function(){t._lastPlayheadPosition=e.data.player_playhead_time,t._lastPlayerWidth=e.data.player_width,t._lastPlayerHeight=e.data.player_height,t._lastSourceWidth=e.data.video_source_width,t._lastSourceHeight=e.data.video_source_height})})},YR=qR,jR=2e3,zR=function i(e){var t=this;Et(this,i),B(this,"isSeeking",void 0),this.isSeeking=!1;var n=-1,r=function(){var s=it.now(),a=(e.data.viewer_time||s)-(n||s);et(e.data,"view_seek_duration",a),e.data.view_max_seek_time=Math.max(e.data.view_max_seek_time||0,a),t.isSeeking=!1,n=-1};e.on("seeking",function(s,a){if(Object.assign(e.data,a),t.isSeeking&&a.viewer_time-n<=jR){n=a.viewer_time;return}t.isSeeking&&r(),t.isSeeking=!0,n=a.viewer_time,et(e.data,"view_seek_count",1),e.send("seeking")}),e.on("seeked",function(){r()}),e.on("viewend",function(){t.isSeeking&&(r(),e.send("seeked")),t.isSeeking=!1,n=-1})},QR=zR,Yg=function(i,e){i.push(e),i.sort(function(t,n){return t.viewer_time-n.viewer_time})},XR=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],ZR=function(){function i(e){var t=this;Et(this,i),B(this,"_adHasPlayed",void 0),B(this,"_adRequests",void 0),B(this,"_adResponses",void 0),B(this,"_currentAdRequestNumber",void 0),B(this,"_currentAdResponseNumber",void 0),B(this,"_prerollPlayTime",void 0),B(this,"_wouldBeNewAdPlay",void 0),B(this,"isAdBreak",void 0),B(this,"pm",void 0),this.pm=e,e.on("viewinit",function(){t.isAdBreak=!1,t._currentAdRequestNumber=0,t._currentAdResponseNumber=0,t._adRequests=[],t._adResponses=[],t._adHasPlayed=!1,t._wouldBeNewAdPlay=!0,t._prerollPlayTime=void 0}),XR.forEach(function(r){return e.on(r,t._updateAdData.bind(t))});var n=function(){t.isAdBreak=!1};e.on("adbreakstart",function(){t.isAdBreak=!0}),e.on("play",n),e.on("playing",n),e.on("viewend",n),e.on("adrequest",function(r,s){s=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdRequestNumber++},s),Yg(t._adRequests,s),et(e.data,"view_ad_request_count"),t.inPrerollPosition()&&(e.data.view_preroll_requested=!0,t._adHasPlayed||et(e.data,"view_preroll_request_count"))}),e.on("adresponse",function(r,s){s=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdResponseNumber++},s),Yg(t._adResponses,s);var a=t.findAdRequest(s.ad_request_id);a&&et(e.data,"view_ad_request_time",Math.max(0,s.viewer_time-a.viewer_time))}),e.on("adplay",function(r,s){t._adHasPlayed=!0,t._wouldBeNewAdPlay&&(t._wouldBeNewAdPlay=!1,et(e.data,"view_ad_played_count")),t.inPrerollPosition()&&!e.data.view_preroll_played&&(e.data.view_preroll_played=!0,t._adRequests.length>0&&(e.data.view_preroll_request_time=Math.max(0,s.viewer_time-t._adRequests[0].viewer_time)),e.data.view_start&&(e.data.view_startup_preroll_request_time=Math.max(0,s.viewer_time-e.data.view_start)),t._prerollPlayTime=s.viewer_time)}),e.on("adplaying",function(r,s){t.inPrerollPosition()&&typeof e.data.view_preroll_load_time>"u"&&typeof t._prerollPlayTime<"u"&&(e.data.view_preroll_load_time=s.viewer_time-t._prerollPlayTime,e.data.view_startup_preroll_load_time=s.viewer_time-t._prerollPlayTime)}),e.on("adclicked",function(r,s){t._wouldBeNewAdPlay||et(e.data,"view_ad_clicked_count")}),e.on("adskipped",function(r,s){t._wouldBeNewAdPlay||et(e.data,"view_ad_skipped_count")}),e.on("adended",function(){t._wouldBeNewAdPlay=!0}),e.on("aderror",function(){t._wouldBeNewAdPlay=!0})}return sn(i,[{key:"inPrerollPosition",value:function(){return typeof this.pm.data.view_content_playback_time>"u"||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(e){for(var t=0;t<this._adRequests.length;t++)if(this._adRequests[t].ad_request_id===e)return this._adRequests[t]}},{key:"_updateAdData",value:function(e,t){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&t.ad_tag_url){var n=An(fo(t.ad_tag_url),2),r=n[0],s=n[1];this.pm.data.view_preroll_ad_tag_domain=s,this.pm.data.view_preroll_ad_tag_hostname=r}if(!this.pm.data.view_preroll_ad_asset_hostname&&t.ad_asset_url){var a=An(fo(t.ad_asset_url),2),o=a[0],l=a[1];this.pm.data.view_preroll_ad_asset_domain=l,this.pm.data.view_preroll_ad_asset_hostname=o}}this.pm.data.ad_asset_url=t==null?void 0:t.ad_asset_url,this.pm.data.ad_tag_url=t==null?void 0:t.ad_tag_url,this.pm.data.ad_creative_id=t==null?void 0:t.ad_creative_id,this.pm.data.ad_id=t==null?void 0:t.ad_id,this.pm.data.ad_universal_id=t==null?void 0:t.ad_universal_id}}]),i}(),JR=ZR,jg=ii(Ci()),ew=function i(e){Et(this,i);var t,n,r=function(){e.disableRebufferTracking||(et(e.data,"view_waiting_rebuffer_count",1),t=it.now(),n=jg.default.setInterval(function(){if(t){var u=it.now();et(e.data,"view_waiting_rebuffer_duration",u-t),t=u}},250))},s=function(){e.disableRebufferTracking||t&&(et(e.data,"view_waiting_rebuffer_duration",it.now()-t),t=!1,jg.default.clearInterval(n))},a=!1,o=function(){a=!0},l=function(){a=!1,s()};e.on("waiting",function(){a&&r()}),e.on("playing",function(){s(),o()}),e.on("pause",l),e.on("seeking",l)},tw=ew,iw=function i(e){var t=this;Et(this,i),B(this,"lastWallClockTime",void 0);var n=function(){t.lastWallClockTime=it.now(),e.on("before*",r)},r=function(s){var a=it.now(),o=t.lastWallClockTime;t.lastWallClockTime=a,a-o>3e4&&(e.emit("devicesleep",{viewer_time:o}),Object.assign(e.data,{viewer_time:o}),e.send("devicesleep"),e.emit("devicewake",{viewer_time:a}),Object.assign(e.data,{viewer_time:a}),e.send("devicewake"))};e.one("playbackheartbeat",n),e.on("playbackheartbeatend",function(){e.off("before*",r),e.one("playbackheartbeat",n)})},nw=iw,xd=ii(Ci()),yT=function(i){return i()}(function(){var i=function(){for(var t=0,n={};t<arguments.length;t++){var r=arguments[t];for(var s in r)n[s]=r[s]}return n};function e(t){function n(r,s,a){var o;if(typeof document<"u"){if(arguments.length>1){if(a=i({path:"/"},n.defaults,a),typeof a.expires=="number"){var l=new Date;l.setMilliseconds(l.getMilliseconds()+a.expires*864e5),a.expires=l}try{o=JSON.stringify(s),/^[\{\[]/.test(o)&&(s=o)}catch{}return t.write?s=t.write(s,r):s=encodeURIComponent(String(s)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),r=encodeURIComponent(String(r)),r=r.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),r=r.replace(/[\(\)]/g,escape),document.cookie=[r,"=",s,a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}r||(o={});for(var u=document.cookie?document.cookie.split("; "):[],c=/(%[0-9A-Z]{2})+/g,d=0;d<u.length;d++){var h=u[d].split("="),f=h.slice(1).join("=");f.charAt(0)==='"'&&(f=f.slice(1,-1));try{var m=h[0].replace(c,decodeURIComponent);if(f=t.read?t.read(f,m):t(f,m)||f.replace(c,decodeURIComponent),this.json)try{f=JSON.parse(f)}catch{}if(r===m){o=f;break}r||(o[m]=f)}catch{}}return o}}return n.set=n,n.get=function(r){return n.call(n,r)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(r,s){n(r,"",i(s,{expires:-1}))},n.withConverter=e,n}return e(function(){})}),TT="muxData",rw=function(i){return Object.entries(i).map(function(e){var t=An(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(r)}).join("&")},sw=function(i){return i.split("&").reduce(function(e,t){var n=An(t.split("="),2),r=n[0],s=n[1],a=+s,o=s&&a==s?a:s;return e[r]=o,e},{})},_T=function(){var i;try{i=sw(yT.get(TT)||"")}catch{i={}}return i},ST=function(i){try{yT.set(TT,rw(i),{expires:365})}catch{}},aw=function(){var i=_T();return i.mux_viewer_id=i.mux_viewer_id||ho(),i.msn=i.msn||Math.random(),ST(i),{mux_viewer_id:i.mux_viewer_id,mux_sample_number:i.msn}},ow=function(){var i=_T(),e=it.now();return i.session_start&&(i.sst=i.session_start,delete i.session_start),i.session_id&&(i.sid=i.session_id,delete i.session_id),i.session_expires&&(i.sex=i.session_expires,delete i.session_expires),(!i.sex||i.sex<e)&&(i.sid=ho(),i.sst=e),i.sex=e+25*60*1e3,ST(i),{session_id:i.sid,session_start:i.sst,session_expires:i.sex}};function lw(i,e){var t=e.beaconCollectionDomain,n=e.beaconDomain;if(t)return"https://"+t;i=i||"inferred";var r=n||"litix.io";return i.match(/^[a-z0-9]+$/)?"https://"+i+"."+r:"https://img.litix.io/a.gif"}var uw=ii(Ci()),AT=function(){var i;switch(xT()){case"cellular":i="cellular";break;case"ethernet":i="wired";break;case"wifi":i="wifi";break;case void 0:break;default:i="other"}return i},xT=function(){var i=uw.default.navigator,e=i&&(i.connection||i.mozConnection||i.webkitConnection);return e&&e.type};AT.getConnectionFromAPI=xT;var cw=AT,dw={a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"},hw=bT(dw),fw={ad:"ad",af:"affiliate",ag:"aggregate",ap:"api",al:"application",ao:"audio",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",bn:"brand",br:"break",bw:"browser",by:"bytes",bz:"business",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ci:"client",ck:"clicked",cl:"canceled",cn:"config",co:"count",ce:"counter",cp:"complete",cq:"creator",cr:"creative",cs:"captions",ct:"content",cu:"current",cx:"connection",cz:"context",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",dy:"dynamic",eb:"enabled",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",ep:"experiments",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ez:"exception",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",or:"origin",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pp:"pip",pr:"preload",ps:"position",pt:"part",py:"property",px:"pop",pz:"plan",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rg:"range",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sh:"shift",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",ss:"status",st:"start",su:"startup",sv:"server",sw:"software",sy:"severity",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"},zg=bT(fw);function bT(i){var e={};for(var t in i)i.hasOwnProperty(t)&&(e[i[t]]=t);return e}function zh(i){var e={},t={};return Object.keys(i).forEach(function(n){var r=!1;if(i.hasOwnProperty(n)&&i[n]!==void 0){var s=n.split("_"),a=s[0],o=hw[a];o||(Le.info("Data key word `"+s[0]+"` not expected in "+n),o=a+"_"),s.splice(1).forEach(function(l){l==="url"&&(r=!0),zg[l]?o+=zg[l]:Number.isInteger(Number(l))?o+=l:(Le.info("Data key word `"+l+"` not expected in "+n),o+="_"+l+"_")}),r?t[o]=i[n]:e[o]=i[n]}}),Object.assign(e,t)}var _r=ii(Ci()),mw=ii(mT()),pw={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},gw=56*1024,vw=["hb","requestcompleted","requestfailed","requestcanceled"],Ew="https://img.litix.io",bn=function(i){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this._beaconUrl=i||Ew,this._eventQueue=[],this._postInFlight=!1,this._resendAfterPost=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},pw,e)};bn.prototype.queueEvent=function(i,e){var t=Object.assign({},e);return this._eventQueue.length<=this._options.maxQueueLength||i==="eventrateexceeded"?(this._eventQueue.push(t),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength):!1};bn.prototype.flushEvents=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(i&&this._eventQueue.length===1){this._eventQueue.pop();return}this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending()};bn.prototype.destroy=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.destroyed=!0,i?this._clearBeaconQueue():this.flushEvents(),_r.default.clearTimeout(this._sendTimeout)};bn.prototype._clearBeaconQueue=function(){var i=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,e=this._eventQueue.slice(i);i>0&&Object.assign(e[e.length-1],zh({mux_view_message:"event queue truncated"}));var t=this._createPayload(e);RT(this._beaconUrl,t,!0,function(){})};bn.prototype._sendBeaconQueue=function(){var i=this;if(this._postInFlight){this._resendAfterPost=!0;return}var e=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var t=this._createPayload(e),n=it.now();RT(this._beaconUrl,t,!1,function(r,s){s?(i._eventQueue=e.concat(i._eventQueue),i._failureCount+=1,Le.info("Error sending beacon: "+s)):i._failureCount=0,i._roundTripTime=it.now()-n,i._postInFlight=!1,i._resendAfterPost&&(i._resendAfterPost=!1,i._eventQueue.length>0&&i._sendBeaconQueue())})};bn.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var i=Math.pow(2,this._failureCount-1);return i=i*Math.random(),(1+i)*this._options.baseTimeBetweenBeacons};bn.prototype._startBeaconSending=function(){var i=this;_r.default.clearTimeout(this._sendTimeout),!this.destroyed&&(this._sendTimeout=_r.default.setTimeout(function(){i._eventQueue.length&&i._sendBeaconQueue(),i._startBeaconSending()},this._getNextBeaconTime()))};bn.prototype._createPayload=function(i){var e=this,t={transmission_timestamp:Math.round(it.now())};this._roundTripTime&&(t.rtt_ms=Math.round(this._roundTripTime));var n,r,s,a=function(){n=JSON.stringify({metadata:t,events:r||i}),s=n.length/1024},o=function(){return s<=e._options.maxPayloadKBSize};return a(),o()||(Le.info("Payload size is too big ("+s+" kb). Removing unnecessary events."),r=i.filter(function(l){return vw.indexOf(l.e)===-1}),a()),o()||(Le.info("Payload size still too big ("+s+" kb). Cropping fields.."),r.forEach(function(l){for(var u in l){var c=l[u],d=50*1024;typeof c=="string"&&c.length>d&&(l[u]=c.substring(0,d))}}),a()),n};var yw=typeof mw.default.exitPictureInPicture=="function"?function(i){return i.length<=gw}:function(i){return!1},RT=function(i,e,t,n){if(t&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(i,e)){n();return}if(_r.default.fetch){_r.default.fetch(i,{method:"POST",body:e,headers:{"Content-Type":"text/plain"},keepalive:yw(e)}).then(function(s){return n(null,s.ok?null:"Error")}).catch(function(s){return n(null,s)});return}if(_r.default.XMLHttpRequest){var r=new _r.default.XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4)return n(null,r.status!==200?"error":void 0)},r.open("POST",i),r.setRequestHeader("Content-Type","text/plain"),r.send(e);return}n()},Tw=bn,_w=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id","player_error_code","player_error_message","player_error_context","player_error_severity","player_error_business_exception"],Sw=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],Aw=["ad_id","ad_creative_id","ad_universal_id"],xw=["viewstart","error","ended","viewend"],bw=10*60*1e3,Rw=function(){function i(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Et(this,i);var r,s,a,o,l,u,c,d,h,f,m,p;B(this,"mux",void 0),B(this,"envKey",void 0),B(this,"options",void 0),B(this,"eventQueue",void 0),B(this,"sampleRate",void 0),B(this,"disableCookies",void 0),B(this,"respectDoNotTrack",void 0),B(this,"previousBeaconData",void 0),B(this,"lastEventTime",void 0),B(this,"rateLimited",void 0),B(this,"pageLevelData",void 0),B(this,"viewerData",void 0),this.mux=e,this.envKey=t,this.options=n,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.eventQueue=new Tw(lw(this.envKey,this.options));var v;this.sampleRate=(v=this.options.sampleRate)!==null&&v!==void 0?v:1;var g;this.disableCookies=(g=this.options.disableCookies)!==null&&g!==void 0?g:!1;var E;this.respectDoNotTrack=(E=this.options.respectDoNotTrack)!==null&&E!==void 0?E:!1,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:(r=this.options.platform)===null||r===void 0?void 0:r.name,viewer_application_version:(s=this.options.platform)===null||s===void 0?void 0:s.version,viewer_application_engine:(a=this.options.platform)===null||a===void 0?void 0:a.layout,viewer_device_name:(o=this.options.platform)===null||o===void 0?void 0:o.product,viewer_device_category:"",viewer_device_manufacturer:(l=this.options.platform)===null||l===void 0?void 0:l.manufacturer,viewer_os_family:(c=this.options.platform)===null||c===void 0||(u=c.os)===null||u===void 0?void 0:u.family,viewer_os_architecture:(h=this.options.platform)===null||h===void 0||(d=h.os)===null||d===void 0?void 0:d.architecture,viewer_os_version:(m=this.options.platform)===null||m===void 0||(f=m.os)===null||f===void 0?void 0:f.version,viewer_connection_type:cw(),page_url:xd.default===null||xd.default===void 0||(p=xd.default.location)===null||p===void 0?void 0:p.href},this.viewerData=this.disableCookies?{}:aw()}return sn(i,[{key:"send",value:function(e,t){if(!(!e||!(t!=null&&t.view_id))){if(this.respectDoNotTrack&&Yh())return Le.info("Not sending `"+e+"` because Do Not Track is enabled");if(!t||typeof t!="object")return Le.error("A data object was expected in send() but was not provided");var n=this.disableCookies?{}:ow(),r=Pm(Yu({},this.pageLevelData,t,n,this.viewerData),{event:e,env_key:this.envKey});r.user_id&&(r.viewer_user_id=r.user_id,delete r.user_id);var s,a=((s=r.mux_sample_number)!==null&&s!==void 0?s:0)>=this.sampleRate,o=this._deduplicateBeaconData(e,r),l=zh(o);if(this.lastEventTime=this.mux.utils.now(),a)return Le.info("Not sending event due to sample rate restriction",e,r,l);if(this.envKey||Le.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",e,r,l),!this.rateLimited){if(Le.info("Sending event",e,r,l),this.rateLimited=!this.eventQueue.queueEvent(e,l),this.mux.WINDOW_UNLOADING&&e==="viewend")this.eventQueue.destroy(!0);else if(this.mux.WINDOW_HIDDEN&&e==="hb"?this.eventQueue.flushEvents(!0):xw.indexOf(e)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return r.event="eventrateexceeded",l=zh(r),this.eventQueue.queueEvent(r.event,l),Le.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(e,t){var n=this,r={},s=t.view_id;if(s==="-1"||e==="viewstart"||e==="viewend"||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=bw)r=Yu({},t),s&&(this.previousBeaconData=r),s&&e==="viewend"&&(this.previousBeaconData=null);else{var a=e.indexOf("request")===0;Object.entries(t).forEach(function(o){var l=An(o,2),u=l[0],c=l[1];n.previousBeaconData&&(c!==n.previousBeaconData[u]||_w.indexOf(u)>-1||n.objectHasChanged(a,u,c,n.previousBeaconData[u])||n.eventRequiresKey(e,u))&&(r[u]=c,n.previousBeaconData[u]=c)})}return r}},{key:"objectHasChanged",value:function(e,t,n,r){return!e||t.indexOf("request_")!==0?!1:t==="request_response_headers"||typeof n!="object"||typeof r!="object"?!0:Object.keys(n||{}).length!==Object.keys(r||{}).length}},{key:"eventRequiresKey",value:function(e,t){return!!(e==="renditionchange"&&t.indexOf("video_source_")===0||Aw.includes(t)&&Sw.includes(e))}}]),i}(),ww=function i(e){Et(this,i);var t=0,n=0,r=0,s=0,a=0,o=0,l=0,u=function(h,f){var m=f.request_start,p=f.request_response_start,v=f.request_response_end,g=f.request_bytes_loaded;s++;var E,y;if(p?(E=p-(m??0),y=(v??0)-p):y=(v??0)-(m??0),y>0&&g&&g>0){var _=g/y*8e3;a++,n+=g,r+=y,e.data.view_min_request_throughput=Math.min(e.data.view_min_request_throughput||1/0,_),e.data.view_average_request_throughput=n/r*8e3,e.data.view_request_count=s,E>0&&(t+=E,e.data.view_max_request_latency=Math.max(e.data.view_max_request_latency||0,E),e.data.view_average_request_latency=t/a)}},c=function(h,f){s++,o++,e.data.view_request_count=s,e.data.view_request_failed_count=o},d=function(h,f){s++,l++,e.data.view_request_count=s,e.data.view_request_canceled_count=l};e.on("requestcompleted",u),e.on("requestfailed",c),e.on("requestcanceled",d)},Iw=ww,Lw=60*60*1e3,kw=function i(e){var t=this;Et(this,i),B(this,"_lastEventTime",void 0),e.on("before*",function(n,r){var s=r.viewer_time,a=it.now(),o=t._lastEventTime;if(t._lastEventTime=a,o&&a-o>Lw){var l=Object.keys(e.data).reduce(function(c,d){return d.indexOf("video_")===0?Object.assign(c,B({},d,e.data[d])):c},{});e.mux.log.info("Received event after at least an hour inactivity, creating a new view");var u=e.playbackHeartbeat._playheadShouldBeProgressing;e._resetView(Object.assign({viewer_time:s},l)),e.playbackHeartbeat._playheadShouldBeProgressing=u,e.playbackHeartbeat._playheadShouldBeProgressing&&n.type!=="play"&&n.type!=="adbreakstart"&&(e.emit("play",{viewer_time:s}),n.type!=="playing"&&e.emit("playing",{viewer_time:s}))}})},Dw=kw,Cw=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],Pw=new Set(["requestcompleted","requestfailed","requestcanceled"]),Mw=function(i){hR(t,i);var e=pR(t);function t(n,r,s){Et(this,t);var a;a=e.call(this),B(ne(a),"DOM_CONTENT_LOADED_EVENT_END",void 0),B(ne(a),"NAVIGATION_START",void 0),B(ne(a),"_destroyed",void 0),B(ne(a),"_heartBeatTimeout",void 0),B(ne(a),"adTracker",void 0),B(ne(a),"dashjs",void 0),B(ne(a),"data",void 0),B(ne(a),"disablePlayheadRebufferTracking",void 0),B(ne(a),"disableRebufferTracking",void 0),B(ne(a),"errorTracker",void 0),B(ne(a),"errorTranslator",void 0),B(ne(a),"emitTranslator",void 0),B(ne(a),"getAdData",void 0),B(ne(a),"getPlayheadTime",void 0),B(ne(a),"getStateData",void 0),B(ne(a),"stateDataTranslator",void 0),B(ne(a),"hlsjs",void 0),B(ne(a),"id",void 0),B(ne(a),"longResumeTracker",void 0),B(ne(a),"minimumRebufferDuration",void 0),B(ne(a),"mux",void 0),B(ne(a),"playbackEventDispatcher",void 0),B(ne(a),"playbackHeartbeat",void 0),B(ne(a),"playbackHeartbeatTime",void 0),B(ne(a),"playheadTime",void 0),B(ne(a),"seekingTracker",void 0),B(ne(a),"sustainedRebufferThreshold",void 0),B(ne(a),"watchTimeTracker",void 0),B(ne(a),"currentFragmentPDT",void 0),B(ne(a),"currentFragmentStart",void 0),a.DOM_CONTENT_LOADED_EVENT_END=qu.domContentLoadedEventEnd(),a.NAVIGATION_START=qu.navigationStart();var o={debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(h){return h},emitTranslator:function(){for(var h=arguments.length,f=new Array(h),m=0;m<h;m++)f[m]=arguments[m];return f},stateDataTranslator:function(h){return h}};a.mux=n,a.id=r,s!=null&&s.beaconDomain&&a.mux.log.warn("The `beaconDomain` setting has been deprecated in favor of `beaconCollectionDomain`. Please change your integration to use `beaconCollectionDomain` instead of `beaconDomain`."),s=Object.assign(o,s),s.data=s.data||{},s.data.property_key&&(s.data.env_key=s.data.property_key,delete s.data.property_key),Le.level=s.debug?vr.DEBUG:vr.WARN,a.getPlayheadTime=s.getPlayheadTime,a.getStateData=s.getStateData||function(){return{}},a.getAdData=s.getAdData||function(){},a.minimumRebufferDuration=s.minimumRebufferDuration,a.sustainedRebufferThreshold=s.sustainedRebufferThreshold,a.playbackHeartbeatTime=s.playbackHeartbeatTime,a.disableRebufferTracking=s.disableRebufferTracking,a.disableRebufferTracking&&a.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),a.disablePlayheadRebufferTracking=s.disablePlayheadRebufferTracking,a.errorTranslator=s.errorTranslator,a.emitTranslator=s.emitTranslator,a.stateDataTranslator=s.stateDataTranslator,a.playbackEventDispatcher=new Rw(n,s.data.env_key,s),a.data={player_instance_id:ho(),mux_sample_rate:s.sampleRate,beacon_domain:s.beaconCollectionDomain||s.beaconDomain},a.data.view_sequence_number=1,a.data.player_sequence_number=1;var l=(function(){typeof this.data.view_start>"u"&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}).bind(ne(a));if(a.on("viewinit",function(h,f){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,f),this._initializeViewData(),this.one("play",l),this.one("adbreakstart",l)}),a.on("videochange",function(h,f){this._resetView(f)}),a.on("programchange",function(h,f){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),this._resetView(Object.assign(f,{view_program_changed:!0})),l(),this.emit("play"),this.emit("playing")}),a.on("fragmentchange",function(h,f){this.currentFragmentPDT=f.currentFragmentPDT,this.currentFragmentStart=f.currentFragmentStart}),a.on("destroy",a.destroy),typeof window<"u"&&typeof window.addEventListener=="function"&&typeof window.removeEventListener=="function"){var u=function(){var h=typeof a.data.view_start<"u";a.mux.WINDOW_HIDDEN=document.visibilityState==="hidden",h&&a.mux.WINDOW_HIDDEN&&(a.data.player_is_paused||a.emit("hb"))};window.addEventListener("visibilitychange",u,!1);var c=function(h){h.persisted||a.destroy()};window.addEventListener("pagehide",c,!1),a.on("destroy",function(){window.removeEventListener("visibilitychange",u),window.removeEventListener("pagehide",c)})}a.on("playerready",function(h,f){Object.assign(this.data,f)}),Cw.forEach(function(h){a.on(h,function(f,m){h.indexOf("ad")!==0&&this._updateStateData(),Object.assign(this.data,m),this._sanitizeData()}),a.on("after"+h,function(){(h!=="error"||this.errorTracker.viewErrored)&&this.send(h)})}),a.on("viewend",function(h,f){Object.assign(a.data,f)});var d=function(h){var f=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=f-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time};return a.one("playerready",d),a.longResumeTracker=new Dw(ne(a)),a.errorTracker=new PR(ne(a)),new nw(ne(a)),a.seekingTracker=new QR(ne(a)),a.playheadTime=new $R(ne(a)),a.playbackHeartbeat=new DR(ne(a)),new YR(ne(a)),a.watchTimeTracker=new OR(ne(a)),new FR(ne(a)),a.adTracker=new JR(ne(a)),new VR(ne(a)),new GR(ne(a)),new WR(ne(a)),new tw(ne(a)),new Iw(ne(a)),s.hlsjs&&a.addHLSJS(s),s.dashjs&&a.addDashJS(s),a.emit("viewinit",s.data),a}return sn(t,[{key:"emit",value:function(n,r){var s,a=Object.assign({viewer_time:this.mux.utils.now()},r),o=[n,a];if(this.emitTranslator)try{o=this.emitTranslator(n,a)}catch(l){this.mux.log.warn("Exception in emit translator callback.",l)}o!=null&&o.length&&(s=Fl(Ks(t.prototype),"emit",this)).call.apply(s,[this].concat(Ei(o)))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,typeof this.data.view_start<"u"&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(n){if(this.data.view_id){var r=Object.assign({},this.data),s=["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"];if(r.video_source_is_live===void 0&&(r.player_source_duration===1/0||r.video_source_duration===1/0?r.video_source_is_live=!0:(r.player_source_duration>0||r.video_source_duration>0)&&(r.video_source_is_live=!1)),r.video_source_is_live||s.forEach(function(u){r[u]=void 0}),r.video_source_url=r.video_source_url||r.player_source_url,r.video_source_url){var a=An(fo(r.video_source_url),2),o=a[0],l=a[1];r.video_source_domain=l,r.video_source_hostname=o}delete r.ad_request_id,this.playbackEventDispatcher.send(n,r),this.data.view_sequence_number++,this.data.player_sequence_number++,Pw.has(n)||this._restartHeartBeat(),n==="viewend"&&delete this.data.view_id}}},{key:"_resetView",value:function(n){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",n)}},{key:"_updateStateData",value:function(){var n=this.getStateData();if(typeof this.stateDataTranslator=="function")try{n=this.stateDataTranslator(n)}catch(r){this.mux.log.warn("Exception in stateDataTranslator translator callback.",r)}Object.assign(this.data,n),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var n=this,r=["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"];r.forEach(function(a){var o=parseInt(n.data[a],10);n.data[a]=isNaN(o)?void 0:o});var s=["player_source_url","video_source_url"];s.forEach(function(a){if(n.data[a]){var o=n.data[a].toLowerCase();(o.indexOf("data:")===0||o.indexOf("blob:")===0)&&(n.data[a]="MSE style URL")}})}},{key:"_resetVideoData",value:function(){var n=this;Object.keys(this.data).forEach(function(r){r.indexOf("video_")===0&&delete n.data[r]})}},{key:"_resetViewData",value:function(){var n=this;Object.keys(this.data).forEach(function(r){r.indexOf("view_")===0&&delete n.data[r]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(){delete this.data.player_error_code,delete this.data.player_error_message,delete this.data.player_error_context,delete this.data.player_error_severity,delete this.data.player_error_business_exception}},{key:"_initializeViewData",value:function(){var n=this,r=this.data.view_id=ho(),s=function(){r===n.data.view_id&&et(n.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",s):s()}},{key:"_restartHeartBeat",value:function(){var n=this;window.clearTimeout(this._heartBeatTimeout),this._heartBeatTimeout=window.setTimeout(function(){n.data.player_is_paused||n.emit("hb")},1e4)}},{key:"addHLSJS",value:function(n){if(!n.hlsjs){this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.");return}if(this.hlsjs){this.mux.log.warn("An instance of HLS.js is already being monitored for this player.");return}this.hlsjs=n.hlsjs,_R(this.mux,this.id,n.hlsjs,{},n.Hls||window.Hls)}},{key:"removeHLSJS",value:function(){this.hlsjs&&(SR(this.hlsjs),this.hlsjs=void 0)}},{key:"addDashJS",value:function(n){if(!n.dashjs){this.mux.log.warn("You must pass a valid dashjs instance in order to track it.");return}if(this.dashjs){this.mux.log.warn("An instance of Dash.js is already being monitored for this player.");return}this.dashjs=n.dashjs,RR(this.mux,this.id,n.dashjs)}},{key:"removeDashJS",value:function(){this.dashjs&&(wR(this.dashjs),this.dashjs=void 0)}}]),t}(LR),Ow=Mw,ha=ii(mT());function Nw(){return ha.default&&!!(ha.default.fullscreenElement||ha.default.webkitFullscreenElement||ha.default.mozFullScreenElement||ha.default.msFullscreenElement)}var Fw=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],Uw={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};function $w(i,e,t){var n=An(Wu(e),3),r=n[0],s=n[1],a=n[2],o=i.log,l=i.utils.getComputedStyle,u=i.utils.secondsToMs,c={automaticErrorTracking:!0};if(r){if(a!=="video"&&a!=="audio")return o.error("The element of `"+s+"` was not a media element.")}else return o.error("No element was found with the `"+s+"` query selector.");r.mux&&(r.mux.destroy(),delete r.mux,o.warn("Already monitoring this video element, replacing existing event listeners"));var d={getPlayheadTime:function(){return u(r.currentTime)},getStateData:function(){var f,m,p,v=((f=(m=this).getPlayheadTime)===null||f===void 0?void 0:f.call(m))||u(r.currentTime),g=this.hlsjs&&this.hlsjs.url,E=this.dashjs&&typeof this.dashjs.getSource=="function"&&this.dashjs.getSource(),y={player_is_paused:r.paused,player_width:parseInt(l(r,"width")),player_height:parseInt(l(r,"height")),player_autoplay_on:r.autoplay,player_preload_on:r.preload,player_language_code:r.lang,player_is_fullscreen:Nw(),video_poster_url:r.poster,video_source_url:g||E||r.currentSrc,video_source_duration:u(r.duration),video_source_height:r.videoHeight,video_source_width:r.videoWidth,view_dropped_frame_count:r==null||(p=r.getVideoPlaybackQuality)===null||p===void 0?void 0:p.call(r).droppedVideoFrames};if(r.getStartDate&&v>0){var _=r.getStartDate();if(_&&typeof _.getTime=="function"&&_.getTime()){var S=_.getTime();if(y.player_program_time=S+v,r.seekable.length>0){var b=S+r.seekable.end(r.seekable.length-1);y.player_live_edge_program_time=b}}}return y}};t=Object.assign(c,t,d),t.data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:i.VERSION},t.data),r.mux=r.mux||{},r.mux.deleted=!1,r.mux.emit=function(f,m){i.emit(s,f,m)},r.mux.updateData=function(f){r.mux.emit("hb",f)};var h=function(){o.error("The monitor for this video element has already been destroyed.")};r.mux.destroy=function(){Object.keys(r.mux.listeners).forEach(function(f){r.removeEventListener(f,r.mux.listeners[f],!1)}),delete r.mux.listeners,r.mux.destroy=h,r.mux.swapElement=h,r.mux.emit=h,r.mux.addHLSJS=h,r.mux.addDashJS=h,r.mux.removeHLSJS=h,r.mux.removeDashJS=h,r.mux.updateData=h,r.mux.setEmitTranslator=h,r.mux.setStateDataTranslator=h,r.mux.setGetPlayheadTime=h,r.mux.deleted=!0,i.emit(s,"destroy")},r.mux.swapElement=function(f){var m=An(Wu(f),3),p=m[0],v=m[1],g=m[2];if(p){if(g!=="video"&&g!=="audio")return i.log.error("The element of `"+v+"` was not a media element.")}else return i.log.error("No element was found with the `"+v+"` query selector.");p.muxId=r.muxId,delete r.muxId,p.mux=p.mux||{},p.mux.listeners=Object.assign({},r.mux.listeners),delete r.mux.listeners,Object.keys(p.mux.listeners).forEach(function(E){r.removeEventListener(E,p.mux.listeners[E],!1),p.addEventListener(E,p.mux.listeners[E],!1)}),p.mux.swapElement=r.mux.swapElement,p.mux.destroy=r.mux.destroy,delete r.mux,r=p},r.mux.addHLSJS=function(f){i.addHLSJS(s,f)},r.mux.addDashJS=function(f){i.addDashJS(s,f)},r.mux.removeHLSJS=function(){i.removeHLSJS(s)},r.mux.removeDashJS=function(){i.removeDashJS(s)},r.mux.setEmitTranslator=function(f){i.setEmitTranslator(s,f)},r.mux.setStateDataTranslator=function(f){i.setStateDataTranslator(s,f)},r.mux.setGetPlayheadTime=function(f){f||(f=t.getPlayheadTime),i.setGetPlayheadTime(s,f)},i.init(s,t),i.emit(s,"playerready"),r.paused||(i.emit(s,"play"),r.readyState>2&&i.emit(s,"playing")),r.mux.listeners={},Fw.forEach(function(f){f==="error"&&!t.automaticErrorTracking||(r.mux.listeners[f]=function(){var m={};if(f==="error"){if(!r.error||r.error.code===1)return;m.player_error_code=r.error.code,m.player_error_message=Uw[r.error.code]||r.error.message}i.emit(s,f,m)},r.addEventListener(f,r.mux.listeners[f],!1))})}function Bw(i,e,t,n){var r=n;if(i&&typeof i[e]=="function")try{r=i[e].apply(i,t)}catch(s){Le.info("safeCall error",s)}return r}var Ha=ii(Ci()),ts;Ha.default&&Ha.default.WeakMap&&(ts=new WeakMap);function Gw(i,e){if(!i||!e||!Ha.default||typeof Ha.default.getComputedStyle!="function")return"";var t;return ts&&ts.has(i)&&(t=ts.get(i)),t||(t=Ha.default.getComputedStyle(i,null),ts&&ts.set(i,t)),t.getPropertyValue(e)}function Hw(i){return Math.floor(i*1e3)}var ar={TARGET_DURATION:"#EXT-X-TARGETDURATION",PART_INF:"#EXT-X-PART-INF",SERVER_CONTROL:"#EXT-X-SERVER-CONTROL",INF:"#EXTINF",PROGRAM_DATE_TIME:"#EXT-X-PROGRAM-DATE-TIME",VERSION:"#EXT-X-VERSION",SESSION_DATA:"#EXT-X-SESSION-DATA"},Nc=function(i){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(i),this.manifest};Nc.prototype.process=function(i){var e;for(this.buffer+=i,e=this.buffer.indexOf(`
`);e>-1;e=this.buffer.indexOf(`
`))this.processLine(this.buffer.substring(0,e)),this.buffer=this.buffer.substring(e+1)};Nc.prototype.processLine=function(i){var e=i.indexOf(":"),t=qw(i,e),n=t[0],r=t.length===2?Om(t[1]):void 0;if(n[0]!=="#")this.currentUri.uri=n,this.manifest.segments.push(this.currentUri),this.manifest.targetDuration&&!("duration"in this.currentUri)&&(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(n){case ar.TARGET_DURATION:{if(!isFinite(r)||r<0)return;this.manifest.targetDuration=r,this.setHoldBack();break}case ar.PART_INF:{bd(this.manifest,t),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break}case ar.SERVER_CONTROL:{bd(this.manifest,t),this.setHoldBack();break}case ar.INF:{r===0?this.currentUri.duration=.01:r>0&&(this.currentUri.duration=r);break}case ar.PROGRAM_DATE_TIME:{var s=r,a=new Date(s);this.manifest.dateTimeString||(this.manifest.dateTimeString=s,this.manifest.dateTimeObject=a),this.currentUri.dateTimeString=s,this.currentUri.dateTimeObject=a;break}case ar.VERSION:{bd(this.manifest,t);break}case ar.SESSION_DATA:{var o=Yw(t[1]),l=ET(o);Object.assign(this.manifest.sessionData,l)}}};Nc.prototype.setHoldBack=function(){var i=this.manifest,e=i.serverControl,t=i.targetDuration,n=i.partTargetDuration;if(e){var r="holdBack",s="partHoldBack",a=t&&t*3,o=n&&n*2;t&&!e.hasOwnProperty(r)&&(e[r]=a),a&&e[r]<a&&(e[r]=a),n&&!e.hasOwnProperty(s)&&(e[s]=n*3),n&&e[s]<o&&(e[s]=o)}};var bd=function(i,e){var t=wT(e[0].replace("#EXT-X-","")),n;Ww(e[1])?(n={},n=Object.assign(Kw(e[1]),n)):n=Om(e[1]),i[t]=n},wT=function(i){return i.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},Om=function(i){if(i.toLowerCase()==="yes"||i.toLowerCase()==="no")return i.toLowerCase()==="yes";var e=i.indexOf(":")!==-1?i:parseFloat(i);return isNaN(e)?i:e},Vw=function(i){var e={},t=i.split("=");if(t.length>1){var n=wT(t[0]);e[n]=Om(t[1])}return e},Kw=function(i){for(var e=i.split(","),t={},n=0;e.length>n;n++){var r=e[n],s=Vw(r);t=Object.assign(s,t)}return t},Ww=function(i){return i.indexOf("=")>-1},qw=function(i,e){return e===-1?[i]:[i.substring(0,e),i.substring(e+1)]},Yw=function(i){var e={};if(i){var t=i.search(","),n=i.slice(0,t),r=i.slice(t+1),s=[n,r];return s.forEach(function(a,o){for(var l=a.replace(/['"]+/g,"").split("="),u=0;u<l.length;u++)l[u]==="DATA-ID"&&(e["DATA-ID"]=l[1-u]),l[u]==="VALUE"&&(e.VALUE=l[1-u])}),{data:e}}},jw=Nc,zw={safeCall:Bw,safeIncrement:et,getComputedStyle:Gw,secondsToMs:Hw,assign:Object.assign,headersStringToObject:Mm,cdnHeadersToRequestId:ju,extractHostnameAndDomain:fo,extractHostname:Ri,manifestParser:jw,generateShortID:gT,generateUUID:ho,now:it.now,findMediaElement:Wu},Qw=zw,Xw={PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled",HEARTBEAT:"hb",DESTROY:"destroy"},Zw=Xw,Jw="mux-embed",eI="5.8.3",tI="2.1",Qe={},Zn=function(i){var e=arguments;typeof i=="string"?Zn.hasOwnProperty(i)?Ga.default.setTimeout(function(){e=Array.prototype.splice.call(e,1),Zn[i].apply(null,e)},0):Le.warn("`"+i+"` is an unknown task"):typeof i=="function"?Ga.default.setTimeout(function(){i(Zn)},0):Le.warn("`"+i+"` is invalid.")},iI={loaded:it.now(),NAME:Jw,VERSION:eI,API_VERSION:tI,PLAYER_TRACKED:!1,monitor:function(i,e){return $w(Zn,i,e)},destroyMonitor:function(i){var e=An(Wu(i),1),t=e[0];t&&t.mux&&typeof t.mux.destroy=="function"?t.mux.destroy():Le.error("A video element monitor for `"+i+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(i,e){var t=vi(i);Qe[t]?Qe[t].addHLSJS(e):Le.error("A monitor for `"+t+"` has not been initialized.")},addDashJS:function(i,e){var t=vi(i);Qe[t]?Qe[t].addDashJS(e):Le.error("A monitor for `"+t+"` has not been initialized.")},removeHLSJS:function(i){var e=vi(i);Qe[e]?Qe[e].removeHLSJS():Le.error("A monitor for `"+e+"` has not been initialized.")},removeDashJS:function(i){var e=vi(i);Qe[e]?Qe[e].removeDashJS():Le.error("A monitor for `"+e+"` has not been initialized.")},init:function(i,e){Yh()&&e&&e.respectDoNotTrack&&Le.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var t=vi(i);Qe[t]=new Ow(Zn,t,e)},emit:function(i,e,t){var n=vi(i);Qe[n]?(Qe[n].emit(e,t),e==="destroy"&&delete Qe[n]):Le.error("A monitor for `"+n+"` has not been initialized.")},updateData:function(i,e){var t=vi(i);Qe[t]?Qe[t].emit("hb",e):Le.error("A monitor for `"+t+"` has not been initialized.")},setEmitTranslator:function(i,e){var t=vi(i);Qe[t]?Qe[t].emitTranslator=e:Le.error("A monitor for `"+t+"` has not been initialized.")},setStateDataTranslator:function(i,e){var t=vi(i);Qe[t]?Qe[t].stateDataTranslator=e:Le.error("A monitor for `"+t+"` has not been initialized.")},setGetPlayheadTime:function(i,e){var t=vi(i);Qe[t]?Qe[t].getPlayheadTime=e:Le.error("A monitor for `"+t+"` has not been initialized.")},checkDoNotTrack:Yh,log:Le,utils:Qw,events:Zw,WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(Zn,iI);typeof Ga.default<"u"&&typeof Ga.default.addEventListener=="function"&&Ga.default.addEventListener("pagehide",function(i){i.persisted||(Zn.WINDOW_UNLOADING=!0)},!1);var Nm=Zn;/*!
* JavaScript Cookie v2.1.3
* https://github.com/js-cookie/js-cookie
*
* Copyright 2006, 2015 Klaus Hartl & Fagner Brack
* Released under the MIT license
*/function nI(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var IT={exports:{}};(function(i,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,u,c){if(c=c||{},l=l.trim(),u=u.trim(),!u){if(!c.alwaysNormalize)return l;var d=o.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=o.normalizePath(d.path),o.buildURLFromParts(d)}var h=o.parseURL(u);if(!h)throw new Error("Error trying to parse relative URL.");if(h.scheme)return c.alwaysNormalize?(h.path=o.normalizePath(h.path),o.buildURLFromParts(h)):u;var f=o.parseURL(l);if(!f)throw new Error("Error trying to parse base URL.");if(!f.netLoc&&f.path&&f.path[0]!=="/"){var m=r.exec(f.path);f.netLoc=m[1],f.path=m[2]}f.netLoc&&!f.path&&(f.path="/");var p={scheme:f.scheme,netLoc:h.netLoc,path:null,params:h.params,query:h.query,fragment:h.fragment};if(!h.netLoc&&(p.netLoc=f.netLoc,h.path[0]!=="/"))if(!h.path)p.path=f.path,h.params||(p.params=f.params,h.query||(p.query=f.query));else{var v=f.path,g=v.substring(0,v.lastIndexOf("/")+1)+h.path;p.path=o.normalizePath(g)}return p.path===null&&(p.path=c.alwaysNormalize?o.normalizePath(h.path):h.path),o.buildURLFromParts(p)},parseURL:function(l){var u=n.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};i.exports=o})()})(IT);var Fm=IT.exports;function Qg(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function vt(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Qg(Object(t),!0).forEach(function(n){aI(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Qg(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function rI(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function sI(i){var e=rI(i,"string");return typeof e=="symbol"?e:String(e)}function aI(i,e,t){return e=sI(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function nt(){return nt=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},nt.apply(this,arguments)}const K=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},oI=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=lI},lI=Number.MAX_SAFE_INTEGER||9007199254740991;let T=function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i}({}),ie=function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i}({}),k=function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.UNKNOWN="unknown",i}({});const hr=function(){},Qh={trace:hr,debug:hr,log:hr,warn:hr,info:hr,error:hr};let Va=Qh;function uI(i){const e=self.console[i];return e?e.bind(self.console,`[${i}] >`):hr}function cI(i,...e){e.forEach(function(t){Va[t]=i[t]?i[t].bind(i):uI(t)})}function dI(i,e){if(typeof console=="object"&&i===!0||typeof i=="object"){cI(i,"debug","log","info","warn","error");try{Va.log(`Debug logs enabled for "${e}" in hls.js version 1.5.20`)}catch{Va=Qh}}else Va=Qh}const I=Va,hI=/^(\d+)x(\d+)$/,Xg=/(.+?)=(".*?"|.*?)(?:,|$)/g;class $e{constructor(e){typeof e=="string"&&(e=$e.parseAttrList(e)),nt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(r*2,r*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=hI.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const n={},r='"';for(Xg.lastIndex=0;(t=Xg.exec(e))!==null;){let s=t[2];s.indexOf(r)===0&&s.lastIndexOf(r)===s.length-1&&(s=s.slice(1,-1));const a=t[1].trim();n[a]=s}return n}}function fI(i){return i!=="ID"&&i!=="CLASS"&&i!=="START-DATE"&&i!=="DURATION"&&i!=="END-DATE"&&i!=="END-ON-NEXT"}function mI(i){return i==="SCTE35-OUT"||i==="SCTE35-IN"}class LT{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const n=t.attr;for(const r in n)if(Object.prototype.hasOwnProperty.call(e,r)&&e[r]!==n[r]){I.warn(`DATERANGE tag attribute: "${r}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=r;break}e=nt(new $e({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const n=new Date(this.attr["END-DATE"]);K(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(K(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&K(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class Fc{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Ae={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class kT{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[Ae.AUDIO]:null,[Ae.VIDEO]:null,[Ae.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const n=e.split("@",2);let r;n.length===1?r=(t==null?void 0:t.byteRangeEndOffset)||0:r=parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Fm.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class Rd extends kT{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new Fc,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!K(this.programDateTime))return null;const e=K(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,r,s,a=!1){const{elementaryStreams:o}=this,l=o[e];if(!l){o[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:s,partial:a};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,r),l.endDTS=Math.max(l.endDTS,s)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Ae.AUDIO]=null,e[Ae.VIDEO]=null,e[Ae.AUDIOVIDEO]=null}}class pI extends kT{constructor(e,t,n,r,s){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new Fc,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const gI=10;class vI{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?K(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||gI}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function Um(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function EI(i){const e=Xh(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function yI(i){const e=function(n,r,s){const a=n[r];n[r]=n[s],n[s]=a};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function TI(i){const e=i.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),r=n[n.length-1].split(",");if(r.length===2){const s=r[0]==="base64",a=r[1];s?(n.splice(-1,1),t=Um(a)):t=EI(a)}}return t}function Xh(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}const Ws=typeof self<"u"?self:void 0;var Te={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},$t={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function wd(i){switch(i){case $t.FAIRPLAY:return Te.FAIRPLAY;case $t.PLAYREADY:return Te.PLAYREADY;case $t.WIDEVINE:return Te.WIDEVINE;case $t.CLEARKEY:return Te.CLEARKEY}}var Zo={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function Id(i){if(i===Zo.WIDEVINE)return Te.WIDEVINE;if(i===Zo.PLAYREADY)return Te.PLAYREADY;if(i===Zo.CENC||i===Zo.CLEARKEY)return Te.CLEARKEY}function Ld(i){switch(i){case Te.FAIRPLAY:return $t.FAIRPLAY;case Te.PLAYREADY:return $t.PLAYREADY;case Te.WIDEVINE:return $t.WIDEVINE;case Te.CLEARKEY:return $t.CLEARKEY}}function Jo(i){const{drmSystems:e,widevineLicenseUrl:t}=i,n=e?[Te.FAIRPLAY,Te.WIDEVINE,Te.PLAYREADY,Te.CLEARKEY].filter(r=>!!e[r]):[];return!n[Te.WIDEVINE]&&t&&n.push(Te.WIDEVINE),n}const DT=function(i){return Ws!=null&&(i=Ws.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function _I(i,e,t,n){let r;switch(i){case Te.FAIRPLAY:r=["cenc","sinf"];break;case Te.WIDEVINE:case Te.PLAYREADY:r=["cenc"];break;case Te.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return SI(r,e,t,n)}function SI(i,e,t,n){return[{initDataTypes:i,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function CT(i){const e=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),a=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(a){const o=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(o){const l=Um(o).subarray(0,16);return yI(l),l}}return null}function Ir(i,e,t){return Uint8Array.prototype.slice?i.slice(e,t):new Uint8Array(Array.prototype.slice.call(i,e,t))}const $m=(i,e)=>e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128,PT=(i,e)=>e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128,mo=(i,e)=>{const t=e;let n=0;for(;$m(i,e);){n+=10;const r=Uc(i,e+6);n+=r,PT(i,e+10)&&(n+=10),e+=n}if(n>0)return i.subarray(t,t+n)},Uc=(i,e)=>{let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t},AI=(i,e)=>$m(i,e)&&Uc(i,e+6)+10<=i.length-e,Bm=i=>{const e=OT(i);for(let t=0;t<e.length;t++){const n=e[t];if(MT(n))return LI(n)}},MT=i=>i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp",xI=i=>{const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=Uc(i,4),n=10;return{type:e,size:t,data:i.subarray(n,n+t)}},OT=i=>{let e=0;const t=[];for(;$m(i,e);){const n=Uc(i,e+6);e+=10;const r=e+n;for(;e+8<r;){const s=xI(i.subarray(e)),a=bI(s);a&&t.push(a),e+=s.size+10}PT(i,e)&&(e+=10)}return t},bI=i=>i.type==="PRIV"?RI(i):i.type[0]==="W"?II(i):wI(i),RI=i=>{if(i.size<2)return;const e=tn(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}},wI=i=>{if(i.size<2)return;if(i.type==="TXXX"){let t=1;const n=tn(i.data.subarray(t),!0);t+=n.length+1;const r=tn(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=tn(i.data.subarray(1));return{key:i.type,data:e}},II=i=>{if(i.type==="WXXX"){if(i.size<2)return;let t=1;const n=tn(i.data.subarray(t),!0);t+=n.length+1;const r=tn(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=tn(i.data);return{key:i.type,data:e}},LI=i=>{if(i.data.byteLength===8){const e=new Uint8Array(i.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}},tn=(i,e=!1)=>{const t=kI();if(t){const u=t.decode(i);if(e){const c=u.indexOf("\0");return c!==-1?u.substring(0,c):u}return u.replace(/\0/g,"")}const n=i.length;let r,s,a,o="",l=0;for(;l<n;){if(r=i[l++],r===0&&e)return o;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(r);break;case 12:case 13:s=i[l++],o+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=i[l++],a=i[l++],o+=String.fromCharCode((r&15)<<12|(s&63)<<6|(a&63)<<0);break}}return o};let kd;function kI(){if(!navigator.userAgent.includes("PlayStation 4"))return!kd&&typeof self.TextDecoder<"u"&&(kd=new self.TextDecoder("utf-8")),kd}const Yi={hexDump:function(i){let e="";for(let t=0;t<i.length;t++){let n=i[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},zu=Math.pow(2,32)-1,DI=[].push,NT={video:1,audio:2,id3:3,text:4};function rt(i){return String.fromCharCode.apply(null,i)}function FT(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function J(i,e){const t=UT(i,e);return t<0?4294967296+t:t}function Zg(i,e){let t=J(i,e);return t*=Math.pow(2,32),t+=J(i,e+4),t}function UT(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function Dd(i,e,t){i[e]=t>>24,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t&255}function CI(i){const e=i.byteLength;for(let t=0;t<e;){const n=J(i,t);if(n>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=n>1?t+n:e}return!1}function ae(i,e){const t=[];if(!e.length)return t;const n=i.byteLength;for(let r=0;r<n;){const s=J(i,r),a=rt(i.subarray(r+4,r+8)),o=s>1?r+s:n;if(a===e[0])if(e.length===1)t.push(i.subarray(r+8,o));else{const l=ae(i.subarray(r+8,o),e.slice(1));l.length&&DI.apply(t,l)}r=o}return t}function PI(i){const e=[],t=i[0];let n=8;const r=J(i,n);n+=4;let s=0,a=0;t===0?(s=J(i,n),a=J(i,n+4),n+=8):(s=Zg(i,n),a=Zg(i,n+8),n+=16),n+=2;let o=i.length+a;const l=FT(i,n);n+=2;for(let u=0;u<l;u++){let c=n;const d=J(i,c);c+=4;const h=d&2147483647;if((d&2147483648)>>>31===1)return I.warn("SIDX has hierarchical references (not supported)"),null;const m=J(i,c);c+=4,e.push({referenceSize:h,subsegmentDuration:m,info:{duration:m/r,start:o,end:o+h-1}}),o+=h,c+=4,n=c}return{earliestPresentationTime:s,timescale:r,version:t,referencesCount:l,references:e}}function $T(i){const e=[],t=ae(i,["moov","trak"]);for(let r=0;r<t.length;r++){const s=t[r],a=ae(s,["tkhd"])[0];if(a){let o=a[0];const l=J(a,o===0?12:20),u=ae(s,["mdia","mdhd"])[0];if(u){o=u[0];const c=J(u,o===0?12:20),d=ae(s,["mdia","hdlr"])[0];if(d){const h=rt(d.subarray(8,12)),f={soun:Ae.AUDIO,vide:Ae.VIDEO}[h];if(f){const m=ae(s,["mdia","minf","stbl","stsd"])[0],p=MI(m);e[l]={timescale:c,type:f},e[f]=vt({timescale:c,id:l},p)}}}}}return ae(i,["moov","mvex","trex"]).forEach(r=>{const s=J(r,4),a=e[s];a&&(a.default={duration:J(r,12),flags:J(r,20)})}),e}function MI(i){const e=i.subarray(8),t=e.subarray(86),n=rt(e.subarray(4,8));let r=n;const s=n==="enca"||n==="encv";if(s){const o=ae(e,[n])[0].subarray(n==="enca"?28:78);ae(o,["sinf"]).forEach(u=>{const c=ae(u,["schm"])[0];if(c){const d=rt(c.subarray(4,8));if(d==="cbcs"||d==="cenc"){const h=ae(u,["frma"])[0];h&&(r=rt(h))}}})}switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const a=ae(t,["avcC"])[0];r+="."+el(a[1])+el(a[2])+el(a[3]);break}case"mp4a":{const a=ae(e,[n])[0],o=ae(a.subarray(28),["esds"])[0];if(o&&o.length>12){let l=4;if(o[l++]!==3)break;l=Cd(o,l),l+=2;const u=o[l++];if(u&128&&(l+=2),u&64&&(l+=o[l++]),o[l++]!==4)break;l=Cd(o,l);const c=o[l++];if(c===64)r+="."+el(c);else break;if(l+=12,o[l++]!==5)break;l=Cd(o,l);const d=o[l++];let h=(d&248)>>3;h===31&&(h+=1+((d&7)<<3)+((o[l]&224)>>5)),r+="."+h}break}case"hvc1":case"hev1":{const a=ae(t,["hvcC"])[0],o=a[1],l=["","A","B","C"][o>>6],u=o&31,c=J(a,2),d=(o&32)>>5?"H":"L",h=a[12],f=a.subarray(6,12);r+="."+l+u,r+="."+c.toString(16).toUpperCase(),r+="."+d+h;let m="";for(let p=f.length;p--;){const v=f[p];(v||m)&&(m="."+v.toString(16).toUpperCase()+m)}r+=m;break}case"dvh1":case"dvhe":{const a=ae(t,["dvcC"])[0],o=a[2]>>1&127,l=a[2]<<5&32|a[3]>>3&31;r+="."+Mi(o)+"."+Mi(l);break}case"vp09":{const a=ae(t,["vpcC"])[0],o=a[4],l=a[5],u=a[6]>>4&15;r+="."+Mi(o)+"."+Mi(l)+"."+Mi(u);break}case"av01":{const a=ae(t,["av1C"])[0],o=a[1]>>>5,l=a[1]&31,u=a[2]>>>7?"H":"M",c=(a[2]&64)>>6,d=(a[2]&32)>>5,h=o===2&&c?d?12:10:c?10:8,f=(a[2]&16)>>4,m=(a[2]&8)>>3,p=(a[2]&4)>>2,v=a[2]&3;r+="."+o+"."+Mi(l)+u+"."+Mi(h)+"."+f+"."+m+p+v+"."+Mi(1)+"."+Mi(1)+"."+Mi(1)+"."+0;break}}return{codec:r,encrypted:s}}function Cd(i,e){const t=e+5;for(;i[e++]&128&&e<t;);return e}function el(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function Mi(i){return(i<10?"0":"")+i}function OI(i,e){if(!i||!e)return i;const t=e.keyId;return t&&e.isCommonEncryption&&ae(i,["moov","trak"]).forEach(r=>{const a=ae(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=ae(a,["enca"]);const l=o.length>0;l||(o=ae(a,["encv"])),o.forEach(u=>{const c=l?u.subarray(28):u.subarray(78);ae(c,["sinf"]).forEach(h=>{const f=BT(h);if(f){const m=f.subarray(8,24);m.some(p=>p!==0)||(I.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${Yi.hexDump(m)} -> ${Yi.hexDump(t)}`),f.set(t,8))}})})}),i}function BT(i){const e=ae(i,["schm"])[0];if(e){const t=rt(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return ae(i,["schi","tenc"])[0]}return null}function NI(i,e){return ae(e,["moof","traf"]).reduce((t,n)=>{const r=ae(n,["tfdt"])[0],s=r[0],a=ae(n,["tfhd"]).reduce((o,l)=>{const u=J(l,4),c=i[u];if(c){let d=J(r,4);if(s===1){if(d===zu)return I.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),o;d*=zu+1,d+=J(r,8)}const h=c.timescale||9e4,f=d/h;if(K(f)&&(o===null||f<o))return f}return o},null);return a!==null&&K(a)&&(t===null||a<t)?a:t},null)}function FI(i,e){let t=0,n=0,r=0;const s=ae(i,["moof","traf"]);for(let a=0;a<s.length;a++){const o=s[a],l=ae(o,["tfhd"])[0],u=J(l,4),c=e[u];if(!c)continue;const d=c.default,h=J(l,0)|(d==null?void 0:d.flags);let f=d==null?void 0:d.duration;h&8&&(h&2?f=J(l,12):f=J(l,8));const m=c.timescale||9e4,p=ae(o,["trun"]);for(let v=0;v<p.length;v++){if(t=UI(p[v]),!t&&f){const g=J(p[v],4);t=f*g}c.type===Ae.VIDEO?n+=t/m:c.type===Ae.AUDIO&&(r+=t/m)}}if(n===0&&r===0){let a=1/0,o=0,l=0;const u=ae(i,["sidx"]);for(let c=0;c<u.length;c++){const d=PI(u[c]);if(d!=null&&d.references){a=Math.min(a,d.earliestPresentationTime/d.timescale);const h=d.references.reduce((f,m)=>f+m.info.duration||0,0);o=Math.max(o,h+d.earliestPresentationTime/d.timescale),l=o-a}}if(l&&K(l))return l}return n||r}function UI(i){const e=J(i,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0;const r=J(i,4);for(let s=0;s<r;s++){if(e&256){const a=J(i,t);n+=a,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function $I(i,e,t){ae(e,["moof","traf"]).forEach(n=>{ae(n,["tfhd"]).forEach(r=>{const s=J(r,4),a=i[s];if(!a)return;const o=a.timescale||9e4;ae(n,["tfdt"]).forEach(l=>{const u=l[0],c=t*o;if(c){let d=J(l,4);if(u===0)d-=c,d=Math.max(d,0),Dd(l,4,d);else{d*=Math.pow(2,32),d+=J(l,8),d-=c,d=Math.max(d,0);const h=Math.floor(d/(zu+1)),f=Math.floor(d%(zu+1));Dd(l,4,h),Dd(l,8,f)}}})})})}function BI(i){const e={valid:null,remainder:null},t=ae(i,["moof"]);if(t.length<2)return e.remainder=i,e;const n=t[t.length-1];return e.valid=Ir(i,0,n.byteOffset-8),e.remainder=Ir(i,n.byteOffset-8),e}function mi(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function Jg(i,e){const t=[],n=e.samples,r=e.timescale,s=e.id;let a=!1;return ae(n,["moof"]).map(l=>{const u=l.byteOffset-8;ae(l,["traf"]).map(d=>{const h=ae(d,["tfdt"]).map(f=>{const m=f[0];let p=J(f,4);return m===1&&(p*=Math.pow(2,32),p+=J(f,8)),p/r})[0];return h!==void 0&&(i=h),ae(d,["tfhd"]).map(f=>{const m=J(f,4),p=J(f,0)&16777215,v=(p&1)!==0,g=(p&2)!==0,E=(p&8)!==0;let y=0;const _=(p&16)!==0;let S=0;const b=(p&32)!==0;let A=8;m===s&&(v&&(A+=8),g&&(A+=4),E&&(y=J(f,A),A+=4),_&&(S=J(f,A),A+=4),b&&(A+=4),e.type==="video"&&(a=GI(e.codec)),ae(d,["trun"]).map(w=>{const P=w[0],R=J(w,0)&16777215,D=(R&1)!==0;let j=0;const $=(R&4)!==0,X=(R&256)!==0;let q=0;const W=(R&512)!==0;let oe=0;const F=(R&1024)!==0,O=(R&2048)!==0;let M=0;const G=J(w,4);let Y=8;D&&(j=J(w,Y),Y+=4),$&&(Y+=4);let le=j+u;for(let me=0;me<G;me++){if(X?(q=J(w,Y),Y+=4):q=y,W?(oe=J(w,Y),Y+=4):oe=S,F&&(Y+=4),O&&(P===0?M=J(w,Y):M=UT(w,Y),Y+=4),e.type===Ae.VIDEO){let we=0;for(;we<oe;){const be=J(n,le);if(le+=4,HI(a,n[le])){const ze=n.subarray(le,le+be);GT(ze,a?2:1,i+M/r,t)}le+=be,we+=be+4}}i+=q/r}}))})})}),t}function GI(i){if(!i)return!1;const e=i.indexOf("."),t=e<0?i:i.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function HI(i,e){if(i){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function GT(i,e,t,n){const r=HT(i);let s=0;s+=e;let a=0,o=0,l=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(l===255);o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(l===255);const u=r.length-s;let c=s;if(o<u)s+=o;else if(o>u){I.error(`Malformed SEI payload. ${o} is too small, only ${u} bytes left to parse.`);break}if(a===4){if(r[c++]===181){const h=FT(r,c);if(c+=2,h===49){const f=J(r,c);if(c+=4,f===1195456820){const m=r[c++];if(m===3){const p=r[c++],v=31&p,g=64&p,E=g?2+v*3:0,y=new Uint8Array(E);if(g){y[0]=p;for(let _=1;_<E;_++)y[_]=r[c++]}n.push({type:m,payloadType:a,pts:t,bytes:y})}}}}}else if(a===5&&o>16){const d=[];for(let m=0;m<16;m++){const p=r[c++].toString(16);d.push(p.length==1?"0"+p:p),(m===3||m===5||m===7||m===9)&&d.push("-")}const h=o-16,f=new Uint8Array(h);for(let m=0;m<h;m++)f[m]=r[c++];n.push({payloadType:a,pts:t,uuid:d.join(""),userData:tn(f),userDataBytes:f})}}}function HT(i){const e=i.byteLength,t=[];let n=1;for(;n<e-2;)i[n]===0&&i[n+1]===0&&i[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return i;const r=e-t.length,s=new Uint8Array(r);let a=0;for(n=0;n<r;a++,n++)a===t[0]&&(a++,t.shift()),s[n]=i[a];return s}function VI(i){const e=i[0];let t="",n="",r=0,s=0,a=0,o=0,l=0,u=0;if(e===0){for(;rt(i.subarray(u,u+1))!=="\0";)t+=rt(i.subarray(u,u+1)),u+=1;for(t+=rt(i.subarray(u,u+1)),u+=1;rt(i.subarray(u,u+1))!=="\0";)n+=rt(i.subarray(u,u+1)),u+=1;n+=rt(i.subarray(u,u+1)),u+=1,r=J(i,12),s=J(i,16),o=J(i,20),l=J(i,24),u=28}else if(e===1){u+=4,r=J(i,u),u+=4;const d=J(i,u);u+=4;const h=J(i,u);for(u+=4,a=2**32*d+h,oI(a)||(a=Number.MAX_SAFE_INTEGER,I.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=J(i,u),u+=4,l=J(i,u),u+=4;rt(i.subarray(u,u+1))!=="\0";)t+=rt(i.subarray(u,u+1)),u+=1;for(t+=rt(i.subarray(u,u+1)),u+=1;rt(i.subarray(u,u+1))!=="\0";)n+=rt(i.subarray(u,u+1)),u+=1;n+=rt(i.subarray(u,u+1)),u+=1}const c=i.subarray(u,i.byteLength);return{schemeIdUri:t,value:n,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:c}}function KI(i,...e){const t=e.length;let n=8,r=t;for(;r--;)n+=e[r].byteLength;const s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=n&255,s.set(i,4),r=0,n=8;r<t;r++)s.set(e[r],n),n+=e[r].byteLength;return s}function WI(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let n,r;n=0,r=new Uint8Array;let s;n>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),KI([112,115,115,104],new Uint8Array([n,0,0,0]),i,s,r,a,t||new Uint8Array)}function qI(i){const e=[];if(i instanceof ArrayBuffer){const t=i.byteLength;let n=0;for(;n+32<t;){const r=new DataView(i,n),s=YI(r);e.push(s),n+=s.size}}return e}function YI(i){const e=i.getUint32(0),t=i.byteOffset,n=i.byteLength;if(n<e)return{offset:t,size:n};if(i.getUint32(4)!==1886614376)return{offset:t,size:e};const s=i.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:t,size:e};const a=i.buffer,o=Yi.hexDump(new Uint8Array(a,t+12,16)),l=i.getUint32(28);let u=null,c=null;if(s===0){if(e-32<l||l<22)return{offset:t,size:e};c=new Uint8Array(a,t+32,l)}else if(s===1){if(!l||n<t+32+l*16+16)return{offset:t,size:e};u=[];for(let d=0;d<l;d++)u.push(new Uint8Array(a,t+32+d*16,16))}return{version:s,systemId:o,kids:u,data:c,offset:t,size:e}}let tl={};class po{static clearKeyUriToKeyIdMap(){tl={}}constructor(e,t,n,r=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case $t.FAIRPLAY:case $t.WIDEVINE:case $t.PLAYREADY:case $t.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&I.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const n=jI(e);return new po(this.method,this.uri,"identity",this.keyFormatVersions,n)}const t=TI(this.uri);if(t)switch(this.keyFormat){case $t.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case $t.PLAYREADY:{const n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=WI(n,null,t),this.keyId=CT(t);break}default:{let n=t.subarray(0,16);if(n.length!==16){const r=new Uint8Array(16);r.set(n,16-n.length),n=r}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=tl[this.uri];if(!n){const r=Object.keys(tl).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,r),tl[this.uri]=n}this.keyId=n}return this}}function jI(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}const VT=/\{\$([a-zA-Z0-9-_]+)\}/g;function e0(i){return VT.test(i)}function Nt(i,e,t){if(i.variableList!==null||i.hasVariableRefs)for(let n=t.length;n--;){const r=t[n],s=e[r];s&&(e[r]=Zh(i,s))}}function Zh(i,e){if(i.variableList!==null||i.hasVariableRefs){const t=i.variableList;return e.replace(VT,n=>{const r=n.substring(2,n.length-1),s=t==null?void 0:t[r];return s===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),n):s})}return e}function t0(i,e,t){let n=i.variableList;n||(i.variableList=n={});let r,s;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(r))s=a.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(a){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else r=e.NAME,s=e.VALUE;r in n?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):n[r]=s||""}function zI(i,e,t){const n=e.IMPORT;if(t&&n in t){let r=i.variableList;r||(i.variableList=r={}),r[n]=t[n]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function Ur(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function QI(i){return typeof self<"u"&&i===self.ManagedMediaSource}const Qu={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function XI(i,e){const t=Qu[e];return!!t&&!!t[i.slice(0,4)]}function Pd(i,e,t=!0){return!i.split(",").some(n=>!KT(n,e,t))}function KT(i,e,t=!0){var n;const r=Ur(t);return(n=r==null?void 0:r.isTypeSupported(go(i,e)))!=null?n:!1}function go(i,e){return`${e}/mp4;codecs="${i}"`}function i0(i){if(i){const e=i.substring(0,4);return Qu.video[e]}return 2}function Xu(i){return i.split(",").reduce((e,t)=>{const n=Qu.video[t];return n?(n*2+e)/(e?3:2):(Qu.audio[t]+e)/(e?2:1)},0)}const Md={};function ZI(i,e=!0){if(Md[i])return Md[i];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[i];for(let n=0;n<t.length;n++)if(KT(t[n],"audio",e))return Md[i]=t[n],t[n];return i}const JI=/flac|opus/i;function Zu(i,e=!0){return i.replace(JI,t=>ZI(t.toLowerCase(),e))}function n0(i,e){return i&&i!=="mp4a"?i:e&&e.split(",")[0]}function eL(i){const e=i.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");if(n.length>2){let r=n.shift()+".";r+=parseInt(n.shift()).toString(16),r+=("000"+parseInt(n.shift()).toString(16)).slice(-4),e[t]=r}}return e.join(",")}const r0=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,s0=/#EXT-X-MEDIA:(.*)/g,tL=/^#EXT(?:INF|-X-TARGETDURATION):/m,a0=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),iL=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Xi{static findGroup(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.id===t)return r}}static resolve(e,t){return Fm.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return tL.test(e)}static parseMasterPlaylist(e,t){const n=e0(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},s=[];r0.lastIndex=0;let a;for(;(a=r0.exec(e))!=null;)if(a[1]){var o;const u=new $e(a[1]);Nt(r,u,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const c=Zh(r,a[2]),d={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:Xi.resolve(c,t)},h=u.decimalResolution("RESOLUTION");h&&(d.width=h.width,d.height=h.height),nL(u.CODECS,d),(o=d.unknownCodecs)!=null&&o.length||s.push(d),r.levels.push(d)}else if(a[3]){const u=a[3],c=a[4];switch(u){case"SESSION-DATA":{const d=new $e(c);Nt(r,d,["DATA-ID","LANGUAGE","VALUE","URI"]);const h=d["DATA-ID"];h&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[h]=d);break}case"SESSION-KEY":{const d=o0(c,t,r);d.encrypted&&d.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(d)):I.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${c}"`);break}case"DEFINE":{{const d=new $e(c);Nt(r,d,["NAME","VALUE","QUERYPARAM"]),t0(r,d,t)}break}case"CONTENT-STEERING":{const d=new $e(c);Nt(r,d,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:Xi.resolve(d["SERVER-URI"],t),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=l0(c);break}}}const l=s.length>0&&s.length<r.levels.length;return r.levels=l?s:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,n){let r;const s={},a=n.levels,o={AUDIO:a.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:a.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(s0.lastIndex=0;(r=s0.exec(e))!==null;){const u=new $e(r[1]),c=u.TYPE;if(c){const d=o[c],h=s[c]||[];s[c]=h,Nt(n,u,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const f=u.LANGUAGE,m=u["ASSOC-LANGUAGE"],p=u.CHANNELS,v=u.CHARACTERISTICS,g=u["INSTREAM-ID"],E={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||f||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:f,url:u.URI?Xi.resolve(u.URI,t):""};if(m&&(E.assocLang=m),p&&(E.channels=p),v&&(E.characteristics=v),g&&(E.instreamId=g),d!=null&&d.length){const y=Xi.findGroup(d,E.groupId)||d[0];u0(E,y,"audioCodec"),u0(E,y,"textCodec")}h.push(E)}}return s}static parseLevelPlaylist(e,t,n,r,s,a){const o=new vI(t),l=o.fragments;let u=null,c=0,d=0,h=0,f=0,m=null,p=new Rd(r,t),v,g,E,y=-1,_=!1,S=null;for(a0.lastIndex=0,o.m3u8=e,o.hasVariableRefs=e0(e);(v=a0.exec(e))!==null;){_&&(_=!1,p=new Rd(r,t),p.start=h,p.sn=c,p.cc=f,p.level=n,u&&(p.initSegment=u,p.rawProgramDateTime=u.rawProgramDateTime,u.rawProgramDateTime=null,S&&(p.setByteRange(S),S=null)));const P=v[1];if(P){p.duration=parseFloat(P);const R=(" "+v[2]).slice(1);p.title=R||null,p.tagList.push(R?["INF",P,R]:["INF",P])}else if(v[3]){if(K(p.duration)){p.start=h,E&&h0(p,E,o),p.sn=c,p.level=n,p.cc=f,l.push(p);const R=(" "+v[3]).slice(1);p.relurl=Zh(o,R),c0(p,m),m=p,h+=p.duration,c++,d=0,_=!0}}else if(v[4]){const R=(" "+v[4]).slice(1);m?p.setByteRange(R,m):p.setByteRange(R)}else if(v[5])p.rawProgramDateTime=(" "+v[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]),y===-1&&(y=l.length);else{if(v=v[0].match(iL),!v){I.warn("No matches on slow regex match for level playlist!");continue}for(g=1;g<v.length&&!(typeof v[g]<"u");g++);const R=(" "+v[g]).slice(1),D=(" "+v[g+1]).slice(1),j=v[g+2]?(" "+v[g+2]).slice(1):"";switch(R){case"PLAYLIST-TYPE":o.type=D.toUpperCase();break;case"MEDIA-SEQUENCE":c=o.startSN=parseInt(D);break;case"SKIP":{const $=new $e(D);Nt(o,$,["RECENTLY-REMOVED-DATERANGES"]);const X=$.decimalInteger("SKIPPED-SEGMENTS");if(K(X)){o.skippedSegments=X;for(let W=X;W--;)l.unshift(null);c+=X}const q=$.enumeratedString("RECENTLY-REMOVED-DATERANGES");q&&(o.recentlyRemovedDateranges=q.split("	"));break}case"TARGETDURATION":o.targetduration=Math.max(parseInt(D),1);break;case"VERSION":o.version=parseInt(D);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":o.live=!1;break;case"#":(D||j)&&p.tagList.push(j?[D,j]:[D]);break;case"DISCONTINUITY":f++,p.tagList.push(["DIS"]);break;case"GAP":p.gap=!0,p.tagList.push([R]);break;case"BITRATE":p.tagList.push([R,D]);break;case"DATERANGE":{const $=new $e(D);Nt(o,$,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),Nt(o,$,$.clientAttrs);const X=new LT($,o.dateRanges[$.ID]);X.isValid||o.skippedSegments?o.dateRanges[X.id]=X:I.warn(`Ignoring invalid DATERANGE tag: "${D}"`),p.tagList.push(["EXT-X-DATERANGE",D]);break}case"DEFINE":{{const $=new $e(D);Nt(o,$,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in $?zI(o,$,a):t0(o,$,t)}break}case"DISCONTINUITY-SEQUENCE":f=parseInt(D);break;case"KEY":{const $=o0(D,t,o);if($.isSupported()){if($.method==="NONE"){E=void 0;break}E||(E={}),E[$.keyFormat]&&(E=nt({},E)),E[$.keyFormat]=$}else I.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${D}"`);break}case"START":o.startTimeOffset=l0(D);break;case"MAP":{const $=new $e(D);if(Nt(o,$,["BYTERANGE","URI"]),p.duration){const X=new Rd(r,t);d0(X,$,n,E),u=X,p.initSegment=u,u.rawProgramDateTime&&!p.rawProgramDateTime&&(p.rawProgramDateTime=u.rawProgramDateTime)}else{const X=p.byteRangeEndOffset;if(X){const q=p.byteRangeStartOffset;S=`${X-q}@${q}`}else S=null;d0(p,$,n,E),u=p,_=!0}break}case"SERVER-CONTROL":{const $=new $e(D);o.canBlockReload=$.bool("CAN-BLOCK-RELOAD"),o.canSkipUntil=$.optionalFloat("CAN-SKIP-UNTIL",0),o.canSkipDateRanges=o.canSkipUntil>0&&$.bool("CAN-SKIP-DATERANGES"),o.partHoldBack=$.optionalFloat("PART-HOLD-BACK",0),o.holdBack=$.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const $=new $e(D);o.partTarget=$.decimalFloatingPoint("PART-TARGET");break}case"PART":{let $=o.partList;$||($=o.partList=[]);const X=d>0?$[$.length-1]:void 0,q=d++,W=new $e(D);Nt(o,W,["BYTERANGE","URI"]);const oe=new pI(W,p,t,q,X);$.push(oe),p.duration+=oe.duration;break}case"PRELOAD-HINT":{const $=new $e(D);Nt(o,$,["URI"]),o.preloadHint=$;break}case"RENDITION-REPORT":{const $=new $e(D);Nt(o,$,["URI"]),o.renditionReports=o.renditionReports||[],o.renditionReports.push($);break}default:I.warn(`line parsed but not handled: ${v}`);break}}}m&&!m.relurl?(l.pop(),h-=m.duration,o.partList&&(o.fragmentHint=m)):o.partList&&(c0(p,m),p.cc=f,o.fragmentHint=p,E&&h0(p,E,o));const b=l.length,A=l[0],w=l[b-1];if(h+=o.skippedSegments*o.targetduration,h>0&&b&&w){o.averagetargetduration=h/b;const P=w.sn;o.endSN=P!=="initSegment"?P:0,o.live||(w.endList=!0),A&&(o.startCC=A.cc)}else o.endSN=0,o.startCC=0;return o.fragmentHint&&(h+=o.fragmentHint.duration),o.totalduration=h,o.endCC=f,y>0&&rL(l,y),o}}function o0(i,e,t){var n,r;const s=new $e(i);Nt(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const a=(n=s.METHOD)!=null?n:"",o=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,c=(r=s.KEYFORMAT)!=null?r:"identity";o&&s.IV&&!l&&I.error(`Invalid IV: ${s.IV}`);const d=o?Xi.resolve(o,e):"",h=(u||"1").split("/").map(Number).filter(Number.isFinite);return new po(a,d,c,h,l)}function l0(i){const t=new $e(i).decimalFloatingPoint("TIME-OFFSET");return K(t)?t:null}function nL(i,e){let t=(i||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const r=t.filter(s=>XI(s,n));r.length&&(e[`${n}Codec`]=r.join(","),t=t.filter(s=>r.indexOf(s)===-1))}),e.unknownCodecs=t}function u0(i,e,t){const n=e[t];n&&(i[t]=n)}function rL(i,e){let t=i[e];for(let n=e;n--;){const r=i[n];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function c0(i,e){i.rawProgramDateTime?i.programDateTime=Date.parse(i.rawProgramDateTime):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime),K(i.programDateTime)||(i.programDateTime=null,i.rawProgramDateTime=null)}function d0(i,e,t,n){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",n&&(i.levelkeys=n),i.initSegment=null}function h0(i,e,t){i.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&n.push(i)}var fe={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ee={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function f0(i){const{type:e}=i;switch(e){case fe.AUDIO_TRACK:return ee.AUDIO;case fe.SUBTITLE_TRACK:return ee.SUBTITLE;default:return ee.MAIN}}function Od(i,e){let t=i.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class sL{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(T.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_LOADING,this.onLevelLoading,this),e.off(T.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(T.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,r=t.loader,s=n||r,a=new s(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:fe.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){const{id:n,level:r,pathwayId:s,url:a,deliveryDirectives:o}=t;this.load({id:n,level:r,pathwayId:s,responseType:"text",type:fe.LEVEL,url:a,deliveryDirectives:o})}onAudioTrackLoading(e,t){const{id:n,groupId:r,url:s,deliveryDirectives:a}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:fe.AUDIO_TRACK,url:s,deliveryDirectives:a})}onSubtitleTrackLoading(e,t){const{id:n,groupId:r,url:s,deliveryDirectives:a}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:fe.SUBTITLE_TRACK,url:s,deliveryDirectives:a})}load(e){var t;const n=this.hls.config;let r=this.getInternalLoader(e);if(r){const u=r.context;if(u&&u.url===e.url&&u.level===e.level){I.trace("[playlist-loader]: playlist request ongoing");return}I.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let s;if(e.type===fe.MANIFEST?s=n.manifestLoadPolicy.default:s=nt({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),K((t=e.deliveryDirectives)==null?void 0:t.part)){let u;if(e.type===fe.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===fe.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===fe.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const c=u.partTarget,d=u.targetduration;if(c&&d){const h=Math.max(c*3,d*.8)*1e3;s=nt({},s,{maxTimeToFirstByteMs:Math.min(h,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(h,s.maxTimeToFirstByteMs)})}}}const a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(u,c,d,h)=>{const f=this.getInternalLoader(d);this.resetInternalLoader(d.type);const m=u.data;if(m.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,d,new Error("no EXTM3U delimiter"),h||null,c);return}c.parsing.start=performance.now(),Xi.isMediaPlaylist(m)?this.handleTrackOrLevelPlaylist(u,c,d,h||null,f):this.handleMasterPlaylist(u,c,d,h)},onError:(u,c,d,h)=>{this.handleNetworkError(c,d,!1,u,h)},onTimeout:(u,c,d)=>{this.handleNetworkError(c,d,!0,void 0,u)}};r.load(e,o,l)}handleMasterPlaylist(e,t,n,r){const s=this.hls,a=e.data,o=Od(e,n),l=Xi.parseMasterPlaylist(a,o);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,r,t);return}const{contentSteering:u,levels:c,sessionData:d,sessionKeys:h,startTimeOffset:f,variableList:m}=l;this.variableList=m;const{AUDIO:p=[],SUBTITLES:v,"CLOSED-CAPTIONS":g}=Xi.parseMasterPlaylistMedia(a,o,l);p.length&&!p.some(y=>!y.url)&&c[0].audioCodec&&!c[0].attrs.AUDIO&&(I.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new $e({}),bitrate:0,url:""})),s.trigger(T.MANIFEST_LOADED,{levels:c,audioTracks:p,subtitles:v,captions:g,contentSteering:u,url:o,stats:t,networkDetails:r,sessionData:d,sessionKeys:h,startTimeOffset:f,variableList:m})}handleTrackOrLevelPlaylist(e,t,n,r,s){const a=this.hls,{id:o,level:l,type:u}=n,c=Od(e,n),d=0,h=K(l)?l:K(o)?o:0,f=f0(n),m=Xi.parseLevelPlaylist(e.data,c,h,f,d,this.variableList);if(u===fe.MANIFEST){const p={attrs:new $e({}),bitrate:0,details:m,name:"",url:c};a.trigger(T.MANIFEST_LOADED,{levels:[p],audioTracks:[],url:c,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=m,this.handlePlaylistLoaded(m,e,t,n,r,s)}handleManifestParsingError(e,t,n,r,s){this.hls.trigger(T.ERROR,{type:ie.NETWORK_ERROR,details:k.MANIFEST_PARSING_ERROR,fatal:t.type===fe.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:s})}handleNetworkError(e,t,n=!1,r,s){let a=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===fe.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===fe.AUDIO_TRACK||e.type===fe.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);I.warn(`[playlist-loader]: ${a}`);let l=k.UNKNOWN,u=!1;const c=this.getInternalLoader(e);switch(e.type){case fe.MANIFEST:l=n?k.MANIFEST_LOAD_TIMEOUT:k.MANIFEST_LOAD_ERROR,u=!0;break;case fe.LEVEL:l=n?k.LEVEL_LOAD_TIMEOUT:k.LEVEL_LOAD_ERROR,u=!1;break;case fe.AUDIO_TRACK:l=n?k.AUDIO_TRACK_LOAD_TIMEOUT:k.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case fe.SUBTITLE_TRACK:l=n?k.SUBTITLE_TRACK_LOAD_TIMEOUT:k.SUBTITLE_LOAD_ERROR,u=!1;break}c&&this.resetInternalLoader(e.type);const d={type:ie.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:c,context:e,error:o,networkDetails:t,stats:s};if(r){const h=(t==null?void 0:t.url)||e.url;d.response=vt({url:h,data:void 0},r)}this.hls.trigger(T.ERROR,d)}handlePlaylistLoaded(e,t,n,r,s,a){const o=this.hls,{type:l,level:u,id:c,groupId:d,deliveryDirectives:h}=r,f=Od(t,r),m=f0(r),p=typeof r.level=="number"&&m===ee.MAIN?u:void 0;if(!e.fragments.length){const g=new Error("No Segments found in Playlist");o.trigger(T.ERROR,{type:ie.NETWORK_ERROR,details:k.LEVEL_EMPTY_ERROR,fatal:!1,url:f,error:g,reason:g.message,response:t,context:r,level:p,parent:m,networkDetails:s,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const v=e.playlistParsingError;if(v){o.trigger(T.ERROR,{type:ie.NETWORK_ERROR,details:k.LEVEL_PARSING_ERROR,fatal:!1,url:f,error:v,reason:v.message,response:t,context:r,level:p,parent:m,networkDetails:s,stats:n});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case fe.MANIFEST:case fe.LEVEL:o.trigger(T.LEVEL_LOADED,{details:e,level:p||0,id:c||0,stats:n,networkDetails:s,deliveryDirectives:h});break;case fe.AUDIO_TRACK:o.trigger(T.AUDIO_TRACK_LOADED,{details:e,id:c||0,groupId:d||"",stats:n,networkDetails:s,deliveryDirectives:h});break;case fe.SUBTITLE_TRACK:o.trigger(T.SUBTITLE_TRACK_LOADED,{details:e,id:c||0,groupId:d||"",stats:n,networkDetails:s,deliveryDirectives:h});break}}}function WT(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function qT(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){I.debug(`[texttrack-utils]: ${n}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,i.addCue(r)}catch(r){I.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(i.mode=t)}function Rs(i){const e=i.mode;if(e==="disabled"&&(i.mode="hidden"),i.cues)for(let t=i.cues.length;t--;)i.removeCue(i.cues[t]);e==="disabled"&&(i.mode=e)}function Jh(i,e,t,n){const r=i.mode;if(r==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){const s=oL(i.cues,e,t);for(let a=0;a<s.length;a++)(!n||n(s[a]))&&i.removeCue(s[a])}r==="disabled"&&(i.mode=r)}function aL(i,e){if(e<i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let n=0,r=t;for(;n<=r;){const s=Math.floor((r+n)/2);if(e<i[s].startTime)r=s-1;else if(e>i[s].startTime&&n<t)n=s+1;else return s}return i[n].startTime-e<e-i[r].startTime?n:r}function oL(i,e,t){const n=[],r=aL(i,e);if(r>-1)for(let s=r,a=i.length;s<a;s++){const o=i[s];if(o.startTime>=e&&o.endTime<=t)n.push(o);else if(o.startTime>t)return n}return n}function Ul(i){const e=[];for(let t=0;t<i.length;t++){const n=i[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(i[t])}return e}var wi={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const lL=.25;function ef(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function m0(i,e,t,n,r){let s=new i(e,t,"");try{s.value=n,r&&(s.type=r)}catch{s=new i(e,t,JSON.stringify(r?vt({type:r},n):n))}return s}const il=(()=>{const i=ef();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Nd(i,e){return i.getTime()/1e3-e}function uL(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class cL{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(Rs(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return WT(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:r}}}=this;if(!n&&!r)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=ef();if(a)for(let o=0;o<s.length;o++){const l=s[o].type;if(l===wi.emsg&&!n||!r)continue;const u=OT(s[o].data);if(u){const c=s[o].pts;let d=c+s[o].duration;d>il&&(d=il),d-c<=0&&(d=c+lL);for(let f=0;f<u.length;f++){const m=u[f];if(!MT(m)){this.updateId3CueEnds(c,l);const p=m0(a,c,d,m,l);p&&this.id3Track.addCue(p)}}}}}updateId3CueEnds(e,t){var n;const r=(n=this.id3Track)==null?void 0:n.cues;if(r)for(let s=r.length;s--;){const a=r[s];a.type===t&&a.startTime<e&&a.endTime===il&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let u;r==="audio"?u=c=>c.type===wi.audioId3&&l:r==="video"?u=c=>c.type===wi.emsg&&o:u=c=>c.type===wi.audioId3&&l||c.type===wi.emsg&&o,Jh(s,t,n,u)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:n,id3Track:r}=this,{dateRanges:s}=t,a=Object.keys(s);if(r){const c=Object.keys(n).filter(d=>!a.includes(d));for(let d=c.length;d--;){const h=c[d];Object.keys(n[h].cues).forEach(f=>{r.removeCue(n[h].cues[f])}),delete n[h]}}const o=t.fragments[t.fragments.length-1];if(a.length===0||!K(o==null?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=o.programDateTime/1e3-o.start,u=ef();for(let c=0;c<a.length;c++){const d=a[c],h=s[d],f=Nd(h.startDate,l),m=n[d],p=(m==null?void 0:m.cues)||{};let v=(m==null?void 0:m.durationKnown)||!1,g=il;const E=h.endDate;if(E)g=Nd(E,l),v=!0;else if(h.endOnNext&&!v){const _=a.reduce((S,b)=>{if(b!==h.id){const A=s[b];if(A.class===h.class&&A.startDate>h.startDate&&(!S||h.startDate<S.startDate))return A}return S},null);_&&(g=Nd(_.startDate,l),v=!0)}const y=Object.keys(h.attr);for(let _=0;_<y.length;_++){const S=y[_];if(!fI(S))continue;const b=p[S];if(b)v&&!m.durationKnown&&(b.endTime=g);else if(u){let A=h.attr[S];mI(S)&&(A=uL(A));const w=m0(u,f,g,{key:S,data:A},wi.dateRange);w&&(w.id=d,this.id3Track.addCue(w),p[S]=w)}}n[d]={cues:p,dateRange:h,durationKnown:v}}}}class dL{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig;let u=o&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:a*r);const c=r;return u+Math.min(this.stallCount*1,c)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;const r=n.edge,s=e-t-this.edgeStalled,a=r-n.totalduration,o=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(a,s),o)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(T.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(T.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(T.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(T.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(T.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(T.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===k.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&I.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const n=this.computeLatency();if(n===null)return;this._latency=n;const{lowLatencyMode:r,maxLiveSyncPlaybackRate:s}=this.config;if(!r||s===1||!t.live)return;const a=this.targetLatency;if(a===null)return;const o=n-a,l=Math.min(this.maxLatency,a+t.targetduration);if(o<l&&o>.05&&this.forwardBufferLength>1){const c=Math.min(2,Math.max(1,s)),d=Math.round(2/(1+Math.exp(-.75*o-this.edgeStalled))*20)/20;e.playbackRate=Math.min(c,Math.max(1,d))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const tf=["NONE","TYPE-0","TYPE-1",null];function hL(i){return tf.indexOf(i)>-1}const Ju=["SDR","PQ","HLG"];function fL(i){return!!i&&Ju.indexOf(i)>-1}var $l={No:"",Yes:"YES",v2:"v2"};function p0(i){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=i,r=n<e/2;return e&&r?t?$l.v2:$l.Yes:$l.No}class g0{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class qs{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return v0(this._audioGroups,e)}hasSubtitleGroup(e){return v0(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function v0(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function Fd(i,e){const t=e.startPTS;if(K(t)){let n=0,r;e.sn>i.sn?(n=t-i.start,r=i):(n=i.start-t,r=e),r.duration!==n&&(r.duration=n)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.start=i.start+(i.minEndPTS-i.start):e.start=i.start+i.duration:e.start=Math.max(i.start-e.duration,0)}function YT(i,e,t,n,r,s){n-t<=0&&(I.warn("Fragment should have a positive duration",e),n=t+e.duration,s=r+e.duration);let o=t,l=n;const u=e.startPTS,c=e.endPTS;if(K(u)){const v=Math.abs(u-t);K(e.deltaPTS)?e.deltaPTS=Math.max(v,e.deltaPTS):e.deltaPTS=v,o=Math.max(t,u),t=Math.min(t,u),r=Math.min(r,e.startDTS),l=Math.min(n,c),n=Math.max(n,c),s=Math.max(s,e.endDTS)}const d=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=o,e.startDTS=r,e.endPTS=n,e.minEndPTS=l,e.endDTS=s;const h=e.sn;if(!i||h<i.startSN||h>i.endSN)return 0;let f;const m=h-i.startSN,p=i.fragments;for(p[m]=e,f=m;f>0;f--)Fd(p[f],p[f-1]);for(f=m;f<p.length-1;f++)Fd(p[f],p[f+1]);return i.fragmentHint&&Fd(p[p.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,d}function mL(i,e){let t=null;const n=i.fragments;for(let o=n.length-1;o>=0;o--){const l=n[o].initSegment;if(l){t=l;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let r;vL(i,e,(o,l,u,c)=>{if(e.skippedSegments&&l.cc!==o.cc){const d=o.cc-l.cc;for(let h=u;h<c.length;h++)c[h].cc+=d}K(o.startPTS)&&K(o.endPTS)&&(l.start=l.startPTS=o.startPTS,l.startDTS=o.startDTS,l.maxStartPTS=o.maxStartPTS,l.endPTS=o.endPTS,l.endDTS=o.endDTS,l.minEndPTS=o.minEndPTS,l.duration=o.endPTS-o.startPTS,l.duration&&(r=l),e.PTSKnown=e.alignedSliding=!0),l.elementaryStreams=o.elementaryStreams,l.loader=o.loader,l.stats=o.stats,o.initSegment&&(l.initSegment=o.initSegment,t=o.initSegment)});const s=e.fragments;if(t&&(e.fragmentHint?s.concat(e.fragmentHint):s).forEach(l=>{var u;l&&(!l.initSegment||l.initSegment.relurl===((u=t)==null?void 0:u.relurl))&&(l.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=s.some(o=>!o),e.deltaUpdateFailed){I.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let o=e.skippedSegments;o--;)s.shift();e.startSN=s[0].sn}else e.canSkipDateRanges&&(e.dateRanges=pL(i.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));e.startCC=e.fragments[0].cc,e.endCC=s[s.length-1].cc}gL(i.partList,e.partList,(o,l)=>{l.elementaryStreams=o.elementaryStreams,l.stats=o.stats}),r?YT(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):jT(i,e),s.length&&(e.totalduration=e.edge-s[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const a=e.advancedDateTime;if(e.advanced&&a){const o=e.edge;e.driftStart||(e.driftStartTime=a,e.driftStart=o),e.driftEndTime=a,e.driftEnd=o}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime}function pL(i,e,t){const n=nt({},i);return t&&t.forEach(r=>{delete n[r]}),Object.keys(e).forEach(r=>{const s=new LT(e[r].attr,n[r]);s.isValid?n[r]=s:I.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[r].attr)}"`)}),n}function gL(i,e,t){if(i&&e){let n=0;for(let r=0,s=i.length;r<=s;r++){const a=i[r],o=e[r+n];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?t(a,o):n--}}}function vL(i,e,t){const n=e.skippedSegments,r=Math.max(i.startSN,e.startSN)-e.startSN,s=(i.fragmentHint?1:0)+(n?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,a=e.startSN-i.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let u=r;u<=s;u++){const c=l[a+u];let d=o[u];n&&!d&&u<n&&(d=e.fragments[u]=c),c&&d&&t(c,d,u,o)}}function jT(i,e){const t=e.startSN+e.skippedSegments-i.startSN,n=i.fragments;t<0||t>=n.length||nf(e,n[t].start)}function nf(i,e){if(e){const t=i.fragments;for(let n=i.skippedSegments;n<t.length;n++)t[n].start+=e;i.fragmentHint&&(i.fragmentHint.start+=e)}}function EL(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const n=i.fragments;if(n.length&&t*4>e){const s=n[n.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function yL(i,e,t){if(!(i!=null&&i.details))return null;const n=i.details;let r=n.fragments[e-n.startSN];return r||(r=n.fragmentHint,r&&r.sn===e)?r:e<n.startSN&&t&&t.sn===e?t:null}function E0(i,e,t){var n;return i!=null&&i.details?zT((n=i.details)==null?void 0:n.partList,e,t):null}function zT(i,e,t){if(i)for(let n=i.length;n--;){const r=i[n];if(r.index===t&&r.fragment.sn===e)return r}return null}function QT(i){i.forEach((e,t)=>{const{details:n}=e;n!=null&&n.fragments&&n.fragments.forEach(r=>{r.level=t})})}function ec(i){switch(i.details){case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_TIMEOUT:case k.LEVEL_LOAD_TIMEOUT:case k.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function y0(i,e){const t=ec(e);return i.default[`${t?"timeout":"error"}Retry`]}function Gm(i,e){const t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function T0(i){return vt(vt({},i),{errorRetry:null,timeoutRetry:null})}function tc(i,e,t,n){if(!i)return!1;const r=n==null?void 0:n.code,s=e<i.maxNumRetry&&(TL(r)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,n,s):s}function TL(i){return i===0&&navigator.onLine===!1||!!i&&(i<400||i>499)}const XT={search:function(i,e){let t=0,n=i.length-1,r=null,s=null;for(;t<=n;){r=(t+n)/2|0,s=i[r];const a=e(s);if(a>0)t=r+1;else if(a<0)n=r-1;else return s}return null}};function _L(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!K(e))return null;const n=i[0].programDateTime;if(e<(n||0))return null;const r=i[i.length-1].endProgramDateTime;if(e>=(r||0))return null;t=t||0;for(let s=0;s<i.length;++s){const a=i[s];if(AL(e,t,a))return a}return null}function ic(i,e,t=0,n=0,r=.005){let s=null;if(i){s=e[i.sn-e[0].sn+1]||null;const o=i.endDTS-t;o>0&&o<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!i||i.level===s.level)&&rf(t,n,s)===0||SL(s,i,Math.min(r,n))))return s;const a=XT.search(e,rf.bind(null,t,n));return a&&(a!==i||!s)?a:s}function SL(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((r,s)=>(s[0]==="INF"&&(r+=parseFloat(s[1])),r),t);return i.start<=n}return!1}function rf(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=i?1:t.start-n>i&&t.start?-1:0}function AL(i,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>i}function xL(i,e){return XT.search(i,t=>t.cc<e?1:t.cc>e?-1:0)}var _t={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},yi={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class bL{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=I.log.bind(I,"[info]:"),this.warn=I.warn.bind(I,"[warning]:"),this.error=I.error.bind(I,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(T.ERROR,this.onError,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(T.ERROR,this.onError,this),e.off(T.ERROR,this.onErrorOut,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===ee.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,r;if(t.fatal)return;const s=this.hls,a=t.context;switch(t.details){case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case k.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction={action:_t.DoNothing,flags:yi.None};return}case k.FRAG_GAP:case k.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=_t.SendAlternateToPenaltyBox;return}case k.LEVEL_EMPTY_ERROR:case k.LEVEL_PARSING_ERROR:{var o,l;const u=t.parent===ee.MAIN?t.level:s.loadLevel;t.details===k.LEVEL_EMPTY_ERROR&&((o=t.context)!=null&&(l=o.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case k.LEVEL_LOAD_ERROR:case k.LEVEL_LOAD_TIMEOUT:typeof(a==null?void 0:a.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level));return;case k.AUDIO_TRACK_LOAD_ERROR:case k.AUDIO_TRACK_LOAD_TIMEOUT:case k.SUBTITLE_LOAD_ERROR:case k.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const u=s.levels[s.loadLevel];if(u&&(a.type===fe.AUDIO_TRACK&&u.hasAudioGroup(a.groupId)||a.type===fe.SUBTITLE_TRACK&&u.hasSubtitleGroup(a.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=_t.SendAlternateToPenaltyBox,t.errorAction.flags=yi.MoveAllAlternatesMatchingHost;return}}return;case k.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=s.levels[s.loadLevel],c=u==null?void 0:u.attrs["HDCP-LEVEL"];c?t.errorAction={action:_t.SendAlternateToPenaltyBox,flags:yi.MoveAllAlternatesMatchingHDCP,hdcpLevel:c}:this.keySystemError(t)}return;case k.BUFFER_ADD_CODEC_ERROR:case k.REMUX_ALLOC_ERROR:case k.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(r=t.level)!=null?r:s.loadLevel);return;case k.INTERNAL_EXCEPTION:case k.BUFFER_APPENDING_ERROR:case k.BUFFER_FULL_ERROR:case k.LEVEL_SWITCH_ERROR:case k.BUFFER_STALLED_ERROR:case k.BUFFER_SEEK_OVER_HOLE:case k.BUFFER_NUDGE_ON_STALL:t.errorAction={action:_t.DoNothing,flags:yi.None};return}t.type===ie.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,r=y0(n.config.playlistLoadPolicy,e),s=this.playlistError++;if(tc(r,s,ec(e),e.response))return{action:_t.RetryRequest,flags:yi.None,retryConfig:r,retryCount:s};const o=this.getLevelSwitchAction(e,t);return r&&(o.retryConfig=r,o.retryCount=s),o}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:s,keyLoadPolicy:a}=t.config,o=y0(e.details.startsWith("key")?a:s,e),l=t.levels.reduce((c,d)=>c+d.fragmentError,0);if(r&&(e.details!==k.FRAG_GAP&&r.fragmentError++,tc(o,l,ec(e),e.response)))return{action:_t.RetryRequest,flags:yi.None,retryConfig:o,retryCount:l};const u=this.getLevelSwitchAction(e,n);return o&&(u.retryConfig=o,u.retryCount=l),u}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const r=this.hls.levels[t];if(r){var s,a;const u=e.details;r.loadError++,u===k.BUFFER_APPEND_ERROR&&r.fragmentError++;let c=-1;const{levels:d,loadLevel:h,minAutoLevel:f,maxAutoLevel:m}=n;n.autoLevelEnabled||(n.loadLevel=-1);const p=(s=e.frag)==null?void 0:s.type,g=(p===ee.AUDIO&&u===k.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===k.BUFFER_ADD_CODEC_ERROR||u===k.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:b})=>r.audioCodec!==b),y=e.sourceBufferName==="video"&&(u===k.BUFFER_ADD_CODEC_ERROR||u===k.BUFFER_APPEND_ERROR)&&d.some(({codecSet:b,audioCodec:A})=>r.codecSet!==b&&r.audioCodec===A),{type:_,groupId:S}=(a=e.context)!=null?a:{};for(let b=d.length;b--;){const A=(b+h)%d.length;if(A!==h&&A>=f&&A<=m&&d[A].loadError===0){var o,l;const w=d[A];if(u===k.FRAG_GAP&&p===ee.MAIN&&e.frag){const P=d[A].details;if(P){const R=ic(e.frag,P.fragments,e.frag.start);if(R!=null&&R.gap)continue}}else{if(_===fe.AUDIO_TRACK&&w.hasAudioGroup(S)||_===fe.SUBTITLE_TRACK&&w.hasSubtitleGroup(S))continue;if(p===ee.AUDIO&&(o=r.audioGroups)!=null&&o.some(P=>w.hasAudioGroup(P))||p===ee.SUBTITLE&&(l=r.subtitleGroups)!=null&&l.some(P=>w.hasSubtitleGroup(P))||g&&r.audioCodec===w.audioCodec||!g&&r.audioCodec!==w.audioCodec||y&&r.codecSet===w.codecSet)continue}c=A;break}}if(c>-1&&n.loadLevel!==c)return e.levelRetry=!0,this.playlistError=0,{action:_t.SendAlternateToPenaltyBox,flags:yi.None,nextAutoLevel:c}}return{action:_t.SendAlternateToPenaltyBox,flags:yi.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case _t.DoNothing:break;case _t.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==k.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:r,hdcpLevel:s,nextAutoLevel:a}=n;switch(r){case yi.None:this.switchLevel(e,a);break;case yi.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=tf[tf.indexOf(s)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,a)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class Hm{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=I.log.bind(I,`${t}:`),this.warn=I.warn.bind(I,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const r=t==null?void 0:t.renditionReports;if(r){let s=-1;for(let a=0;a<r.length;a++){const o=r[a];let l;try{l=new self.URL(o.URI,t.url).href}catch(u){I.warn(`Could not construct new URL for Rendition Report: ${u}`),l=o.URI||""}if(l===e){s=a;break}else l===e.substring(0,l.length)&&(s=a)}if(s!==-1){const a=r[s],o=parseInt(a["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let l=parseInt(a["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const c=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&c>t.partTarget&&(l+=1)}const u=n&&p0(n);return new g0(o,l>=0?l:void 0,u)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){const{details:r,stats:s}=t,a=self.performance.now(),o=s.loading.first?Math.max(0,a-s.loading.first):0;if(r.advancedDateTime=Date.now()-o,r.live||n!=null&&n.live){if(r.reloaded(n),n&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),n&&r.fragments.length>0&&mL(n,r),!this.canLoad||!r.live)return;let l,u,c;if(r.canBlockReload&&r.endSN&&r.advanced){const v=this.hls.config.lowLatencyMode,g=r.lastPartSn,E=r.endSN,y=r.lastPartIndex,_=y!==-1,S=g===E,b=v?0:y;_?(u=S?E+1:g,c=S?b:y+1):u=E+1;const A=r.age,w=A+r.ageHeader;let P=Math.min(w-r.partTarget,r.targetduration*1.5);if(P>0){if(n&&P>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${P} with playlist age: ${r.age}`),P=0;else{const R=Math.floor(P/r.targetduration);if(u+=R,c!==void 0){const D=Math.round(P%r.targetduration/r.partTarget);c+=D}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${A.toFixed(2)}s goal: ${P} skip sn ${R} to part ${c}`)}r.tuneInGoal=P}if(l=this.getDeliveryDirectives(r,t.deliveryDirectives,u,c),v||!S){this.loadPlaylist(l);return}}else(r.canBlockReload||r.canSkipUntil)&&(l=this.getDeliveryDirectives(r,t.deliveryDirectives,u,c));const d=this.hls.mainForwardBufferInfo,h=d?d.end-d.len:0,f=(r.edge-h)*1e3,m=EL(r,f);r.updated&&a>this.requestScheduled+m&&(this.requestScheduled=s.loading.start),u!==void 0&&r.canBlockReload?this.requestScheduled=s.loading.first+m-(r.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+m<a?this.requestScheduled=a:this.requestScheduled-a<=0&&(this.requestScheduled+=m);let p=this.requestScheduled-a;p=Math.max(0,p),this.log(`reload live playlist ${e} in ${Math.round(p)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),p)}else this.clearTimer()}getDeliveryDirectives(e,t,n,r){let s=p0(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,s=$l.No),new g0(n,r,s)}checkRetry(e){const t=e.details,n=ec(e),r=e.errorAction,{action:s,retryCount:a=0,retryConfig:o}=r||{},l=!!r&&!!o&&(s===_t.RetryRequest||!r.resolved&&s===_t.SendAlternateToPenaltyBox);if(l){var u;if(this.requestScheduled=-1,a>=o.maxNumRetry)return!1;if(n&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const c=Gm(o,a);this.timer=self.setTimeout(()=>this.loadPlaylist(),c),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${c}ms`)}e.levelRetry=!0,r.resolved=!0}return l}}class Yr{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class RL{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Yr(e),this.fast_=new Yr(t),this.defaultTTFB_=r,this.ttfb_=new Yr(e)}update(e,t){const{slow_:n,fast_:r,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new Yr(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new Yr(t,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new Yr(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,r=e/1e3,s=n/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const ZT={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},_0={};function wL(i,e,t,n,r,s){const a=i.audioCodec?i.audioGroups:null,o=s==null?void 0:s.audioCodec,l=s==null?void 0:s.channels,u=l?parseInt(l):o?1/0:2;let c=null;if(a!=null&&a.length)try{a.length===1&&a[0]?c=e.groups[a[0]].channels:c=a.reduce((d,h)=>{if(h){const f=e.groups[h];if(!f)throw new Error(`Audio track group ${h} not found`);Object.keys(f.channels).forEach(m=>{d[m]=(d[m]||0)+f.channels[m]})}return d},{2:0})}catch{return!0}return i.videoCodec!==void 0&&(i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(n,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(r,8e6))||!!c&&K(u)&&Object.keys(c).some(d=>parseInt(d)>u)}function IL(i,e,t){const n=i.videoCodec,r=i.audioCodec;if(!n||!r||!t)return Promise.resolve(ZT);const s={width:i.width,height:i.height,bitrate:Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)),framerate:i.frameRate||30},a=i.videoRange;a!=="SDR"&&(s.transferFunction=a.toLowerCase());const o=n.split(",").map(l=>({type:"media-source",video:vt(vt({},s),{},{contentType:go(l,"video")})}));return r&&i.audioGroups&&i.audioGroups.forEach(l=>{var u;l&&((u=e.groups[l])==null||u.tracks.forEach(c=>{if(c.groupId===l){const d=c.channels||"",h=parseFloat(d);K(h)&&h>2&&o.push.apply(o,r.split(",").map(f=>({type:"media-source",audio:{contentType:go(f,"audio"),channels:""+h}})))}}))}),Promise.all(o.map(l=>{const u=LL(l);return _0[u]||(_0[u]=t.decodingInfo(l))})).then(l=>({supported:!l.some(u=>!u.supported),configurations:o,decodingInfoResults:l})).catch(l=>({supported:!1,configurations:o,decodingInfoResults:[],error:l}))}function LL(i){const{audio:e,video:t}=i,n=t||e;if(n){const r=n.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${r}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${r}`}return""}function kL(){if(typeof matchMedia=="function"){const i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function DL(i,e){let t=!1,n=[];return i&&(t=i!=="SDR",n=[i]),e&&(n=e.allowedVideoRanges||Ju.slice(0),t=e.preferHDR!==void 0?e.preferHDR:kL(),t?n=n.filter(r=>r!=="SDR"):n=["SDR"]),{preferHDR:t,allowedVideoRanges:n}}function CL(i,e,t,n,r){const s=Object.keys(i),a=n==null?void 0:n.channels,o=n==null?void 0:n.audioCodec,l=a&&parseInt(a)===2;let u=!0,c=!1,d=1/0,h=1/0,f=1/0,m=0,p=[];const{preferHDR:v,allowedVideoRanges:g}=DL(e,r);for(let S=s.length;S--;){const b=i[s[S]];u=b.channels[2]>0,d=Math.min(d,b.minHeight),h=Math.min(h,b.minFramerate),f=Math.min(f,b.minBitrate);const A=g.filter(w=>b.videoRanges[w]>0);A.length>0&&(c=!0,p=A)}d=K(d)?d:0,h=K(h)?h:0;const E=Math.max(1080,d),y=Math.max(30,h);return f=K(f)?f:t,t=Math.max(f,t),c||(e=void 0,p=[]),{codecSet:s.reduce((S,b)=>{const A=i[b];if(b===S)return S;if(A.minBitrate>t)return an(b,`min bitrate of ${A.minBitrate} > current estimate of ${t}`),S;if(!A.hasDefaultAudio)return an(b,"no renditions with default or auto-select sound found"),S;if(o&&b.indexOf(o.substring(0,4))%5!==0)return an(b,`audio codec preference "${o}" not found`),S;if(a&&!l){if(!A.channels[a])return an(b,`no renditions with ${a} channel sound found (channels options: ${Object.keys(A.channels)})`),S}else if((!o||l)&&u&&A.channels[2]===0)return an(b,"no renditions with stereo sound found"),S;return A.minHeight>E?(an(b,`min resolution of ${A.minHeight} > maximum of ${E}`),S):A.minFramerate>y?(an(b,`min framerate of ${A.minFramerate} > maximum of ${y}`),S):p.some(w=>A.videoRanges[w]>0)?A.maxScore<m?(an(b,`max score of ${A.maxScore} < selected max of ${m}`),S):S&&(Xu(b)>=Xu(S)||A.fragmentError>i[S].fragmentError)?S:(m=A.maxScore,b):(an(b,`no variants with VIDEO-RANGE of ${JSON.stringify(p)} found`),S)},void 0),videoRanges:p,preferHDR:v,minFramerate:h,minBitrate:f}}function an(i,e){I.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function PL(i){return i.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const r=t.channels||"2";return n.channels[r]=(n.channels[r]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function ML(i,e,t,n){return i.slice(t,n+1).reduce((r,s)=>{if(!s.codecSet)return r;const a=s.audioGroups;let o=r[s.codecSet];o||(r[s.codecSet]=o={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!a,fragmentError:0}),o.minBitrate=Math.min(o.minBitrate,s.bitrate);const l=Math.min(s.height,s.width);return o.minHeight=Math.min(o.minHeight,l),o.minFramerate=Math.min(o.minFramerate,s.frameRate),o.maxScore=Math.max(o.maxScore,s.score),o.fragmentError+=s.fragmentError,o.videoRanges[s.videoRange]=(o.videoRanges[s.videoRange]||0)+1,a&&a.forEach(u=>{if(!u)return;const c=e.groups[u];c&&(o.hasDefaultAudio=o.hasDefaultAudio||e.hasDefaultAudio?c.hasDefault:c.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(c.channels).forEach(d=>{o.channels[d]=(o.channels[d]||0)+c.channels[d]}))}),r},{})}function Zi(i,e,t){if("attrs"in i){const n=e.indexOf(i);if(n!==-1)return n}for(let n=0;n<e.length;n++){const r=e[n];if(Lr(i,r,t))return n}return-1}function Lr(i,e,t){const{groupId:n,name:r,lang:s,assocLang:a,default:o}=i,l=i.forced;return(n===void 0||e.groupId===n)&&(r===void 0||e.name===r)&&(s===void 0||e.lang===s)&&(s===void 0||e.assocLang===a)&&(o===void 0||e.default===o)&&(l===void 0||e.forced===l)&&(!("characteristics"in i)||OL(i.characteristics||"",e.characteristics))&&(t===void 0||t(i,e))}function OL(i,e=""){const t=i.split(","),n=e.split(",");return t.length===n.length&&!t.some(r=>n.indexOf(r)===-1)}function fr(i,e){const{audioCodec:t,channels:n}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function NL(i,e,t,n,r){const s=e[n],o=e.reduce((h,f,m)=>{const p=f.uri;return(h[p]||(h[p]=[])).push(m),h},{})[s.uri];o.length>1&&(n=Math.max.apply(Math,o));const l=s.videoRange,u=s.frameRate,c=s.codecSet.substring(0,4),d=S0(e,n,h=>{if(h.videoRange!==l||h.frameRate!==u||h.codecSet.substring(0,4)!==c)return!1;const f=h.audioGroups,m=t.filter(p=>!f||f.indexOf(p.groupId)!==-1);return Zi(i,m,r)>-1});return d>-1?d:S0(e,n,h=>{const f=h.audioGroups,m=t.filter(p=>!f||f.indexOf(p.groupId)!==-1);return Zi(i,m,r)>-1})}function S0(i,e,t){for(let n=e;n>-1;n--)if(t(i[n]))return n;for(let n=e+1;n<i.length;n++)if(t(i[n]))return n;return-1}class FL{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:n,hls:r}=this,{autoLevelEnabled:s,media:a}=r;if(!t||!a)return;const o=performance.now(),l=n?n.stats:t.stats,u=n?n.duration:t.duration,c=o-l.loading.start,d=r.minAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||t.level<=d){this.clearTimer(),this._nextAutoLevel=-1;return}if(!s||a.paused||!a.playbackRate||!a.readyState)return;const h=r.mainForwardBufferInfo;if(h===null)return;const f=this.bwEstimator.getEstimateTTFB(),m=Math.abs(a.playbackRate);if(c<=Math.max(f,1e3*(u/(m*2))))return;const p=h.len/m,v=l.loading.first?l.loading.first-l.loading.start:-1,g=l.loaded&&v>-1,E=this.getBwEstimate(),y=r.levels,_=y[t.level],S=l.total||Math.max(l.loaded,Math.round(u*_.averageBitrate/8));let b=g?c-v:c;b<1&&g&&(b=Math.min(c,l.loaded*8/E));const A=g?l.loaded*1e3/b:0,w=A?(S-l.loaded)/A:S*8/E+f/1e3;if(w<=p)return;const P=A?A*8:E;let R=Number.POSITIVE_INFINITY,D;for(D=t.level-1;D>d;D--){const $=y[D].maxBitrate;if(R=this.getTimeToLoadFrag(f/1e3,P,u*$,!y[D].details),R<p)break}if(R>=w||R>u*10)return;r.nextLoadLevel=r.nextAutoLevel=D,g?this.bwEstimator.sample(c-Math.min(f,v),l.loaded):this.bwEstimator.sampleTTFB(c);const j=y[D].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>j&&this.resetEstimator(j),this.clearTimer(),I.warn(`[abr] Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${p.toFixed(3)} s
      Estimated load time for current fragment: ${w.toFixed(3)} s
      Estimated load time for down switch fragment: ${R.toFixed(3)} s
      TTFB estimate: ${v|0} ms
      Current BW estimate: ${K(E)?E|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${D} @ ${j|0} bps`),r.trigger(T.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:n,stats:l})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(I.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new RL(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.FRAG_LOADING,this.onFragLoading,this),e.on(T.FRAG_LOADED,this.onFragLoaded,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.FRAG_LOADING,this.onFragLoading,this),e.off(T.FRAG_LOADED,this.onFragLoaded,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(T.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var r;this.fragCurrent=n,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case k.BUFFER_ADD_CODEC_ERROR:case k.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case k.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:r,partCurrent:s}=this;if(n&&r&&n.sn===r.sn&&n.level===r.level){const a=performance.now(),o=s?s.stats:n.stats,l=a-o.loading.start,u=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&u>-1){const d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(d,u),o.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,n,r){const s=e+n/t,a=r?this.lastLevelLoadSec:0;return s+a}onLevelLoaded(e,t){const n=this.hls.config,{loading:r}=t.stats,s=r.end-r.start;K(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){const r=n?n.stats:t.stats;if(t.type===ee.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=n?n.duration:t.duration,a=this.hls.levels[t.level],o=(a.loaded?a.loaded.bytes:0)+r.loaded,l=(a.loaded?a.loaded.duration:0)+s;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(t.bitrateTest){const s={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(T.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:r}=t,s=r!=null&&r.stats.loaded?r.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;const a=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,s.loaded),s.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ee.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,s=this.findBestLevel(n,t,e,0,r,1,1);if(s>-1)return s;const a=this.hls.firstLevel,o=Math.min(Math.max(a,t),e);return I.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=n&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,s)&&a[e].loadError<=a[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:r,config:s,minAutoLevel:a}=n,o=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),u=this.getStarvationDelay();let c=s.abrBandWidthFactor,d=s.abrBandWidthUpFactor;if(u){const v=this.findBestLevel(l,a,r,u,0,c,d);if(v>=0)return v}let h=o?Math.min(o,s.maxStarvationDelay):s.maxStarvationDelay;if(!u){const v=this.bitrateTestDelay;v&&(h=(o?Math.min(o,s.maxLoadingDelay):s.maxLoadingDelay)-v,I.info(`[abr] bitrate test took ${Math.round(1e3*v)}ms, set first fragment max fetchDuration to ${Math.round(1e3*h)} ms`),c=d=1)}const f=this.findBestLevel(l,a,r,u,h,c,d);if(I.info(`[abr] ${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${f}`),f>-1)return f;const m=n.levels[a],p=n.levels[n.loadLevel];return(m==null?void 0:m.bitrate)<(p==null?void 0:p.bitrate)?a:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,s,a,o){var l;const u=r+s,c=this.lastLoadedFragLevel,d=c===-1?this.hls.firstLevel:c,{fragCurrent:h,partCurrent:f}=this,{levels:m,allAudioTracks:p,loadLevel:v,config:g}=this.hls;if(m.length===1)return 0;const E=m[d],y=!!(E!=null&&(l=E.details)!=null&&l.live),_=v===-1||c===-1;let S,b="SDR",A=(E==null?void 0:E.frameRate)||0;const{audioPreference:w,videoPreference:P}=g,R=this.audioTracksByGroup||(this.audioTracksByGroup=PL(p));if(_){if(this.firstSelection!==-1)return this.firstSelection;const q=this.codecTiers||(this.codecTiers=ML(m,R,t,n)),W=CL(q,b,e,w,P),{codecSet:oe,videoRanges:F,minFramerate:O,minBitrate:M,preferHDR:G}=W;S=oe,b=G?F[F.length-1]:F[0],A=O,e=Math.max(e,M),I.log(`[abr] picked start tier ${JSON.stringify(W)}`)}else S=E==null?void 0:E.codecSet,b=E==null?void 0:E.videoRange;const D=f?f.duration:h?h.duration:0,j=this.bwEstimator.getEstimateTTFB()/1e3,$=[];for(let q=n;q>=t;q--){var X;const W=m[q],oe=q>d;if(!W)continue;if(g.useMediaCapabilities&&!W.supportedResult&&!W.supportedPromise){const me=navigator.mediaCapabilities;typeof(me==null?void 0:me.decodingInfo)=="function"&&wL(W,R,b,A,e,w)?(W.supportedPromise=IL(W,R,me),W.supportedPromise.then(we=>{if(!this.hls)return;W.supportedResult=we;const be=this.hls.levels,ze=be.indexOf(W);we.error?I.warn(`[abr] MediaCapabilities decodingInfo error: "${we.error}" for level ${ze} ${JSON.stringify(we)}`):we.supported||(I.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${ze} ${JSON.stringify(we)}`),ze>-1&&be.length>1&&(I.log(`[abr] Removing unsupported level ${ze}`),this.hls.removeLevel(ze)))})):W.supportedResult=ZT}if(S&&W.codecSet!==S||b&&W.videoRange!==b||oe&&A>W.frameRate||!oe&&A>0&&A<W.frameRate||W.supportedResult&&!((X=W.supportedResult.decodingInfoResults)!=null&&X[0].smooth)){$.push(q);continue}const F=W.details,O=(f?F==null?void 0:F.partTarget:F==null?void 0:F.averagetargetduration)||D;let M;oe?M=o*e:M=a*e;const G=D&&r>=D*2&&s===0?m[q].averageBitrate:m[q].maxBitrate,Y=this.getTimeToLoadFrag(j,M,G*O,F===void 0);if(M>=G&&(q===c||W.loadError===0&&W.fragmentError===0)&&(Y<=j||!K(Y)||y&&!this.bitrateTestDelay||Y<u)){const me=this.forcedAutoLevel;return q!==v&&(me===-1||me!==v)&&($.length&&I.trace(`[abr] Skipped level(s) ${$.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${m[$[0]].codecs}" ${m[$[0]].videoRange}; not compatible with "${E.codecs}" ${b}`),I.info(`[abr] switch candidate:${d}->${q} adjustedbw(${Math.round(M)})-bitrate=${Math.round(M-G)} ttfb:${j.toFixed(1)} avgDuration:${O.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${Y.toFixed(1)} firstSelection:${_} codecSet:${S} videoRange:${b} hls.loadLevel:${v}`)),_&&(this.firstSelection=q),q}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls,r=Math.min(Math.max(e,n),t);this._nextAutoLevel!==r&&(this.nextAutoLevelKey="",this._nextAutoLevel=r)}}class UL{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var mt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class $L{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(T.BUFFER_APPENDED,this.onBufferAppended,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.BUFFER_APPENDED,this.onBufferAppended,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let r=n.length;r--;){const s=n[r];if(!s)break;const a=s.end;if(s.start<=e&&a!==null&&e<=a)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:n}=this,r=Object.keys(n);for(let s=r.length;s--;){const a=n[r[s]];if((a==null?void 0:a.body.type)===t&&a.buffered){const o=a.body;if(o.start<=e&&e<=o.end)return o}}return null}detectEvictedFragments(e,t,n,r){this.timeRanges&&(this.timeRanges[e]=t);const s=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o||s>=o.body.sn)return;if(!o.buffered&&!o.loaded){o.body.type===n&&this.removeFragment(o.body);return}const l=o.range[e];l&&l.time.some(u=>{const c=!this.isTimeBuffered(u.startPTS,u.endPTS,t);return c&&this.removeFragment(o.body),c})})}detectPartialFragments(e){const t=this.timeRanges,{frag:n,part:r}=e;if(!t||n.sn==="initSegment")return;const s=jr(n),a=this.fragments[s];if(!a||a.buffered&&n.gap)return;const o=!n.relurl;Object.keys(t).forEach(l=>{const u=n.elementaryStreams[l];if(!u)return;const c=t[l],d=o||u.partial===!0;a.range[l]=this.getBufferedTimes(n,r,d,c)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=n.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),nl(a)||this.removeParts(n.sn-1,n.type)):this.removeFragment(a.body)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(r=>r.fragment.sn>=e))}fragBuffered(e,t){const n=jr(e);let r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,n,r){const s={time:[],partial:n},a=e.start,o=e.end,l=e.minEndPTS||o,u=e.maxStartPTS||a;for(let c=0;c<r.length;c++){const d=r.start(c)-this.bufferPadding,h=r.end(c)+this.bufferPadding;if(u>=d&&l<=h){s.time.push({startPTS:Math.max(a,r.start(c)),endPTS:Math.min(o,r.end(c))});break}else if(a<h&&o>d){const f=Math.max(a,r.start(c)),m=Math.min(o,r.end(c));m>f&&(s.partial=!0,s.time.push({startPTS:f,endPTS:m}))}else if(o<=d)break}return s}getPartialFragment(e){let t=null,n,r,s,a=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(u=>{const c=l[u];c&&nl(c)&&(r=c.body.start-o,s=c.body.end+o,e>=r&&e<=s&&(n=Math.min(e-r,s-e),a<=n&&(t=c.body,a=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||nl(t))}getState(e){const t=jr(e),n=this.fragments[t];return n?n.buffered?nl(n)?mt.PARTIAL:mt.OK:mt.APPENDING:mt.NOT_LOADED}isTimeBuffered(e,t,n){let r,s;for(let a=0;a<n.length;a++){if(r=n.start(a)-this.bufferPadding,s=n.end(a)+this.bufferPadding,e>=r&&t<=s)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){const{frag:n,part:r}=t;if(n.sn==="initSegment"||n.bitrateTest)return;const s=r?null:t,a=jr(n);this.fragments[a]={body:n,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:r,timeRanges:s}=t;if(n.sn==="initSegment")return;const a=n.type;if(r){let o=this.activePartLists[a];o||(this.activePartLists[a]=o=[]),o.push(r)}this.timeRanges=s,Object.keys(s).forEach(o=>{const l=s[o];this.detectEvictedFragments(o,l,a,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=jr(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const l=o.body;l.type!==n||r&&!l.gap||l.start<t&&l.end>e&&(o.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const t=jr(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const r=e.sn;this.activePartLists[e.type]=n.filter(s=>s.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function nl(i){var e,t,n;return i.buffered&&(i.body.gap||((e=i.range.video)==null?void 0:e.partial)||((t=i.range.audio)==null?void 0:t.partial)||((n=i.range.audiovideo)==null?void 0:n.partial))}function jr(i){return`${i.type}_${i.level}_${i.sn}`}const BL={length:0,start:()=>0,end:()=>0};class De{static isBuffered(e,t){try{if(e){const n=De.getBuffered(e);for(let r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){const r=De.getBuffered(e),s=[];let a;for(a=0;a<r.length;a++)s.push({start:r.start(a),end:r.end(a)});return this.bufferedInfo(s,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(u,c){const d=u.start-c.start;return d||c.end-u.end});let r=[];if(n)for(let u=0;u<e.length;u++){const c=r.length;if(c){const d=r[c-1].end;e[u].start-d<n?e[u].end>d&&(r[c-1].end=e[u].end):r.push(e[u])}else r.push(e[u])}else r=e;let s=0,a,o=t,l=t;for(let u=0;u<r.length;u++){const c=r[u].start,d=r[u].end;if(t+n>=c&&t<d)o=c,l=d,s=l-t;else if(t+n<c){a=c;break}}return{len:s,start:o||0,end:l||0,nextStart:a}}static getBuffered(e){try{return e.buffered}catch(t){return I.log("failed to get media.buffered",t),BL}}}class Vm{constructor(e,t,n,r=0,s=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=rl(),this.buffering={audio:rl(),video:rl(),audiovideo:rl()},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=s,this.partial=a}}function rl(){return{start:0,executeStart:0,executeEnd:0,end:0}}function Bl(i,e){for(let n=0,r=i.length;n<r;n++){var t;if(((t=i[n])==null?void 0:t.cc)===e)return i[n]}return null}function GL(i,e,t){return!!(e&&(t.endCC>t.startCC||i&&i.cc<t.startCC))}function HL(i,e){const t=i.fragments,n=e.fragments;if(!n.length||!t.length){I.log("No fragments to align");return}const r=Bl(t,n[0].cc);if(!r||r&&!r.startPTS){I.log("No frag in previous level to align on");return}return r}function A0(i,e){if(i){const t=i.start+e;i.start=i.startPTS=t,i.endPTS=t+i.duration}}function JT(i,e){const t=e.fragments;for(let n=0,r=t.length;n<r;n++)A0(t[n],i);e.fragmentHint&&A0(e.fragmentHint,i),e.alignedSliding=!0}function VL(i,e,t){e&&(KL(i,t,e),!t.alignedSliding&&e&&nc(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&jT(e,t))}function KL(i,e,t){if(GL(i,t,e)){const n=HL(t,e);n&&K(n.start)&&(I.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),JT(n.start,e))}}function nc(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,n=e.fragments;if(!t.length||!n.length)return;let r,s;const a=Math.min(e.endCC,i.endCC);e.startCC<a&&i.startCC<a&&(r=Bl(n,a),s=Bl(t,a)),(!r||!s)&&(r=n[Math.floor(n.length/2)],s=Bl(t,r.cc)||t[Math.floor(t.length/2)]);const o=r.programDateTime,l=s.programDateTime;if(!o||!l)return;const u=(l-o)/1e3-(s.start-r.start);JT(u,i)}const x0=Math.pow(2,17);class WL{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new hn({type:ie.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,a=r.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(f=>f[0]==="GAP")){l(R0(e));return}else e.gap=!1;const u=this.loader=e.loader=s?new s(r):new a(r),c=b0(e),d=T0(r.fragLoadPolicy.default),h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:x0};e.stats=u.stats,u.load(c,h,{onSuccess:(f,m,p,v)=>{this.resetLoader(e,u);let g=f.data;p.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(g.slice(0,16)),g=g.slice(16)),o({frag:e,part:null,payload:g,networkDetails:v})},onError:(f,m,p,v)=>{this.resetLoader(e,u),l(new hn({type:ie.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:vt({url:n,data:void 0},f),error:new Error(`HTTP Error ${f.code} ${f.text}`),networkDetails:p,stats:v}))},onAbort:(f,m,p)=>{this.resetLoader(e,u),l(new hn({type:ie.NETWORK_ERROR,details:k.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:p,stats:f}))},onTimeout:(f,m,p)=>{this.resetLoader(e,u),l(new hn({type:ie.NETWORK_ERROR,details:k.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:p,stats:f}))},onProgress:(f,m,p,v)=>{t&&t({frag:e,part:null,payload:p,networkDetails:v})}})})}loadPart(e,t,n){this.abort();const r=this.config,s=r.fLoader,a=r.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(R0(e,t));return}const u=this.loader=e.loader=s?new s(r):new a(r),c=b0(e,t),d=T0(r.fragLoadPolicy.default),h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:x0};t.stats=u.stats,u.load(c,h,{onSuccess:(f,m,p,v)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const g={frag:e,part:t,payload:f.data,networkDetails:v};n(g),o(g)},onError:(f,m,p,v)=>{this.resetLoader(e,u),l(new hn({type:ie.NETWORK_ERROR,details:k.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:vt({url:c.url,data:void 0},f),error:new Error(`HTTP Error ${f.code} ${f.text}`),networkDetails:p,stats:v}))},onAbort:(f,m,p)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),l(new hn({type:ie.NETWORK_ERROR,details:k.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:p,stats:f}))},onTimeout:(f,m,p)=>{this.resetLoader(e,u),l(new hn({type:ie.NETWORK_ERROR,details:k.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:p,stats:f}))}})})}updateStatsFromPart(e,t){const n=e.stats,r=t.stats,s=r.total;if(n.loaded+=r.loaded,s){const l=Math.round(e.duration/t.duration),u=Math.min(Math.round(n.loaded/s),l),d=(l-u)*Math.round(n.loaded/u);n.total=n.loaded+d}else n.total=Math.max(n.loaded,n.total);const a=n.loading,o=r.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function b0(i,e=null){const t=e||i,n={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(K(r)&&K(s)){var a;let o=r,l=s;if(i.sn==="initSegment"&&((a=i.decryptdata)==null?void 0:a.method)==="AES-128"){const u=s-r;u%16&&(l=s+(16-u%16)),r!==0&&(n.resetIV=!0,o=r-16)}n.rangeStart=o,n.rangeEnd=l}return n}function R0(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),n={type:ie.MEDIA_ERROR,details:k.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(n.part=e),(e||i).stats.aborted=!0,new hn(n)}class hn extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class qL{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class YL{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function jL(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?Ir(i,0,e-t):i}class zL{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let r=0;r<4;r++)n[r]=t.getUint32(r*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],s=n[1],a=n[2],o=n[3],l=this.invSubMix,u=l[0],c=l[1],d=l[2],h=l[3],f=new Uint32Array(256);let m=0,p=0,v=0;for(v=0;v<256;v++)v<128?f[v]=v<<1:f[v]=v<<1^283;for(v=0;v<256;v++){let g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^g&255^99,e[m]=g,t[g]=m;const E=f[m],y=f[E],_=f[y];let S=f[g]*257^g*16843008;r[m]=S<<24|S>>>8,s[m]=S<<16|S>>>16,a[m]=S<<8|S>>>24,o[m]=S,S=_*16843009^y*65537^E*257^m*16843008,u[g]=S<<24|S>>>8,c[g]=S<<16|S>>>16,d[g]=S<<8|S>>>24,h[g]=S,m?(m=E^f[f[f[_^E]]],p^=f[f[p]]):m=p=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const a=this.ksRows=(s+6+1)*4;let o,l;const u=this.keySchedule=new Uint32Array(a),c=this.invKeySchedule=new Uint32Array(a),d=this.sBox,h=this.rcon,f=this.invSubMix,m=f[0],p=f[1],v=f[2],g=f[3];let E,y;for(o=0;o<a;o++){if(o<s){E=u[o]=t[o];continue}y=E,o%s===0?(y=y<<8|y>>>24,y=d[y>>>24]<<24|d[y>>>16&255]<<16|d[y>>>8&255]<<8|d[y&255],y^=h[o/s|0]<<24):s>6&&o%s===4&&(y=d[y>>>24]<<24|d[y>>>16&255]<<16|d[y>>>8&255]<<8|d[y&255]),u[o]=E=(u[o-s]^y)>>>0}for(l=0;l<a;l++)o=a-l,l&3?y=u[o]:y=u[o-4],l<4||o<=4?c[l]=y:c[l]=m[d[y>>>24]]^p[d[y>>>16&255]]^v[d[y>>>8&255]]^g[d[y&255]],c[l]=c[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const r=this.keySize+6,s=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],u=o[1],c=o[2],d=o[3],h=this.uint8ArrayToUint32Array_(n);let f=h[0],m=h[1],p=h[2],v=h[3];const g=new Int32Array(e),E=new Int32Array(g.length);let y,_,S,b,A,w,P,R,D,j,$,X,q,W;const oe=this.networkToHostOrderSwap;for(;t<g.length;){for(D=oe(g[t]),j=oe(g[t+1]),$=oe(g[t+2]),X=oe(g[t+3]),A=D^s[0],w=X^s[1],P=$^s[2],R=j^s[3],q=4,W=1;W<r;W++)y=l[A>>>24]^u[w>>16&255]^c[P>>8&255]^d[R&255]^s[q],_=l[w>>>24]^u[P>>16&255]^c[R>>8&255]^d[A&255]^s[q+1],S=l[P>>>24]^u[R>>16&255]^c[A>>8&255]^d[w&255]^s[q+2],b=l[R>>>24]^u[A>>16&255]^c[w>>8&255]^d[P&255]^s[q+3],A=y,w=_,P=S,R=b,q=q+4;y=a[A>>>24]<<24^a[w>>16&255]<<16^a[P>>8&255]<<8^a[R&255]^s[q],_=a[w>>>24]<<24^a[P>>16&255]<<16^a[R>>8&255]<<8^a[A&255]^s[q+1],S=a[P>>>24]<<24^a[R>>16&255]<<16^a[A>>8&255]<<8^a[w&255]^s[q+2],b=a[R>>>24]<<24^a[A>>16&255]<<16^a[w>>8&255]<<8^a[P&255]^s[q+3],E[t]=oe(y^f),E[t+1]=oe(b^m),E[t+2]=oe(S^p),E[t+3]=oe(_^v),f=D,m=j,p=$,v=X,t=t+4}return E.buffer}}const QL=16;class Km{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?jL(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((r,s)=>{this.softwareDecrypt(new Uint8Array(e),t,n);const a=this.flush();a?r(a.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){const{currentIV:r,currentResult:s,remainderData:a}=this;this.logOnce("JS AES decrypt"),a&&(e=mi(a,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;r&&(n=r);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new zL),l.expandKey(t);const u=s;return this.currentResult=l.decrypt(o.buffer,0,n),this.currentIV=Ir(o,-16).buffer,u||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new YL(this.subtle,t)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new qL(this.subtle,new Uint8Array(n)).decrypt(e.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(I.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);const r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%QL;return n!==e.length&&(t=Ir(e,0,n),this.remainderData=Ir(e,n)),t}logOnce(e){this.logEnabled&&(I.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const XL={toString:function(i){let e="";const t=i.length;for(let n=0;n<t;n++)e+=`[${i.start(n).toFixed(3)}-${i.end(n).toFixed(3)}]`;return e}},N={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Wm extends UL{constructor(e,t,n,r,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=N.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=r,this.log=I.log.bind(I,`${r}:`),this.warn=I.warn.bind(I,`${r}:`),this.hls=e,this.fragmentLoader=new WL(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Km(e.config),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=N.STOPPED}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const n=t.partList;if(n!=null&&n.length){const s=n[n.length-1];return De.isBuffered(this.media,s.start+s.duration/2)}const r=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);const r=this.config;this.levels&&r.autoStartLoad&&this.state===N.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:n,mediaBuffer:r,state:s}=this,a=n?n.currentTime:0,o=De.bufferInfo(r||n,a,e.maxBufferHole);if(this.log(`media seeking to ${K(a)?a.toFixed(3):a}, state: ${s}`),this.state===N.ENDED)this.resetLoadingState();else if(t){const l=e.maxFragLookUpTolerance,u=t.start-l,c=t.start+t.duration+l;if(!o.len||c<o.start||u>o.end){const d=a>c;(a<u||d)&&(d&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),!this.loadedmetadata&&!o.len&&(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=N.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const r=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,n,r).then(s=>{if(!s)return;const a=this.state;if(this.fragContextChanged(e)){(a===N.FRAG_LOADING||!this.fragCurrent&&a===N.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=N.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(T.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===N.STOPPED||this.state===N.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===mt.APPENDING){const s=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,s),o=Math.max(e.duration,a?a.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(o,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===mt.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:n};this.hls.trigger(T.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:r}=this,{payload:s}=n,a=e.decryptdata;if(s&&s.byteLength>0&&a!=null&&a.key&&a.iv&&a.method==="AES-128"){const o=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),a.key.buffer,a.iv.buffer).catch(l=>{throw r.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{const u=self.performance.now();return r.trigger(T.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:o,tdecrypt:u}}),n.payload=l,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===N.STOPPED||this.state===N.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state=N.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,r,s,a;const o=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===ee.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((r=e.endPTS)!=null?r:NaN).toFixed(3)}] > buffer:${o?XL.toString(De.getBuffered(o)):"(detached)"})`),e.sn!=="initSegment"){var l;if(e.type!==ee.SUBTITLE){const c=e.elementaryStreams;if(!Object.keys(c).some(d=>!!c[d])){this.state=N.IDLE;return}}const u=(l=this.levels)==null?void 0:l[e.level];u!=null&&u.fragmentError&&(this.log(`Resetting level fragment error count of ${u.fragmentError} on frag buffered`),u.fragmentError=0)}this.state=N.IDLE,o&&(!this.loadedmetadata&&e.type==ee.MAIN&&o.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((a=this.fragPrevious)==null?void 0:a.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:r,partsLoaded:s}=e,a=!s||s.length===0||s.some(l=>!l),o=new Vm(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var s;const a=t==null?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=N.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(c=>{if(!this.fragContextChanged(c.frag))return this.hls.trigger(T.KEY_LOADED,c),this.state===N.KEY_LOADING&&(this.state=N.IDLE),c}),this.hls.trigger(T.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&a.encryptedFragments.length&&this.keyLoader.loadClear(e,a.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const c=a.partList;if(c&&r){n>e.end&&a.fragmentHint&&(e=a.fragmentHint);const d=this.getNextPart(c,e,n);if(d>-1){const h=c[d];this.log(`Loading part sn: ${e.sn} p: ${h.index} cc: ${e.cc} of playlist [${a.startSN}-${a.endSN}] parts [0-${d}-${c.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=h.start+h.duration,this.state=N.FRAG_LOADING;let f;return o?f=o.then(m=>!m||this.fragContextChanged(m.frag)?null:this.doFragPartsLoad(e,h,t,r)).catch(m=>this.handleFragLoadError(m)):f=this.doFragPartsLoad(e,h,t,r).catch(m=>this.handleFragLoadError(m)),this.hls.trigger(T.FRAG_LOADING,{frag:e,part:h,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):f}else if(!e.url||this.loadedEndOfParts(c,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${a?"of ["+a.startSN+"-"+a.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),K(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=N.FRAG_LOADING;const l=this.config.progressive;let u;return l&&o?u=o.then(c=>!c||this.fragContextChanged(c==null?void 0:c.frag)?null:this.fragmentLoader.load(e,r)).catch(c=>this.handleFragLoadError(c)):u=Promise.all([this.fragmentLoader.load(e,l?r:void 0),o]).then(([c])=>(!l&&c&&r&&r(c),c)).catch(c=>this.handleFragLoadError(c)),this.hls.trigger(T.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):u}doFragPartsLoad(e,t,n,r){return new Promise((s,a)=>{var o;const l=[],u=(o=n.details)==null?void 0:o.partList,c=d=>{this.fragmentLoader.loadPart(e,d,r).then(h=>{l[d.index]=h;const f=h.part;this.hls.trigger(T.FRAG_LOADED,h);const m=E0(n,e.sn,d.index+1)||zT(u,e.sn,d.index+1);if(m)c(m);else return s({frag:e,part:f,partsLoaded:l})}).catch(a)};c(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===k.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(T.ERROR,t)}else this.hls.trigger(T.ERROR,{type:ie.OTHER_ERROR,details:k.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==N.PARSING){!this.fragCurrent&&this.state!==N.STOPPED&&this.state!==N.ERROR&&(this.state=N.IDLE);return}const{frag:n,part:r,level:s}=t,a=self.performance.now();n.stats.parsing.end=a,r&&(r.stats.parsing.end=a),this.updateLevelTiming(n,r,s,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:r,sn:s,part:a}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${r}. The current chunk will not be buffered.`),null;const o=t[r],l=a>-1?E0(o,s,a):null,u=l?l.fragment:yL(o,s,n);return u?(n&&n!==u&&(u.stats=n.stats),{frag:u,part:l,level:o}):null}bufferFragmentData(e,t,n,r,s){var a;if(!e||this.state!==N.PARSING)return;const{data1:o,data2:l}=e;let u=o;if(o&&l&&(u=mi(o,l)),!((a=u)!=null&&a.length))return;const c={type:e.type,frag:t,part:n,chunkMeta:r,parent:t.type,data:u};if(this.hls.trigger(T.BUFFER_APPENDING,c),e.dropped&&e.independent&&!n){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!De.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,r=De.bufferInfo(t,n,0),s=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),o=Math.max(Math.min(e.start-a,r.end-a),n+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){const n=this.getLoadPosition();return K(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){const{config:{maxBufferHole:r}}=this,s=De.bufferInfo(e,t,r);if(s.len===0&&s.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,n);if(a&&s.nextStart<a.end)return De.bufferInfo(e,t,Math.max(s.nextStart,r))}return s}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,r=Math.max(Math.min(e-t,n.maxBufferLength),t),s=Math.max(e-t*3,n.maxMaxBufferLength/2,r);return s>=r?(n.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,t=ee.MAIN){const n=this.fragmentTracker.getAppendedFrag(e,ee.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,r=n.length;if(!r)return null;const{config:s}=this,a=n[0].start;let o;if(t.live){const l=s.initialLiveManifestSize;if(r<l)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${l})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a)&&(o=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=o?this.hls.liveSyncPosition||o.start:e)}else e<=a&&(o=n[0]);if(!o){const l=s.lowLatencyMode?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(o)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===mt.OK||n===mt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,s){const a=e.gap,o=this.getNextFragment(this.nextLoadPosition,t);if(o===null)return o;if(e=o,a&&e&&!e.gap&&n.nextStart){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r);if(l!==null&&n.len+l.len>=s)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let r=-1,s=!1,a=!0;for(let o=0,l=e.length;o<l;o++){const u=e[o];if(a=a&&!u.independent,r>-1&&n<u.start)break;const c=u.loaded;c?r=-1:(s||u.independent||a)&&u.fragment===t&&(r=o),s=c}return r}loadedEndOfParts(e,t){const n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){const n=this.fragPrevious;let r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=_L(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){const a=t[s-e.startSN];n.cc===a.cc&&(r=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=xL(t,n.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){const{config:r}=this;let{fragPrevious:s}=this,{fragments:a,endSN:o}=n;const{fragmentHint:l}=n,{maxFragLookUpTolerance:u}=r,c=n.partList,d=!!(r.lowLatencyMode&&c!=null&&c.length&&l);d&&l&&!this.bitrateTest&&(a=a.concat(l),o=l.sn);let h;if(e<t){const f=e>t-u?0:u;h=ic(s,a,e,f)}else h=a[a.length-1];if(h){const f=h.sn-n.startSN,m=this.fragmentTracker.getState(h);if((m===mt.OK||m===mt.PARTIAL&&h.gap)&&(s=h),s&&h.sn===s.sn&&(!d||c[0].fragment.sn>h.sn)&&s&&h.level===s.level){const v=a[f+1];h.sn<o&&this.fragmentTracker.getState(v)!==mt.OK?h=v:h=null}}return h}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const r=this.hls.liveSyncPosition,s=n.currentTime,a=e.fragments[0].start,o=e.edge,l=s>=a-t.maxFragLookUpTolerance&&s<=o;if(r!==null&&n.duration>r&&(s<r||!l)){const u=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||s<o-u)&&(this.loadedmetadata||(this.nextLoadPosition=r),n.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${r.toFixed(3)}`),n.currentTime=r))}}alignPlaylists(e,t,n){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const s=e.fragments[0].start,a=!t,o=e.alignedSliding&&K(s);if(a||!o&&!s){const{fragPrevious:l}=this;VL(l,n,e);const u=e.fragments[0].start;return this.log(`Live playlist sliding: ${u.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${l?l.sn:"na"} fragments: ${r}`),u}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){const r=this.startTimeOffset!==null,s=r?this.startTimeOffset:e.startTimeOffset;s!==null&&K(s)?(n=t+s,s<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${s} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==N.FRAG_LOADING_WAITING_RETRY)&&(this.state=N.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const c=this.getCurrentContext(t.chunkMeta);c&&(t.frag=c.frag)}const n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var r;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(r=this.fragCurrent)==null?void 0:r.url}`);return}const s=t.details===k.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);const a=t.errorAction,{action:o,retryCount:l=0,retryConfig:u}=a||{};if(a&&o===_t.RetryRequest&&u){this.resetStartWhenNotLoaded(this.levelLastLoaded);const c=Gm(u,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${u.maxNumRetry} in ${c}ms`),a.resolved=!0,this.retryDate=self.performance.now()+c,this.state=N.FRAG_LOADING_WAITING_RETRY}else if(u&&a)if(this.resetFragmentErrors(e),l<u.maxNumRetry)!s&&o!==_t.RemoveAlternatePermanently&&(a.resolved=!0);else{I.warn(`${t.details} reached or exceeded max retry (${l})`);return}else(a==null?void 0:a.action)===_t.SendAlternateToPenaltyBox?this.state=N.WAITING_LEVEL:this.state=N.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===N.PARSING||this.state===N.PARSED){const t=e.frag,n=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,n),s=r&&r.len>.5;s&&this.reduceMaxBufferLength(r.len,(t==null?void 0:t.duration)||10);const a=!s;return a&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===ee.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==N.STOPPED&&(this.state=N.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const r=De.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===N.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=N.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){var s;const a=n.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,u)=>{const c=e.elementaryStreams[u];if(c){const d=c.endPTS-c.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${d})`),l||!1;const h=r?0:YT(a,e,c.startPTS,c.endPTS,c.startDTS,c.endDTS);return this.hls.trigger(T.LEVEL_PTS_UPDATED,{details:a,level:n,drift:h,type:u,frag:e,start:c.startPTS,end:c.endPTS}),!0}return l},!1)&&((s=this.transmuxer)==null?void 0:s.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(n.fragmentError===0&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(l.message),this.hls.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=N.PARSED,this.hls.trigger(T.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class e_{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=ZL(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function ZL(i,e){const t=new Uint8Array(e);let n=0;for(let r=0;r<i.length;r++){const s=i[r];t.set(s,n),n+=s.length}return t}function JL(){return typeof __HLS_WORKER_BUNDLE__=="function"}function ek(){const i=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(i);return{worker:new self.Worker(e),objectURL:e}}function tk(i){const e=new self.URL(i,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function ji(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class qm{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=mi(this.cachedData,e),this.cachedData=null);let n=mo(e,0),r=n?n.length:0,s;const a=this._audioTrack,o=this._id3Track,l=n?Bm(n):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&K(l))&&(this.basePTS=ik(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:wi.audioId3,duration:Number.POSITIVE_INFINITY});r<u;){if(this.canParse(e,r)){const c=this.appendFrame(a,e,r);c?(this.frameIndex++,this.lastPTS=c.sample.pts,r+=c.length,s=r):r=u}else AI(e,r)?(n=mo(e,r),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:wi.audioId3,duration:Number.POSITIVE_INFINITY}),r+=n.length,s=r):r++;if(r===u&&s!==u){const c=Ir(e,s);this.cachedData?this.cachedData=mi(this.cachedData,c):this.cachedData=c}}return{audioTrack:a,videoTrack:ji(),id3Track:o,textTrack:ji()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:ji(),id3Track:this._id3Track,textTrack:ji()}}destroy(){}}const ik=(i,e,t)=>{if(K(i))return i*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function nk(i,e,t,n){let r,s,a,o;const l=navigator.userAgent.toLowerCase(),u=n,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=((e[t+2]&192)>>>6)+1;const d=(e[t+2]&60)>>>2;if(d>c.length-1){const h=new Error(`invalid ADTS sampling index:${d}`);i.emit(T.ERROR,T.ERROR,{type:ie.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!0,error:h,reason:h.message});return}return a=(e[t+2]&1)<<2,a|=(e[t+3]&192)>>>6,I.log(`manifest codec:${n}, ADTS type:${r}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(r=5,o=new Array(4),s=d-3):(r=2,o=new Array(2),s=d):l.indexOf("android")!==-1?(r=2,o=new Array(2),s=d):(r=5,o=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&d>=6?s=d-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(d>=6&&a===1||/vivaldi/i.test(l))||!n&&a===1)&&(r=2,o=new Array(2)),s=d)),o[0]=r<<3,o[0]|=(d&14)>>1,o[1]|=(d&1)<<7,o[1]|=a<<3,r===5&&(o[1]|=(s&14)>>1,o[2]=(s&1)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:c[d],channelCount:a,codec:"mp4a.40."+r,manifestCodec:u}}function t_(i,e){return i[e]===255&&(i[e+1]&246)===240}function i_(i,e){return i[e+1]&1?7:9}function Ym(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function rk(i,e){return e+5<i.length}function rc(i,e){return e+1<i.length&&t_(i,e)}function sk(i,e){return rk(i,e)&&t_(i,e)&&Ym(i,e)<=i.length-e}function ak(i,e){if(rc(i,e)){const t=i_(i,e);if(e+t>=i.length)return!1;const n=Ym(i,e);if(n<=t)return!1;const r=e+n;return r===i.length||rc(i,r)}return!1}function n_(i,e,t,n,r){if(!i.samplerate){const s=nk(e,t,n,r);if(!s)return;i.config=s.config,i.samplerate=s.samplerate,i.channelCount=s.channelCount,i.codec=s.codec,i.manifestCodec=s.manifestCodec,I.log(`parsed codec:${i.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function r_(i){return 1024*9e4/i}function ok(i,e){const t=i_(i,e);if(e+t<=i.length){const n=Ym(i,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function s_(i,e,t,n,r){const s=r_(i.samplerate),a=n+r*s,o=ok(e,t);let l;if(o){const{frameLength:d,headerLength:h}=o,f=h+d,m=Math.max(0,t+f-e.length);m?(l=new Uint8Array(f-h),l.set(e.subarray(t+h,e.length),0)):l=e.subarray(t+h,t+f);const p={unit:l,pts:a};return m||i.samples.push(p),{sample:p,length:f,missing:m}}const u=e.length-t;return l=new Uint8Array(u),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:a},length:u,missing:-1}}let sl=null;const lk=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],uk=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],ck=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],dk=[0,1,1,4];function a_(i,e,t,n,r){if(t+24>e.length)return;const s=o_(e,t);if(s&&t+s.frameLength<=e.length){const a=s.samplesPerFrame*9e4/s.sampleRate,o=n+r*a,l={unit:e.subarray(t,t+s.frameLength),pts:o,dts:o};return i.config=[],i.channelCount=s.channelCount,i.samplerate=s.sampleRate,i.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function o_(i,e){const t=i[e+1]>>3&3,n=i[e+1]>>1&3,r=i[e+2]>>4&15,s=i[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&s!==3){const a=i[e+2]>>1&1,o=i[e+3]>>6,l=t===3?3-n:n===3?3:4,u=lk[l*14+r-1]*1e3,d=uk[(t===3?0:t===2?1:2)*3+s],h=o===3?1:2,f=ck[t][n],m=dk[n],p=f*8*m,v=Math.floor(f*u/d+a)*m;if(sl===null){const y=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);sl=y?parseInt(y[1]):0}return!!sl&&sl<=87&&n===2&&u>=224e3&&o===0&&(i[e+3]=i[e+3]|128),{sampleRate:d,channelCount:h,frameLength:v,samplesPerFrame:p}}}function jm(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function l_(i,e){return e+1<i.length&&jm(i,e)}function hk(i,e){return jm(i,e)&&4<=i.length-e}function u_(i,e){if(e+1<i.length&&jm(i,e)){const n=o_(i,e);let r=4;n!=null&&n.frameLength&&(r=n.frameLength);const s=e+r;return s===i.length||l_(i,s)}return!1}class fk extends qm{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=mo(e,0);let n=(t==null?void 0:t.length)||0;if(u_(e,n))return!1;for(let r=e.length;n<r;n++)if(ak(e,n))return I.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return sk(e,t)}appendFrame(e,t,n){n_(e,this.observer,t,n,e.manifestCodec);const r=s_(e,t,n,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const mk=/\/emsg[-/]ID3/i;class pk{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){const s=this.videoTrack=ji("video",1),a=this.audioTrack=ji("audio",1),o=this.txtTrack=ji("text",1);if(this.id3Track=ji("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=$T(e);if(l.video){const{id:u,timescale:c,codec:d}=l.video;s.id=u,s.timescale=o.timescale=c,s.codec=d}if(l.audio){const{id:u,timescale:c,codec:d}=l.audio;a.id=u,a.timescale=c,a.codec=d}o.id=NT.text,s.sampleDuration=0,s.duration=a.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return CI(e)}demux(e,t){this.timeOffset=t;let n=e;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=mi(this.remainderData,e));const o=BI(n);this.remainderData=o.remainder,r.samples=o.valid||new Uint8Array}else r.samples=n;const a=this.extractID3Track(r,t);return s.samples=Jg(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return n.samples=Jg(e,t),{videoTrack:t,audioTrack:ji(),id3Track:r,textTrack:ji()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const r=ae(e.samples,["emsg"]);r&&r.forEach(s=>{const a=VI(s);if(mk.test(a.schemeIdUri)){const o=K(a.presentationTime)?a.presentationTime/a.timeScale:t+a.presentationTimeDelta/a.timeScale;let l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const u=a.payload;n.samples.push({data:u,len:u.byteLength,dts:o,pts:o,type:wi.emsg,duration:l})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const c_=(i,e)=>{let t=0,n=5;e+=n;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;n>0;){a[0]=i[e];const o=Math.min(n,8),l=8-o;s[0]=4278190080>>>24+l<<l,r[0]=(a[0]&s[0])>>l,t=t?t<<o|r[0]:r[0],e+=1,n-=o}return t};class gk extends qm{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const r=d_(e,t,n,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const t=mo(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&Bm(t)!==void 0&&c_(e,n)<16}}function d_(i,e,t,n,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const s=e[t+4]>>6;if(s>=3)return-1;const o=[48e3,44100,32e3][s],l=e[t+4]&63,c=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+s]*2;if(t+c>e.length)return-1;const d=e[t+6]>>5;let h=0;d===2?h+=2:(d&1&&d!==1&&(h+=2),d&4&&(h+=2));const f=(e[t+6]<<8|e[t+7])>>12-h&1,p=[2,1,2,3,3,4,4,5][d]+f,v=e[t+5]>>3,g=e[t+5]&7,E=new Uint8Array([s<<6|v<<1|g>>2,(g&3)<<6|d<<3|f<<2|l>>4,l<<4&224]),y=1536/o*9e4,_=n+r*y,S=e.subarray(t,t+c);return i.config=E,i.channelCount=p,i.samplerate=o,i.samples.push({unit:S,pts:_}),c}class vk{constructor(){this.VideoSample=null}createVideoSample(e,t,n,r){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:r,length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,r;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const s=n.units;r=s[s.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,r=n.length;if(r){const s=n[r-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&I.log(e.pts+"/"+e.dts+":"+e.debug)}}class w0{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");r.set(e.subarray(n,n+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&I.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,r;for(let s=0;s<e;s++)n!==0&&(r=this.readEG(),n=(t+r+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,r=0,s,a,o;const l=this.readUByte.bind(this),u=this.readBits.bind(this),c=this.readUEG.bind(this),d=this.readBoolean.bind(this),h=this.skipBits.bind(this),f=this.skipEG.bind(this),m=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);l();const v=l();if(u(5),h(3),l(),m(),v===100||v===110||v===122||v===244||v===44||v===83||v===86||v===118||v===128){const b=c();if(b===3&&h(1),m(),m(),h(1),d())for(a=b!==3?8:12,o=0;o<a;o++)d()&&(o<6?p(16):p(64))}m();const g=c();if(g===0)c();else if(g===1)for(h(1),f(),f(),s=c(),o=0;o<s;o++)f();m(),h(1);const E=c(),y=c(),_=u(1);_===0&&h(1),h(1),d()&&(e=c(),t=c(),n=c(),r=c());let S=[1,1];if(d()&&d())switch(l()){case 1:S=[1,1];break;case 2:S=[12,11];break;case 3:S=[10,11];break;case 4:S=[16,11];break;case 5:S=[40,33];break;case 6:S=[24,11];break;case 7:S=[20,11];break;case 8:S=[32,11];break;case 9:S=[80,33];break;case 10:S=[18,11];break;case 11:S=[15,11];break;case 12:S=[64,33];break;case 13:S=[160,99];break;case 14:S=[4,3];break;case 15:S=[3,2];break;case 16:S=[2,1];break;case 255:{S=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((E+1)*16-e*2-t*2),height:(2-_)*(y+1)*16-(_?2:4)*(n+r),pixelRatio:S}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class Ek extends vk{parseAVCPES(e,t,n,r,s){const a=this.parseAVCNALu(e,n.data);let o=this.VideoSample,l,u=!1;n.data=null,o&&a.length&&!e.audFound&&(this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),a.forEach(c=>{var d;switch(c.type){case 1:{let p=!1;l=!0;const v=c.data;if(u&&v.length>4){const g=new w0(v).readSliceType();(g===2||g===4||g===7||g===9)&&(p=!0)}if(p){var h;(h=o)!=null&&h.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null)}o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),o.frame=!0,o.key=p;break}case 5:l=!0,(d=o)!=null&&d.frame&&!o.key&&(this.pushAccessUnit(o,e),o=this.VideoSample=null),o||(o=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),o.key=!0,o.frame=!0;break;case 6:{l=!0,GT(c.data,1,n.pts,t.samples);break}case 7:{var f,m;l=!0,u=!0;const p=c.data,g=new w0(p).readSPS();if(!e.sps||e.width!==g.width||e.height!==g.height||((f=e.pixelRatio)==null?void 0:f[0])!==g.pixelRatio[0]||((m=e.pixelRatio)==null?void 0:m[1])!==g.pixelRatio[1]){e.width=g.width,e.height=g.height,e.pixelRatio=g.pixelRatio,e.sps=[p],e.duration=s;const E=p.subarray(1,4);let y="avc1.";for(let _=0;_<3;_++){let S=E[_].toString(16);S.length<2&&(S="0"+S),y+=S}e.codec=y}break}case 8:l=!0,e.pps=[c.data];break;case 9:l=!0,e.audFound=!0,o&&this.pushAccessUnit(o,e),o=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:l=!0;break;default:l=!1,o&&(o.debug+="unknown NAL "+c.type+" ");break}o&&l&&o.units.push(c)}),r&&o&&(this.pushAccessUnit(o,e),this.VideoSample=null)}parseAVCNALu(e,t){const n=t.byteLength;let r=e.naluState||0;const s=r,a=[];let o=0,l,u,c,d=-1,h=0;for(r===-1&&(d=0,h=t[0]&31,r=0,o=1);o<n;){if(l=t[o++],!r){r=l?0:1;continue}if(r===1){r=l?0:2;continue}if(!l)r=3;else if(l===1){if(u=o-r-1,d>=0){const f={data:t.subarray(d,u),type:h};a.push(f)}else{const f=this.getLastNalUnit(e.samples);f&&(s&&o<=4-s&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-s)),u>0&&(f.data=mi(f.data,t.subarray(0,u)),f.state=0))}o<n?(c=t[o]&31,d=o,h=c,r=0):r=-1}else r=0}if(d>=0&&r>=0){const f={data:t.subarray(d,n),type:h,state:r};a.push(f)}if(a.length===0){const f=this.getLastNalUnit(e.samples);f&&(f.data=mi(f.data,t))}return e.naluState=r,a}}class yk{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new Km(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){const r=e[t].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),a=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(a).then(o=>{const l=new Uint8Array(o);r.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)n.set(e.subarray(s,s+16),r);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(n.subarray(r,r+16),s);return e}decryptAvcSample(e,t,n,r,s){const a=HT(s.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)})}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){r();return}const s=e[t].units;for(;!(n>=s.length);n++){const a=s[n];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,n,r,a),!this.decrypter.isSync()))return}}}}const ut=188;class Fn{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new Ek}static probe(e){const t=Fn.syncOffset(e);return t>0&&I.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let n=Math.min(ut*5,t-ut)+1,r=0;for(;r<n;){let s=!1,a=-1,o=0;for(let l=r;l<t;l+=ut)if(e[l]===71&&(t-l===ut||e[l+ut]===71)){if(o++,a===-1&&(a=l,a!==0&&(n=Math.min(a+ut*99,e.length-ut)+1)),s||(s=sf(e,l)===0),s&&o>1&&(a===0&&o>2||l+ut>n))return a}else{if(o)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:NT[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Fn.createTrack("video"),this._audioTrack=Fn.createTrack("audio",r),this._id3Track=Fn.createTrack("id3"),this._txtTrack=Fn.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=r}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,r=!1){n||(this.sampleAes=null);let s;const a=this._videoTrack,o=this._audioTrack,l=this._id3Track,u=this._txtTrack;let c=a.pid,d=a.pesData,h=o.pid,f=l.pid,m=o.pesData,p=l.pesData,v=null,g=this.pmtParsed,E=this._pmtId,y=e.length;if(this.remainderData&&(e=mi(this.remainderData,e),y=e.length,this.remainderData=null),y<ut&&!r)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};const _=Math.max(0,Fn.syncOffset(e));y-=(y-_)%ut,y<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,y,e.buffer.byteLength-y));let S=0;for(let A=_;A<y;A+=ut)if(e[A]===71){const w=!!(e[A+1]&64),P=sf(e,A),R=(e[A+3]&48)>>4;let D;if(R>1){if(D=A+5+e[A+4],D===A+ut)continue}else D=A+4;switch(P){case c:w&&(d&&(s=zr(d))&&this.videoParser.parseAVCPES(a,u,s,!1,this._duration),d={data:[],size:0}),d&&(d.data.push(e.subarray(D,A+ut)),d.size+=A+ut-D);break;case h:if(w){if(m&&(s=zr(m)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,s);break;case"mp3":this.parseMPEGPES(o,s);break;case"ac3":this.parseAC3PES(o,s);break}m={data:[],size:0}}m&&(m.data.push(e.subarray(D,A+ut)),m.size+=A+ut-D);break;case f:w&&(p&&(s=zr(p))&&this.parseID3PES(l,s),p={data:[],size:0}),p&&(p.data.push(e.subarray(D,A+ut)),p.size+=A+ut-D);break;case 0:w&&(D+=e[D]+1),E=this._pmtId=Tk(e,D);break;case E:{w&&(D+=e[D]+1);const j=_k(e,D,this.typeSupported,n,this.observer);c=j.videoPid,c>0&&(a.pid=c,a.segmentCodec=j.segmentVideoCodec),h=j.audioPid,h>0&&(o.pid=h,o.segmentCodec=j.segmentAudioCodec),f=j.id3Pid,f>0&&(l.pid=f),v!==null&&!g&&(I.warn(`MPEG-TS PMT found at ${A} after unknown PID '${v}'. Backtracking to sync byte @${_} to parse all TS packets.`),v=null,A=_-188),g=this.pmtParsed=!0;break}case 17:case 8191:break;default:v=P;break}}else S++;S>0&&sc(this.observer,new Error(`Found ${S} TS packet/s that do not start with 0x47`)),a.pesData=d,o.pesData=m,l.pesData=p;const b={audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};return r&&this.extractRemainingSamples(b),b}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:r,textTrack:s}=e,a=n.pesData,o=t.pesData,l=r.pesData;let u;if(a&&(u=zr(a))?(this.videoParser.parseAVCPES(n,s,u,!0,this._duration),n.pesData=null):n.pesData=a,o&&(u=zr(o))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else o!=null&&o.size&&I.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;l&&(u=zr(l))?(this.parseID3PES(r,u),r.pesData=null):r.pesData=l}demuxSampleAes(e,t,n){const r=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new yk(this.observer,this.config,t);return this.decrypt(r,s)}decrypt(e,t){return new Promise(n=>{const{audioTrack:r,videoTrack:s}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let n=0;const r=this.aacOverFlow;let s=t.data;if(r){this.aacOverFlow=null;const d=r.missing,h=r.sample.unit.byteLength;if(d===-1)s=mi(r.sample.unit,s);else{const f=h-d;r.sample.unit.set(s.subarray(0,d),f),e.samples.push(r.sample),n=r.missing}}let a,o;for(a=n,o=s.length;a<o-1&&!rc(s,a);a++);if(a!==n){let d;const h=a<o-1;if(h?d=`AAC PES did not start with ADTS header,offset:${a}`:d="No ADTS header found in AAC PES",sc(this.observer,new Error(d),h),!h)return}n_(e,this.observer,s,a,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(r){const d=r_(e.samplerate);l=r.sample.pts+d}else{I.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,c;for(;a<o;)if(c=s_(e,s,a,l,u),a+=c.length,c.missing){this.aacOverFlow=c;break}else for(u++;a<o-1&&!rc(s,a);a++);}parseMPEGPES(e,t){const n=t.data,r=n.length;let s=0,a=0;const o=t.pts;if(o===void 0){I.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<r;)if(l_(n,a)){const l=a_(e,n,a,o,s);if(l)a+=l.length,s++;else break}else a++}parseAC3PES(e,t){{const n=t.data,r=t.pts;if(r===void 0){I.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=n.length;let a=0,o=0,l;for(;o<s&&(l=d_(e,n,o,r,a++))>0;)o+=l}}parseID3PES(e,t){if(t.pts===void 0){I.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=nt({},t,{type:this._videoTrack?wi.emsg:wi.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function sf(i,e){return((i[e+1]&31)<<8)+i[e+2]}function Tk(i,e){return(i[e+10]&31)<<8|i[e+11]}function _k(i,e,t,n,r){const s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},a=(i[e+1]&15)<<8|i[e+2],o=e+3+a-4,l=(i[e+10]&15)<<8|i[e+11];for(e+=12+l;e<o;){const u=sf(i,e),c=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!n){Ud("ADTS AAC");break}case 15:s.audioPid===-1&&(s.audioPid=u);break;case 21:s.id3Pid===-1&&(s.id3Pid=u);break;case 219:if(!n){Ud("H.264");break}case 27:s.videoPid===-1&&(s.videoPid=u,s.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?I.log("MPEG audio found, not supported in this browser"):s.audioPid===-1&&(s.audioPid=u,s.segmentAudioCodec="mp3");break;case 193:if(!n){Ud("AC-3");break}case 129:t.ac3?s.audioPid===-1&&(s.audioPid=u,s.segmentAudioCodec="ac3"):I.log("AC-3 audio found, not supported in this browser");break;case 6:if(s.audioPid===-1&&c>0){let d=e+5,h=c;for(;h>2;){switch(i[d]){case 106:t.ac3!==!0?I.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=u,s.segmentAudioCodec="ac3");break}const m=i[d+1]+2;d+=m,h-=m}}break;case 194:case 135:return sc(r,new Error("Unsupported EC-3 in M2TS found")),s;case 36:return sc(r,new Error("Unsupported HEVC in M2TS found")),s}e+=c+5}return s}function sc(i,e,t){I.warn(`parsing error: ${e.message}`),i.emit(T.ERROR,T.ERROR,{type:ie.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Ud(i){I.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function zr(i){let e=0,t,n,r,s,a;const o=i.data;if(!i||i.size===0)return null;for(;o[0].length<19&&o.length>1;)o[0]=mi(o[0],o[1]),o.splice(1,1);if(t=o[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>i.size-6)return null;const u=t[7];u&192&&(s=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,u&64?(a=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,s-a>60*9e4&&(I.warn(`${Math.round((s-a)/9e4)}s delta between PTS and DTS, align them`),s=a)):a=s),r=t[8];let c=r+9;if(i.size<=c)return null;i.size-=c;const d=new Uint8Array(i.size);for(let h=0,f=o.length;h<f;h++){t=o[h];let m=t.byteLength;if(c)if(c>m){c-=m;continue}else t=t.subarray(c),m-=c,c=0;d.set(t,e),e+=m}return n&&(n-=r+3),{data:d,pts:s,dts:a,len:n}}return null}class Sk extends qm{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=mo(e,0);let n=(t==null?void 0:t.length)||0;if(t&&e[n]===11&&e[n+1]===119&&Bm(t)!==void 0&&c_(e,n)<=16)return!1;for(let r=e.length;n<r;n++)if(u_(e,n))return I.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return hk(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return a_(e,t,n,this.basePTS,this.frameIndex)}}class I0{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const In=Math.pow(2,32)-1;class L{static init(){L.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in L.types)L.types.hasOwnProperty(e)&&(L.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);L.HDLR_TYPES={video:t,audio:n};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);L.STTS=L.STSC=L.STCO=s,L.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),L.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),L.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),L.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);L.FTYP=L.box(L.types.ftyp,a,l,a,o),L.DINF=L.box(L.types.dinf,L.box(L.types.dref,r))}static box(e,...t){let n=8,r=t.length;const s=r;for(;r--;)n+=t[r].byteLength;const a=new Uint8Array(n);for(a[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=n&255,a.set(e,4),r=0,n=8;r<s;r++)a.set(t[r],n),n+=t[r].byteLength;return a}static hdlr(e){return L.box(L.types.hdlr,L.HDLR_TYPES[e])}static mdat(e){return L.box(L.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(In+1)),r=Math.floor(t%(In+1));return L.box(L.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return L.box(L.types.mdia,L.mdhd(e.timescale,e.duration),L.hdlr(e.type),L.minf(e))}static mfhd(e){return L.box(L.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?L.box(L.types.minf,L.box(L.types.smhd,L.SMHD),L.DINF,L.stbl(e)):L.box(L.types.minf,L.box(L.types.vmhd,L.VMHD),L.DINF,L.stbl(e))}static moof(e,t,n){return L.box(L.types.moof,L.mfhd(e),L.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=L.trak(e[t]);return L.box.apply(null,[L.types.moov,L.mvhd(e[0].timescale,e[0].duration)].concat(n).concat(L.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=L.trex(e[t]);return L.box.apply(null,[L.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(In+1)),r=Math.floor(t%(In+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return L.box(L.types.mvhd,s)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let r,s;for(r=0;r<t.length;r++)s=t[r].flags,n[r+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return L.box(L.types.sdtp,n)}static stbl(e){return L.box(L.types.stbl,L.stsd(e),L.box(L.types.stts,L.STTS),L.box(L.types.stsc,L.STSC),L.box(L.types.stsz,L.STSZ),L.box(L.types.stco,L.STCO))}static avc1(e){let t=[],n=[],r,s,a;for(r=0;r<e.sps.length;r++)s=e.sps[r],a=s.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(s));for(r=0;r<e.pps.length;r++)s=e.pps[r],a=s.byteLength,n.push(a>>>8&255),n.push(a&255),n=n.concat(Array.prototype.slice.call(s));const o=L.box(L.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),l=e.width,u=e.height,c=e.pixelRatio[0],d=e.pixelRatio[1];return L.box(L.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,L.box(L.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),L.box(L.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return L.box(L.types.mp4a,L.audioStsd(e),L.box(L.types.esds,L.esds(e)))}static mp3(e){return L.box(L.types[".mp3"],L.audioStsd(e))}static ac3(e){return L.box(L.types["ac-3"],L.audioStsd(e),L.box(L.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?L.box(L.types.stsd,L.STSD,L.mp3(e)):e.segmentCodec==="ac3"?L.box(L.types.stsd,L.STSD,L.ac3(e)):L.box(L.types.stsd,L.STSD,L.mp4a(e)):L.box(L.types.stsd,L.STSD,L.avc1(e))}static tkhd(e){const t=e.id,n=e.duration*e.timescale,r=e.width,s=e.height,a=Math.floor(n/(In+1)),o=Math.floor(n%(In+1));return L.box(L.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const n=L.sdtp(e),r=e.id,s=Math.floor(t/(In+1)),a=Math.floor(t%(In+1));return L.box(L.types.traf,L.box(L.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),L.box(L.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255])),L.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,L.box(L.types.trak,L.tkhd(e),L.mdia(e))}static trex(e){const t=e.id;return L.box(L.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],r=n.length,s=12+16*r,a=new Uint8Array(s);let o,l,u,c,d,h;for(t+=8+s,a.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),o=0;o<r;o++)l=n[o],u=l.duration,c=l.size,d=l.flags,h=l.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&61440,d.degradPrio&15,h>>>24&255,h>>>16&255,h>>>8&255,h&255],12+16*o);return L.box(L.types.trun,a)}static initSegment(e){L.types||L.init();const t=L.moov(e);return mi(L.FTYP,t)}}L.types=void 0;L.HDLR_TYPES=void 0;L.STTS=void 0;L.STSC=void 0;L.STCO=void 0;L.STSZ=void 0;L.VMHD=void 0;L.SMHD=void 0;L.STSD=void 0;L.FTYP=void 0;L.DINF=void 0;const h_=9e4;function zm(i,e,t=1,n=!1){const r=i*e*t;return n?Math.round(r):r}function Ak(i,e,t=1,n=!1){return zm(i,e,1/t,n)}function fa(i,e=!1){return zm(i,1e3,1/h_,e)}function xk(i,e=1){return zm(i,h_,1/e)}const bk=10*1e3,L0=1024,Rk=1152,wk=1536;let Qr=null,$d=null;class Gl{constructor(e,t,n,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,Qr===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Qr=a?parseInt(a[1]):0}if($d===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);$d=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){I.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){I.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){I.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,r=e.reduce((s,a)=>{let o=a.pts,l=o-s;return l<-4294967296&&(t=!0,o=ai(o,n),l=o-s),l>0?s:o},n);return t&&I.debug("PTS rollover detected"),r}remux(e,t,n,r,s,a,o,l){let u,c,d,h,f,m,p=s,v=s;const g=e.pid>-1,E=t.pid>-1,y=t.samples.length,_=e.samples.length>0,S=o&&y>0||y>1;if((!g||_)&&(!E||S)||this.ISGenerated||o){if(this.ISGenerated){var A,w,P,R;const X=this.videoTrackConfig;X&&(t.width!==X.width||t.height!==X.height||((A=t.pixelRatio)==null?void 0:A[0])!==((w=X.pixelRatio)==null?void 0:w[0])||((P=t.pixelRatio)==null?void 0:P[1])!==((R=X.pixelRatio)==null?void 0:R[1]))&&this.resetInitSegment()}else d=this.generateIS(e,t,s,a);const D=this.isVideoContiguous;let j=-1,$;if(S&&(j=Ik(t.samples),!D&&this.config.forceKeyFrameOnDiscontinuity))if(m=!0,j>0){I.warn(`[mp4-remuxer]: Dropped ${j} out of ${y} video samples due to a missing keyframe`);const X=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(j),t.dropped+=j,v+=(t.samples[0].pts-X)/t.inputTimeScale,$=v}else j===-1&&(I.warn(`[mp4-remuxer]: No keyframe found out of ${y} video samples`),m=!1);if(this.ISGenerated){if(_&&S){const X=this.getVideoStartPts(t.samples),W=(ai(e.samples[0].pts,X)-X)/t.inputTimeScale;p+=Math.max(0,W),v+=Math.max(0,-W)}if(_){if(e.samplerate||(I.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,s,a)),c=this.remuxAudio(e,p,this.isAudioContiguous,a,E||S||l===ee.AUDIO?v:void 0),S){const X=c?c.endPTS-c.startPTS:0;t.inputTimeScale||(I.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,s,a)),u=this.remuxVideo(t,v,D,X)}}else S&&(u=this.remuxVideo(t,v,D,0));u&&(u.firstKeyFrame=j,u.independent=j!==-1,u.firstKeyFramePTS=$)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(f=f_(n,s,this._initPTS,this._initDTS)),r.samples.length&&(h=m_(r,s,this._initPTS))),{audio:c,video:u,initSegment:d,independent:m,text:h,id3:f}}generateIS(e,t,n,r){const s=e.samples,a=t.samples,o=this.typeSupported,l={},u=this._initPTS;let c=!u||r,d="audio/mp4",h,f,m;if(c&&(h=f=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(d="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):L.initSegment([e]),metadata:{channelCount:e.channelCount}},c&&(m=e.inputTimeScale,!u||m!==u.timescale?h=f=s[0].pts-Math.round(m*n):c=!1)}if(t.sps&&t.pps&&a.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:L.initSegment([t]),metadata:{width:t.width,height:t.height}},c)if(m=t.inputTimeScale,!u||m!==u.timescale){const p=this.getVideoStartPts(a),v=Math.round(m*n);f=Math.min(f,ai(a[0].dts,p)-v),h=Math.min(h,p-v)}else c=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,c?(this._initPTS={baseTime:h,timescale:m},this._initDTS={baseTime:f,timescale:m}):h=m=void 0,{tracks:l,initPTS:h,timescale:m}}remuxVideo(e,t,n,r){const s=e.inputTimeScale,a=e.samples,o=[],l=a.length,u=this._initPTS;let c=this.nextAvcDts,d=8,h=this.videoSampleDuration,f,m,p=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,g=!1;if(!n||c===null){const O=t*s,M=a[0].pts-ai(a[0].dts,a[0].pts);Qr&&c!==null&&Math.abs(O-M-c)<15e3?n=!0:c=O-M}const E=u.baseTime*s/u.timescale;for(let O=0;O<l;O++){const M=a[O];M.pts=ai(M.pts-E,c),M.dts=ai(M.dts-E,c),M.dts<a[O>0?O-1:O].dts&&(g=!0)}g&&a.sort(function(O,M){const G=O.dts-M.dts,Y=O.pts-M.pts;return G||Y}),f=a[0].dts,m=a[a.length-1].dts;const y=m-f,_=y?Math.round(y/(l-1)):h||e.inputTimeScale/30;if(n){const O=f-c,M=O>_,G=O<-1;if((M||G)&&(M?I.warn(`AVC: ${fa(O,!0)} ms (${O}dts) hole between fragments detected at ${t.toFixed(3)}`):I.warn(`AVC: ${fa(-O,!0)} ms (${O}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!G||c>=a[0].pts||Qr)){f=c;const Y=a[0].pts-O;if(M)a[0].dts=f,a[0].pts=Y;else for(let le=0;le<a.length&&!(a[le].dts>Y);le++)a[le].dts-=O,a[le].pts-=O;I.log(`Video: Initial PTS/DTS adjusted: ${fa(Y,!0)}/${fa(f,!0)}, delta: ${fa(O,!0)} ms`)}}f=Math.max(0,f);let S=0,b=0,A=f;for(let O=0;O<l;O++){const M=a[O],G=M.units,Y=G.length;let le=0;for(let me=0;me<Y;me++)le+=G[me].data.length;b+=le,S+=Y,M.length=le,M.dts<A?(M.dts=A,A+=_/4|0||1):A=M.dts,p=Math.min(M.pts,p),v=Math.max(M.pts,v)}m=a[l-1].dts;const w=b+4*S+8;let P;try{P=new Uint8Array(w)}catch(O){this.observer.emit(T.ERROR,T.ERROR,{type:ie.MUX_ERROR,details:k.REMUX_ALLOC_ERROR,fatal:!1,error:O,bytes:w,reason:`fail allocating video mdat ${w}`});return}const R=new DataView(P.buffer);R.setUint32(0,w),P.set(L.types.mdat,4);let D=!1,j=Number.POSITIVE_INFINITY,$=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,q=Number.NEGATIVE_INFINITY;for(let O=0;O<l;O++){const M=a[O],G=M.units;let Y=0;for(let we=0,be=G.length;we<be;we++){const ze=G[we],Rn=ze.data,Kr=ze.data.byteLength;R.setUint32(d,Kr),d+=4,P.set(Rn,d),d+=Kr,Y+=4+Kr}let le;if(O<l-1)h=a[O+1].dts-M.dts,le=a[O+1].pts-M.pts;else{const we=this.config,be=O>0?M.dts-a[O-1].dts:_;if(le=O>0?M.pts-a[O-1].pts:_,we.stretchShortVideoTrack&&this.nextAudioPts!==null){const ze=Math.floor(we.maxBufferHole*s),Rn=(r?p+r*s:this.nextAudioPts)-M.pts;Rn>ze?(h=Rn-be,h<0?h=be:D=!0,I.log(`[mp4-remuxer]: It is approximately ${Rn/90} ms to the next segment; using duration ${h/90} ms for the last video frame.`)):h=be}else h=be}const me=Math.round(M.pts-M.dts);j=Math.min(j,h),X=Math.max(X,h),$=Math.min($,le),q=Math.max(q,le),o.push(new k0(M.key,h,Y,me))}if(o.length){if(Qr){if(Qr<70){const O=o[0].flags;O.dependsOn=2,O.isNonSync=0}}else if($d&&q-$<X-j&&_/X<.025&&o[0].cts===0){I.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let O=f;for(let M=0,G=o.length;M<G;M++){const Y=O+o[M].duration,le=O+o[M].cts;if(M<G-1){const me=Y+o[M+1].cts;o[M].duration=me-le}else o[M].duration=M?o[M-1].duration:_;o[M].cts=0,O=Y}}}h=D||!h?_:h,this.nextAvcDts=c=m+h,this.videoSampleDuration=h,this.isVideoContiguous=!0;const F={data1:L.moof(e.sequenceNumber++,f,nt({},e,{samples:o})),data2:P,startPTS:p/s,endPTS:(v+h)/s,startDTS:f/s,endDTS:c/s,type:"video",hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,F}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return Rk;case"ac3":return wk;default:return L0}}remuxAudio(e,t,n,r,s){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,l=a/o,u=this.getSamplesPerFrame(e),c=u*l,d=this._initPTS,h=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,f=[],m=s!==void 0;let p=e.samples,v=h?0:8,g=this.nextAudioPts||-1;const E=t*a,y=d.baseTime*a/d.timescale;if(this.isAudioContiguous=n=n||p.length&&g>0&&(r&&Math.abs(E-g)<9e3||Math.abs(ai(p[0].pts-y,E)-g)<20*c),p.forEach(function(W){W.pts=ai(W.pts-y,E)}),!n||g<0){if(p=p.filter(W=>W.pts>=0),!p.length)return;s===0?g=0:r&&!m?g=Math.max(0,E):g=p[0].pts}if(e.segmentCodec==="aac"){const W=this.config.maxAudioFramesDrift;for(let oe=0,F=g;oe<p.length;oe++){const O=p[oe],M=O.pts,G=M-F,Y=Math.abs(1e3*G/a);if(G<=-W*c&&m)oe===0&&(I.warn(`Audio frame @ ${(M/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*G/a)} ms.`),this.nextAudioPts=g=F=M);else if(G>=W*c&&Y<bk&&m){let le=Math.round(G/c);F=M-le*c,F<0&&(le--,F+=c),oe===0&&(this.nextAudioPts=g=F),I.warn(`[mp4-remuxer]: Injecting ${le} audio frame @ ${(F/a).toFixed(3)}s due to ${Math.round(1e3*G/a)} ms gap.`);for(let me=0;me<le;me++){const we=Math.max(F,0);let be=I0.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);be||(I.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),be=O.unit.subarray()),p.splice(oe,0,{unit:be,pts:we}),F+=c,oe++}}O.pts=F,F+=c}}let _=null,S=null,b,A=0,w=p.length;for(;w--;)A+=p[w].unit.byteLength;for(let W=0,oe=p.length;W<oe;W++){const F=p[W],O=F.unit;let M=F.pts;if(S!==null){const Y=f[W-1];Y.duration=Math.round((M-S)/l)}else if(n&&e.segmentCodec==="aac"&&(M=g),_=M,A>0){A+=v;try{b=new Uint8Array(A)}catch(Y){this.observer.emit(T.ERROR,T.ERROR,{type:ie.MUX_ERROR,details:k.REMUX_ALLOC_ERROR,fatal:!1,error:Y,bytes:A,reason:`fail allocating audio mdat ${A}`});return}h||(new DataView(b.buffer).setUint32(0,A),b.set(L.types.mdat,4))}else return;b.set(O,v);const G=O.byteLength;v+=G,f.push(new k0(!0,u,G,0)),S=M}const P=f.length;if(!P)return;const R=f[f.length-1];this.nextAudioPts=g=S+l*R.duration;const D=h?new Uint8Array(0):L.moof(e.sequenceNumber++,_/l,nt({},e,{samples:f}));e.samples=[];const j=_/a,$=g/a,q={data1:D,data2:b,startPTS:j,endPTS:$,startDTS:j,endDTS:$,type:"audio",hasAudio:!0,hasVideo:!1,nb:P};return this.isAudioContiguous=!0,q}remuxEmptyAudio(e,t,n,r){const s=e.inputTimeScale,a=e.samplerate?e.samplerate:s,o=s/a,l=this.nextAudioPts,u=this._initDTS,c=u.baseTime*9e4/u.timescale,d=(l!==null?l:r.startDTS*s)+c,h=r.endDTS*s+c,f=o*L0,m=Math.ceil((h-d)/f),p=I0.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(I.warn("[mp4-remuxer]: remux empty Audio"),!p){I.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const v=[];for(let g=0;g<m;g++){const E=d+g*f;v.push({unit:p,pts:E,dts:E})}return e.samples=v,this.remuxAudio(e,t,n,!1)}}function ai(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function Ik(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function f_(i,e,t,n){const r=i.samples.length;if(!r)return;const s=i.inputTimeScale;for(let o=0;o<r;o++){const l=i.samples[o];l.pts=ai(l.pts-t.baseTime*s/t.timescale,e*s)/s,l.dts=ai(l.dts-n.baseTime*s/n.timescale,e*s)/s}const a=i.samples;return i.samples=[],{samples:a}}function m_(i,e,t){const n=i.samples.length;if(!n)return;const r=i.inputTimeScale;for(let a=0;a<n;a++){const o=i.samples[a];o.pts=ai(o.pts-t.baseTime*r/t.timescale,e*r)/r}i.samples.sort((a,o)=>a.pts-o.pts);const s=i.samples;return i.samples=[],{samples:s}}class k0{constructor(e,t,n,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=r,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class Lk{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(OI(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const r=this.initData=$T(e);r.audio&&(t=D0(r.audio,Ae.AUDIO)),r.video&&(n=D0(r.video,Ae.VIDEO));const s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:r.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?s.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:I.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,n,r,s,a){var o,l;let{initPTS:u,lastEndTime:c}=this;const d={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};K(c)||(c=this.lastEndTime=s||0);const h=t.samples;if(!(h!=null&&h.length))return d;const f={initPTS:void 0,timescale:1};let m=this.initData;if((o=m)!=null&&o.length||(this.generateInitSegment(h),m=this.initData),!((l=m)!=null&&l.length))return I.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);const p=FI(h,m),v=NI(m,h),g=v===null?s:v;(kk(u,g,s,p)||f.timescale!==u.timescale&&a)&&(f.initPTS=g-s,u&&u.timescale===1&&I.warn(`Adjusting initPTS by ${f.initPTS-u.baseTime}`),this.initPTS=u={baseTime:f.initPTS,timescale:1});const E=e?g-u.baseTime/u.timescale:c,y=E+p;$I(m,h,u.baseTime/u.timescale),p>0?this.lastEndTime=y:(I.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const _=!!m.audio,S=!!m.video;let b="";_&&(b+="audio"),S&&(b+="video");const A={data1:h,startPTS:E,startDTS:E,endPTS:y,endDTS:y,type:b,hasAudio:_,hasVideo:S,nb:1,dropped:0};return d.audio=A.type==="audio"?A:void 0,d.video=A.type!=="audio"?A:void 0,d.initSegment=f,d.id3=f_(n,s,u,u),r.samples.length&&(d.text=m_(r,s,u)),d}}function kk(i,e,t,n){if(i===null)return!0;const r=Math.max(n,1),s=e-i.baseTime/i.timescale;return Math.abs(s-t)>r}function D0(i,e){const t=i==null?void 0:i.codec;if(t&&t.length>4)return t;if(e===Ae.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return Zu(t,!1);const n="mp4a.40.5";return I.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${n}"`),n}return I.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let fn;try{fn=self.performance.now.bind(self.performance)}catch{I.debug("Unable to use Performance API on this environment"),fn=Ws==null?void 0:Ws.Date.now}const Hl=[{demux:pk,remux:Lk},{demux:Fn,remux:Gl},{demux:fk,remux:Gl},{demux:Sk,remux:Gl}];Hl.splice(2,0,{demux:gk,remux:Gl});class C0{constructor(e,t,n,r,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){const s=n.transmuxing;s.executeStart=fn();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:l}=this;r&&(this.currentTransmuxState=r);const{contiguous:u,discontinuity:c,trackSwitch:d,accurateTimeOffset:h,timeOffset:f,initSegmentChange:m}=r||o,{audioCodec:p,videoCodec:v,defaultInitPts:g,duration:E,initSegmentData:y}=l,_=Dk(a,t);if(_&&_.method==="AES-128"){const w=this.getDecrypter();if(w.isSync()){let P=w.softwareDecrypt(a,_.key.buffer,_.iv.buffer);if(n.part>-1&&(P=w.flush()),!P)return s.executeEnd=fn(),Bd(n);a=new Uint8Array(P)}else return this.decryptionPromise=w.webCryptoDecrypt(a,_.key.buffer,_.iv.buffer).then(P=>{const R=this.push(P,null,n);return this.decryptionPromise=null,R}),this.decryptionPromise}const S=this.needsProbing(c,d);if(S){const w=this.configureTransmuxer(a);if(w)return I.warn(`[transmuxer] ${w.message}`),this.observer.emit(T.ERROR,T.ERROR,{type:ie.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,fatal:!1,error:w,reason:w.message}),s.executeEnd=fn(),Bd(n)}(c||d||m||S)&&this.resetInitSegment(y,p,v,E,t),(c||m||S)&&this.resetInitialTimestamp(g),u||this.resetContiguity();const b=this.transmux(a,_,f,h,n),A=this.currentTransmuxState;return A.contiguous=!0,A.discontinuity=!1,A.trackSwitch=!1,s.executeEnd=fn(),b}flush(e){const t=e.transmuxing;t.executeStart=fn();const{decrypter:n,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const a=[],{timeOffset:o}=r;if(n){const d=n.flush();d&&a.push(this.push(d,null,e))}const{demuxer:l,remuxer:u}=this;if(!l||!u)return t.executeEnd=fn(),[Bd(e)];const c=l.flush(o);return Vl(c)?c.then(d=>(this.flushRemux(a,d,e),a)):(this.flushRemux(a,c,e),a)}flushRemux(e,t,n){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=t,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;I.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);const c=this.remuxer.remux(r,s,a,o,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:n}),n.transmuxing.executeEnd=fn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,s){const{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,t,n,r),o.resetInitSegment(e,t,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,s){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,n,r,s):a=this.transmuxUnencrypted(e,n,r,s),a}transmuxUnencrypted(e,t,n,r){const{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,a,o,l,t,n,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,n,r,s){return this.demuxer.demuxSampleAes(e,t,n).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,n,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:r,vendor:s}=this;let a;for(let h=0,f=Hl.length;h<f;h++){var o;if((o=Hl[h].demux)!=null&&o.probe(e)){a=Hl[h];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,u=this.remuxer,c=a.remux,d=a.demux;(!u||!(u instanceof c))&&(this.remuxer=new c(n,t,r,s)),(!l||!(l instanceof d))&&(this.demuxer=new d(n,t,r),this.probe=d.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Km(this.config)),e}}function Dk(i,e){let t=null;return i.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Bd=i=>({remuxResult:{},chunkMeta:i});function Vl(i){return"then"in i&&i.then instanceof Function}class Ck{constructor(e,t,n,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=s||null}}class Pk{constructor(e,t,n,r,s,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=a}}var p_={exports:{}};(function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function s(l,u,c,d,h){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new r(c,d||l,h),m=t?t+u:u;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],f]:l._events[m].push(f):(l._events[m]=f,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,d;if(this._eventsCount===0)return u;for(d in c=this._events)e.call(c,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=t?t+u:u,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,m=new Array(f);h<f;h++)m[h]=d[h].fn;return m},o.prototype.listenerCount=function(u){var c=t?t+u:u,d=this._events[c];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,c,d,h,f,m){var p=t?t+u:u;if(!this._events[p])return!1;var v=this._events[p],g=arguments.length,E,y;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),g){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,c),!0;case 3:return v.fn.call(v.context,c,d),!0;case 4:return v.fn.call(v.context,c,d,h),!0;case 5:return v.fn.call(v.context,c,d,h,f),!0;case 6:return v.fn.call(v.context,c,d,h,f,m),!0}for(y=1,E=new Array(g-1);y<g;y++)E[y-1]=arguments[y];v.fn.apply(v.context,E)}else{var _=v.length,S;for(y=0;y<_;y++)switch(v[y].once&&this.removeListener(u,v[y].fn,void 0,!0),g){case 1:v[y].fn.call(v[y].context);break;case 2:v[y].fn.call(v[y].context,c);break;case 3:v[y].fn.call(v[y].context,c,d);break;case 4:v[y].fn.call(v[y].context,c,d,h);break;default:if(!E)for(S=1,E=new Array(g-1);S<g;S++)E[S-1]=arguments[S];v[y].fn.apply(v[y].context,E)}}return!0},o.prototype.on=function(u,c,d){return s(this,u,c,d,!1)},o.prototype.once=function(u,c,d){return s(this,u,c,d,!0)},o.prototype.removeListener=function(u,c,d,h){var f=t?t+u:u;if(!this._events[f])return this;if(!c)return a(this,f),this;var m=this._events[f];if(m.fn)m.fn===c&&(!h||m.once)&&(!d||m.context===d)&&a(this,f);else{for(var p=0,v=[],g=m.length;p<g;p++)(m[p].fn!==c||h&&!m[p].once||d&&m[p].context!==d)&&v.push(m[p]);v.length?this._events[f]=v.length===1?v[0]:v:a(this,f)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&a(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,i.exports=o})(p_);var Mk=p_.exports,Qm=nI(Mk);class g_{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;const a=(u,c)=>{c=c||{},c.frag=this.frag,c.id=this.id,u===T.ERROR&&(this.error=c.error),this.hls.trigger(u,c)};this.observer=new Qm,this.observer.on(T.FRAG_DECRYPTED,a),this.observer.on(T.ERROR,a);const o=Ur(s.preferManagedMediaSource)||{isTypeSupported:()=>!1},l={mpeg:o.isTypeSupported("audio/mpeg"),mp3:o.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:o.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||JL())){try{s.workerPath?(I.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=tk(s.workerPath)):(I.log(`injecting Web Worker for "${t}"`),this.workerContext=ek()),this.onwmsg=d=>this.onWorkerMessage(d);const{worker:c}=this.workerContext;c.addEventListener("message",this.onwmsg),c.onerror=d=>{const h=new Error(`${d.message}  (${d.filename}:${d.lineno})`);s.enableWorker=!1,I.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(T.ERROR,{type:ie.OTHER_ERROR,details:k.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:h})},c.postMessage({cmd:"init",typeSupported:l,vendor:"",id:t,config:JSON.stringify(s)})}catch(c){I.warn(`Error setting up "${t}" Web Worker, fallback to inline`,c),this.resetWorker(),this.error=null,this.transmuxer=new C0(this.observer,l,s,"",t)}return}this.transmuxer=new C0(this.observer,l,s,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,r,s,a,o,l,u,c){var d,h;u.transmuxing.start=self.performance.now();const{transmuxer:f}=this,m=a?a.start:s.start,p=s.decryptdata,v=this.frag,g=!(v&&s.cc===v.cc),E=!(v&&u.level===v.level),y=v?u.sn-v.sn:-1,_=this.part?u.part-this.part.index:-1,S=y===0&&u.id>1&&u.id===(v==null?void 0:v.stats.chunkCount),b=!E&&(y===1||y===0&&(_===1||S&&_<=0)),A=self.performance.now();(E||y||s.stats.parsing.start===0)&&(s.stats.parsing.start=A),a&&(_||!b)&&(a.stats.parsing.start=A);const w=!(v&&((d=s.initSegment)==null?void 0:d.url)===((h=v.initSegment)==null?void 0:h.url)),P=new Pk(g,b,l,E,m,w);if(!b||g||w){I.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${u.sn} p: ${u.part} level: ${u.level} id: ${u.id}
        discontinuity: ${g}
        trackSwitch: ${E}
        contiguous: ${b}
        accurateTimeOffset: ${l}
        timeOffset: ${m}
        initSegmentChange: ${w}`);const R=new Ck(n,r,t,o,c);this.configureTransmuxer(R)}if(this.frag=s,this.part=a,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:p,chunkMeta:u,state:P},e instanceof ArrayBuffer?[e]:[]);else if(f){const R=f.push(e,p,u,P);Vl(R)?(f.async=!0,R.then(D=>{this.handleTransmuxComplete(D)}).catch(D=>{this.transmuxerError(D,u,"transmuxer-interface push error")})):(f.async=!1,this.handleTransmuxComplete(R))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);Vl(n)||t.async?(Vl(n)||(n=Promise.resolve(n)),n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(!(t!=null&&t.event)){I.warn(`worker message received with no ${t?"event name":"data"}`);return}const n=this.hls;if(this.hls)switch(t.event){case"init":{var r;const s=(r=this.workerContext)==null?void 0:r.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":I[t.data.logType]&&I[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const P0=100;class Ok extends Wm{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",ee.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(T.ERROR,this.onError,this),e.on(T.BUFFER_RESET,this.onBufferReset,this),e.on(T.BUFFER_CREATED,this.onBufferCreated,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(T.ERROR,this.onError,this),e.off(T.BUFFER_RESET,this.onBufferReset,this),e.off(T.BUFFER_CREATED,this.onBufferCreated,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s}){if(n==="main"){const a=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${a} found from main: ${r}`),this.videoTrackCC=a,this.state===N.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=N.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(P0),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=N.IDLE):(this.loadedmetadata=!1,this.state=N.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case N.IDLE:this.doTickIdle();break;case N.WAITING_TRACK:{var e;const{levels:n,trackId:r}=this,s=n==null||(e=n[r])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=N.WAITING_INIT_PTS}break}case N.FRAG_LOADING_WAITING_RETRY:{var t;const n=performance.now(),r=this.retryDate;if(!r||n>=r||(t=this.media)!=null&&t.seeking){const{levels:s,trackId:a}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((s==null?void 0:s[a])||null),this.state=N.IDLE}break}case N.WAITING_INIT_PTS:{const n=this.waitingData;if(n){const{frag:r,part:s,cache:a,complete:o}=n;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=N.FRAG_LOADING;const l=a.flush(),u={frag:r,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),o&&super._handleFragmentLoadComplete(u)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${r.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const l=this.getLoadPosition(),u=De.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);rf(u.end,this.config.maxFragLookUpTolerance,r)<0&&(this.log(`Waiting fragment cc (${r.cc}) @ ${r.start} cancelled because another fragment at ${u.end} is needed`),this.clearWaitingFragment())}}else this.state=N.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=N.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:n,trackId:r}=this,s=e.config;if(!this.buffering||!n&&(this.startFragRequested||!s.startFragPrefetch)||!(t!=null&&t[r]))return;const a=t[r],o=a.details;if(!o||o.live&&this.levelLastLoaded!==a||this.waitForCdnTuneIn(o)){this.state=N.WAITING_TRACK;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,Ae.AUDIO,ee.AUDIO));const u=this.getFwdBufferInfo(l,ee.AUDIO);if(u===null)return;if(!this.switchingTrack&&this._streamEnded(u,o)){e.trigger(T.BUFFER_EOS,{type:"audio"}),this.state=N.ENDED;return}const c=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,ee.MAIN),d=u.len,h=this.getMaxBufferLength(c==null?void 0:c.len),f=o.fragments,m=f[0].start,p=this.getLoadPosition(),v=this.flushing?p:u.end;if(this.switchingTrack&&n){const _=p;o.PTSKnown&&_<m&&(u.end>m||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=m+.05)}if(d>=h&&!this.switchingTrack&&v<f[f.length-1].start)return;let g=this.getNextFragment(v,o),E=!1;if(g&&this.isLoopLoading(g,v)&&(E=!!g.gap,g=this.getNextFragmentLoopLoading(g,o,u,ee.MAIN,h)),!g){this.bufferFlushed=!0;return}const y=c&&g.start>c.end+o.targetduration;if(y||!(c!=null&&c.len)&&u.len){const _=this.getAppendedFrag(g.start,ee.MAIN);if(_===null||(E||(E=!!_.gap||!!y&&c.len===0),y&&!E||E&&u.nextStart&&u.nextStart<_.end))return}this.loadFragment(g,a,v)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new qs(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?this.setInterval(P0):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=N.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=N.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(T.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:r}=this,{details:s,id:a}=t;if(!r){this.warn(`Audio tracks were reset while loading level ${a}`);return}this.log(`Audio track ${a} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const o=r[a];let l=0;if(s.live||(n=o.details)!=null&&n.live){this.checkLiveUpdate(s);const c=this.mainDetails;if(s.deltaUpdateFailed||!c)return;if(!o.details&&s.hasProgramDateTime&&c.hasProgramDateTime)nc(s,c),l=s.fragments[0].start;else{var u;l=this.alignPlaylists(s,o.details,(u=this.levelLastLoaded)==null?void 0:u.details)}}o.details=s,this.levelLastLoaded=o,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(this.mainDetails||s,l),this.state===N.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=N.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:s}=e,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const u=l[o];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const c=u.details;if(!c){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const d=a.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new g_(this.hls,ee.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const f=this.initPTS[n.cc],m=(t=n.initSegment)==null?void 0:t.data;if(f!==void 0){const v=r?r.index:-1,g=v!==-1,E=new Vm(n.level,n.sn,n.stats.chunkCount,s.byteLength,v,g);h.push(s,m,d,"",n,r,c.totalduration,!1,E,f)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${c.startSN} ,${c.endSN}],track ${o}`);const{cache:p}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new e_,complete:!1};p.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=N.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n.type!==ee.AUDIO){if(!this.loadedmetadata&&n.type===ee.MAIN){const s=this.videoBuffer||this.media;s&&De.getBuffered(s).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(T.AUDIO_TRACK_SWITCHED,vt({},s)))}this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal){this.state=N.ERROR;return}switch(t.details){case k.FRAG_GAP:case k.FRAG_PARSING_ERROR:case k.FRAG_DECRYPT_ERROR:case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ee.AUDIO,t);break;case k.AUDIO_TRACK_LOAD_ERROR:case k.AUDIO_TRACK_LOAD_TIMEOUT:case k.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===N.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===fe.AUDIO_TRACK&&(this.state=N.IDLE);break;case k.BUFFER_APPEND_ERROR:case k.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===k.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case k.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Ae.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Ae.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===N.ENDED&&(this.state=N.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,ee.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:r}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:c}=o,{details:d}=c,{audio:h,text:f,id3:m,initSegment:p}=s;if(this.fragContextChanged(l)||!d){this.fragmentTracker.removeFragment(l);return}if(this.state=N.PARSING,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),p!=null&&p.tracks){const v=l.initSegment||l;this._bufferInitSegment(c,p.tracks,v,a),r.trigger(T.FRAG_PARSING_INIT_SEGMENT,{frag:v,id:n,tracks:p.tracks})}if(h){const{startPTS:v,endPTS:g,startDTS:E,endDTS:y}=h;u&&(u.elementaryStreams[Ae.AUDIO]={startPTS:v,endPTS:g,startDTS:E,endDTS:y}),l.setElementaryStreamInfo(Ae.AUDIO,v,g,E,y),this.bufferFragmentData(h,l,u,a)}if(m!=null&&(t=m.samples)!=null&&t.length){const v=nt({id:n,frag:l,details:d},m);r.trigger(T.FRAG_PARSING_METADATA,v)}if(f){const v=nt({id:n,frag:l,details:d},f);r.trigger(T.FRAG_PARSING_USERDATA,v)}}_bufferInitSegment(e,t,n,r){if(this.state!==N.PARSING)return;t.video&&delete t.video;const s=t.audio;if(!s)return;s.id="audio";const a=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${a}/${s.codec}]`),a&&a.split(",").length===1&&(s.levelCodec=a),this.hls.trigger(T.BUFFER_CODECS,t);const o=s.initSegment;if(o!=null&&o.byteLength){const l={type:"audio",frag:n,part:null,chunkMeta:r,parent:n.type,data:o};this.hls.trigger(T.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||r===mt.NOT_LOADED||r===mt.PARTIAL){var s;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=N.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragments[0].start!==t.details.fragments[0].start&&nc(t.details,a)}else this.startFragRequested=!0,super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:r,characteristics:s,audioCodec:a,channels:o}=this.bufferedTrack;Lr({name:t,lang:n,assocLang:r,characteristics:s,audioCodec:a,channels:o},e,fr)||(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(T.AUDIO_TRACK_SWITCHED,vt({},e))}}function v_(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!vo(i[t].attrs,e[t].attrs))return!1;return!0}function vo(i,e,t){const n=i["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>i[r]!==e[r])}function af(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}class Nk extends Hm{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVEL_LOADING,this.onLevelLoading,this),e.off(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(T.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:r,details:s}=t,a=this.tracksInGroup[n];if(!a||a.groupId!==r){this.warn(`Audio track with id:${n} and group:${r} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Audio track ${n} "${a.name}" lang:${a.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,r=this.groupIds;let s=this.currentTrack;if(!n||(r==null?void 0:r.length)!==(n==null?void 0:n.length)||n!=null&&n.some(o=>(r==null?void 0:r.indexOf(o))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(h=>!n||n.indexOf(h.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(h=>h.default)&&(this.selectDefaultTrack=!1),o.forEach((h,f)=>{h.id=f});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const l=this.hls.config.audioPreference;if(!s&&l){const h=Zi(l,o,fr);if(h>-1)s=o[h];else{const f=Zi(l,this.tracks);s=this.tracks[f]}}let u=this.findTrackId(s);u===-1&&s&&(u=this.findTrackId(null));const c={audioTracks:o};this.log(`Updating audio tracks, ${o.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(T.AUDIO_TRACKS_UPDATED,c);const d=this.trackId;if(u!==-1&&d===-1)this.setAudioTrack(u);else if(o.length&&d===-1){var a;const h=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${o.length}`);this.warn(h.message),this.hls.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:h})}}else this.shouldReloadPlaylist(s)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===fe.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const r=this.currentTrack;if(r&&Lr(e,r,fr))return r;const s=Zi(e,this.tracksInGroup,fr);if(s>-1){const a=this.tracksInGroup[s];return this.setAudioTrack(s),a}else if(r){let a=t.loadLevel;a===-1&&(a=t.firstAutoLevel);const o=NL(e,t.levels,n,a,fr);if(o===-1)return null;t.nextLoadLevel=o}if(e.channels||e.audioCodec){const a=Zi(e,n);if(a>-1)return n[a]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e],s=r.details&&!r.details.live;if(e===this.trackId&&r===n&&s||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(T.AUDIO_TRACK_SWITCHING,vt({},r)),s))return;const a=this.switchParams(r.url,n==null?void 0:n.details,r.details);this.loadPlaylist(a)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(!(this.selectDefaultTrack&&!r.default)&&(!e||Lr(e,r,fr)))return n}if(e){const{name:n,lang:r,assocLang:s,characteristics:a,audioCodec:o,channels:l}=e;for(let u=0;u<t.length;u++){const c=t[u];if(Lr({name:n,lang:r,assocLang:s,characteristics:a,audioCodec:o,channels:l},c,fr))return u}for(let u=0;u<t.length;u++){const c=t[u];if(vo(e.attrs,c.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const c=t[u];if(vo(e.attrs,c.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const n=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(T.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:e||null})}}}const M0=500;class Fk extends Wm{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",ee.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.ERROR,this.onError,this),e.on(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(T.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(T.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.ERROR,this.onError,this),e.off(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(T.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(T.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=N.IDLE,this.setInterval(M0),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:r}=t;if(this.fragPrevious=n,this.state=N.IDLE,!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let a;const o=n.start;for(let u=0;u<s.length;u++)if(o>=s[u].start&&o<=s[u].end){a=s[u];break}const l=n.start+n.duration;a?a.end=l:(a={start:o,end:l},s.push(a)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){const{startOffset:n,endOffset:r}=t;if(n===0&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(a=>{for(let o=0;o<a.length;){if(a[o].end<=s){a.shift();continue}else if(a[o].start<s)a[o].start=s;else break;o++}}),this.fragmentTracker.removeFragmentsInRange(n,s,ee.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===ee.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const n=t.frag;(n==null?void 0:n.type)===ee.SUBTITLE&&(t.details===k.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==N.STOPPED&&(this.state=N.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&v_(this.levels,t)){this.levels=t.map(n=>new qs(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const r=new qs(n);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ee.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(M0)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:r,levels:s}=this,{details:a,id:o}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${o}`);return}const l=s[o];if(o>=s.length||!l)return;this.log(`Subtitle track ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(a.live||(n=l.details)!=null&&n.live){const d=this.mainDetails;if(a.deltaUpdateFailed||!d)return;const h=d.fragments[0];if(!l.details)a.hasProgramDateTime&&d.hasProgramDateTime?(nc(a,d),u=a.fragments[0].start):h&&(u=h.start,nf(a,u));else{var c;u=this.alignPlaylists(a,l.details,(c=this.levelLastLoaded)==null?void 0:c.details),u===0&&h&&(u=h.start,nf(a,u))}}l.details=a,this.levelLastLoaded=l,o===r&&(!this.startFragRequested&&(this.mainDetails||!a.live)&&this.setStartPosition(this.mainDetails||a,u),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===N.IDLE&&(ic(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,r=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r!=null&&r.key&&r.iv&&r.method==="AES-128"){const a=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer).catch(o=>{throw s.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:t}),o}).then(o=>{const l=performance.now();s.trigger(T.FRAG_DECRYPTED,{frag:t,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=N.IDLE})}}doTick(){if(!this.media){this.state=N.IDLE;return}if(this.state===N.IDLE){const{currentTrackId:e,levels:t}=this,n=t==null?void 0:t[e];if(!n||!t.length||!n.details)return;const{config:r}=this,s=this.getLoadPosition(),a=De.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:o,len:l}=a,u=this.getFwdBufferInfo(this.media,ee.MAIN),c=n.details,d=this.getMaxBufferLength(u==null?void 0:u.len)+c.levelTargetDuration;if(l>d)return;const h=c.fragments,f=h.length,m=c.edge;let p=null;const v=this.fragPrevious;if(o<m){const g=r.maxFragLookUpTolerance,E=o>m-g?0:g;p=ic(v,h,Math.max(h[0].start,o),E),!p&&v&&v.start<h[0].start&&(p=h[0])}else p=h[f-1];if(!p)return;if(p=this.mapToInitFragWhenRequired(p),p.sn!=="initSegment"){const g=p.sn-c.startSN,E=h[g-1];E&&E.cc===p.cc&&this.fragmentTracker.getState(E)===mt.NOT_LOADED&&(p=E)}this.fragmentTracker.getState(p)===mt.NOT_LOADED&&this.loadFragment(p,n,o)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new Uk(this.tracksBuffered[this.currentTrackId]||[])}}class Uk{constructor(e){this.buffered=void 0;const t=(n,r,s)=>{if(r=r>>>0,r>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}class $k extends Hm{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=Ul(this.media.textTracks);for(let s=0;s<n.length;s++)if(n[s].mode==="hidden")t=n[s];else if(n[s].mode==="showing"){t=n[s];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVEL_LOADING,this.onLevelLoading,this),e.off(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(T.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Ul(this.media.textTracks).forEach(t=>{Rs(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:r,details:s}=t,a=this.tracksInGroup[n];if(!a||a.groupId!==r){this.warn(`Subtitle track with id:${n} and group:${r} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Subtitle track ${n} "${a.name}" lang:${a.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,r=this.groupIds;let s=this.currentTrack;if(!n||(r==null?void 0:r.length)!==(n==null?void 0:n.length)||n!=null&&n.some(a=>(r==null?void 0:r.indexOf(a))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(c=>!n||n.indexOf(c.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(c=>c.default)&&(this.selectDefaultTrack=!1),a.forEach((c,d)=>{c.id=d});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const o=this.hls.config.subtitlePreference;if(!s&&o){this.selectDefaultTrack=!1;const c=Zi(o,a);if(c>-1)s=a[c];else{const d=Zi(o,this.tracks);s=this.tracks[d]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));const u={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(T.SUBTITLE_TRACKS_UPDATED,u),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}else this.shouldReloadPlaylist(s)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const s=t[r];if(!(n&&!s.default||!n&&!e)&&(!e||Lr(s,e)))return r}if(e){for(let r=0;r<t.length;r++){const s=t[r];if(vo(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){const s=t[r];if(vo(e.attrs,s.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(af(r,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===fe.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Lr(e,n))return n;const r=Zi(e,this.tracksInGroup);if(r>-1){const s=this.tracksInGroup[r];return this.setSubtitleTrack(r),s}else{if(n)return null;{const s=Zi(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const n=t.id,r=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(T.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=Ul(e.textTracks),n=this.currentTrack;let r;if(n&&(r=t.filter(s=>af(n,s))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==r&&(s.mode="disabled")}),r){const s=this.subtitleDisplay?"showing":"hidden";r.mode!==s&&(r.mode=s)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!K(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(T.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&s)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:a,groupId:o="",name:l,type:u,url:c}=r;this.hls.trigger(T.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:u,url:c});const d=this.switchParams(r.url,n==null?void 0:n.details,r.details);this.loadPlaylist(d)}}class Bk{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){const r=this.queues[t];r.push(e),r.length===1&&!n&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const n=new Promise(s=>{t=s}),r={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,e),n}executeNext(e){const t=this.queues[e];if(t.length){const n=t[0];try{n.execute()}catch(r){I.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${r}`),n.onError(r);const s=this.buffers[e];s!=null&&s.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const O0=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class Gk{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=n=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:n,mediaSource:r}=this;this.log("Media source opened"),n&&(n.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(T.MEDIA_ATTACHED,{media:n,mediaSource:r})),r&&r.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:r}=this;n!==r&&I.error(`Media element src was set while attaching MediaSource (${r} > ${n})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=QI(Ur(e.config.preferManagedMediaSource)),this.log=I.log.bind(I,t),this.warn=I.warn.bind(I,t),this.error=I.error.bind(I,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.BUFFER_RESET,this.onBufferReset,this),e.on(T.BUFFER_APPENDING,this.onBufferAppending,this),e.on(T.BUFFER_CODECS,this.onBufferCodecs,this),e.on(T.BUFFER_EOS,this.onBufferEos,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(T.FRAG_PARSED,this.onFragParsed,this),e.on(T.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.BUFFER_RESET,this.onBufferReset,this),e.off(T.BUFFER_APPENDING,this.onBufferAppending,this),e.off(T.BUFFER_CODECS,this.onBufferCodecs,this),e.off(T.BUFFER_EOS,this.onBufferEos,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(T.FRAG_PARSED,this.onFragParsed,this),e.off(T.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new Bk(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const n=this.media=t.media,r=Ur(this.appendSource);if(n&&r){var s;const a=this.mediaSource=new r;this.log(`created media source: ${(s=a.constructor)==null?void 0:s.name}`),a.addEventListener("sourceopen",this._onMediaSourceOpen),a.addEventListener("sourceended",this._onMediaSourceEnded),a.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.addEventListener("startstreaming",this._onStartStreaming),a.addEventListener("endstreaming",this._onEndStreaming));const o=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{n.removeAttribute("src");const l=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||l&&a instanceof l,N0(n),Hk(n,o),n.load()}catch{n.src=o}else n.src=o;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(r){this.warn(`onMediaDetaching: ${r.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&N0(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(T.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer(),this.hls.resumeBuffering()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var n;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(r){this.warn(`onBufferReset ${e}`,r)}}onBufferCodecs(e,t){const n=this.getSourceBufferTypes().length,r=Object.keys(t);if(r.forEach(a=>{if(n){const l=this.tracks[a];if(l&&typeof l.buffer.changeType=="function"){var o;const{id:u,codec:c,levelCodec:d,container:h,metadata:f}=t[a],m=n0(l.codec,l.levelCodec),p=m==null?void 0:m.replace(O0,"$1");let v=n0(c,d);const g=(o=v)==null?void 0:o.replace(O0,"$1");if(v&&p!==g){a.slice(0,5)==="audio"&&(v=Zu(v,this.appendSource));const E=`${h};codecs=${v}`;this.appendChangeType(a,E),this.log(`switching codec ${m} to ${v}`),this.tracks[a]={buffer:l.buffer,codec:c,container:h,levelCodec:d,metadata:f,id:u}}}}else this.pendingTracks[a]=t[a]}),n)return;const s=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==s&&(this.log(`${s} bufferCodec event(s) expected ${r.join(",")}`),this.bufferCodecEventsExpected=s),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:n}=this,r={execute:()=>{const s=this.sourceBuffer[e];s&&(this.log(`changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{this.warn(`Failed to change ${e} SourceBuffer type`,s)}};n.append(r,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:n,operationQueue:r,tracks:s}=this,{data:a,type:o,frag:l,part:u,chunkMeta:c}=t,d=c.buffering[o],h=self.performance.now();d.start=h;const f=l.stats.buffering,m=u?u.stats.buffering:null;f.start===0&&(f.start=h),m&&m.start===0&&(m.start=h);const p=s.audio;let v=!1;o==="audio"&&(p==null?void 0:p.container)==="audio/mpeg"&&(v=!this.lastMpegAudioChunk||c.id===1||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);const g=l.start,E={execute:()=>{if(d.executeStart=self.performance.now(),v){const y=this.sourceBuffer[o];if(y){const _=g-y.timestampOffset;Math.abs(_)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${g} (delta: ${_}) sn: ${l.sn})`),y.timestampOffset=g)}}this.appendExecutor(a,o)},onStart:()=>{},onComplete:()=>{const y=self.performance.now();d.executeEnd=d.end=y,f.first===0&&(f.first=y),m&&m.first===0&&(m.first=y);const{sourceBuffer:_}=this,S={};for(const b in _)S[b]=De.getBuffered(_[b]);this.appendErrors[o]=0,o==="audio"||o==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(T.BUFFER_APPENDED,{type:o,frag:l,part:u,chunkMeta:c,parent:l.type,timeRanges:S})},onError:y=>{const _={type:ie.MEDIA_ERROR,parent:l.type,details:k.BUFFER_APPEND_ERROR,sourceBufferName:o,frag:l,part:u,chunkMeta:c,error:y,err:y,fatal:!1};if(y.code===DOMException.QUOTA_EXCEEDED_ERR)_.details=k.BUFFER_FULL_ERROR;else{const S=++this.appendErrors[o];_.details=k.BUFFER_APPEND_ERROR,this.warn(`Failed ${S}/${n.config.appendErrorMaxRetry} times to append segment in "${o}" sourceBuffer`),S>=n.config.appendErrorMaxRetry&&(_.fatal=!0)}n.trigger(T.ERROR,_)}};r.append(E,o,!!this.pendingTracks[o])}onBufferFlushing(e,t){const{operationQueue:n}=this,r=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(T.BUFFER_FLUSHED,{type:s})},onError:a=>{this.warn(`Failed to remove from ${s} SourceBuffer`,a)}});t.type?n.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{n.append(r(s),s)})}onFragParsed(e,t){const{frag:n,part:r}=t,s=[],a=r?r.elementaryStreams:n.elementaryStreams;a[Ae.AUDIOVIDEO]?s.push("audiovideo"):(a[Ae.AUDIO]&&s.push("audio"),a[Ae.VIDEO]&&s.push("video"));const o=()=>{const l=self.performance.now();n.stats.buffering.end=l,r&&(r.stats.buffering.end=l);const u=r?r.stats:n.stats;this.hls.trigger(T.FRAG_BUFFERED,{frag:n,part:r,stats:u,id:n.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(o,s)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((r,s)=>{const a=this.sourceBuffer[s];return a&&(!t.type||t.type===s)&&(a.ending=!0,a.ended||(a.ended=!0,this.log(`${s} sourceBuffer now EOS`))),r&&!!(!a||a.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const a=this.sourceBuffer[s];a&&(a.ending=!1)});const{mediaSource:r}=this;if(!r||r.readyState!=="open"){r&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${r.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),r.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.getSourceBufferTypes().length)return;const s=e.config,a=n.currentTime,o=t.levelTargetDuration,l=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(K(l)&&l>0){const u=Math.max(l,o),c=Math.floor(a/o)*o-u;this.flushBackBuffer(a,o,c)}if(K(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const u=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),c=Math.max(u,o),d=Math.floor(a/o)*o+c;this.flushFrontBuffer(a,o,d)}}flushBackBuffer(e,t,n){const{details:r,sourceBuffer:s}=this;this.getSourceBufferTypes().forEach(o=>{const l=s[o];if(l){const u=De.getBuffered(l);if(u.length>0&&n>u.start(0)){if(this.hls.trigger(T.BACK_BUFFER_REACHED,{bufferEnd:n}),r!=null&&r.live)this.hls.trigger(T.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(l.ended&&u.end(u.length-1)-e<t*2){this.log(`Cannot flush ${o} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(T.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:o})}}})}flushFrontBuffer(e,t,n){const{sourceBuffer:r}=this;this.getSourceBufferTypes().forEach(a=>{const o=r[a];if(o){const l=De.getBuffered(o),u=l.length;if(u<2)return;const c=l.start(u-1),d=l.end(u-1);if(n>c||e>=c&&e<=d)return;if(o.ended&&e-d<2*t){this.log(`Cannot flush ${a} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(T.BUFFER_FLUSHING,{startOffset:c,endOffset:1/0,type:a})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:n,mediaSource:r}=this,s=e.fragments[0].start+e.totalduration,a=n.duration,o=K(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(r.duration=1/0,this.updateSeekableRange(e)):(s>o&&s>a||!K(a))&&(this.log(`Updating Media Source duration to ${s.toFixed(3)}`),r.duration=s)}updateSeekableRange(e){const t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){const s=Math.max(0,n[0].start),a=Math.max(s,s+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${s}-${a}.`),t.setLiveSeekableRange(s,a)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,r=Object.keys(n).length;if(r&&(!e||r===2||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(T.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(a=>{t.executeNext(a)});else{const a=new Error("could not create source buffer for media codec(s)");this.hls.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:a,reason:a.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(const s in e)if(!t[s]){var r;const a=e[s];if(!a)throw Error(`source buffer exists for track ${s}, however track does not`);let o=((r=a.levelCodec)==null?void 0:r.indexOf(","))===-1?a.levelCodec:a.codec;o&&s.slice(0,5)==="audio"&&(o=Zu(o,this.appendSource));const l=`${a.container};codecs=${o}`;this.log(`creating sourceBuffer(${l})`);try{const u=t[s]=n.addSourceBuffer(l),c=s;this.addBufferListener(c,"updatestart",this._onSBUpdateStart),this.addBufferListener(c,"updateend",this._onSBUpdateEnd),this.addBufferListener(c,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(c,"bufferedchange",(d,h)=>{const f=h.removedRanges;f!=null&&f.length&&this.hls.trigger(T.BUFFER_FLUSHED,{type:s})}),this.tracks[s]={buffer:u,codec:o,container:a.container,levelCodec:a.levelCodec,metadata:a.metadata,id:a.id}}catch(u){this.error(`error while trying to add sourceBuffer: ${u.message}`),this.hls.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:u,sourceBufferName:s,mimeType:l})}}}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n==null?void 0:n.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${r}`,t),this.hls.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const s=this.operationQueue.current(e);s&&s.onError(r)}removeExecutor(e,t,n){const{media:r,mediaSource:s,operationQueue:a,sourceBuffer:o}=this,l=o[e];if(!r||!s||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(e);return}const u=K(r.duration)?r.duration:1/0,c=K(s.duration)?s.duration:1/0,d=Math.max(0,t),h=Math.min(n,u,c);h>d&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${d},${h}] from the ${e} SourceBuffer`),l.remove(d,h)):a.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.sourceBuffer[t];if(!n){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}n.ended=!1,n.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:n}=this,r=t.map(s=>n.appendBlocker(s));Promise.all(r).then(()=>{e(),t.forEach(s=>{const a=this.sourceBuffer[s];a!=null&&a.updating||n.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){const r=this.sourceBuffer[e];if(!r)return;const s=n.bind(this,e);this.listeners[e].push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}}function N0(i){const e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function Hk(i,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}const Vk={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},E_=i=>String.fromCharCode(Vk[i]||i),Ti=15,on=100,Kk={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Wk={17:2,18:4,21:6,22:8,23:10,19:13,20:15},qk={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Yk={25:2,26:4,29:6,30:8,31:10,27:13,28:15},jk=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class zk{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;I.log(`${this.time} [${e}] ${n}`)}}}const or=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class y_{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Qk{constructor(){this.uchar=" ",this.penState=new y_}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Xk{constructor(e){this.chars=[],this.pos=0,this.currPenState=new y_,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<on;t++)this.chars.push(new Qk);this.logger=e}equals(e){for(let t=0;t<on;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<on;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<on;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>on&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=on)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=E_(e);if(this.pos>=on){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<on;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<on;n++){const r=this.chars[n].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Gd{constructor(e){this.rows=[],this.currRow=Ti-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Ti;t++)this.rows.push(new Xk(e));this.logger=e}reset(){for(let e=0;e<Ti;e++)this.rows[e].clear();this.currRow=Ti-1}equals(e){let t=!0;for(let n=0;n<Ti;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<Ti;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Ti;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let o=0;o<Ti;o++)this.rows[o].clear();const s=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const o=a.rows[s].cueStartTime,l=this.logger.time;if(o!==null&&l!==null&&o<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(a.rows[s+u])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,a=Math.max(s-1,0);n.setCursor(e.indent),e.color=n.chars[a].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",r=-1;for(let s=0;s<Ti;s++){const a=this.rows[s].getTextString();a&&(r=s+1,e?t.push("Row "+r+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class F0{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Gd(n),this.nonDisplayedMemory=new Gd(n),this.lastOutputScreen=new Gd(n),this.currRollUpRow=this.displayedMemory.rows[Ti-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Ti-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class U0{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=Jk(),this.logger=void 0;const r=this.logger=new zk;this.channels=[null,new F0(e,t,r),new F0(e+1,n,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const r=t[n]&127,s=t[n+1]&127;let a=!1,o=null;if(r===0&&s===0)continue;this.logger.log(3,()=>"["+or([t[n],t[n+1]])+"] -> ("+or([r,s])+")");const l=this.cmdHistory;if(r>=16&&r<=31){if(Zk(r,s,l)){al(null,null,l),this.logger.log(3,()=>"Repeated command ("+or([r,s])+") is dropped");continue}al(r,s,this.cmdHistory),a=this.parseCmd(r,s),a||(a=this.parseMidrow(r,s)),a||(a=this.parsePAC(r,s)),a||(a=this.parseBackgroundAttributes(r,s))}else al(null,null,l);if(!a&&(o=this.parseChars(r,s),o)){const c=this.currentChannel;c&&c>0?this.channels[c].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!o&&this.logger.log(2,()=>"Couldn't parse cleaned data "+or([r,s])+" orig: "+or([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(n||r))return!1;const s=e===20||e===21||e===23?1:2,a=this.channels[s];return e===20||e===21||e===28||e===29?t===32?a.ccRCL():t===33?a.ccBS():t===34?a.ccAOF():t===35?a.ccAON():t===36?a.ccDER():t===37?a.ccRU(2):t===38?a.ccRU(3):t===39?a.ccRU(4):t===40?a.ccFON():t===41?a.ccRDC():t===42?a.ccTR():t===43?a.ccRTD():t===44?a.ccEDM():t===45?a.ccCR():t===46?a.ccENM():t===47&&a.ccEOC():a.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[n];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+or([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(r||s))return!1;const a=e<=23?1:2;t>=64&&t<=95?n=a===1?Kk[e]:qk[e]:n=a===1?Wk[e]:Yk[e];const o=this.channels[a];return o?(o.setPAC(this.interpretPAC(n,t)),this.currentChannel=a,!0):!1}interpretPAC(e,t){let n;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,r.underline=(n&1)===1,n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((n-16)/2)*4,r}parseChars(e,t){let n,r=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let a;s===17?a=t+80:s===18?a=t+112:a=t+144,this.logger.log(2,()=>"Special char '"+E_(a)+"' in channel "+n),r=[a]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+or(r).join(",")),r}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(n||r))return!1;let s;const a={};e===16||e===24?(s=Math.floor((t-32)/2),a.background=jk[s],t%2===1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}al(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function al(i,e,t){t.a=i,t.b=e}function Zk(i,e,t){return t.a===i&&t.b===e}function Jk(){return{a:null,b:null}}class ol{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var Xm=function(){if(Ws!=null&&Ws.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;const u=l.toLowerCase();return~o.indexOf(u)?u:!1}function n(o){return t(i,o)}function r(o){return t(e,o)}function s(o,...l){let u=1;for(;u<arguments.length;u++){const c=arguments[u];for(const d in c)o[d]=c[d]}return o}function a(o,l,u){const c=this,d={enumerable:!0};c.hasBeenReset=!1;let h="",f=!1,m=o,p=l,v=u,g=null,E="",y=!0,_="auto",S="start",b=50,A="middle",w=50,P="middle";Object.defineProperty(c,"id",s({},d,{get:function(){return h},set:function(R){h=""+R}})),Object.defineProperty(c,"pauseOnExit",s({},d,{get:function(){return f},set:function(R){f=!!R}})),Object.defineProperty(c,"startTime",s({},d,{get:function(){return m},set:function(R){if(typeof R!="number")throw new TypeError("Start time must be set to a number.");m=R,this.hasBeenReset=!0}})),Object.defineProperty(c,"endTime",s({},d,{get:function(){return p},set:function(R){if(typeof R!="number")throw new TypeError("End time must be set to a number.");p=R,this.hasBeenReset=!0}})),Object.defineProperty(c,"text",s({},d,{get:function(){return v},set:function(R){v=""+R,this.hasBeenReset=!0}})),Object.defineProperty(c,"region",s({},d,{get:function(){return g},set:function(R){g=R,this.hasBeenReset=!0}})),Object.defineProperty(c,"vertical",s({},d,{get:function(){return E},set:function(R){const D=n(R);if(D===!1)throw new SyntaxError("An invalid or illegal string was specified.");E=D,this.hasBeenReset=!0}})),Object.defineProperty(c,"snapToLines",s({},d,{get:function(){return y},set:function(R){y=!!R,this.hasBeenReset=!0}})),Object.defineProperty(c,"line",s({},d,{get:function(){return _},set:function(R){if(typeof R!="number"&&R!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");_=R,this.hasBeenReset=!0}})),Object.defineProperty(c,"lineAlign",s({},d,{get:function(){return S},set:function(R){const D=r(R);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");S=D,this.hasBeenReset=!0}})),Object.defineProperty(c,"position",s({},d,{get:function(){return b},set:function(R){if(R<0||R>100)throw new Error("Position must be between 0 and 100.");b=R,this.hasBeenReset=!0}})),Object.defineProperty(c,"positionAlign",s({},d,{get:function(){return A},set:function(R){const D=r(R);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");A=D,this.hasBeenReset=!0}})),Object.defineProperty(c,"size",s({},d,{get:function(){return w},set:function(R){if(R<0||R>100)throw new Error("Size must be between 0 and 100.");w=R,this.hasBeenReset=!0}})),Object.defineProperty(c,"align",s({},d,{get:function(){return P},set:function(R){const D=r(R);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");P=D,this.hasBeenReset=!0}})),c.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class eD{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function T_(i){function e(n,r,s,a){return(n|0)*3600+(r|0)*60+(s|0)+parseFloat(a||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class tD{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function __(i,e,t,n){const r=n?i.split(n):[i];for(const s in r){if(typeof r[s]!="string")continue;const a=r[s].split(t);if(a.length!==2)continue;const o=a[0],l=a[1];e(o,l)}}const of=new Xm(0,0,""),ll=of.align==="middle"?"middle":"center";function iD(i,e,t){const n=i;function r(){const o=T_(i);if(o===null)throw new Error("Malformed timestamp: "+n);return i=i.replace(/^[^\sa-zA-Z-]+/,""),o}function s(o,l){const u=new tD;__(o,function(h,f){let m;switch(h){case"region":for(let p=t.length-1;p>=0;p--)if(t[p].id===f){u.set(h,t[p].region);break}break;case"vertical":u.alt(h,f,["rl","lr"]);break;case"line":m=f.split(","),u.integer(h,m[0]),u.percent(h,m[0])&&u.set("snapToLines",!1),u.alt(h,m[0],["auto"]),m.length===2&&u.alt("lineAlign",m[1],["start",ll,"end"]);break;case"position":m=f.split(","),u.percent(h,m[0]),m.length===2&&u.alt("positionAlign",m[1],["start",ll,"end","line-left","line-right","auto"]);break;case"size":u.percent(h,f);break;case"align":u.alt(h,f,["start",ll,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let c=u.get("line","auto");c==="auto"&&of.line===-1&&(c=-1),l.line=c,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",ll);let d=u.get("position","auto");d==="auto"&&of.position===50&&(d=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=d}function a(){i=i.replace(/^\s+/,"")}if(a(),e.startTime=r(),a(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);i=i.slice(3),a(),e.endTime=r(),a(),s(i,e)}function S_(i){return i.replace(/<br(?: \/)?>/gi,`
`)}class nD{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new eD,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let s=t.buffer,a=0;for(s=S_(s);a<s.length&&s[a]!=="\r"&&s[a]!==`
`;)++a;const o=s.slice(0,a);return s[a]==="\r"&&++a,s[a]===`
`&&++a,t.buffer=s.slice(a),o}function r(s){__(s,function(a,o){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=n();const o=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:s=n(),t.state){case"HEADER":/:/.test(s)?r(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new Xm(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{iD(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const o=s.indexOf("-->")!==-1;if(!s||o&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const rD=/\r\n|\n\r|\n|\r/g,Hd=function(e,t,n=0){return e.slice(n,n+t.length)===t},sD=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!K(t)||!K(n)||!K(r)||!K(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*r,t+=60*60*1e3*s,t},Vd=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function Zm(i,e,t){return Vd(i.toString())+Vd(e.toString())+Vd(t)}const aD=function(e,t,n){let r=e[t],s=e[r.prevCC];if(!s||!s.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(a=s)!=null&&a.new;){var a;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=n};function oD(i,e,t,n,r,s,a){const o=new nD,l=tn(new Uint8Array(i)).trim().replace(rD,`
`).split(`
`),u=[],c=e?xk(e.baseTime,e.timescale):0;let d="00:00.000",h=0,f=0,m,p=!0;o.oncue=function(v){const g=t[n];let E=t.ccOffset;const y=(h-c)/9e4;if(g!=null&&g.new&&(f!==void 0?E=t.ccOffset=g.start:aD(t,n,y)),y){if(!e){m=new Error("Missing initPTS for VTT MPEGTS");return}E=y-t.presentationOffset}const _=v.endTime-v.startTime,S=ai((v.startTime+E-f)*9e4,r*9e4)/9e4;v.startTime=Math.max(S,0),v.endTime=Math.max(S+_,0);const b=v.text.trim();v.text=decodeURIComponent(encodeURIComponent(b)),v.id||(v.id=Zm(v.startTime,v.endTime,b)),v.endTime>0&&u.push(v)},o.onparsingerror=function(v){m=v},o.onflush=function(){if(m){a(m);return}s(u)},l.forEach(v=>{if(p)if(Hd(v,"X-TIMESTAMP-MAP=")){p=!1,v.slice(16).split(",").forEach(g=>{Hd(g,"LOCAL:")?d=g.slice(6):Hd(g,"MPEGTS:")&&(h=parseInt(g.slice(7)))});try{f=sD(d)/1e3}catch(g){m=g}return}else v===""&&(p=!1);o.parse(v+`
`)}),o.flush()}const Kd="stpp.ttml.im1t",A_=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,x_=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,lD={left:"start",center:"center",right:"end",start:"start",end:"end"};function $0(i,e,t,n){const r=ae(new Uint8Array(i),["mdat"]);if(r.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const s=r.map(o=>tn(o)),a=Ak(e.baseTime,1,e.timescale);try{s.forEach(o=>t(uD(o,a)))}catch(o){n(o)}}function uD(i,e){const r=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce((d,h)=>(d[h]=r.getAttribute(`ttp:${h}`)||s[h],d),{}),o=r.getAttribute("xml:space")!=="preserve",l=B0(Wd(r,"styling","style")),u=B0(Wd(r,"layout","region")),c=Wd(r,"body","[begin]");return[].map.call(c,d=>{const h=b_(d,o);if(!h||!d.hasAttribute("begin"))return null;const f=Yd(d.getAttribute("begin"),a),m=Yd(d.getAttribute("dur"),a);let p=Yd(d.getAttribute("end"),a);if(f===null)throw G0(d);if(p===null){if(m===null)throw G0(d);p=f+m}const v=new Xm(f-e,p-e,h);v.id=Zm(v.startTime,v.endTime,v.text);const g=u[d.getAttribute("region")],E=l[d.getAttribute("style")],y=cD(g,E,l),{textAlign:_}=y;if(_){const S=lD[_];S&&(v.lineAlign=S),v.align=_}return nt(v,y),v}).filter(d=>d!==null)}function Wd(i,e,t){const n=i.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function B0(i){return i.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function b_(i,e){return[].slice.call(i.childNodes).reduce((t,n,r)=>{var s;return n.nodeName==="br"&&r?t+`
`:(s=n.childNodes)!=null&&s.length?b_(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function cD(i,e,t){const n="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(r=t[a]),s.reduce((o,l)=>{const u=qd(e,n,l)||qd(i,n,l)||qd(r,n,l);return u&&(o[l]=u),o},{})}function qd(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function G0(i){return new Error(`Could not parse ttml timestamp ${i}`)}function Yd(i,e){if(!i)return null;let t=T_(i);return t===null&&(A_.test(i)?t=dD(i,e):x_.test(i)&&(t=hD(i,e))),t}function dD(i,e){const t=A_.exec(i),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function hD(i,e){const t=x_.exec(i),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class fD{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=V0(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(T.FRAG_LOADING,this.onFragLoading,this),e.on(T.FRAG_LOADED,this.onFragLoaded,this),e.on(T.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(T.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(T.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(T.FRAG_LOADING,this.onFragLoading,this),e.off(T.FRAG_LOADED,this.onFragLoaded,this),e.off(T.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(T.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(T.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new ol(this,"textTrack1"),t=new ol(this,"textTrack2"),n=new ol(this,"textTrack3"),r=new ol(this,"textTrack4");this.cea608Parser1=new U0(1,e,t),this.cea608Parser2=new U0(3,n,r)}}addCues(e,t,n,r,s){let a=!1;for(let o=s.length;o--;){const l=s[o],u=mD(l[0],l[1],t,n);if(u>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),a=!0,u/(n-t)>.5))return}if(a||s.push([t,n]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,t,n,r)}else{const o=this.Cues.newCue(null,t,n,r);this.hls.trigger(T.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s}){const{unparsedVttFrags:a}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:r,timescale:s}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.onFragLoaded(T.FRAG_LOADED,o)}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let r=0;r<n.textTracks.length;r++){const s=n.textTracks[r];if(H0(s,{name:e,lang:t,attrs:{}}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:r}=this,{label:s,languageCode:a}=t[e],o=this.getExistingTrack(s,a);if(o)n[e]=o,Rs(n[e]),WT(n[e],r);else{const l=this.createTextTrack("captions",s,a);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,r={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(T.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){const r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{Rs(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=V0(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)Rs(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],r=n.some(s=>s.textCodec===Kd);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(v_(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const a=this.media,o=a?Ul(a.textTracks):null;if(this.tracks.forEach((l,u)=>{let c;if(o){let d=null;for(let h=0;h<o.length;h++)if(o[h]&&H0(o[h],l)){d=o[h],o[h]=null;break}d&&(c=d)}if(c)Rs(c);else{const d=R_(l);c=this.createTextTrack(d,l.name,l.lang),c&&(c.mode="disabled")}c&&this.textTracks.push(c)}),o!=null&&o.length){const l=o.filter(u=>u!==null).map(u=>u.label);l.length&&I.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(T.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const r=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!r)return;const s=`textTrack${r[1]}`,a=this.captionsProperties[s];a&&(a.label=n.name,n.lang&&(a.languageCode=n.lang),a.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===ee.MAIN){var n,r;const{cea608Parser1:s,cea608Parser2:a,lastSn:o}=this,{cc:l,sn:u}=t.frag,c=(n=(r=t.part)==null?void 0:r.index)!=null?n:-1;s&&a&&(u!==o+1||u===o&&c!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),a.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=c}}onFragLoaded(e,t){const{frag:n,payload:r}=t;if(n.type===ee.SUBTITLE)if(r.byteLength){const s=n.decryptdata,a="stats"in t;if(s==null||!s.encrypted||a){const o=this.tracks[n.level],l=this.vttCCs;l[n.cc]||(l[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),o&&o.textCodec===Kd?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;$0(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),n.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{I.log(`Failed to parse IMSC1: ${r}`),n.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:n,payload:r}=e,{initPTS:s,unparsedVttFrags:a}=this,o=s.length-1;if(!s[n.cc]&&o===-1){a.push(e);return}const l=this.hls,u=(t=n.initSegment)!=null&&t.data?mi(n.initSegment.data,new Uint8Array(r)):r;oD(u,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,c=>{this._appendCues(c,n.level),l.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},c=>{const d=c.message==="Missing initPTS for VTT MPEGTS";d?a.push(e):this._fallbackToIMSC1(n,r),I.log(`Failed to parse VTT cue: ${c}`),!(d&&o>n.cc)&&l.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:c})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||$0(t,this.initPTS[e.cc],()=>{n.textCodec=Kd,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(s=>qT(r,s))}else{const r=this.tracks[t];if(!r)return;const s=r.default?"default":"subtitles"+t;n.trigger(T.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===ee.SUBTITLE&&this.onFragLoaded(T.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:n,cea608Parser2:r}=this;if(!this.enabled||!n||!r)return;const{frag:s,samples:a}=t;if(!(s.type===ee.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let o=0;o<a.length;o++){const l=a[o].bytes;if(l){const u=this.extractCea608Data(l);n.addData(a[o].pts,u[0]),r.addData(a[o].pts,u[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:s}){const{media:a}=this;if(!(!a||a.currentTime<n)){if(!s||s==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(l=>Jh(o[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(l=>Jh(o[l],t,r))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let r=2;for(let s=0;s<n;s++){const a=e[r++],o=127&e[r++],l=127&e[r++];if(o===0&&l===0)continue;if((4&a)!==0){const c=3&a;(c===0||c===1)&&(t[c].push(o),t[c].push(l))}}return t}}function R_(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function H0(i,e){return!!i&&i.kind===R_(e)&&af(e,i)}function mD(i,e,t,n){return Math.min(e,n)-Math.max(i,t)}function V0(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class Jm{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(T.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.BUFFER_CODECS,this.onBufferCodecs,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(T.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.BUFFER_CODECS,this.onBufferCodecs,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&K(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&I.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,Jm.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const r=(o,l)=>l?o.width!==l.width||o.height!==l.height:!0;let s=e.length-1;const a=Math.max(t,n);for(let o=0;o<e.length;o+=1){const l=e[o];if((l.width>=a||l.height>=a)&&r(l,e[o+1])){s=o;break}}return s}}class pD{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){const r=performance.now();if(t){if(this.lastTime){const s=r-this.lastTime,a=n-this.lastDroppedFrames,o=t-this.lastDecodedFrames,l=1e3*a/s,u=this.hls;if(u.trigger(T.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:n}),l>0&&a>u.config.fpsDroppedMonitoringThreshold*o){let c=u.currentLevel;I.warn("drop FPS ratio greater than max allowed value for currentLevel: "+c),c>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=c)&&(c=c-1,u.trigger(T.FPS_DROP_LEVEL_CAPPING,{level:c,droppedLevel:u.currentLevel}),u.autoLevelCapping=c,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const ul="[eme]";class Os{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=Os.CDMCleanupPromise?[Os.CDMCleanupPromise]:[],this.debug=I.debug.bind(I,ul),this.log=I.log.bind(I,ul),this.warn=I.warn.bind(I,ul),this.error=I.error.bind(I,ul),this.onMediaEncrypted=t=>{const{initDataType:n,initData:r}=t,s=`"${t.type}" event: init data type: "${n}"`;if(this.debug(s),r!==null){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=Jo(this.config));const o=a.map(Ld).filter(l=>!!l);this.keyFormatPromise=this.getKeyFormatPromise(o)}this.keyFormatPromise.then(a=>{const o=wd(a);let l,u;if(n==="sinf"){if(o!==Te.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${o}`);return}const m=rt(new Uint8Array(r));try{const p=Um(JSON.parse(m).sinf),v=BT(p);if(!v)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");l=v.subarray(8,24),u=Te.FAIRPLAY}catch(p){this.warn(`${s} Failed to parse sinf: ${p}`);return}}else{if(o!==Te.WIDEVINE&&o!==Te.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${n}" for selected key-system ${o}`);return}const m=qI(r),p=m.filter(g=>!!g.systemId&&Id(g.systemId)===o);p.length>1&&this.warn(`${s} Using first of ${p.length} pssh found for selected key-system ${o}`);const v=p[0];if(!v){m.length===0||m.some(g=>!g.systemId)?this.warn(`${s} contains incomplete or invalid pssh data`):this.log(`ignoring ${s} for ${m.map(g=>Id(g.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(u=Id(v.systemId),v.version===0&&v.data)if(u===Te.WIDEVINE){const g=v.data.length-22;l=v.data.subarray(g,g+16)}else u===Te.PLAYREADY&&(l=CT(v.data))}if(!u||!l){this.log(`Unable to handle ${s} with key-system ${o}`);return}const c=Yi.hexDump(l),{keyIdToKeySessionPromise:d,mediaKeySessions:h}=this;let f=d[c];for(let m=0;m<h.length;m++){const p=h[m],v=p.decryptdata;if(!v.keyId)continue;const g=Yi.hexDump(v.keyId);if(c===g||v.uri.replace(/-/g,"").indexOf(c)!==-1){if(f=d[g],v.pssh)break;delete d[g],v.pssh=new Uint8Array(r),v.keyId=l,f=d[c]=f.then(()=>this.generateRequestWithPreferredKeySession(p,n,r,"encrypted-event-key-match")),f.catch(E=>this.handleError(E));break}}if(!f){if(u!==o){this.log(`Ignoring "${s}" with ${u} init data for selected key-system ${o}`);return}f=d[c]=this.getKeySystemSelectionPromise([u]).then(({keySystem:m,mediaKeys:p})=>{var v;this.throwIfDestroyed();const g=new po("ISO-23001-7",c,(v=Ld(m))!=null?v:"");return g.pssh=new Uint8Array(r),g.keyId=l,this.attemptSetMediaKeys(m,p).then(()=>{this.throwIfDestroyed();const E=this.createMediaKeySessionContext({decryptdata:g,keySystem:m,mediaKeys:p});return this.generateRequestWithPreferredKeySession(E,n,r,"encrypted-event-no-match")})}),f.catch(m=>this.handleError(m))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(T.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(T.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(T.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(T.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(T.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(T.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,r=t[e];if(r)return r.licenseUrl;if(e===Te.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(a,o,l)=>!!a&&l.indexOf(a)===o,r=t.map(a=>a.audioCodec).filter(n),s=t.map(a=>a.videoCodec).filter(n);return r.length+s.length===0&&s.push("avc1.42e01e"),new Promise((a,o)=>{const l=u=>{const c=u.shift();this.getMediaKeysPromise(c,r,s).then(d=>a({keySystem:c,mediaKeys:d})).catch(d=>{u.length?l(u):d instanceof ri?o(d):o(new ri({type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${n}`;return DT===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return n(e,t)}getMediaKeysPromise(e,t,n){const r=_I(e,t,n,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let a=s==null?void 0:s.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(r)}`),a=this.requestMediaKeySystemAccess(e,r);const o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),a.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=l.createMediaKeys().then(c=>(this.log(`Media-keys created for "${e}"`),u.then(d=>d?this.setMediaKeysServerCertificate(c,e,d):c))),o.mediaKeys.catch(c=>{this.error(`Failed to create media-keys for "${e}"}: ${c}`)}),o.mediaKeys})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${Yi.hexDump(e.keyId||[])}`);const r=n.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(n,s,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Yi.hexDump(e.keyId)}updateKeySession(e,t){var n;const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${Yi.hexDump(((n=e.decryptdata)==null?void 0:n.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),r.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,n)=>{const r=Jo(this.config),s=e.map(wd).filter(a=>!!a&&r.indexOf(a)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:a})=>{const o=Ld(a);o?t(o):n(new Error(`Unable to find format for key-system "${a}"`))}).catch(n)})}loadKey(e){const t=e.keyInfo.decryptdata,n=this.getKeyIdString(t),r=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);let s=this.keyIdToKeySessionPromise[n];return s||(s=this.keyIdToKeySessionPromise[n]=this.getKeySystemForKeyPromise(t).then(({keySystem:a,mediaKeys:o})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(a,o).then(()=>{this.throwIfDestroyed();const l=this.createMediaKeySessionContext({keySystem:a,mediaKeys:o,decryptdata:t});return this.generateRequestWithPreferredKeySession(l,"cenc",t.pssh,"playlist-key")}))),s.catch(a=>this.handleError(a))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof ri?this.hls.trigger(T.ERROR,e.data):this.hls.trigger(T.ERROR,{type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),n=this.keyIdToKeySessionPromise[t];if(!n){const r=wd(e.keyFormat),s=r?[r]:Jo(this.config);return this.attemptKeySystemAccess(s)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Jo(this.config)),e.length===0)throw new ri({type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(n).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>n.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,n,r){var s,a;const o=(s=this.config.drmSystems)==null||(a=s[e.keySystem])==null?void 0:a.generateRequest;if(o)try{const m=o.call(this.hls,t,n,e);if(!m)throw new Error("Invalid response from configured generateRequest filter");t=m.initDataType,n=e.decryptdata.pssh=m.initData?new Uint8Array(m.initData):null}catch(m){var l;if(this.warn(m.message),(l=this.hls)!=null&&l.config.debug)throw m}if(n===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${u} (init data type: ${t} length: ${n?n.byteLength:null})`);const c=new Qm,d=e._onmessage=m=>{const p=e.mediaKeysSession;if(!p){c.emit("error",new Error("invalid state"));return}const{messageType:v,message:g}=m;this.log(`"${v}" message event for session "${p.sessionId}" message size: ${g.byteLength}`),v==="license-request"||v==="license-renewal"?this.renewLicense(e,g).catch(E=>{this.handleError(E),c.emit("error",E)}):v==="license-release"?e.keySystem===Te.FAIRPLAY&&(this.updateKeySession(e,Xh("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${v}"`)},h=e._onkeystatuseschange=m=>{if(!e.mediaKeysSession){c.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const v=e.keyStatus;c.emit("keyStatus",v),v==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",d),e.mediaKeysSession.addEventListener("keystatuseschange",h);const f=new Promise((m,p)=>{c.on("error",p),c.on("keyStatus",v=>{v.startsWith("usable")?m():v==="output-restricted"?p(new ri({type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):v==="internal-error"?p(new ri({type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${v}"`)):v==="expired"?p(new Error("key expired while generating request")):this.warn(`unhandled key status change "${v}"`)})});return e.mediaKeysSession.generateRequest(t,n).then(()=>{var m;this.log(`Request generated for key-session "${(m=e.mediaKeysSession)==null?void 0:m.sessionId}" keyId: ${u}`)}).catch(m=>{throw new ri({type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_NO_SESSION,error:m,fatal:!1},`Error generating key-session request: ${m}`)}).then(()=>f).catch(m=>{throw c.removeAllListeners(),this.removeSession(e),m}).then(()=>(c.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,n)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Yi.hexDump("buffer"in n?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):new Uint8Array(n))} session keyId: ${Yi.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,n=t.loader,r=new n(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,o)=>{const l={responseType:"arraybuffer",url:s},u=t.certLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(h,f,m,p)=>{a(h.data)},onError:(h,f,m,p)=>{o(new ri({type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:vt({url:l.url,data:void 0},h)},`"${e}" certificate request failed (${s}). Status: ${h.code} (${h.text})`))},onTimeout:(h,f,m)=>{o(new ri({type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(h,f,m)=>{o(new Error("aborted"))}};r.load(l,c,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((r,s)=>{e.setServerCertificate(n).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${n==null?void 0:n.byteLength}) on "${t}"`),r(e)}).catch(a=>{s(new ri({type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(r=>{throw new ri({type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:r,fatal:!0},r.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=new DOMParser().parseFromString(n,"application/xml"),s=r.querySelectorAll("HttpHeader");if(s.length>0){let c;for(let d=0,h=s.length;d<h;d++){var a,o;c=s[d];const f=(a=c.querySelector("name"))==null?void 0:a.textContent,m=(o=c.querySelector("value"))==null?void 0:o.textContent;f&&m&&e.setRequestHeader(f,m)}}const l=r.querySelector("Challenge"),u=l==null?void 0:l.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Xh(atob(u))}setupLicenseXHR(e,t,n,r){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,n,r)}).catch(a=>{if(!n.decryptdata)throw a;return e.open("POST",t,!0),s.call(this.hls,e,t,n,r)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((r,s)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,o,a,e)}catch(c){this.error(c)}r(l)}else{const l=n.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||o.status>=400&&o.status<500)s(new ri({type:ie.KEY_SYSTEM_ERROR,details:k.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const c=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${c} attempts left`),this.requestLicense(e,t).then(r,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:l,licenseChallenge:u})=>{e.keySystem==Te.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(l,u)),l.send(u)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),n.addEventListener("encrypted",this.onMediaEncrypted),n.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},po.clearKeyUriToKeyIdMap();const n=t.length;Os.CDMCleanupPromise=Promise.all(t.map(r=>this.removeSession(r)).concat(e==null?void 0:e.setMediaKeys(null).catch(r=>{this.log(`Could not clear media keys: ${r}`)}))).then(()=>{n&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(r=>{this.log(`Could not close sessions and clear media keys: ${r}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((r,s)=>(r.indexOf(s.keyFormat)===-1&&r.push(s.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);return r>-1&&this.mediaKeySessions.splice(r,1),t.remove().catch(s=>{this.log(`Could not remove session: ${s}`)}).then(()=>t.close()).catch(s=>{this.log(`Could not close session: ${s}`)})}}}Os.CDMCleanupPromise=void 0;class ri extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var Rt;(function(i){i.MANIFEST="m",i.AUDIO="a",i.VIDEO="v",i.MUXED="av",i.INIT="i",i.CAPTION="c",i.TIMED_TEXT="tt",i.KEY="k",i.OTHER="o"})(Rt||(Rt={}));var lf;(function(i){i.DASH="d",i.HLS="h",i.SMOOTH="s",i.OTHER="o"})(lf||(lf={}));var Sr;(function(i){i.OBJECT="CMCD-Object",i.REQUEST="CMCD-Request",i.SESSION="CMCD-Session",i.STATUS="CMCD-Status"})(Sr||(Sr={}));const gD={[Sr.OBJECT]:["br","d","ot","tb"],[Sr.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Sr.SESSION]:["cid","pr","sf","sid","st","v"],[Sr.STATUS]:["bs","rtp"]};class Ys{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(n=>n instanceof Ys?n:new Ys(n))),this.value=e,this.params=t}}class w_{constructor(e){this.description=void 0,this.description=e}}const vD="Dict";function ED(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function yD(i,e,t,n){return new Error(`failed to ${i} "${ED(e)}" as ${t}`,{cause:n})}const K0="Bare Item",TD="Boolean",_D="Byte Sequence",SD="Decimal",AD="Integer";function xD(i){return i<-999999999999999||999999999999999<i}const bD=/[\x00-\x1f\x7f]+/,RD="Token",wD="Key";function rn(i,e,t){return yD("serialize",i,e,t)}function ID(i){if(typeof i!="boolean")throw rn(i,TD);return i?"?1":"?0"}function LD(i){return btoa(String.fromCharCode(...i))}function kD(i){if(ArrayBuffer.isView(i)===!1)throw rn(i,_D);return`:${LD(i)}:`}function I_(i){if(xD(i))throw rn(i,AD);return i.toString()}function DD(i){return`@${I_(i.getTime()/1e3)}`}function L_(i,e){if(i<0)return-L_(-i,e);const t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){const r=Math.floor(i*t);return(r%2===0?r:r+1)/t}else return Math.round(i*t)/t}function CD(i){const e=L_(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw rn(i,SD);const t=e.toString();return t.includes(".")?t:`${t}.0`}const PD="String";function MD(i){if(bD.test(i))throw rn(i,PD);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function OD(i){return i.description||i.toString().slice(7,-1)}function W0(i){const e=OD(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw rn(e,RD);return e}function uf(i){switch(typeof i){case"number":if(!K(i))throw rn(i,K0);return Number.isInteger(i)?I_(i):CD(i);case"string":return MD(i);case"symbol":return W0(i);case"boolean":return ID(i);case"object":if(i instanceof Date)return DD(i);if(i instanceof Uint8Array)return kD(i);if(i instanceof w_)return W0(i);default:throw rn(i,K0)}}function cf(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw rn(i,wD);return i}function ep(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${cf(e)}`:`;${cf(e)}=${uf(t)}`).join("")}function k_(i){return i instanceof Ys?`${uf(i.value)}${ep(i.params)}`:uf(i)}function ND(i){return`(${i.value.map(k_).join(" ")})${ep(i.params)}`}function FD(i,e={whitespace:!0}){if(typeof i!="object")throw rn(i,vD);const t=i instanceof Map?i.entries():Object.entries(i),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([r,s])=>{s instanceof Ys||(s=new Ys(s));let a=cf(r);return s.value===!0?a+=ep(s.params):(a+="=",Array.isArray(s.value)?a+=ND(s):a+=k_(s)),a}).join(`,${n}`)}function UD(i,e){return FD(i,e)}const $D=i=>i==="ot"||i==="sf"||i==="st",BD=i=>typeof i=="number"?K(i):i!=null&&i!==""&&i!==!1;function GD(i,e){const t=new URL(i),n=new URL(e);if(t.origin!==n.origin)return i;const r=t.pathname.split("/").slice(1),s=n.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")}function HD(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?s:s&3|8).toString(16)})}}}const Kl=i=>Math.round(i),VD=(i,e)=>(e!=null&&e.baseUrl&&(i=GD(i,e.baseUrl)),encodeURIComponent(i)),cl=i=>Kl(i/100)*100,KD={br:Kl,d:Kl,bl:cl,dl:cl,mtp:cl,nor:VD,rtp:cl,tb:Kl};function WD(i,e){const t={};if(i==null||typeof i!="object")return t;const n=Object.keys(i).sort(),r=nt({},KD,e==null?void 0:e.formatters),s=e==null?void 0:e.filter;return n.forEach(a=>{if(s!=null&&s(a))return;let o=i[a];const l=r[a];l&&(o=l(o,e)),!(a==="v"&&o===1)&&(a=="pr"&&o===1||BD(o)&&($D(a)&&typeof o=="string"&&(o=new w_(o)),t[a]=o))}),t}function D_(i,e={}){return i?UD(WD(i,e),nt({whitespace:!1},e)):""}function qD(i,e={}){if(!i)return{};const t=Object.entries(i),n=Object.entries(gD).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),r=t.reduce((s,a)=>{var o,l;const[u,c]=a,d=((o=n.find(h=>h[1].includes(u)))==null?void 0:o[0])||Sr.REQUEST;return(l=s[d])!=null||(s[d]={}),s[d][u]=c,s},{});return Object.entries(r).reduce((s,[a,o])=>(s[a]=D_(o,e),s),{})}function YD(i,e,t){return nt(i,qD(e,t))}const jD="CMCD";function zD(i,e={}){if(!i)return"";const t=D_(i,e);return`${jD}=${encodeURIComponent(t)}`}const q0=/CMCD=[^&#]+/;function QD(i,e,t){const n=zD(e,t);if(!n)return i;if(q0.test(i))return i.replace(q0,n);const r=i.includes("?")?"&":"?";return`${i}${r}${n}`}class XD{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:Rt.MANIFEST,su:!this.initialized})}catch(s){I.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const s=r.frag,a=this.hls.levels[s.level],o=this.getObjectType(s),l={d:s.duration*1e3,ot:o};(o===Rt.VIDEO||o===Rt.AUDIO||o==Rt.MUXED)&&(l.br=a.bitrate/1e3,l.tb=this.getTopBandwidth(o)/1e3,l.bl=this.getBufferLength(o)),this.apply(r,l)}catch(s){I.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||HD(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHED,this.onMediaDetached,this),e.on(T.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHED,this.onMediaDetached,this),e.off(T.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:lf.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){nt(t,this.createData());const n=t.ot===Rt.INIT||t.ot===Rt.VIDEO||t.ot===Rt.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((s,a)=>(r.includes(a)&&(s[a]=t[a]),s),{})),this.useHeaders?(e.headers||(e.headers={}),YD(e.headers,t)):e.url=QD(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return Rt.TIMED_TEXT;if(e.sn==="initSegment")return Rt.INIT;if(t==="audio")return Rt.AUDIO;if(t==="main")return this.hls.audioTracks.length?Rt.VIDEO:Rt.MUXED}getTopBandwidth(e){let t=0,n;const r=this.hls;if(e===Rt.AUDIO)n=r.audioTracks;else{const s=r.maxAutoLevel,a=s>-1?s+1:r.levels.length;n=r.levels.slice(0,a)}for(const s of n)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,n=e===Rt.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:De.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}}const ZD=3e5;class JD{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=I.log.bind(I,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if((n==null?void 0:n.action)===_t.SendAlternateToPenaltyBox&&n.flags===yi.MoveAllAlternatesMatchingHost){const r=this.levels;let s=this.pathwayPriority,a=this.pathwayId;if(t.context){const{groupId:o,pathwayId:l,type:u}=t.context;o&&r?a=this.getPathwayForGroupId(o,u,a):l&&(a=l)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!s&&r&&(s=r.reduce((o,l)=>(o.indexOf(l.pathwayId)===-1&&o.push(l.pathwayId),o),[])),s&&s.length>1&&(this.updatePathwayPriority(s),n.resolved=this.pathwayId!==a),n.resolved||I.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${r&&r.length} priorities: ${JSON.stringify(s)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(s=>{r-n[s]>ZD&&delete n[s]});for(let s=0;s<e.length;s++){const a=e[s];if(a in n)continue;if(a===this.pathwayId)return;const o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,QT(t),this.hls.trigger(T.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[o];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=o);break}}}getPathwayForGroupId(e,t,n){const r=this.getLevelsForPathway(n).concat(this.levels||[]);for(let s=0;s<r.length;s++)if(t===fe.AUDIO_TRACK&&r[s].hasAudioGroup(e)||t===fe.SUBTITLE_TRACK&&r[s].hasSubtitleGroup(e))return r[s].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},r={};e.forEach(s=>{const{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=s;if(t.some(c=>c.pathwayId===a))return;const u=this.getLevelsForPathway(o).map(c=>{const d=new $e(c.attrs);d["PATHWAY-ID"]=a;const h=d.AUDIO&&`${d.AUDIO}_clone_${a}`,f=d.SUBTITLES&&`${d.SUBTITLES}_clone_${a}`;h&&(n[d.AUDIO]=h,d.AUDIO=h),f&&(r[d.SUBTITLES]=f,d.SUBTITLES=f);const m=C_(c.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),p=new qs({attrs:d,audioCodec:c.audioCodec,bitrate:c.bitrate,height:c.height,name:c.name,url:m,videoCodec:c.videoCodec,width:c.width});if(c.audioGroups)for(let v=1;v<c.audioGroups.length;v++)p.addGroupId("audio",`${c.audioGroups[v]}_clone_${a}`);if(c.subtitleGroups)for(let v=1;v<c.subtitleGroups.length;v++)p.addGroupId("text",`${c.subtitleGroups[v]}_clone_${a}`);return p});t.push(...u),Y0(this.audioTracks,n,l,a),Y0(this.subtitleTracks,r,l,a)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const c=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+c)}const s={responseType:"json",url:r.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},u={onSuccess:(c,d,h,f)=>{this.log(`Loaded steering manifest: "${r}"`);const m=c.data;if(m.VERSION!==1){this.log(`Steering VERSION ${m.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=m.TTL;const{"RELOAD-URI":p,"PATHWAY-CLONES":v,"PATHWAY-PRIORITY":g}=m;if(p)try{this.uri=new self.URL(p,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${p}`);return}this.scheduleRefresh(this.uri||h.url),v&&this.clonePathways(v);const E={steeringManifest:m,url:r.toString()};this.hls.trigger(T.STEERING_MANIFEST_LOADED,E),g&&this.updatePathwayPriority(g)},onError:(c,d,h,f)=>{if(this.log(`Error loading steering manifest: ${c.code} ${c.text} (${d.url})`),this.stopLoad(),c.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let m=this.timeToLoad*1e3;if(c.code===429){const p=this.loader;if(typeof(p==null?void 0:p.getResponseHeader)=="function"){const v=p.getResponseHeader("Retry-After");v&&(m=parseFloat(v)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,m)},onTimeout:(c,d,h)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,l,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const r=(n=this.hls)==null?void 0:n.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function Y0(i,e,t,n){i&&Object.keys(e).forEach(r=>{const s=i.filter(a=>a.groupId===r).map(a=>{const o=nt({},a);return o.details=void 0,o.attrs=new $e(o.attrs),o.url=o.attrs.URI=C_(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=e[r],o.attrs["PATHWAY-ID"]=n,o});i.push(...s)})}function C_(i,e,t,n){const{HOST:r,PARAMS:s,[t]:a}=n;let o;e&&(o=a==null?void 0:a[e],o&&(i=o));const l=new self.URL(i);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach(u=>{u&&l.searchParams.set(u,s[u])}),l.href}const eC=/^age:\s*[\d.]+\s*$/im;class P_{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Fc,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return s(n,t.url)}).catch(a=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),s(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(a=>{this.callbacks.onError({code:n.status,text:a.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=n.loadPolicy;if(r)for(const o in r)e.setRequestHeader(o,r[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&K(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const r=t.readyState,s=this.config;if(!n.aborted&&r>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const a=t.status,o=t.responseType==="text"?t.responseText:null;if(a>=200&&a<300){const d=o??t.response;if(d!=null){n.loading.end=Math.max(self.performance.now(),n.loading.first);const h=t.responseType==="arraybuffer"?d.byteLength:d.length;if(n.loaded=n.total=h,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;const f=this.callbacks.onProgress;if(f&&f(n,e,d,t),!this.callbacks)return;const m={url:t.responseURL,data:d,code:a};this.callbacks.onSuccess(m,n,e,t);return}}const l=s.loadPolicy.errorRetry,u=n.retry,c={url:e.url,data:void 0,code:a};tc(l,u,!1,c)?this.retry(l):(I.error(`${a} while loading ${e.url}`),this.callbacks.onError({code:a,text:t.statusText},e,t,n))}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(tc(e,t,!0))this.retry(e);else{var n;I.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=Gm(e,n.retry),n.retry++,I.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&eC.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function tC(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const iC=/(\d+)-(\d+)\/(\d+)/;class j0{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||aC,this.controller=new self.AbortController,this.stats=new Fc}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=nC(e,this.controller.signal),a=n.onProgress,o=e.responseType==="arraybuffer",l=o?"byteLength":"length",{maxTimeToFirstByteMs:u,maxLoadTimeMs:c}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=u&&K(u)?u:c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(d=>{this.response=this.loader=d;const h=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=c,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},c-(h-r.loading.start)),!d.ok){const{status:f,statusText:m}=d;throw new oC(m||"fetch, bad network response",f,d)}return r.loading.first=h,r.total=sC(d.headers)||r.total,a&&K(t.highWaterMark)?this.loadProgressively(d,r,e,t.highWaterMark,a):o?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{const h=this.response;if(!h)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const f=d[l];f&&(r.loaded=r.total=f);const m={url:h.url,data:d,code:h.status};a&&!K(t.highWaterMark)&&a(r,e,d,h),n.onSuccess(m,r,e,h)}).catch(d=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;const h=d&&d.code||0,f=d?d.message:null;n.onError({code:h,text:f},e,d?d.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,s){const a=new e_,o=e.body.getReader(),l=()=>o.read().then(u=>{if(u.done)return a.dataLength&&s(t,n,a.flush(),e),Promise.resolve(new ArrayBuffer(0));const c=u.value,d=c.length;return t.loaded+=d,d<r||a.dataLength?(a.push(c),a.dataLength>=r&&s(t,n,a.flush(),e)):s(t,n,c,e),l()}).catch(()=>Promise.reject());return l()}}function nC(i,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(nt({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}function rC(i){const e=iC.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}function sC(i){const e=i.get("Content-Range");if(e){const n=rC(e);if(K(n))return n}const t=i.get("Content-Length");if(t)return parseInt(t)}function aC(i,e){return new self.Request(i.url,e)}class oC extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const lC=/\s/,uC={newCue(i,e,t,n){const r=[];let s,a,o,l,u;const c=self.VTTCue||self.TextTrackCue;for(let h=0;h<n.rows.length;h++)if(s=n.rows[h],o=!0,l=0,u="",!s.isEmpty()){var d;for(let p=0;p<s.chars.length;p++)lC.test(s.chars[p].uchar)&&o?l++:(u+=s.chars[p].uchar,o=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const f=S_(u.trim()),m=Zm(e,t,f);i!=null&&(d=i.cues)!=null&&d.getCueById(m)||(a=new c(e,t,f),a.id=m,a.line=h+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),r.push(a))}return i&&r.length&&(r.sort((h,f)=>h.line==="auto"||f.line==="auto"?0:h.line>8&&f.line>8?f.line-h.line:h.line-f.line),r.forEach(h=>qT(i,h))),r}},cC={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},M_=vt(vt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:P_,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:FL,bufferController:Gk,capLevelController:Jm,errorController:bL,fpsController:pD,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:DT,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:cC},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},dC()),{},{subtitleStreamController:Fk,subtitleTrackController:$k,timelineController:fD,audioStreamController:Ok,audioTrackController:Nk,emeController:Os,cmcdController:XD,contentSteeringController:JD});function dC(){return{cueHandler:uC,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function hC(i,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=df(i),n=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(s=>{const a=`${s==="level"?"playlist":s}LoadPolicy`,o=e[a]===void 0,l=[];r.forEach(u=>{const c=`${s}Loading${u}`,d=e[c];if(d!==void 0&&o){l.push(c);const h=t[a].default;switch(e[a]={default:h},u){case"TimeOut":h.maxLoadTimeMs=d,h.maxTimeToFirstByteMs=d;break;case"MaxRetry":h.errorRetry.maxNumRetry=d,h.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":h.errorRetry.retryDelayMs=d,h.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":h.errorRetry.maxRetryDelayMs=d,h.timeoutRetry.maxRetryDelayMs=d;break}}}),l.length&&I.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${a}": ${JSON.stringify(e[a])}`)}),vt(vt({},t),e)}function df(i){return i&&typeof i=="object"?Array.isArray(i)?i.map(df):Object.keys(i).reduce((e,t)=>(e[t]=df(i[t]),e),{}):i}function fC(i){const e=i.loader;e!==j0&&e!==P_?(I.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):tC()&&(i.loader=j0,i.progressive=!0,i.enableSoftwareAES=!0,I.log("[config]: Progressive streaming enabled, using FetchLoader"))}let jd;class mC extends Hm{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,r=[],s={},a={};let o=!1,l=!1,u=!1;t.levels.forEach(c=>{var d,h;const f=c.attrs;let{audioCodec:m,videoCodec:p}=c;((d=m)==null?void 0:d.indexOf("mp4a.40.34"))!==-1&&(jd||(jd=/chrome|firefox/i.test(navigator.userAgent)),jd&&(c.audioCodec=m=void 0)),m&&(c.audioCodec=m=Zu(m,n)),((h=p)==null?void 0:h.indexOf("avc1"))===0&&(p=c.videoCodec=eL(p));const{width:v,height:g,unknownCodecs:E}=c;if(o||(o=!!(v&&g)),l||(l=!!p),u||(u=!!m),E!=null&&E.length||m&&!Pd(m,"audio",n)||p&&!Pd(p,"video",n))return;const{CODECS:y,"FRAME-RATE":_,"HDCP-LEVEL":S,"PATHWAY-ID":b,RESOLUTION:A,"VIDEO-RANGE":w}=f,R=`${`${b||"."}-`}${c.bitrate}-${A}-${_}-${y}-${w}-${S}`;if(s[R])if(s[R].uri!==c.url&&!c.attrs["PATHWAY-ID"]){const D=a[R]+=1;c.attrs["PATHWAY-ID"]=new Array(D+1).join(".");const j=new qs(c);s[R]=j,r.push(j)}else s[R].addGroupId("audio",f.AUDIO),s[R].addGroupId("text",f.SUBTITLES);else{const D=new qs(c);s[R]=D,a[R]=1,r.push(D)}}),this.filterAndSortMediaOptions(r,t,o,l,u)}filterAndSortMediaOptions(e,t,n,r,s){let a=[],o=[],l=e;if((n||r)&&s&&(l=l.filter(({videoCodec:m,videoRange:p,width:v,height:g})=>(!!m||!!(v&&g))&&fL(p))),l.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const m=new Error("no level with compatible codecs found in manifest");this.hls.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:m,reason:m.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:m}=this.hls.config;a=t.audioTracks.filter(p=>!p.audioCodec||Pd(p.audioCodec,"audio",m)),z0(a)}t.subtitles&&(o=t.subtitles,z0(o));const u=l.slice(0);l.sort((m,p)=>{if(m.attrs["HDCP-LEVEL"]!==p.attrs["HDCP-LEVEL"])return(m.attrs["HDCP-LEVEL"]||"")>(p.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&m.height!==p.height)return m.height-p.height;if(m.frameRate!==p.frameRate)return m.frameRate-p.frameRate;if(m.videoRange!==p.videoRange)return Ju.indexOf(m.videoRange)-Ju.indexOf(p.videoRange);if(m.videoCodec!==p.videoCodec){const v=i0(m.videoCodec),g=i0(p.videoCodec);if(v!==g)return g-v}if(m.uri===p.uri&&m.codecSet!==p.codecSet){const v=Xu(m.codecSet),g=Xu(p.codecSet);if(v!==g)return g-v}return m.averageBitrate!==p.averageBitrate?m.averageBitrate-p.averageBitrate:0});let c=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length)){for(let m=0;m<u.length;m++)if(u[m].pathwayId===l[0].pathwayId){c=u[m];break}}this._levels=l;for(let m=0;m<l.length;m++)if(l[m]===c){var d;this._firstLevel=m;const p=c.bitrate,v=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${p}`),((d=this.hls.userConfig)==null?void 0:d.abrEwmaDefaultEstimate)===void 0){const g=Math.min(p,this.hls.config.abrEwmaDefaultEstimateMax);g>v&&v===M_.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=g)}break}const h=s&&!r,f={levels:l,audioTracks:a,subtitleTracks:o,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:r,altAudio:!h&&a.some(m=>!!m.url)};this.hls.trigger(T.MANIFEST_PARSED,f),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const c=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(T.ERROR,{type:ie.OTHER_ERROR,details:k.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:c,reason:c.message}),d)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,a=t[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,n===e&&a.details&&r&&s===o)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${o?" with Pathway "+o:""} from level ${n}${s?" with Pathway "+s:""}`);const l={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(T.LEVEL_SWITCHING,l);const u=a.details;if(!u||u.live){const c=this.switchParams(a.uri,r==null?void 0:r.details,u);this.loadPlaylist(c)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===fe.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===ee.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(s=>!!n[s]))return;const r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var n;const{level:r,details:s}=t,a=this._levels[r];if(!a){var o;this.warn(`Invalid level index ${r}`),(o=t.deliveryDirectives)!=null&&o.skip&&(s.deltaUpdateFailed=!0);return}r===this.currentLevelIndex?(a.fragmentError===0&&(a.loadError=0),this.playlistLoaded(r,t,a.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let r=n.uri;if(e)try{r=e.addDirectives(r)}catch(a){this.warn(`Could not construct new URL with HLS Delivery Directives: ${a}`)}const s=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${s?" Pathway "+s:""} ${r}`),this.clearTimer(),this.hls.trigger(T.LEVEL_LOADING,{url:r,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const n=this._levels.filter((r,s)=>s!==e?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(a=>a.level=-1)),!1));QT(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(T.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(T.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function z0(i){const e={};i.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}class pC{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[n].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=k.KEY_LOAD_ERROR,n,r,s){return new hn({type:ie.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:n,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:n,cc:r}=e;for(let s=0;s<t.length;s++){const a=t[s];if(r<=a.cc&&(n==="initSegment"||a.sn==="initSegment"||n<a.sn)){this.emeController.selectKeySystemFormat(a).then(o=>{a.setKeyFormat(o)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,k.KEY_LOAD_ERROR,u))}const a=s.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,k.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((n=o)!=null&&n.decryptdata.key)return s.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((r=o)!=null&&r.keyLoadPromise){var l;switch((l=o.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(u=>(s.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,k.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(n);if(r)return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,r=n.loader,s=new r(n);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((a,o)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=n.keyLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(h,f,m,p)=>{const{frag:v,keyInfo:g,url:E}=m;if(!v.decryptdata||g!==this.keyUriToKeyInfo[E])return o(this.createKeyLoadError(v,k.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),p));g.decryptdata.key=v.decryptdata.key=new Uint8Array(h.data),v.keyLoader=null,g.loader=null,a({frag:v,keyInfo:g})},onError:(h,f,m,p)=>{this.resetLoader(f),o(this.createKeyLoadError(t,k.KEY_LOAD_ERROR,new Error(`HTTP Error ${h.code} loading key ${h.text}`),m,vt({url:l.url,data:void 0},h)))},onTimeout:(h,f,m)=>{this.resetLoader(f),o(this.createKeyLoadError(t,k.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),m))},onAbort:(h,f,m)=>{this.resetLoader(f),o(this.createKeyLoadError(t,k.INTERNAL_ABORTED,new Error("key loading aborted"),m))}};s.load(l,c,d)})}resetLoader(e){const{frag:t,keyInfo:n,url:r}=e,s=n.loader;t.keyLoader===s&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[r],s&&s.destroy()}}function O_(){return self.SourceBuffer||self.WebKitSourceBuffer}function N_(){if(!Ur())return!1;const e=O_();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function gC(){if(!N_())return!1;const i=Ur();return typeof(i==null?void 0:i.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>i.isTypeSupported(go(e,"video")))||["mp4a.40.2","fLaC"].some(e=>i.isTypeSupported(go(e,"audio"))))}function vC(){var i;const e=O_();return typeof(e==null||(i=e.prototype)==null?void 0:i.changeType)=="function"}const EC=250,Wl=2,yC=.1,TC=.05;class _C{constructor(e,t,n,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:n,media:r,stalled:s}=this;if(r===null)return;const{currentTime:a,seeking:o}=r,l=this.seeking&&!o,u=!this.seeking&&o;if(this.seeking=o,a!==e){if(this.moved=!0,o||(this.nudgeRetry=0),s!==null){if(this.stallReported){const v=self.performance.now()-s;I.warn(`playback not stuck anymore @${a}, after ${Math.round(v)}ms`),this.stallReported=!1}this.stalled=null}return}if(u||l){this.stalled=null;return}if(r.paused&&!o||r.ended||r.playbackRate===0||!De.getBuffered(r).length){this.nudgeRetry=0;return}const c=De.bufferInfo(r,a,0),d=c.nextStart||0;if(o){const v=c.len>Wl,g=!d||t&&t.start<=a||d-a>Wl&&!this.fragmentTracker.getPartialFragment(a);if(v||g)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var h;if(!(c.len>0)&&!d)return;const g=Math.max(d,c.start||0)-a,E=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,_=(E==null||(h=E.details)==null?void 0:h.live)?E.details.targetduration*2:Wl,S=this.fragmentTracker.getPartialFragment(a);if(g>0&&(g<=_||S)){r.paused||this._trySkipBufferHole(S);return}}const f=self.performance.now();if(s===null){this.stalled=f;return}const m=f-s;if(!o&&m>=EC&&(this._reportStall(c),!this.media))return;const p=De.bufferInfo(r,a,n.maxBufferHole);this._tryFixBufferStall(p,m)}_tryFixBufferStall(e,t){const{config:n,fragmentTracker:r,media:s}=this;if(s===null)return;const a=s.currentTime,o=r.getPartialFragment(a);o&&(this._trySkipBufferHole(o)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-a<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(I.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:n,stallReported:r}=this;if(!r&&n){this.stallReported=!0;const s=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);I.warn(s.message),t.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:n,media:r}=this;if(r===null)return 0;const s=r.currentTime,a=De.bufferInfo(r,s,0),o=s<a.start?a.start:a.nextStart;if(o){const l=a.len<=t.maxBufferHole,u=a.len>0&&a.len<1&&r.readyState<3,c=o-s;if(c>0&&(l||u)){if(c>t.maxBufferHole){const{fragmentTracker:h}=this;let f=!1;if(s===0){const m=h.getAppendedFrag(0,ee.MAIN);m&&o<m.end&&(f=!0)}if(!f){const m=e||h.getAppendedFrag(s,ee.MAIN);if(m){let p=!1,v=m.end;for(;v<o;){const g=h.getPartialFragment(v);if(g)v+=g.duration;else{p=!0;break}}if(p)return 0}}}const d=Math.max(o+TC,s+yC);if(I.warn(`skipping hole, adjusting currentTime from ${s} to ${d}`),this.moved=!0,this.stalled=null,r.currentTime=d,e&&!e.gap){const h=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${d}`);n.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:h,reason:h.message,frag:e})}return d}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:n,nudgeRetry:r}=this;if(n===null)return;const s=n.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){const a=s+(r+1)*e.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${s} to ${a}`);I.warn(o.message),n.currentTime=a,t.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1})}else{const a=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);I.error(a.message),t.trigger(T.ERROR,{type:ie.MEDIA_ERROR,details:k.BUFFER_STALLED_ERROR,error:a,fatal:!0})}}}const SC=100;class AC extends Wm{constructor(e,t,n){super(e,t,n,"[stream-controller]",ee.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(T.ERROR,this.onError,this),e.on(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(T.BUFFER_CREATED,this.onBufferCreated,this),e.on(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(T.ERROR,this.onError,this),e.off(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(T.BUFFER_CREATED,this.onBufferCreated,this),e.off(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(SC),this.level=-1,!this.startFragRequested){let r=n.startLevel;r===-1&&(n.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=n.firstAutoLevel),n.nextLoadLevel=r,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=N.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=N.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case N.WAITING_LEVEL:{const{levels:t,level:n}=this,r=t==null?void 0:t[n],s=r==null?void 0:r.details;if(s&&(!s.live||this.levelLastLoaded===r)){if(this.waitForCdnTuneIn(s))break;this.state=N.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=N.IDLE;break}break}case N.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){const{levels:r,level:s}=this,a=r==null?void 0:r[s];this.resetStartWhenNotLoaded(a||null),this.state=N.IDLE}}break}this.state===N.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:r}=this;if(t===null||!r&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[s]))return;const a=n[s],o=this.getMainFwdBufferInfo();if(o===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){const p={};this.altAudio&&(p.type="video"),this.hls.trigger(T.BUFFER_EOS,p),this.state=N.ENDED;return}if(!this.buffering)return;e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const u=a.details;if(!u||this.state===N.WAITING_LEVEL||u.live&&this.levelLastLoaded!==a){this.level=s,this.state=N.WAITING_LEVEL;return}const c=o.len,d=this.getMaxBufferLength(a.maxBitrate);if(c>=d)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const h=this.backtrackFragment?this.backtrackFragment.start:o.end;let f=this.getNextFragment(h,u);if(this.couldBacktrack&&!this.fragPrevious&&f&&f.sn!=="initSegment"&&this.fragmentTracker.getState(f)!==mt.OK){var m;const v=((m=this.backtrackFragment)!=null?m:f).sn-u.startSN,g=u.fragments[v-1];g&&f.cc===g.cc&&(f=g,this.fragmentTracker.removeFragment(g))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(f&&this.isLoopLoading(f,h)){if(!f.gap){const v=this.audioOnly&&!this.altAudio?Ae.AUDIO:Ae.VIDEO,g=(v===Ae.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;g&&this.afterBufferFlushed(g,v,ee.MAIN)}f=this.getNextFragmentLoopLoading(f,u,o,ee.MAIN,d)}f&&(f.initSegment&&!f.initSegment.data&&!this.bitrateTest&&(f=f.initSegment),this.loadFragment(f,a,h))}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);this.fragCurrent=e,r===mt.NOT_LOADED||r===mt.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ee.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<s.targetduration*2)return}if(!t.paused&&e){const o=this.hls.nextLoadLevel,l=e[o],u=this.fragLastKbps;u&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:n=0}else n=0;const a=this.getBufferedFrag(t.currentTime+n);if(a){const o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();const l=o.maxStartPTS?o.maxStartPTS:o.start,u=o.duration,c=Math.max(a.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(c,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case N.KEY_LOADING:case N.FRAG_LOADING:case N.FRAG_LOADING_WAITING_RETRY:case N.PARSING:case N.PARSED:this.state=N.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new _C(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;K(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(T.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,r=!1;t.levels.forEach(s=>{const a=s.audioCodec;a&&(n=n||a.indexOf("mp4a.40.2")!==-1,r=r||a.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&r&&!vC(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==N.IDLE)return;const r=n[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(r.details))&&(this.state=N.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:r}=this,s=t.level,a=t.details,o=a.totalduration;if(!r){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${o}`);const l=r[s],u=this.fragCurrent;u&&(this.state===N.FRAG_LOADING||this.state===N.FRAG_LOADING_WAITING_RETRY)&&u.level!==t.level&&u.loader&&this.abortCurrentFrag();let c=0;if(a.live||(n=l.details)!=null&&n.live){var d;if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;c=this.alignPlaylists(a,l.details,(d=this.levelLastLoaded)==null?void 0:d.details)}if(l.details=a,this.levelLastLoaded=l,this.hls.trigger(T.LEVEL_UPDATED,{details:a,level:s}),this.state===N.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=N.IDLE}this.startFragRequested?a.live&&this.synchronizeToLiveEdge(a):this.setStartPosition(a,c),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:n,part:r,payload:s}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const o=a[n.level],l=o.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const u=o.videoCodec,c=l.PTSKnown||!l.live,d=(t=n.initSegment)==null?void 0:t.data,h=this._getAudioCodec(o),f=this.transmuxer=this.transmuxer||new g_(this.hls,ee.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),m=r?r.index:-1,p=m!==-1,v=new Vm(n.level,n.sn,n.stats.chunkCount,s.byteLength,m,p),g=this.initPTS[n.cc];f.push(s,d,h,u,n,r,l.totalduration,c,v,g)}onAudioTrackSwitching(e,t){const n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;n&&(s.trigger(T.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(T.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=t.id,r=!!this.hls.audioTracks[n].url;if(r){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r,this.tick()}onBufferCreated(e,t){const n=t.tracks;let r,s,a=!1;for(const o in n){const l=n[o];if(l.id==="main"){if(s=o,r=l,o==="video"){const u=n[o];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n&&n.type!==ee.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===N.PARSED&&(this.state=N.IDLE);return}const s=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal){this.state=N.ERROR;return}switch(t.details){case k.FRAG_GAP:case k.FRAG_PARSING_ERROR:case k.FRAG_DECRYPT_ERROR:case k.FRAG_LOAD_ERROR:case k.FRAG_LOAD_TIMEOUT:case k.KEY_LOAD_ERROR:case k.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ee.MAIN,t);break;case k.LEVEL_LOAD_ERROR:case k.LEVEL_LOAD_TIMEOUT:case k.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===N.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===fe.LEVEL&&(this.state=N.IDLE);break;case k.BUFFER_APPEND_ERROR:case k.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===k.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case k.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!De.getBuffered(e).length){const n=this.state!==N.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=N.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Ae.AUDIO||this.audioOnly&&!this.altAudio){const n=(t===Ae.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,ee.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const r=De.getBuffered(e),a=(r.length?r.start(0):0)-n;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${a} to match buffer start`),n+=a,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:r}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=N.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),r.trigger(T.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const n="main",{hls:r}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:c}=o,{video:d,text:h,id3:f,initSegment:m}=s,{details:p}=c,v=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=N.PARSING,m){if(m!=null&&m.tracks){const y=l.initSegment||l;this._bufferInitSegment(c,m.tracks,y,a),r.trigger(T.FRAG_PARSING_INIT_SEGMENT,{frag:y,id:n,tracks:m.tracks})}const g=m.initPTS,E=m.timescale;K(g)&&(this.initPTS[l.cc]={baseTime:g,timescale:E},r.trigger(T.INIT_PTS_FOUND,{frag:l,id:n,initPTS:g,timescale:E}))}if(d&&p&&l.sn!=="initSegment"){const g=p.fragments[l.sn-1-p.startSN],E=l.sn===p.startSN,y=!g||l.cc>g.cc;if(s.independent!==!1){const{startPTS:_,endPTS:S,startDTS:b,endDTS:A}=d;if(u)u.elementaryStreams[d.type]={startPTS:_,endPTS:S,startDTS:b,endDTS:A};else if(d.firstKeyFrame&&d.independent&&a.id===1&&!y&&(this.couldBacktrack=!0),d.dropped&&d.independent){const w=this.getMainFwdBufferInfo(),P=(w?w.end:this.getLoadPosition())+this.config.maxBufferHole,R=d.firstKeyFramePTS?d.firstKeyFramePTS:_;if(!E&&P<R-this.config.maxBufferHole&&!y){this.backtrack(l);return}else y&&(l.gap=!0);l.setElementaryStreamInfo(d.type,l.start,S,l.start,A,!0)}else E&&_>Wl&&(l.gap=!0);l.setElementaryStreamInfo(d.type,_,S,b,A),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(d,l,u,a,E||y)}else if(E||y)l.gap=!0;else{this.backtrack(l);return}}if(v){const{startPTS:g,endPTS:E,startDTS:y,endDTS:_}=v;u&&(u.elementaryStreams[Ae.AUDIO]={startPTS:g,endPTS:E,startDTS:y,endDTS:_}),l.setElementaryStreamInfo(Ae.AUDIO,g,E,y,_),this.bufferFragmentData(v,l,u,a)}if(p&&f!=null&&(t=f.samples)!=null&&t.length){const g={id:n,frag:l,details:p,samples:f.samples};r.trigger(T.FRAG_PARSING_METADATA,g)}if(p&&h){const g={id:n,frag:l,details:p,samples:h.samples};r.trigger(T.FRAG_PARSING_USERDATA,g)}}_bufferInitSegment(e,t,n,r){if(this.state!==N.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:a,audiovideo:o}=t;if(s){let l=e.audioCodec;const u=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5");const c=s.metadata;c&&"channelCount"in c&&(c.channelCount||1)!==1&&u.indexOf("firefox")===-1&&(l="mp4a.40.5")}l&&l.indexOf("mp4a.40.5")!==-1&&u.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`)}a&&(a.levelCodec=e.videoCodec,a.id="main",this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${a.codec}]`)),o&&this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.codecs}/${o.codec}]`),this.hls.trigger(T.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{const c=t[l].initSegment;c!=null&&c.byteLength&&this.hls.trigger(T.BUFFER_APPENDING,{type:l,data:c,frag:n,part:null,chunkMeta:r,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,ee.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=N.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(De.isBuffered(e,n)?t=this.getAppendedFrag(n):De.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,s=t.level;(!r||t.sn!==r.sn||r.level!==s)&&(this.fragPlaying=t,this.hls.trigger(T.FRAG_CHANGED,{frag:t}),(!r||r.level!==s)&&this.hls.trigger(T.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,n=this.currentFrag;if(n&&K(t)&&K(n.programDateTime)){const r=n.programDateTime+(t-n.start)*1e3;return new Date(r)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Ar{static get version(){return"1.5.20"}static isMSESupported(){return N_()}static isSupported(){return gC()}static getMediaSource(){return Ur()}static get Events(){return T}static get ErrorTypes(){return ie}static get ErrorDetails(){return k}static get DefaultConfig(){return Ar.defaultConfig?Ar.defaultConfig:M_}static set DefaultConfig(e){Ar.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Qm,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,dI(e.debug||!1,"Hls instance");const t=this.config=hC(Ar.DefaultConfig,e);this.userConfig=e,t.progressive&&fC(t);const{abrController:n,bufferController:r,capLevelController:s,errorController:a,fpsController:o}=t,l=new a(this),u=this.abrController=new n(this),c=this.bufferController=new r(this),d=this.capLevelController=new s(this),h=new o(this),f=new sL(this),m=new cL(this),p=t.contentSteeringController,v=p?new p(this):null,g=this.levelController=new mC(this,v),E=new $L(this),y=new pC(this.config),_=this.streamController=new AC(this,E,y);d.setStreamController(_),h.setStreamController(_);const S=[f,g,_];v&&S.splice(1,0,v),this.networkControllers=S;const b=[u,c,d,h,m,E];this.audioTrackController=this.createController(t.audioTrackController,S);const A=t.audioStreamController;A&&S.push(new A(this,E,y)),this.subtitleTrackController=this.createController(t.subtitleTrackController,S);const w=t.subtitleStreamController;w&&S.push(new w(this,E,y)),this.createController(t.timelineController,b),y.emeController=this.emeController=this.createController(t.emeController,b),this.cmcdController=this.createController(t.cmcdController,b),this.latencyController=this.createController(dL,b),this.coreComponents=b,S.push(l);const P=l.onErrorOut;typeof P=="function"&&this.on(T.ERROR,P,l)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,r){this._emitter.off(e,t,n,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(I.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const r=e===T.ERROR;this.trigger(T.ERROR,{type:ie.OTHER_ERROR,details:k.INTERNAL_EXCEPTION,fatal:r,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){I.log("destroy"),this.trigger(T.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){I.log("attachMedia"),this._media=e,this.trigger(T.MEDIA_ATTACHING,{media:e})}detachMedia(){I.log("detachMedia"),this.trigger(T.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,n=this.url,r=this.url=Fm.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,I.log(`loadSource:${r}`),t&&n&&(n!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(T.MANIFEST_LOADING,{url:e})}startLoad(e=-1){I.log(`startLoad(${e})`),this.started=!0,this.resumeBuffering();for(let t=0;t<this.networkControllers.length&&(this.networkControllers[t].startLoad(e),!(!this.started||!this.networkControllers));t++);}stopLoad(){I.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}resumeBuffering(){I.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()})}pauseBuffering(){I.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()})}swapAudioCodec(){I.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){I.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){I.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){I.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){I.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){I.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){I.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(I.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){hL(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let r;if(t===-1&&e!=null&&e.length?r=e.length-1:r=t,n)for(let s=r;s--;){const a=e[s].attrs["HDCP-LEVEL"];if(a&&a<=n)return s}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Ar.defaultConfig=void 0;var he=Ar,Ne={VIDEO:"video",THUMBNAIL:"thumbnail",STORYBOARD:"storyboard",DRM:"drm"},ke={NOT_AN_ERROR:0,NETWORK_OFFLINE:2000002,NETWORK_UNKNOWN_ERROR:2e6,NETWORK_NO_STATUS:2000001,NETWORK_INVALID_URL:24e5,NETWORK_NOT_FOUND:2404e3,NETWORK_NOT_READY:2412e3,NETWORK_GENERIC_SERVER_FAIL:25e5,NETWORK_TOKEN_MISSING:2403201,NETWORK_TOKEN_MALFORMED:2412202,NETWORK_TOKEN_EXPIRED:2403210,NETWORK_TOKEN_AUD_MISSING:2403221,NETWORK_TOKEN_AUD_MISMATCH:2403222,NETWORK_TOKEN_SUB_MISMATCH:2403232,ENCRYPTED_ERROR:5e6,ENCRYPTED_UNSUPPORTED_KEY_SYSTEM:5000001,ENCRYPTED_GENERATE_REQUEST_FAILED:5000002,ENCRYPTED_UPDATE_LICENSE_FAILED:5000003,ENCRYPTED_UPDATE_SERVER_CERT_FAILED:5000004,ENCRYPTED_CDM_ERROR:5000005,ENCRYPTED_OUTPUT_RESTRICTED:5000006,ENCRYPTED_MISSING_TOKEN:5000002},F_=i=>i===Ne.VIDEO?"playback":i,Cn=class Sa extends Error{constructor(e,t=Sa.MEDIA_ERR_CUSTOM,n,r){var s;super(e),this.name="MediaError",this.code=t,this.context=r,this.fatal=n??(t>=Sa.MEDIA_ERR_NETWORK&&t<=Sa.MEDIA_ERR_ENCRYPTED),this.message||(this.message=(s=Sa.defaultMessages[this.code])!=null?s:"")}};Cn.MEDIA_ERR_ABORTED=1,Cn.MEDIA_ERR_NETWORK=2,Cn.MEDIA_ERR_DECODE=3,Cn.MEDIA_ERR_SRC_NOT_SUPPORTED=4,Cn.MEDIA_ERR_ENCRYPTED=5,Cn.MEDIA_ERR_CUSTOM=100,Cn.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail.",3:"A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.",4:"An unsupported error occurred. The server or network failed, or your browser does not support this format.",5:"The media is encrypted and there are no keys to decrypt it."};var Q=Cn,xC=i=>i==null,tp=(i,e)=>xC(e)?!1:i in e,hf={ANY:"any",MUTED:"muted"},Ct={ON_DEMAND:"on-demand",LIVE:"live",UNKNOWN:"unknown"},ff={MSE:"mse",NATIVE:"native"},ql={HEADER:"header",QUERY:"query",NONE:"none"},ir={M3U8:"application/vnd.apple.mpegurl",MP4:"video/mp4"},Q0={HLS:ir.M3U8},bC=[...Object.values(ir),"hls","HLS"],RC="en",mf={code:RC},Ze=(i,e,t,n,r=i)=>{r.addEventListener(e,t,n),i.addEventListener("teardown",()=>{r.removeEventListener(e,t)},{once:!0})};function wC(i,e,t){e&&t>e&&(t=e);for(let n=0;n<i.length;n++)if(i.start(n)<=t&&i.end(n)>=t)return!0;return!1}var U_=i=>{let e=i.indexOf("?");if(e<0)return[i];let t=i.slice(0,e),n=i.slice(e);return[t,n]},$c=i=>{let e=i.type;if(e){let n=e.toUpperCase();return tp(n,Q0)?Q0[n]:e}let{src:t}=i;return t?IC(t):""},$_=i=>i==="VOD"?Ct.ON_DEMAND:Ct.LIVE,B_=i=>i==="EVENT"?Number.POSITIVE_INFINITY:i==="VOD"?Number.NaN:0,IC=i=>{let e="";try{e=new URL(i).pathname}catch{console.error("invalid url")}let t=e.lastIndexOf(".");if(t<0)return"";let n=e.slice(t+1).toUpperCase();return tp(n,ir)?ir[n]:""},LC=i=>{let e=(i??"").split(".")[1];if(e)try{let t=e.replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(n)}catch{return}},kC=({exp:i},e=Date.now())=>!i||i*1e3<e,DC=({sub:i},e)=>i!==e,CC=({aud:i},e)=>!i,PC=({aud:i},e)=>i!==e,G_="en";function pe(i,e=!0){var t,n;let r=e&&(n=(t=mf)==null?void 0:t[i])!=null?n:i,s=e?mf.code:G_;return new MC(r,s)}var MC=class{constructor(i,e=(t=>(t=mf)!=null?t:G_)()){this.message=i,this.locale=e}format(i){return this.message.replace(/\{(\w+)\}/g,(e,t)=>{var n;return(n=i[t])!=null?n:""})}toString(){return this.message}},OC=Object.values(hf),X0=i=>typeof i=="boolean"||typeof i=="string"&&OC.includes(i),NC=(i,e,t)=>{let{autoplay:n}=i,r=!1,s=!1,a=X0(n)?n:!!n,o=()=>{r||Ze(e,"playing",()=>{r=!0},{once:!0})};if(o(),Ze(e,"loadstart",()=>{r=!1,o(),zd(e,a)},{once:!0}),Ze(e,"loadstart",()=>{t||(i.streamType&&i.streamType!==Ct.UNKNOWN?s=i.streamType===Ct.LIVE:s=!Number.isFinite(e.duration)),zd(e,a)},{once:!0}),t&&t.once(he.Events.LEVEL_LOADED,(l,u)=>{var c;i.streamType&&i.streamType!==Ct.UNKNOWN?s=i.streamType===Ct.LIVE:s=(c=u.details.live)!=null?c:!1}),!a){let l=()=>{!s||Number.isFinite(i.startTime)||(t!=null&&t.liveSyncPosition?e.currentTime=t.liveSyncPosition:Number.isFinite(e.seekable.end(0))&&(e.currentTime=e.seekable.end(0)))};t&&Ze(e,"play",()=>{e.preload==="metadata"?t.once(he.Events.LEVEL_UPDATED,l):l()},{once:!0})}return l=>{r||(a=X0(l)?l:!!l,zd(e,a))}},zd=(i,e)=>{if(!e)return;let t=i.muted,n=()=>i.muted=t;switch(e){case hf.ANY:i.play().catch(()=>{i.muted=!0,i.play().catch(n)});break;case hf.MUTED:i.muted=!0,i.play().catch(n);break;default:i.play().catch(()=>{});break}},FC=({preload:i,src:e},t,n)=>{let r=d=>{d!=null&&["","none","metadata","auto"].includes(d)?t.setAttribute("preload",d):t.removeAttribute("preload")};if(!n)return r(i),r;let s=!1,a=!1,o=n.config.maxBufferLength,l=n.config.maxBufferSize,u=d=>{r(d);let h=d??t.preload;a||h==="none"||(h==="metadata"?(n.config.maxBufferLength=1,n.config.maxBufferSize=1):(n.config.maxBufferLength=o,n.config.maxBufferSize=l),c())},c=()=>{!s&&e&&(s=!0,n.loadSource(e))};return Ze(t,"play",()=>{a=!0,n.config.maxBufferLength=o,n.config.maxBufferSize=l,c()},{once:!0}),u(i),u};function UC(i,e){var t;if(!("videoTracks"in i))return;let n=new WeakMap;e.on(he.Events.MANIFEST_PARSED,function(u,c){l();let d=i.addVideoTrack("main");d.selected=!0;for(let[h,f]of c.levels.entries()){let m=d.addRendition(f.url[0],f.width,f.height,f.videoCodec,f.bitrate);n.set(f,`${h}`),m.id=`${h}`}}),e.on(he.Events.AUDIO_TRACKS_UPDATED,function(u,c){o();for(let d of c.audioTracks){let h=d.default?"main":"alternative",f=i.addAudioTrack(h,d.name,d.lang);f.id=`${d.id}`,d.default&&(f.enabled=!0)}}),i.audioTracks.addEventListener("change",()=>{var u;let c=+((u=[...i.audioTracks].find(h=>h.enabled))==null?void 0:u.id),d=e.audioTracks.map(h=>h.id);c!=e.audioTrack&&d.includes(c)&&(e.audioTrack=c)}),e.on(he.Events.LEVELS_UPDATED,function(u,c){var d;let h=i.videoTracks[(d=i.videoTracks.selectedIndex)!=null?d:0];if(!h)return;let f=c.levels.map(m=>n.get(m));for(let m of i.videoRenditions)m.id&&!f.includes(m.id)&&h.removeRendition(m)});let r=u=>{let c=u.target.selectedIndex;c!=e.nextLevel&&s(c)},s=u=>{let c=i.currentTime,d=!1,h=(f,m)=>{d||(d=!Number.isFinite(m.endOffset))};e.on(he.Events.BUFFER_FLUSHING,h),e.nextLevel=u,e.off(he.Events.BUFFER_FLUSHING,h),d||e.trigger(he.Events.BUFFER_FLUSHING,{startOffset:c+10,endOffset:1/0,type:"video"})};(t=i.videoRenditions)==null||t.addEventListener("change",r);let a=()=>{for(let u of i.videoTracks)i.removeVideoTrack(u)},o=()=>{for(let u of i.audioTracks)i.removeAudioTrack(u)},l=()=>{a(),o()};e.once(he.Events.DESTROYING,l)}var Qd=i=>"time"in i?i.time:i.startTime;function $C(i,e){e.on(he.Events.NON_NATIVE_TEXT_TRACKS_FOUND,(r,{tracks:s})=>{s.forEach(a=>{var o,l;let u=(o=a.subtitleTrack)!=null?o:a.closedCaptions,c=e.subtitleTracks.findIndex(({lang:h,name:f,type:m})=>h==(u==null?void 0:u.lang)&&f===a.label&&m.toLowerCase()===a.kind),d=((l=a._id)!=null?l:a.default)?"default":`${a.kind}${c}`;H_(i,a.kind,a.label,u==null?void 0:u.lang,d,a.default)})});let t=()=>{if(!e.subtitleTracks.length)return;let r=Array.from(i.textTracks).find(o=>o.id&&o.mode==="showing"&&["subtitles","captions"].includes(o.kind));if(!r)return;let s=e.subtitleTracks[e.subtitleTrack],a=s?s.default?"default":`${e.subtitleTracks[e.subtitleTrack].type.toLowerCase()}${e.subtitleTrack}`:void 0;if(e.subtitleTrack<0||(r==null?void 0:r.id)!==a){let o=e.subtitleTracks.findIndex(({lang:l,name:u,type:c,default:d})=>r.id==="default"&&d||l==r.language&&u===r.label&&c.toLowerCase()===r.kind);e.subtitleTrack=o}(r==null?void 0:r.id)===a&&r.cues&&Array.from(r.cues).forEach(o=>{r.addCue(o)})};i.textTracks.addEventListener("change",t),e.on(he.Events.CUES_PARSED,(r,{track:s,cues:a})=>{let o=i.textTracks.getTrackById(s);if(!o)return;let l=o.mode==="disabled";l&&(o.mode="hidden"),a.forEach(u=>{var c;(c=o.cues)!=null&&c.getCueById(u.id)||o.addCue(u)}),l&&(o.mode="disabled")}),e.once(he.Events.DESTROYING,()=>{i.textTracks.removeEventListener("change",t),i.querySelectorAll("track[data-removeondestroy]").forEach(r=>{r.remove()})});let n=()=>{Array.from(i.textTracks).forEach(r=>{var s,a;if(!["subtitles","caption"].includes(r.kind)&&(r.label==="thumbnails"||r.kind==="chapters")){if(!((s=r.cues)!=null&&s.length)){let o="track";r.kind&&(o+=`[kind="${r.kind}"]`),r.label&&(o+=`[label="${r.label}"]`);let l=i.querySelector(o),u=(a=l==null?void 0:l.getAttribute("src"))!=null?a:"";l==null||l.removeAttribute("src"),setTimeout(()=>{l==null||l.setAttribute("src",u)},0)}r.mode!=="hidden"&&(r.mode="hidden")}})};e.once(he.Events.MANIFEST_LOADED,n),e.once(he.Events.MEDIA_ATTACHED,n)}function H_(i,e,t,n,r,s){let a=document.createElement("track");return a.kind=e,a.label=t,n&&(a.srclang=n),r&&(a.id=r),s&&(a.default=!0),a.track.mode=["subtitles","captions"].includes(e)?"disabled":"hidden",a.setAttribute("data-removeondestroy",""),i.append(a),a.track}function ip(i,e,t){var n;return(n=Array.from(i.querySelectorAll("track")).find(r=>r.track.label===e&&r.track.kind===t))==null?void 0:n.track}async function V_(i,e,t,n){let r=ip(i,t,n);return r||(r=H_(i,n,t),r.mode="hidden",await new Promise(s=>setTimeout(()=>s(void 0),0))),r.mode!=="hidden"&&(r.mode="hidden"),[...e].sort((s,a)=>Qd(a)-Qd(s)).forEach(s=>{var a,o;let l=s.value,u=Qd(s);if("endTime"in s&&s.endTime!=null)r==null||r.addCue(new VTTCue(u,s.endTime,n==="chapters"?l:JSON.stringify(l??null)));else{let c=Array.prototype.findIndex.call(r==null?void 0:r.cues,m=>m.startTime>=u),d=(a=r==null?void 0:r.cues)==null?void 0:a[c],h=d?d.startTime:Number.isFinite(i.duration)?i.duration:Number.MAX_SAFE_INTEGER,f=(o=r==null?void 0:r.cues)==null?void 0:o[c-1];f&&(f.endTime=u),r==null||r.addCue(new VTTCue(u,h,n==="chapters"?l:JSON.stringify(l??null)))}}),i.textTracks.dispatchEvent(new Event("change",{bubbles:!0,composed:!0})),r}var K_="cuepoints",W_=Object.freeze({label:K_});async function BC(i,e,t=W_){return V_(i,e,t.label,"metadata")}var Z0=i=>({time:i.startTime,value:JSON.parse(i.text)});function GC(i,e={label:K_}){var t,n;let r=ip(i,e.label,"metadata");if(!((t=r==null?void 0:r.activeCues)!=null&&t.length))return;if(r.activeCues.length===1)return Z0(r.activeCues[0]);let{currentTime:s}=i,a=Array.prototype.find.call((n=r.activeCues)!=null?n:[],({startTime:o,endTime:l})=>o<=s&&l>s);return Z0(a||r.activeCues[0])}async function HC(i,e=W_){return new Promise(t=>{Ze(i,"loadstart",async()=>{let n=await BC(i,[],e);Ze(i,"cuechange",()=>{let r=GC(i);if(r){let s=new CustomEvent("cuepointchange",{composed:!0,bubbles:!0,detail:r});i.dispatchEvent(s)}},{},n),t(n)})})}var q_="chapters",Y_=Object.freeze({label:q_}),J0=i=>({startTime:i.startTime,endTime:i.endTime,value:i.text});async function VC(i,e,t=Y_){return V_(i,e,t.label,"chapters")}function KC(i,e={label:q_}){var t,n;let r=ip(i,e.label,"chapters");if(!((t=r==null?void 0:r.activeCues)!=null&&t.length))return;if(r.activeCues.length===1)return J0(r.activeCues[0]);let{currentTime:s}=i,a=Array.prototype.find.call((n=r.activeCues)!=null?n:[],({startTime:o,endTime:l})=>o<=s&&l>s);return J0(a||r.activeCues[0])}async function WC(i,e=Y_){return new Promise(t=>{Ze(i,"loadstart",async()=>{let n=await VC(i,[],e);Ze(i,"cuechange",()=>{let r=KC(i);if(r){let s=new CustomEvent("chapterchange",{composed:!0,bubbles:!0,detail:r});i.dispatchEvent(s)}},{},n),t(n)})})}var ev={VIDEO:"v",THUMBNAIL:"t",STORYBOARD:"s",DRM:"d"},qC=i=>{if(i===Ne.VIDEO)return ev.VIDEO;if(i===Ne.DRM)return ev.DRM},YC=(i,e)=>{var t,n;let r=F_(i),s=`${r}Token`;return(t=e.tokens)!=null&&t[r]?(n=e.tokens)==null?void 0:n[r]:tp(s,e)?e[s]:void 0},ac=(i,e,t,n=!1,r=!(s=>(s=globalThis.navigator)==null?void 0:s.onLine)())=>{var s,a;if(r){let v=pe("Your device appears to be offline",n),g,E=Q.MEDIA_ERR_NETWORK,y=new Q(v,E,!0,g);return y.errorCategory=e,y.muxCode=ke.NETWORK_OFFLINE,y.data=i,y}let o="status"in i?i.status:i.code,l=Date.now(),u=Q.MEDIA_ERR_NETWORK;if(o===200)return;let c=F_(e),d=YC(e,t),h=qC(e),[f]=U_((s=t.playbackId)!=null?s:"");if(!o||!f)return;let m=LC(d);if(d&&!m){let v=pe("The {tokenNamePrefix}-token provided is invalid or malformed.",n).format({tokenNamePrefix:c}),g=pe("Compact JWT string: {token}",n).format({token:d}),E=new Q(v,u,!0,g);return E.errorCategory=e,E.muxCode=ke.NETWORK_TOKEN_MALFORMED,E.data=i,E}if(o>=500){let v=new Q("",u,!0);return v.errorCategory=e,v.muxCode=ke.NETWORK_UNKNOWN_ERROR,v}if(o===403)if(m){if(kC(m,l)){let v={timeStyle:"medium",dateStyle:"medium"},g=pe("The video’s secured {tokenNamePrefix}-token has expired.",n).format({tokenNamePrefix:c}),E=pe("Expired at: {expiredDate}. Current time: {currentDate}.",n).format({expiredDate:new Intl.DateTimeFormat("en",v).format((a=m.exp)!=null?a:0*1e3),currentDate:new Intl.DateTimeFormat("en",v).format(l)}),y=new Q(g,u,!0,E);return y.errorCategory=e,y.muxCode=ke.NETWORK_TOKEN_EXPIRED,y.data=i,y}if(DC(m,f)){let v=pe("The video’s playback ID does not match the one encoded in the {tokenNamePrefix}-token.",n).format({tokenNamePrefix:c}),g=pe("Specified playback ID: {playbackId} and the playback ID encoded in the {tokenNamePrefix}-token: {tokenPlaybackId}",n).format({tokenNamePrefix:c,playbackId:f,tokenPlaybackId:m.sub}),E=new Q(v,u,!0,g);return E.errorCategory=e,E.muxCode=ke.NETWORK_TOKEN_SUB_MISMATCH,E.data=i,E}if(CC(m)){let v=pe("The {tokenNamePrefix}-token is formatted with incorrect information.",n).format({tokenNamePrefix:c}),g=pe("The {tokenNamePrefix}-token has no aud value. aud value should be {expectedAud}.",n).format({tokenNamePrefix:c,expectedAud:h}),E=new Q(v,u,!0,g);return E.errorCategory=e,E.muxCode=ke.NETWORK_TOKEN_AUD_MISSING,E.data=i,E}if(PC(m,h)){let v=pe("The {tokenNamePrefix}-token is formatted with incorrect information.",n).format({tokenNamePrefix:c}),g=pe("The {tokenNamePrefix}-token has an incorrect aud value: {aud}. aud value should be {expectedAud}.",n).format({tokenNamePrefix:c,expectedAud:h,aud:m.aud}),E=new Q(v,u,!0,g);return E.errorCategory=e,E.muxCode=ke.NETWORK_TOKEN_AUD_MISMATCH,E.data=i,E}}else{let v=pe("Authorization error trying to access this {category} URL. If this is a signed URL, you might need to provide a {tokenNamePrefix}-token.",n).format({tokenNamePrefix:c,category:e}),g=pe("Specified playback ID: {playbackId}",n).format({playbackId:f}),E=new Q(v,u,!0,g);return E.errorCategory=e,E.muxCode=ke.NETWORK_TOKEN_MISSING,E.data=i,E}if(o===412){let v=pe("This playback-id may belong to a live stream that is not currently active or an asset that is not ready.",n),g=pe("Specified playback ID: {playbackId}",n).format({playbackId:f}),E=new Q(v,u,!0,g);return E.errorCategory=e,E.muxCode=ke.NETWORK_NOT_READY,E.data=i,E}if(o===404){let v=pe("This URL or playback-id does not exist. You may have used an Asset ID or an ID from a different resource.",n),g=pe("Specified playback ID: {playbackId}",n).format({playbackId:f}),E=new Q(v,u,!0,g);return E.errorCategory=e,E.muxCode=ke.NETWORK_NOT_FOUND,E.data=i,E}if(o===400){let v=pe("The URL or playback-id was invalid. You may have used an invalid value as a playback-id."),g=pe("Specified playback ID: {playbackId}",n).format({playbackId:f}),E=new Q(v,u,!0,g);return E.errorCategory=e,E.muxCode=ke.NETWORK_INVALID_URL,E.data=i,E}let p=new Q("",u,!0);return p.errorCategory=e,p.muxCode=ke.NETWORK_UNKNOWN_ERROR,p.data=i,p},tv=he.DefaultConfig.capLevelController,j_=class z_ extends tv{constructor(e){super(e)}get levels(){var e;return(e=this.hls.levels)!=null?e:[]}getValidLevels(e){return this.levels.filter((t,n)=>this.isLevelAllowed(t)&&n<=e)}getMaxLevel(e){let t=super.getMaxLevel(e),n=this.getValidLevels(e);if(!n[t])return t;let r=Math.min(n[t].width,n[t].height),s=z_.minMaxResolution;return r>=s?t:tv.getMaxLevelByMediaSize(n,s*(16/9),s)}};j_.minMaxResolution=720;var jC=j_,zC=jC,Yl={FAIRPLAY:"fairplay",PLAYREADY:"playready",WIDEVINE:"widevine"},QC=i=>{if(i.includes("fps"))return Yl.FAIRPLAY;if(i.includes("playready"))return Yl.PLAYREADY;if(i.includes("widevine"))return Yl.WIDEVINE},XC=async i=>fetch(i).then(e=>e.status!==200?Promise.reject(e):e.text()).then(e=>{let t=e.split(`
`).find((n,r,s)=>r&&s[r-1].startsWith("#EXT-X-STREAM-INF"));return fetch(t).then(n=>n.status!==200?Promise.reject(n):n.text()).then(n=>n.split(`
`))}),ZC=i=>{var e,t,n;let r=(t=((e=i.find(l=>l.startsWith("#EXT-X-PLAYLIST-TYPE")))!=null?e:"").split(":")[1])==null?void 0:t.trim(),s=$_(r),a=B_(r),o;if(s===Ct.LIVE){let l=i.find(u=>u.startsWith("#EXT-X-PART-INF"));if(l)o=+l.split(":")[1].split("=")[1]*2;else{let u=i.find(d=>d.startsWith("#EXT-X-TARGETDURATION")),c=(n=u==null?void 0:u.split(":"))==null?void 0:n[1];o=+(c??6)*3}}return{streamType:s,targetLiveWindow:a,liveEdgeStartOffset:o}},JC=async(i,e)=>{if(e===ir.MP4)return{streamType:Ct.ON_DEMAND,targetLiveWindow:Number.NaN,liveEdgeStartOffset:void 0};if(e===ir.M3U8){let t=await XC(i);return ZC(t)}return console.error(`Media type ${e} is an unrecognized or unsupported type for src ${i}.`),{streamType:void 0,targetLiveWindow:void 0,liveEdgeStartOffset:void 0}},eP=async(i,e,t=$c({src:i}))=>{var n,r,s;let{streamType:a,targetLiveWindow:o,liveEdgeStartOffset:l}=await JC(i,t);((n=Lt.get(e))!=null?n:{}).liveEdgeStartOffset=l,((r=Lt.get(e))!=null?r:{}).targetLiveWindow=o,e.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0})),((s=Lt.get(e))!=null?s:{}).streamType=a,e.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}))},tP=i=>{var e;let t=i.type,n=$_(t),r=B_(t),s,a=!!((e=i.partList)!=null&&e.length);return n===Ct.LIVE&&(s=a?i.partTarget*2:i.targetduration*3),{streamType:n,targetLiveWindow:r,liveEdgeStartOffset:s,lowLatency:a}},iP=(i,e,t)=>{var n,r,s,a,o,l,u,c;let{streamType:d,targetLiveWindow:h,liveEdgeStartOffset:f,lowLatency:m}=tP(i);if(d===Ct.LIVE){m?(t.config.backBufferLength=(n=t.userConfig.backBufferLength)!=null?n:4,t.config.maxFragLookUpTolerance=(r=t.userConfig.maxFragLookUpTolerance)!=null?r:.001,t.config.abrBandWidthUpFactor=(s=t.userConfig.abrBandWidthUpFactor)!=null?s:t.config.abrBandWidthFactor):t.config.backBufferLength=(a=t.userConfig.backBufferLength)!=null?a:8;let p=Object.freeze({get length(){return e.seekable.length},start(v){return e.seekable.start(v)},end(v){var g;return v>this.length||v<0||Number.isFinite(e.duration)?e.seekable.end(v):(g=t.liveSyncPosition)!=null?g:e.seekable.end(v)}});((o=Lt.get(e))!=null?o:{}).seekable=p}((l=Lt.get(e))!=null?l:{}).liveEdgeStartOffset=f,((u=Lt.get(e))!=null?u:{}).targetLiveWindow=h,e.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0})),((c=Lt.get(e))!=null?c:{}).streamType=d,e.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}))},iv,nv,nP=(nv=(iv=globalThis==null?void 0:globalThis.navigator)==null?void 0:iv.userAgent)!=null?nv:"",rv,sv,av,rP=(av=(sv=(rv=globalThis==null?void 0:globalThis.navigator)==null?void 0:rv.userAgentData)==null?void 0:sv.platform)!=null?av:"",sP=nP.toLowerCase().includes("android")||["x11","android"].some(i=>rP.toLowerCase().includes(i)),Lt=new WeakMap,Jn="mux.com",ov,lv,Q_=(lv=(ov=he).isSupported)==null?void 0:lv.call(ov),aP=sP,oP=()=>Nm.utils.now(),lP=Nm.utils.generateUUID,uv=({playbackId:i,customDomain:e=Jn,maxResolution:t,minResolution:n,renditionOrder:r,programStartTime:s,programEndTime:a,assetStartTime:o,assetEndTime:l,playbackToken:u,tokens:{playback:c=u}={},extraSourceParams:d={}}={})=>{if(!i)return;let[h,f=""]=U_(i),m=new URL(`https://stream.${e}/${h}.m3u8${f}`);return c||m.searchParams.has("token")?(m.searchParams.forEach((p,v)=>{v!="token"&&m.searchParams.delete(v)}),c&&m.searchParams.set("token",c)):(t&&m.searchParams.set("max_resolution",t),n&&(m.searchParams.set("min_resolution",n),t&&+t.slice(0,-1)<+n.slice(0,-1)&&console.error("minResolution must be <= maxResolution","minResolution",n,"maxResolution",t)),r&&m.searchParams.set("rendition_order",r),s&&m.searchParams.set("program_start_time",`${s}`),a&&m.searchParams.set("program_end_time",`${a}`),o&&m.searchParams.set("asset_start_time",`${o}`),l&&m.searchParams.set("asset_end_time",`${l}`),Object.entries(d).forEach(([p,v])=>{v!=null&&m.searchParams.set(p,v)})),m.toString()},Bc=i=>{if(!i)return;let[e]=i.split("?");return e||void 0},uP=i=>{if(!i||!i.startsWith("https://stream."))return;let[e]=new URL(i).pathname.slice(1).split(".m3u8");return e||void 0},cP=i=>{var e,t,n;return(e=i==null?void 0:i.metadata)!=null&&e.video_id?i.metadata.video_id:iS(i)&&(n=(t=Bc(i.playbackId))!=null?t:uP(i.src))!=null?n:i.src},dP=i=>{var e;return(e=Lt.get(i))==null?void 0:e.error},cv=i=>{var e,t;return(t=(e=Lt.get(i))==null?void 0:e.streamType)!=null?t:Ct.UNKNOWN},hP=i=>{var e,t;return(t=(e=Lt.get(i))==null?void 0:e.seekable)!=null?t:i.seekable},np=.034,fP=(i,e,t=np)=>Math.abs(i-e)<=t,X_=(i,e,t=np)=>i>e||fP(i,e,t),mP=(i,e=np)=>i.paused&&X_(i.currentTime,i.duration,e),Z_=(i,e)=>{var t,n,r;if(!e||!i.buffered.length)return;if(i.readyState>2)return!1;let s=e.currentLevel>=0?(n=(t=e.levels)==null?void 0:t[e.currentLevel])==null?void 0:n.details:(r=e.levels.find(d=>!!d.details))==null?void 0:r.details;if(!s||s.live)return;let{fragments:a}=s;if(!(a!=null&&a.length))return;if(i.currentTime<i.duration-(s.targetduration+.5))return!1;let o=a[a.length-1];if(i.currentTime<=o.start)return!1;let l=o.start+o.duration/2,u=i.buffered.start(i.buffered.length-1),c=i.buffered.end(i.buffered.length-1);return l>u&&l<c},pP=(i,e)=>i.ended||i.loop?i.ended:e&&Z_(i,e)?!0:mP(i),gP=(i,e,t)=>{J_(e,t);let{metadata:n={}}=i,{view_session_id:r=lP()}=n,s=cP(i);n.view_session_id=r,n.video_id=s,i.metadata=n;let a=c=>{var d;(d=e.mux)==null||d.emit("hb",{view_drm_type:c})};i.drmTypeCb=a,Lt.set(e,{});let o=vP(i,e),l=FC(i,e,o);AP(i,e,o),xP(i,e,o),HC(e),WC(e);let u=NC(i,e,o);return{engine:o,setAutoplay:u,setPreload:l}},J_=(i,e)=>{let t=e==null?void 0:e.engine;t&&(t.detachMedia(),t.destroy()),i!=null&&i.mux&&!i.mux.deleted&&(i.mux.destroy(),delete i.mux),i&&(i.removeAttribute("src"),i.load(),i.removeEventListener("error",rS),i.removeEventListener("error",pf),i.removeEventListener("durationchange",nS),Lt.delete(i),i.dispatchEvent(new Event("teardown")))};function eS(i,e){var t;let n=$c(i);if(n!==ir.M3U8)return!0;let r=!n||((t=e.canPlayType(n))!=null?t:!0),{preferPlayback:s}=i,a=s===ff.MSE,o=s===ff.NATIVE;return r&&(o||!(Q_&&(a||aP)))}var vP=(i,e)=>{let{debug:t,streamType:n,startTime:r=-1,metadata:s,preferCmcd:a,_hlsConfig:o={}}=i,l=$c(i)===ir.M3U8,u=eS(i,e);if(l&&!u&&Q_){let c={backBufferLength:30,renderTextTracksNatively:!1,liveDurationInfinity:!0,capLevelToPlayerSize:!0,capLevelOnFPSDrop:!0},d=EP(n),h=yP(i),f=a!==ql.NONE?{useHeaders:a===ql.HEADER,sessionId:s==null?void 0:s.view_session_id,contentId:s==null?void 0:s.video_id}:void 0;return new he({debug:t,startPosition:r,cmcd:f,xhrSetup:(m,p)=>{var v,g;if(a&&a!==ql.QUERY)return;let E=new URL(p);if(!E.searchParams.has("CMCD"))return;let y=((g=(v=E.searchParams.get("CMCD"))==null?void 0:v.split(","))!=null?g:[]).filter(_=>_.startsWith("sid")||_.startsWith("cid")).join(",");E.searchParams.set("CMCD",y),m.open("GET",E)},capLevelController:zC,...c,...d,...h,...o})}},EP=i=>i===Ct.LIVE?{backBufferLength:8}:{},yP=i=>{let{tokens:{drm:e}={},playbackId:t,drmTypeCb:n}=i,r=Bc(t);return!e||!r?{}:{emeEnabled:!0,drmSystems:{"com.apple.fps":{licenseUrl:jl(i,"fairplay"),serverCertificateUrl:tS(i,"fairplay")},"com.widevine.alpha":{licenseUrl:jl(i,"widevine")},"com.microsoft.playready":{licenseUrl:jl(i,"playready")}},requestMediaKeySystemAccessFunc:(s,a)=>(s==="com.widevine.alpha"&&(a=[...a.map(o=>{var l;let u=(l=o.videoCapabilities)==null?void 0:l.map(c=>({...c,robustness:"HW_SECURE_ALL"}));return{...o,videoCapabilities:u}}),...a]),navigator.requestMediaKeySystemAccess(s,a).then(o=>{let l=QC(s);return n==null||n(l),o}))}},TP=async i=>{let e=await fetch(i);return e.status!==200?Promise.reject(e):await e.arrayBuffer()},_P=async(i,e)=>{let t=await fetch(e,{method:"POST",headers:{"Content-type":"application/octet-stream"},body:i});if(t.status!==200)return Promise.reject(t);let n=await t.arrayBuffer();return new Uint8Array(n)},SP=(i,e)=>{Ze(e,"encrypted",async t=>{try{let n=t.initDataType;if(n!=="skd"){console.error(`Received unexpected initialization data type "${n}"`);return}if(!e.mediaKeys){let l=await navigator.requestMediaKeySystemAccess("com.apple.fps",[{initDataTypes:[n],videoCapabilities:[{contentType:"application/vnd.apple.mpegurl",robustness:""}],distinctiveIdentifier:"not-allowed",persistentState:"not-allowed",sessionTypes:["temporary"]}]).then(c=>{var d;return(d=i.drmTypeCb)==null||d.call(i,Yl.FAIRPLAY),c}).catch(()=>{let c=pe("Cannot play DRM-protected content with current security configuration on this browser. Try playing in another browser."),d=new Q(c,Q.MEDIA_ERR_ENCRYPTED,!0);d.errorCategory=Ne.DRM,d.muxCode=ke.ENCRYPTED_UNSUPPORTED_KEY_SYSTEM,Qi(e,d)});if(!l)return;let u=await l.createMediaKeys();try{let c=await TP(tS(i,"fairplay")).catch(d=>{if(d instanceof Response){let h=ac(d,Ne.DRM,i);return console.error("mediaError",h==null?void 0:h.message,h==null?void 0:h.context),h?Promise.reject(h):Promise.reject(new Error("Unexpected error in app cert request"))}return Promise.reject(d)});await u.setServerCertificate(c).catch(()=>{let d=pe("Your server certificate failed when attempting to set it. This may be an issue with a no longer valid certificate."),h=new Q(d,Q.MEDIA_ERR_ENCRYPTED,!0);return h.errorCategory=Ne.DRM,h.muxCode=ke.ENCRYPTED_UPDATE_SERVER_CERT_FAILED,Promise.reject(h)})}catch(c){Qi(e,c);return}await e.setMediaKeys(u)}let r=t.initData;if(r==null){console.error(`Could not start encrypted playback due to missing initData in ${t.type} event`);return}let s=e.mediaKeys.createSession();s.addEventListener("keystatuseschange",()=>{s.keyStatuses.forEach(l=>{let u;if(l==="internal-error"){let c=pe("The DRM Content Decryption Module system had an internal failure. Try reloading the page, upading your browser, or playing in another browser.");u=new Q(c,Q.MEDIA_ERR_ENCRYPTED,!0),u.errorCategory=Ne.DRM,u.muxCode=ke.ENCRYPTED_CDM_ERROR}else if(l==="output-restricted"||l==="output-downscaled"){let c=pe("DRM playback is being attempted in an environment that is not sufficiently secure. User may see black screen.");u=new Q(c,Q.MEDIA_ERR_ENCRYPTED,!1),u.errorCategory=Ne.DRM,u.muxCode=ke.ENCRYPTED_OUTPUT_RESTRICTED}u&&Qi(e,u)})});let a=await Promise.all([s.generateRequest(n,r).catch(()=>{let l=pe("Failed to generate a DRM license request. This may be an issue with the player or your protected content."),u=new Q(l,Q.MEDIA_ERR_ENCRYPTED,!0);u.errorCategory=Ne.DRM,u.muxCode=ke.ENCRYPTED_GENERATE_REQUEST_FAILED,Qi(e,u)}),new Promise(l=>{s.addEventListener("message",u=>{l(u.message)},{once:!0})})]).then(([,l])=>l);s.generateRequest(n,r);let o=await _P(a,jl(i,"fairplay")).catch(l=>{if(l instanceof Response){let u=ac(l,Ne.DRM,i);return console.error("mediaError",u==null?void 0:u.message,u==null?void 0:u.context),u?Promise.reject(u):Promise.reject(new Error("Unexpected error in license key request"))}return Promise.reject(l)});await s.update(o).catch(()=>{let l=pe("Failed to update DRM license. This may be an issue with the player or your protected content."),u=new Q(l,Q.MEDIA_ERR_ENCRYPTED,!0);return u.errorCategory=Ne.DRM,u.muxCode=ke.ENCRYPTED_UPDATE_LICENSE_FAILED,Promise.reject(u)})}catch(n){Qi(e,n);return}})},jl=({playbackId:i,tokens:{drm:e}={},customDomain:t=Jn},n)=>{let r=Bc(i);return`https://license.${t.toLocaleLowerCase().endsWith(Jn)?t:Jn}/license/${n}/${r}?token=${e}`},tS=({playbackId:i,tokens:{drm:e}={},customDomain:t=Jn},n)=>{let r=Bc(i);return`https://license.${t.toLocaleLowerCase().endsWith(Jn)?t:Jn}/appcert/${n}/${r}?token=${e}`},iS=({playbackId:i,src:e,customDomain:t})=>{if(i)return!0;if(typeof e!="string")return!1;let n=window==null?void 0:window.location.href,r=new URL(e,n).hostname.toLocaleLowerCase();return r.includes(Jn)||!!t&&r.includes(t.toLocaleLowerCase())},AP=(i,e,t)=>{var n;let{envKey:r,disableTracking:s}=i,a=iS(i);if(!s&&(r||a)){let{playerInitTime:o,playerSoftwareName:l,playerSoftwareVersion:u,beaconCollectionDomain:c,debug:d,disableCookies:h}=i,f={...i.metadata,video_title:((n=i==null?void 0:i.metadata)==null?void 0:n.video_title)||void 0},m=p=>typeof p.player_error_code=="string"?!1:typeof i.errorTranslator=="function"?i.errorTranslator(p):p;Nm.monitor(e,{debug:d,beaconCollectionDomain:c,hlsjs:t,Hls:t?he:void 0,automaticErrorTracking:!1,errorTranslator:m,disableCookies:h,data:{...r?{env_key:r}:{},player_software_name:l,player_software:l,player_software_version:u,player_init_time:o,...f}})}},xP=(i,e,t)=>{var n,r;let s=eS(i,e),{src:a}=i,o=()=>{e.ended||!pP(e,t)||(Z_(e,t)?e.currentTime=e.buffered.end(e.buffered.length-1):e.dispatchEvent(new Event("ended")))},l,u,c=()=>{let d=hP(e),h,f;d.length>0&&(h=d.start(0),f=d.end(0)),(u!==f||l!==h)&&e.dispatchEvent(new CustomEvent("seekablechange",{composed:!0})),l=h,u=f};if(Ze(e,"durationchange",c),e&&s){let d=$c(i);if(typeof a=="string"){let h=()=>{if(cv(e)!==Ct.LIVE||Number.isFinite(e.duration))return;let m=setInterval(c,1e3);e.addEventListener("teardown",()=>{clearInterval(m)},{once:!0}),Ze(e,"durationchange",()=>{Number.isFinite(e.duration)&&clearInterval(m)})},f=async()=>eP(a,e,d).then(h).catch(m=>{if(m instanceof Response){let p=ac(m,Ne.VIDEO,i);if(p){Qi(e,p);return}}});if(e.preload==="none"){let m=()=>{f(),e.removeEventListener("loadedmetadata",p)},p=()=>{f(),e.removeEventListener("play",m)};Ze(e,"play",m,{once:!0}),Ze(e,"loadedmetadata",p,{once:!0})}else f();(n=i.tokens)!=null&&n.drm?SP(i,e):Ze(e,"encrypted",()=>{let m=pe("Attempting to play DRM-protected content without providing a DRM token."),p=new Q(m,Q.MEDIA_ERR_ENCRYPTED,!0);p.errorCategory=Ne.DRM,p.muxCode=ke.ENCRYPTED_MISSING_TOKEN,Qi(e,p)},{once:!0}),e.setAttribute("src",a),i.startTime&&(((r=Lt.get(e))!=null?r:{}).startTime=i.startTime,e.addEventListener("durationchange",nS,{once:!0}))}else e.removeAttribute("src");e.addEventListener("error",rS),e.addEventListener("error",pf),e.addEventListener("emptied",()=>{e.querySelectorAll("track[data-removeondestroy]").forEach(h=>{h.remove()})},{once:!0}),Ze(e,"pause",o),Ze(e,"seeked",o),Ze(e,"play",()=>{e.ended||X_(e.currentTime,e.duration)&&(e.currentTime=e.seekable.length?e.seekable.start(0):0)})}else t&&a?(t.once(he.Events.LEVEL_LOADED,(d,h)=>{iP(h.details,e,t),c(),cv(e)===Ct.LIVE&&!Number.isFinite(e.duration)&&(t.on(he.Events.LEVEL_UPDATED,c),Ze(e,"durationchange",()=>{Number.isFinite(e.duration)&&t.off(he.Events.LEVELS_UPDATED,c)}))}),t.on(he.Events.ERROR,(d,h)=>{Qi(e,bP(h,i))}),e.addEventListener("error",pf),Ze(e,"waiting",o),UC(i,t),$C(e,t),t.attachMedia(e)):console.error("It looks like the video you're trying to play will not work on this system! If possible, try upgrading to the newest versions of your browser or software.")};function nS(i){var e;let t=i.target,n=(e=Lt.get(t))==null?void 0:e.startTime;if(n&&wC(t.seekable,t.duration,n)){let r=t.preload==="auto";r&&(t.preload="none"),t.currentTime=n,r&&(t.preload="auto")}}async function rS(i){if(!i.isTrusted)return;i.stopImmediatePropagation();let e=i.target;if(!(e!=null&&e.error))return;let{message:t,code:n}=e.error,r=new Q(t,n);if(e.src&&n===Q.MEDIA_ERR_SRC_NOT_SUPPORTED&&e.readyState===HTMLMediaElement.HAVE_NOTHING){setTimeout(()=>{var s;let a=(s=dP(e))!=null?s:e.error;(a==null?void 0:a.code)===Q.MEDIA_ERR_SRC_NOT_SUPPORTED&&Qi(e,r)},500);return}if(e.src&&(n!==Q.MEDIA_ERR_DECODE||n!==void 0))try{let{status:s}=await fetch(e.src);r.data={response:{code:s}}}catch{}Qi(e,r)}function Qi(i,e){var t;e.fatal&&(((t=Lt.get(i))!=null?t:{}).error=e,i.dispatchEvent(new CustomEvent("error",{detail:e})))}function pf(i){var e,t;if(!(i instanceof CustomEvent)||!(i.detail instanceof Q))return;let n=i.target,r=i.detail;!r||!r.fatal||(((e=Lt.get(n))!=null?e:{}).error=r,(t=n.mux)==null||t.emit("error",{player_error_code:r.code,player_error_message:r.message,player_error_context:r.context}))}var bP=(i,e)=>{var t,n,r;console.error("getErrorFromHlsErrorData()",i);let s={[he.ErrorTypes.NETWORK_ERROR]:Q.MEDIA_ERR_NETWORK,[he.ErrorTypes.MEDIA_ERROR]:Q.MEDIA_ERR_DECODE,[he.ErrorTypes.KEY_SYSTEM_ERROR]:Q.MEDIA_ERR_ENCRYPTED},a=c=>[he.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,he.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED].includes(c.details)?Q.MEDIA_ERR_NETWORK:s[c.type],o=c=>{if(c.type===he.ErrorTypes.KEY_SYSTEM_ERROR)return Ne.DRM;if(c.type===he.ErrorTypes.NETWORK_ERROR)return Ne.VIDEO},l,u=a(i);if(u===Q.MEDIA_ERR_NETWORK&&i.response){let c=(t=o(i))!=null?t:Ne.VIDEO;l=(n=ac(i.response,c,e))!=null?n:new Q("",u)}else if(u===Q.MEDIA_ERR_ENCRYPTED)if(i.details===he.ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE){let c=pe("Attempting to play DRM-protected content without providing a DRM token.");l=new Q(c,Q.MEDIA_ERR_ENCRYPTED,i.fatal),l.errorCategory=Ne.DRM,l.muxCode=ke.ENCRYPTED_MISSING_TOKEN}else if(i.details===he.ErrorDetails.KEY_SYSTEM_NO_ACCESS){let c=pe("Cannot play DRM-protected content with current security configuration on this browser. Try playing in another browser.");l=new Q(c,Q.MEDIA_ERR_ENCRYPTED,i.fatal),l.errorCategory=Ne.DRM,l.muxCode=ke.ENCRYPTED_UNSUPPORTED_KEY_SYSTEM}else if(i.details===he.ErrorDetails.KEY_SYSTEM_NO_SESSION){let c=pe("Failed to generate a DRM license request. This may be an issue with the player or your protected content.");l=new Q(c,Q.MEDIA_ERR_ENCRYPTED,!0),l.errorCategory=Ne.DRM,l.muxCode=ke.ENCRYPTED_GENERATE_REQUEST_FAILED}else if(i.details===he.ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED){let c=pe("Failed to update DRM license. This may be an issue with the player or your protected content.");l=new Q(c,Q.MEDIA_ERR_ENCRYPTED,i.fatal),l.errorCategory=Ne.DRM,l.muxCode=ke.ENCRYPTED_UPDATE_LICENSE_FAILED}else if(i.details===he.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED){let c=pe("Your server certificate failed when attempting to set it. This may be an issue with a no longer valid certificate.");l=new Q(c,Q.MEDIA_ERR_ENCRYPTED,i.fatal),l.errorCategory=Ne.DRM,l.muxCode=ke.ENCRYPTED_UPDATE_SERVER_CERT_FAILED}else if(i.details===he.ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR){let c=pe("The DRM Content Decryption Module system had an internal failure. Try reloading the page, upading your browser, or playing in another browser.");l=new Q(c,Q.MEDIA_ERR_ENCRYPTED,i.fatal),l.errorCategory=Ne.DRM,l.muxCode=ke.ENCRYPTED_CDM_ERROR}else if(i.details===he.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED){let c=pe("DRM playback is being attempted in an environment that is not sufficiently secure. User may see black screen.");l=new Q(c,Q.MEDIA_ERR_ENCRYPTED,!1),l.errorCategory=Ne.DRM,l.muxCode=ke.ENCRYPTED_OUTPUT_RESTRICTED}else l=new Q(i.error.message,Q.MEDIA_ERR_ENCRYPTED,i.fatal),l.errorCategory=Ne.DRM,l.muxCode=ke.ENCRYPTED_ERROR;else l=new Q("",u,i.fatal);return l.context||(l.context=`${i.url?`url: ${i.url}
`:""}${i.response&&(i.response.code||i.response.text)?`response: ${i.response.code}, ${i.response.text}
`:""}${i.reason?`failure reason: ${i.reason}
`:""}${i.level?`level: ${i.level}
`:""}${i.parent?`parent stream controller: ${i.parent}
`:""}${i.buffer?`buffer length: ${i.buffer}
`:""}${i.error?`error: ${i.error}
`:""}${i.event?`event: ${i.event}
`:""}${i.err?`error message: ${(r=i.err)==null?void 0:r.message}
`:""}`),l.data=i,l},RP=(...i)=>{let e=re.useRef(null);return re.useEffect(()=>{i.forEach(t=>{t&&(typeof t=="function"?t(e.current):t.current=e.current)})},[i]),e},wP=()=>{try{return"0.24.4"}catch{}return"UNKNOWN"},IP=wP(),LP=()=>IP,kP=LP(),DP="mux-video-react",rp=ye.forwardRef((i,e)=>{var t,n;let{playbackId:r,src:s,children:a,autoPlay:o,preload:l,tokens:u,playbackToken:c,drmToken:d,...h}=i,f=Object.fromEntries(Object.entries(h).filter(([_])=>!Object.keys(rp.propTypes).includes(_))),[m]=re.useState((t=i.playerInitTime)!=null?t:oP()),[p,v]=re.useState((n=uv(i))!=null?n:s),g=re.useRef(void 0),E=re.useRef(null),y=RP(E,e);return re.useEffect(()=>{var _;v((_=uv(i))!=null?_:s)},[s,r]),re.useEffect(()=>{let _={playerInitTime:m,...i,src:p,playerSoftwareName:DP,playerSoftwareVersion:kP,autoplay:o},S=y.current;return S&&(g.current=gP(_,S,g.current)),()=>{J_(S,g.current),S=void 0,g.current=void 0}},[p]),re.useEffect(()=>{var _;(_=g.current)==null||_.setAutoplay(o)},[o]),re.useEffect(()=>{var _;(_=g.current)==null||_.setPreload(l)},[l]),ye.createElement("video",{ref:y,...f},a)});rp.propTypes={_hlsConfig:Re.any,beaconCollectionDomain:Re.string,customDomain:Re.string,debug:Re.bool,disableCookies:Re.bool,disableTracking:Re.bool,drmToken:Re.string,envKey:Re.string,errorTranslator:Re.func,liveEdgeStart:Re.number,maxResolution:Re.oneOf(["720p","1080p","1440p","2160p"]),metadata:Re.any,minResolution:Re.oneOf(["480p","540p","720p","1080p","1440p","2160p"]),playbackId:Re.string,playbackToken:Re.string,playerInitTime:Re.number,preferCmcd:Re.oneOf(Object.values(ql)),preferPlayback:Re.oneOf(Object.values(ff)),programStartTime:Re.number,programEndTime:Re.number,assetStartTime:Re.number,assetEndTime:Re.number,renditionOrder:Re.oneOf(["desc"]),startTime:Re.number,streamType:Re.oneOf(Object.values(Ct)),targetLiveWindow:Re.number,tokens:Re.object,type:Re.oneOf(bC)};var CP=rp;/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 *
 * Modified version of `@lit/react` for vanilla custom elements with support for SSR.
 */const PP=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),MP={className:"class",htmlFor:"for"};function OP(i){return i.toLowerCase()}function NP(i){if(typeof i=="boolean")return i?"":void 0;if(typeof i!="function"&&!(typeof i=="object"&&i!==null))return i}function Se({react:i,tagName:e,elementClass:t,events:n,displayName:r,toAttributeName:s=OP,toAttributeValue:a=NP}){const o=Number.parseInt(i.version)>=19,l=i.forwardRef((u,c)=>{var g,E;const d=i.useRef(null),h=i.useRef(new Map),f={},m={},p={},v={};for(const[y,_]of Object.entries(u)){if(PP.has(y)){p[y]=_;continue}const S=s(MP[y]??y);if(y in t.prototype&&!(y in(((g=globalThis.HTMLElement)==null?void 0:g.prototype)??{}))&&!((E=t.observedAttributes)!=null&&E.some(A=>A===S))){v[y]=_;continue}if(y.startsWith("on")){f[y]=_;continue}const b=a(_);S&&b!=null&&(m[S]=String(b),o||(p[S]=b)),S&&o&&(p[S]=_)}if(typeof window<"u"){for(const y in f){const _=f[y],S=y.endsWith("Capture"),b=((n==null?void 0:n[y])??y.slice(2).toLowerCase()).slice(0,S?-7:void 0);i.useLayoutEffect(()=>{const A=d==null?void 0:d.current;if(!(!A||typeof _!="function"))return A.addEventListener(b,_,S),()=>{A.removeEventListener(b,_,S)}},[d==null?void 0:d.current,_])}i.useLayoutEffect(()=>{if(d.current===null)return;const y=new Map;for(const _ in v)dv(d.current,_,v[_]),h.current.delete(_),y.set(_,v[_]);for(const[_,S]of h.current)dv(d.current,_,void 0);h.current=y})}if(typeof window>"u"&&(t!=null&&t.getTemplateHTML)&&(t!=null&&t.shadowRootOptions)){const{mode:y,delegatesFocus:_}=t.shadowRootOptions,S=i.createElement("template",{shadowrootmode:y,shadowrootdelegatesfocus:_,dangerouslySetInnerHTML:{__html:t.getTemplateHTML(m)}});p.children=[S,p.children]}return i.createElement(e,{...p,ref:i.useCallback(y=>{d.current=y,typeof c=="function"?c(y):c!==null&&(c.current=y)},[c])})});return l.displayName=r??t.name,l}function dv(i,e,t){var n;i[e]=t,t==null&&e in(((n=globalThis.HTMLElement)==null?void 0:n.prototype)??{})&&i.removeAttribute(e)}const z={MEDIA_PLAY_REQUEST:"mediaplayrequest",MEDIA_PAUSE_REQUEST:"mediapauserequest",MEDIA_MUTE_REQUEST:"mediamuterequest",MEDIA_UNMUTE_REQUEST:"mediaunmuterequest",MEDIA_VOLUME_REQUEST:"mediavolumerequest",MEDIA_SEEK_REQUEST:"mediaseekrequest",MEDIA_AIRPLAY_REQUEST:"mediaairplayrequest",MEDIA_ENTER_FULLSCREEN_REQUEST:"mediaenterfullscreenrequest",MEDIA_EXIT_FULLSCREEN_REQUEST:"mediaexitfullscreenrequest",MEDIA_PREVIEW_REQUEST:"mediapreviewrequest",MEDIA_ENTER_PIP_REQUEST:"mediaenterpiprequest",MEDIA_EXIT_PIP_REQUEST:"mediaexitpiprequest",MEDIA_ENTER_CAST_REQUEST:"mediaentercastrequest",MEDIA_EXIT_CAST_REQUEST:"mediaexitcastrequest",MEDIA_SHOW_TEXT_TRACKS_REQUEST:"mediashowtexttracksrequest",MEDIA_HIDE_TEXT_TRACKS_REQUEST:"mediahidetexttracksrequest",MEDIA_SHOW_SUBTITLES_REQUEST:"mediashowsubtitlesrequest",MEDIA_DISABLE_SUBTITLES_REQUEST:"mediadisablesubtitlesrequest",MEDIA_TOGGLE_SUBTITLES_REQUEST:"mediatogglesubtitlesrequest",MEDIA_PLAYBACK_RATE_REQUEST:"mediaplaybackraterequest",MEDIA_RENDITION_REQUEST:"mediarenditionrequest",MEDIA_AUDIO_TRACK_REQUEST:"mediaaudiotrackrequest",MEDIA_SEEK_TO_LIVE_REQUEST:"mediaseektoliverequest",REGISTER_MEDIA_STATE_RECEIVER:"registermediastatereceiver",UNREGISTER_MEDIA_STATE_RECEIVER:"unregistermediastatereceiver"},_e={MEDIA_CHROME_ATTRIBUTES:"mediachromeattributes",MEDIA_CONTROLLER:"mediacontroller"},sS={MEDIA_AIRPLAY_UNAVAILABLE:"mediaAirplayUnavailable",MEDIA_AUDIO_TRACK_ENABLED:"mediaAudioTrackEnabled",MEDIA_AUDIO_TRACK_LIST:"mediaAudioTrackList",MEDIA_AUDIO_TRACK_UNAVAILABLE:"mediaAudioTrackUnavailable",MEDIA_BUFFERED:"mediaBuffered",MEDIA_CAST_UNAVAILABLE:"mediaCastUnavailable",MEDIA_CHAPTERS_CUES:"mediaChaptersCues",MEDIA_CURRENT_TIME:"mediaCurrentTime",MEDIA_DURATION:"mediaDuration",MEDIA_ENDED:"mediaEnded",MEDIA_ERROR:"mediaError",MEDIA_ERROR_CODE:"mediaErrorCode",MEDIA_ERROR_MESSAGE:"mediaErrorMessage",MEDIA_FULLSCREEN_UNAVAILABLE:"mediaFullscreenUnavailable",MEDIA_HAS_PLAYED:"mediaHasPlayed",MEDIA_HEIGHT:"mediaHeight",MEDIA_IS_AIRPLAYING:"mediaIsAirplaying",MEDIA_IS_CASTING:"mediaIsCasting",MEDIA_IS_FULLSCREEN:"mediaIsFullscreen",MEDIA_IS_PIP:"mediaIsPip",MEDIA_LOADING:"mediaLoading",MEDIA_MUTED:"mediaMuted",MEDIA_PAUSED:"mediaPaused",MEDIA_PIP_UNAVAILABLE:"mediaPipUnavailable",MEDIA_PLAYBACK_RATE:"mediaPlaybackRate",MEDIA_PREVIEW_CHAPTER:"mediaPreviewChapter",MEDIA_PREVIEW_COORDS:"mediaPreviewCoords",MEDIA_PREVIEW_IMAGE:"mediaPreviewImage",MEDIA_PREVIEW_TIME:"mediaPreviewTime",MEDIA_RENDITION_LIST:"mediaRenditionList",MEDIA_RENDITION_SELECTED:"mediaRenditionSelected",MEDIA_RENDITION_UNAVAILABLE:"mediaRenditionUnavailable",MEDIA_SEEKABLE:"mediaSeekable",MEDIA_STREAM_TYPE:"mediaStreamType",MEDIA_SUBTITLES_LIST:"mediaSubtitlesList",MEDIA_SUBTITLES_SHOWING:"mediaSubtitlesShowing",MEDIA_TARGET_LIVE_WINDOW:"mediaTargetLiveWindow",MEDIA_TIME_IS_LIVE:"mediaTimeIsLive",MEDIA_VOLUME:"mediaVolume",MEDIA_VOLUME_LEVEL:"mediaVolumeLevel",MEDIA_VOLUME_UNAVAILABLE:"mediaVolumeUnavailable",MEDIA_WIDTH:"mediaWidth"},aS=Object.entries(sS),x=aS.reduce((i,[e,t])=>(i[e]=t.toLowerCase(),i),{}),FP={USER_INACTIVE:"userinactivechange",BREAKPOINTS_CHANGE:"breakpointchange",BREAKPOINTS_COMPUTED:"breakpointscomputed"},js=aS.reduce((i,[e,t])=>(i[e]=t.toLowerCase(),i),{...FP});Object.entries(js).reduce((i,[e,t])=>{const n=x[e];return n&&(i[t]=n),i},{userinactivechange:"userinactive"});const UP=Object.entries(x).reduce((i,[e,t])=>{const n=js[e];return n&&(i[t]=n),i},{userinactive:"userinactivechange"}),nn={SUBTITLES:"subtitles",CAPTIONS:"captions",DESCRIPTIONS:"descriptions",CHAPTERS:"chapters",METADATA:"metadata"},Ns={DISABLED:"disabled",HIDDEN:"hidden",SHOWING:"showing"},hv={MOUSE:"mouse",PEN:"pen",TOUCH:"touch"},si={UNAVAILABLE:"unavailable",UNSUPPORTED:"unsupported"},mn={LIVE:"live",ON_DEMAND:"on-demand",UNKNOWN:"unknown"},$P={INLINE:"inline",FULLSCREEN:"fullscreen",PICTURE_IN_PICTURE:"picture-in-picture"};function BP(i){return i==null?void 0:i.map(GP).join(" ")}function GP(i){if(i){const{id:e,width:t,height:n}=i;return[e,t,n].filter(r=>r!=null).join(":")}}function HP(i){return i==null?void 0:i.map(VP).join(" ")}function VP(i){if(i){const{id:e,kind:t,language:n,label:r}=i;return[e,t,n,r].filter(s=>s!=null).join(":")}}function sp(i){return typeof i=="number"&&!Number.isNaN(i)&&Number.isFinite(i)}const oS=i=>new Promise(e=>setTimeout(e,i)),fv=[{singular:"hour",plural:"hours"},{singular:"minute",plural:"minutes"},{singular:"second",plural:"seconds"}],KP=(i,e)=>{const t=i===1?fv[e].singular:fv[e].plural;return`${i} ${t}`},Ka=i=>{if(!sp(i))return"";const e=Math.abs(i),t=e!==i,n=new Date(0,0,0,0,0,e,0);return`${[n.getHours(),n.getMinutes(),n.getSeconds()].map((o,l)=>o&&KP(o,l)).filter(o=>o).join(", ")}${t?" remaining":""}`};function kr(i,e){let t=!1;i<0&&(t=!0,i=0-i),i=i<0?0:i;let n=Math.floor(i%60),r=Math.floor(i/60%60),s=Math.floor(i/3600);const a=Math.floor(e/60%60),o=Math.floor(e/3600);return(isNaN(i)||i===1/0)&&(s=r=n="0"),s=s>0||o>0?s+":":"",r=((s||a>=10)&&r<10?"0"+r:r)+":",n=n<10?"0"+n:n,(t?"-":"")+s+r+n}const lS={"Start airplay":"Start airplay","Stop airplay":"Stop airplay",Audio:"Audio",Captions:"Captions","Enable captions":"Enable captions","Disable captions":"Disable captions","Start casting":"Start casting","Stop casting":"Stop casting","Enter fullscreen mode":"Enter fullscreen mode","Exit fullscreen mode":"Exit fullscreen mode",Mute:"Mute",Unmute:"Unmute","Enter picture in picture mode":"Enter picture in picture mode","Exit picture in picture mode":"Exit picture in picture mode",Play:"Play",Pause:"Pause","Playback rate":"Playback rate","Playback rate {playbackRate}":"Playback rate {playbackRate}",Quality:"Quality","Seek backward":"Seek backward","Seek forward":"Seek forward",Settings:"Settings","audio player":"audio player","video player":"video player",volume:"volume",seek:"seek","closed captions":"closed captions","current playback rate":"current playback rate","playback time":"playback time","media loading":"media loading",settings:"settings","audio tracks":"audio tracks",quality:"quality",play:"play",pause:"pause",mute:"mute",unmute:"unmute",live:"live","start airplay":"start airplay","stop airplay":"stop airplay","start casting":"start casting","stop casting":"stop casting","enter fullscreen mode":"enter fullscreen mode","exit fullscreen mode":"exit fullscreen mode","enter picture in picture mode":"enter picture in picture mode","exit picture in picture mode":"exit picture in picture mode","seek to live":"seek to live","playing live":"playing live","seek back {seekOffset} seconds":"seek back {seekOffset} seconds","seek forward {seekOffset} seconds":"seek forward {seekOffset} seconds","Network Error":"Network Error","Decode Error":"Decode Error","Source Not Supported":"Source Not Supported","Encryption Error":"Encryption Error","A network error caused the media download to fail.":"A network error caused the media download to fail.","A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.":"A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.","An unsupported error occurred. The server or network failed, or your browser does not support this format.":"An unsupported error occurred. The server or network failed, or your browser does not support this format.","The media is encrypted and there are no keys to decrypt it.":"The media is encrypted and there are no keys to decrypt it."},WP={en:lS},qP=()=>{var i;return((i=globalThis.navigator)==null?void 0:i.language.split("-")[0])||"en"},te=(i,e={})=>{var t;return(((t=WP[qP()])==null?void 0:t[i])||lS[i]).replace(/\{(\w+)\}/g,(r,s)=>e[s]!==void 0?String(e[s]):`{${s}}`)};class uS{addEventListener(){}removeEventListener(){}dispatchEvent(){return!0}}class cS extends uS{}class mv extends cS{constructor(){super(...arguments),this.role=null}}class YP{observe(){}unobserve(){}disconnect(){}}const dS={createElement:function(){return new Eo.HTMLElement},createElementNS:function(){return new Eo.HTMLElement},addEventListener(){},removeEventListener(){},dispatchEvent(i){return!1}},Eo={ResizeObserver:YP,document:dS,Node:cS,Element:mv,HTMLElement:class extends mv{constructor(){super(...arguments),this.innerHTML=""}get content(){return new Eo.DocumentFragment}},DocumentFragment:class extends uS{},customElements:{get:function(){},define:function(){},whenDefined:function(){}},localStorage:{getItem(i){return null},setItem(i,e){},removeItem(i){}},CustomEvent:function(){},getComputedStyle:function(){},navigator:{languages:[],get userAgent(){return""}},matchMedia(i){return{matches:!1,media:i}}},hS=typeof window>"u"||typeof window.customElements>"u",fS=Object.keys(Eo).every(i=>i in globalThis),C=hS&&!fS?Eo:globalThis,ue=hS&&!fS?dS:globalThis.document,pv=new WeakMap,ap=i=>{let e=pv.get(i);return e||pv.set(i,e=new Set),e},mS=new C.ResizeObserver(i=>{for(const e of i)for(const t of ap(e.target))t(e)});function pS(i,e){ap(i).add(e),mS.observe(i)}function gS(i,e){const t=ap(i);t.delete(e),t.size||mS.unobserve(i)}function jP(i){const e={};for(const t of i)e[t.name]=t.value;return e}function zP(i){var e;return(e=QP(i))!=null?e:Co(i,"media-controller")}function QP(i){var e;const{MEDIA_CONTROLLER:t}=_e,n=i.getAttribute(t);if(n)return(e=ZP(i))==null?void 0:e.getElementById(n)}const vS=(i,e,t=".value")=>{const n=i.querySelector(t);n&&(n.textContent=e)},XP=(i,e)=>{const t=`slot[name="${e}"]`,n=i.shadowRoot.querySelector(t);return n?n.children:[]},ES=(i,e)=>XP(i,e)[0],ea=(i,e)=>!i||!e?!1:i!=null&&i.contains(e)?!0:ea(i,e.getRootNode().host),Co=(i,e)=>{if(!i)return null;const t=i.closest(e);return t||Co(i.getRootNode().host,e)};function yS(i=document){var e;const t=i==null?void 0:i.activeElement;return t?(e=yS(t.shadowRoot))!=null?e:t:null}function ZP(i){var e;const t=(e=i==null?void 0:i.getRootNode)==null?void 0:e.call(i);return t instanceof ShadowRoot||t instanceof Document?t:null}function TS(i,{depth:e=3,checkOpacity:t=!0,checkVisibilityCSS:n=!0}={}){if(i.checkVisibility)return i.checkVisibility({checkOpacity:t,checkVisibilityCSS:n});let r=i;for(;r&&e>0;){const s=getComputedStyle(r);if(t&&s.opacity==="0"||n&&s.visibility==="hidden"||s.display==="none")return!1;r=r.parentElement,e--}return!0}function JP(i,e,t,n){const r=Xd(t,n),s=Xd(t,{x:i,y:e}),a=Xd(n,{x:i,y:e});return s>r||a>r?s>a?1:0:s/r}function Xd(i,e){return Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2))}function Je(i,e){const t=eM(i,n=>n===e);return t||tM(i,e)}function eM(i,e){var t,n;let r;for(r of(t=i.querySelectorAll("style:not([media])"))!=null?t:[]){let s;try{s=(n=r.sheet)==null?void 0:n.cssRules}catch{continue}for(const a of s??[])if(e(a.selectorText))return a}}function tM(i,e){var t,n;const r=(t=i.querySelectorAll("style:not([media])"))!=null?t:[],s=r==null?void 0:r[r.length-1];return s!=null&&s.sheet?(s==null||s.sheet.insertRule(`${e}{}`,s.sheet.cssRules.length),(n=s.sheet.cssRules)==null?void 0:n[s.sheet.cssRules.length-1]):(console.warn("Media Chrome: No style sheet found on style tag of",i),{style:{setProperty:()=>{},removeProperty:()=>"",getPropertyValue:()=>""}})}function Ke(i,e,t=Number.NaN){const n=i.getAttribute(e);return n!=null?+n:t}function pt(i,e,t){const n=+t;if(t==null||Number.isNaN(n)){i.hasAttribute(e)&&i.removeAttribute(e);return}Ke(i,e,void 0)!==n&&i.setAttribute(e,`${n}`)}function ge(i,e){return i.hasAttribute(e)}function ve(i,e,t){if(t==null){i.hasAttribute(e)&&i.removeAttribute(e);return}ge(i,e)!=t&&i.toggleAttribute(e,t)}function We(i,e,t=null){var n;return(n=i.getAttribute(e))!=null?n:t}function qe(i,e,t){if(t==null){i.hasAttribute(e)&&i.removeAttribute(e);return}const n=`${t}`;We(i,e,void 0)!==n&&i.setAttribute(e,n)}var _S=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},Ln=(i,e,t)=>(_S(i,e,"read from private field"),t?t.call(i):e.get(i)),iM=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},dl=(i,e,t,n)=>(_S(i,e,"write to private field"),e.set(i,t),t),Ft;const SS=ue.createElement("template");SS.innerHTML=`
<style>
  :host {
    display: var(--media-control-display, var(--media-gesture-receiver-display, inline-block));
    box-sizing: border-box;
  }
</style>
`;class AS extends C.HTMLElement{constructor(e={}){if(super(),iM(this,Ft,void 0),!this.shadowRoot){const t=this.attachShadow({mode:"open"}),n=SS.content.cloneNode(!0);this.nativeEl=n;let r=e.slotTemplate;r||(r=ue.createElement("template"),r.innerHTML=`<slot>${e.defaultContent||""}</slot>`),this.nativeEl.appendChild(r.content.cloneNode(!0)),t.appendChild(n)}}static get observedAttributes(){return[_e.MEDIA_CONTROLLER,x.MEDIA_PAUSED]}attributeChangedCallback(e,t,n){var r,s,a,o,l;e===_e.MEDIA_CONTROLLER&&(t&&((s=(r=Ln(this,Ft))==null?void 0:r.unassociateElement)==null||s.call(r,this),dl(this,Ft,null)),n&&this.isConnected&&(dl(this,Ft,(a=this.getRootNode())==null?void 0:a.getElementById(n)),(l=(o=Ln(this,Ft))==null?void 0:o.associateElement)==null||l.call(o,this)))}connectedCallback(){var e,t,n,r;this.tabIndex=-1,this.setAttribute("aria-hidden","true"),dl(this,Ft,nM(this)),this.getAttribute(_e.MEDIA_CONTROLLER)&&((t=(e=Ln(this,Ft))==null?void 0:e.associateElement)==null||t.call(e,this)),(n=Ln(this,Ft))==null||n.addEventListener("pointerdown",this),(r=Ln(this,Ft))==null||r.addEventListener("click",this)}disconnectedCallback(){var e,t,n,r;this.getAttribute(_e.MEDIA_CONTROLLER)&&((t=(e=Ln(this,Ft))==null?void 0:e.unassociateElement)==null||t.call(e,this)),(n=Ln(this,Ft))==null||n.removeEventListener("pointerdown",this),(r=Ln(this,Ft))==null||r.removeEventListener("click",this),dl(this,Ft,null)}handleEvent(e){var t;const n=(t=e.composedPath())==null?void 0:t[0];if(["video","media-controller"].includes(n==null?void 0:n.localName)){if(e.type==="pointerdown")this._pointerType=e.pointerType;else if(e.type==="click"){const{clientX:s,clientY:a}=e,{left:o,top:l,width:u,height:c}=this.getBoundingClientRect(),d=s-o,h=a-l;if(d<0||h<0||d>u||h>c||u===0&&c===0)return;const{pointerType:f=this._pointerType}=e;if(this._pointerType=void 0,f===hv.TOUCH){this.handleTap(e);return}else if(f===hv.MOUSE){this.handleMouseClick(e);return}}}}get mediaPaused(){return ge(this,x.MEDIA_PAUSED)}set mediaPaused(e){ve(this,x.MEDIA_PAUSED,e)}handleTap(e){}handleMouseClick(e){const t=this.mediaPaused?z.MEDIA_PLAY_REQUEST:z.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new C.CustomEvent(t,{composed:!0,bubbles:!0}))}}Ft=new WeakMap;function nM(i){var e;const t=i.getAttribute(_e.MEDIA_CONTROLLER);return t?(e=i.getRootNode())==null?void 0:e.getElementById(t):Co(i,"media-controller")}C.customElements.get("media-gesture-receiver")||C.customElements.define("media-gesture-receiver",AS);var rM=AS,op=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},zt=(i,e,t)=>(op(i,e,"read from private field"),t?t.call(i):e.get(i)),Yt=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},mr=(i,e,t,n)=>(op(i,e,"write to private field"),e.set(i,t),t),ui=(i,e,t)=>(op(i,e,"access private method"),t),oc,is,yo,ws,zl,gf,xS,Aa,Ql,vf,bS,Ef,RS,To,Gc,Hc,lp,zs,_o;const se={AUDIO:"audio",AUTOHIDE:"autohide",BREAKPOINTS:"breakpoints",GESTURES_DISABLED:"gesturesdisabled",KEYBOARD_CONTROL:"keyboardcontrol",NO_AUTOHIDE:"noautohide",USER_INACTIVE:"userinactive"},wS=ue.createElement("template");wS.innerHTML=`
  <style>
    
    :host([${x.MEDIA_IS_FULLSCREEN}]) ::slotted([slot=media]) {
      outline: none;
    }

    :host {
      box-sizing: border-box;
      position: relative;
      display: inline-block;
      line-height: 0;
      background-color: var(--media-background-color, #000);
    }

    :host(:not([${se.AUDIO}])) [part~=layer]:not([part~=media-layer]) {
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      display: flex;
      flex-flow: column nowrap;
      align-items: start;
      pointer-events: none;
      background: none;
    }

    slot[name=media] {
      display: var(--media-slot-display, contents);
    }

    
    :host([${se.AUDIO}]) slot[name=media] {
      display: var(--media-slot-display, none);
    }

    
    :host([${se.AUDIO}]) [part~=layer][part~=gesture-layer] {
      height: 0;
      display: block;
    }

    
    :host(:not([${se.AUDIO}])[${se.GESTURES_DISABLED}]) ::slotted([slot=gestures-chrome]),
    :host(:not([${se.AUDIO}])[${se.GESTURES_DISABLED}]) media-gesture-receiver[slot=gestures-chrome] {
      display: none;
    }

    
    ::slotted(:not([slot=media]):not([slot=poster]):not(media-loading-indicator):not([role=dialog]):not([hidden])) {
      pointer-events: auto;
    }

    :host(:not([${se.AUDIO}])) *[part~=layer][part~=centered-layer] {
      align-items: center;
      justify-content: center;
    }

    :host(:not([${se.AUDIO}])) ::slotted(media-gesture-receiver[slot=gestures-chrome]),
    :host(:not([${se.AUDIO}])) media-gesture-receiver[slot=gestures-chrome] {
      align-self: stretch;
      flex-grow: 1;
    }

    slot[name=middle-chrome] {
      display: inline;
      flex-grow: 1;
      pointer-events: none;
      background: none;
    }

    
    ::slotted([slot=media]),
    ::slotted([slot=poster]) {
      width: 100%;
      height: 100%;
    }

    
    :host(:not([${se.AUDIO}])) .spacer {
      flex-grow: 1;
    }

    
    :host(:-webkit-full-screen) {
      
      width: 100% !important;
      height: 100% !important;
    }

    
    ::slotted(:not([slot=media]):not([slot=poster]):not([${se.NO_AUTOHIDE}]):not([hidden]):not([role=dialog])) {
      opacity: 1;
      transition: var(--media-control-transition-in, opacity 0.25s);
    }

    
    :host([${se.USER_INACTIVE}]:not([${x.MEDIA_PAUSED}]):not([${x.MEDIA_IS_AIRPLAYING}]):not([${x.MEDIA_IS_CASTING}]):not([${se.AUDIO}])) ::slotted(:not([slot=media]):not([slot=poster]):not([${se.NO_AUTOHIDE}]):not([role=dialog])) {
      opacity: 0;
      transition: var(--media-control-transition-out, opacity 1s);
    }

    :host([${se.USER_INACTIVE}]:not([${x.MEDIA_PAUSED}]):not([${x.MEDIA_IS_CASTING}]):not([${se.AUDIO}])) ::slotted([slot=media]) {
      cursor: none;
    }

    ::slotted(media-control-bar)  {
      align-self: stretch;
    }

    
    :host(:not([${se.AUDIO}])[${x.MEDIA_HAS_PLAYED}]) slot[name=poster] {
      display: none;
    }

    ::slotted([role=dialog]) {
      width: 100%;
      height: 100%;
      align-self: center;
    }

    ::slotted([role=menu]) {
      align-self: end;
    }
  </style>

  <slot name="media" part="layer media-layer"></slot>
  <slot name="poster" part="layer poster-layer"></slot>
  <slot name="gestures-chrome" part="layer gesture-layer">
    <media-gesture-receiver slot="gestures-chrome"></media-gesture-receiver>
  </slot>
  <span part="layer vertical-layer">
    <slot name="top-chrome" part="top chrome"></slot>
    <slot name="middle-chrome" part="middle chrome"></slot>
    <slot name="centered-chrome" part="layer centered-layer center centered chrome"></slot>
    
    <slot part="bottom chrome"></slot>
  </span>
  <slot name="dialog" part="layer dialog-layer"></slot>
`;const sM=Object.values(x),aM="sm:384 md:576 lg:768 xl:960";function oM(i){IS(i.target,i.contentRect.width)}function IS(i,e){var t;if(!i.isConnected)return;const n=(t=i.getAttribute(se.BREAKPOINTS))!=null?t:aM,r=lM(n),s=uM(r,e);let a=!1;if(Object.keys(r).forEach(o=>{if(s.includes(o)){i.hasAttribute(`breakpoint${o}`)||(i.setAttribute(`breakpoint${o}`,""),a=!0);return}i.hasAttribute(`breakpoint${o}`)&&(i.removeAttribute(`breakpoint${o}`),a=!0)}),a){const o=new CustomEvent(js.BREAKPOINTS_CHANGE,{detail:s});i.dispatchEvent(o)}i.breakpointsComputed||(i.breakpointsComputed=!0,i.dispatchEvent(new CustomEvent(js.BREAKPOINTS_COMPUTED,{bubbles:!0,composed:!0})))}function lM(i){const e=i.split(/\s+/);return Object.fromEntries(e.map(t=>t.split(":")))}function uM(i,e){return Object.keys(i).filter(t=>e>=parseInt(i[t]))}class up extends C.HTMLElement{constructor(){super(),Yt(this,gf),Yt(this,vf),Yt(this,Ef),Yt(this,To),Yt(this,Hc),Yt(this,zs),Yt(this,oc,0),Yt(this,is,null),Yt(this,yo,null),Yt(this,ws,void 0),this.breakpointsComputed=!1,Yt(this,zl,new MutationObserver(ui(this,gf,xS).bind(this))),Yt(this,Aa,!1),Yt(this,Ql,t=>{zt(this,Aa)||(setTimeout(()=>{oM(t),mr(this,Aa,!1)},0),mr(this,Aa,!0))}),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(wS.content.cloneNode(!0)));const e=this.querySelector(":scope > slot[slot=media]");e&&e.addEventListener("slotchange",()=>{if(!e.assignedElements({flatten:!0}).length){zt(this,is)&&this.mediaUnsetCallback(zt(this,is));return}this.handleMediaUpdated(this.media)})}static get observedAttributes(){return[se.AUTOHIDE,se.GESTURES_DISABLED].concat(sM).filter(e=>![x.MEDIA_RENDITION_LIST,x.MEDIA_AUDIO_TRACK_LIST,x.MEDIA_CHAPTERS_CUES,x.MEDIA_WIDTH,x.MEDIA_HEIGHT,x.MEDIA_ERROR,x.MEDIA_ERROR_MESSAGE].includes(e))}attributeChangedCallback(e,t,n){e.toLowerCase()==se.AUTOHIDE&&(this.autohide=n)}get media(){let e=this.querySelector(":scope > [slot=media]");return(e==null?void 0:e.nodeName)=="SLOT"&&(e=e.assignedElements({flatten:!0})[0]),e}async handleMediaUpdated(e){e&&(mr(this,is,e),e.localName.includes("-")&&await C.customElements.whenDefined(e.localName),this.mediaSetCallback(e))}connectedCallback(){var e;zt(this,zl).observe(this,{childList:!0,subtree:!0}),pS(this,zt(this,Ql));const t=this.getAttribute(se.AUDIO)!=null,n=te(t?"audio player":"video player");this.setAttribute("role","region"),this.setAttribute("aria-label",n),this.handleMediaUpdated(this.media),this.setAttribute(se.USER_INACTIVE,""),IS(this,this.getBoundingClientRect().width),this.addEventListener("pointerdown",this),this.addEventListener("pointermove",this),this.addEventListener("pointerup",this),this.addEventListener("mouseleave",this),this.addEventListener("keyup",this),(e=C.window)==null||e.addEventListener("mouseup",this)}disconnectedCallback(){var e;zt(this,zl).disconnect(),gS(this,zt(this,Ql)),this.media&&this.mediaUnsetCallback(this.media),(e=C.window)==null||e.removeEventListener("mouseup",this)}mediaSetCallback(e){}mediaUnsetCallback(e){mr(this,is,null)}handleEvent(e){switch(e.type){case"pointerdown":mr(this,oc,e.timeStamp);break;case"pointermove":ui(this,vf,bS).call(this,e);break;case"pointerup":ui(this,Ef,RS).call(this,e);break;case"mouseleave":ui(this,To,Gc).call(this);break;case"mouseup":this.removeAttribute(se.KEYBOARD_CONTROL);break;case"keyup":ui(this,zs,_o).call(this),this.setAttribute(se.KEYBOARD_CONTROL,"");break}}set autohide(e){const t=Number(e);mr(this,ws,isNaN(t)?0:t)}get autohide(){return(zt(this,ws)===void 0?2:zt(this,ws)).toString()}get breakpoints(){return We(this,se.BREAKPOINTS)}set breakpoints(e){qe(this,se.BREAKPOINTS,e)}get audio(){return ge(this,se.AUDIO)}set audio(e){ve(this,se.AUDIO,e)}get gesturesDisabled(){return ge(this,se.GESTURES_DISABLED)}set gesturesDisabled(e){ve(this,se.GESTURES_DISABLED,e)}get keyboardControl(){return ge(this,se.KEYBOARD_CONTROL)}set keyboardControl(e){ve(this,se.KEYBOARD_CONTROL,e)}get noAutohide(){return ge(this,se.NO_AUTOHIDE)}set noAutohide(e){ve(this,se.NO_AUTOHIDE,e)}get userInteractive(){return ge(this,se.USER_INACTIVE)}set userInteractive(e){ve(this,se.USER_INACTIVE,e)}}oc=new WeakMap;is=new WeakMap;yo=new WeakMap;ws=new WeakMap;zl=new WeakMap;gf=new WeakSet;xS=function(i){const e=this.media;for(const t of i){if(t.type!=="childList")continue;const n=t.removedNodes;for(const r of n){if(r.slot!="media"||t.target!=this)continue;let s=t.previousSibling&&t.previousSibling.previousElementSibling;if(!s||!e)this.mediaUnsetCallback(r);else{let a=s.slot!=="media";for(;(s=s.previousSibling)!==null;)s.slot=="media"&&(a=!1);a&&this.mediaUnsetCallback(r)}}if(e)for(const r of t.addedNodes)r===e&&this.handleMediaUpdated(e)}};Aa=new WeakMap;Ql=new WeakMap;vf=new WeakSet;bS=function(i){i.pointerType!=="mouse"&&i.timeStamp-zt(this,oc)<250||(ui(this,Hc,lp).call(this),clearTimeout(zt(this,yo)),[this,this.media].includes(i.target)&&ui(this,zs,_o).call(this))};Ef=new WeakSet;RS=function(i){if(i.pointerType==="touch"){const e=!this.hasAttribute(se.USER_INACTIVE);[this,this.media].includes(i.target)&&e?ui(this,To,Gc).call(this):ui(this,zs,_o).call(this)}else i.composedPath().some(e=>["media-play-button","media-fullscreen-button"].includes(e==null?void 0:e.localName))&&ui(this,zs,_o).call(this)};To=new WeakSet;Gc=function(){if(zt(this,ws)<0||this.hasAttribute(se.USER_INACTIVE))return;this.setAttribute(se.USER_INACTIVE,"");const i=new C.CustomEvent(js.USER_INACTIVE,{composed:!0,bubbles:!0,detail:!0});this.dispatchEvent(i)};Hc=new WeakSet;lp=function(){if(!this.hasAttribute(se.USER_INACTIVE))return;this.removeAttribute(se.USER_INACTIVE);const i=new C.CustomEvent(js.USER_INACTIVE,{composed:!0,bubbles:!0,detail:!1});this.dispatchEvent(i)};zs=new WeakSet;_o=function(){ui(this,Hc,lp).call(this),clearTimeout(zt(this,yo));const i=parseInt(this.autohide);i<0||mr(this,yo,setTimeout(()=>{ui(this,To,Gc).call(this)},i*1e3))};C.customElements.get("media-container")||C.customElements.define("media-container",up);var cM=up,LS=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},ht=(i,e,t)=>(LS(i,e,"read from private field"),t?t.call(i):e.get(i)),ma=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},hl=(i,e,t,n)=>(LS(i,e,"write to private field"),e.set(i,t),t),ns,rs,lc,xr,cn,Pn;class kS{constructor(e,t,{defaultValue:n}={defaultValue:void 0}){ma(this,cn),ma(this,ns,void 0),ma(this,rs,void 0),ma(this,lc,void 0),ma(this,xr,new Set),hl(this,ns,e),hl(this,rs,t),hl(this,lc,new Set(n))}[Symbol.iterator](){return ht(this,cn,Pn).values()}get length(){return ht(this,cn,Pn).size}get value(){var e;return(e=[...ht(this,cn,Pn)].join(" "))!=null?e:""}set value(e){var t;e!==this.value&&(hl(this,xr,new Set),this.add(...(t=e==null?void 0:e.split(" "))!=null?t:[]))}toString(){return this.value}item(e){return[...ht(this,cn,Pn)][e]}values(){return ht(this,cn,Pn).values()}forEach(e,t){ht(this,cn,Pn).forEach(e,t)}add(...e){var t,n;e.forEach(r=>ht(this,xr).add(r)),!(this.value===""&&!((t=ht(this,ns))!=null&&t.hasAttribute(`${ht(this,rs)}`)))&&((n=ht(this,ns))==null||n.setAttribute(`${ht(this,rs)}`,`${this.value}`))}remove(...e){var t;e.forEach(n=>ht(this,xr).delete(n)),(t=ht(this,ns))==null||t.setAttribute(`${ht(this,rs)}`,`${this.value}`)}contains(e){return ht(this,cn,Pn).has(e)}toggle(e,t){return typeof t<"u"?t?(this.add(e),!0):(this.remove(e),!1):this.contains(e)?(this.remove(e),!1):(this.add(e),!0)}replace(e,t){return this.remove(e),this.add(t),e===t}}ns=new WeakMap;rs=new WeakMap;lc=new WeakMap;xr=new WeakMap;cn=new WeakSet;Pn=function(){return ht(this,xr).size?ht(this,xr):ht(this,lc)};const dM=(i="")=>i.split(/\s+/),DS=(i="")=>{const[e,t,n]=i.split(":"),r=n?decodeURIComponent(n):void 0;return{kind:e==="cc"?nn.CAPTIONS:nn.SUBTITLES,language:t,label:r}},CS=(i="",e={})=>dM(i).map(t=>{const n=DS(t);return{...e,...n}}),PS=i=>i?Array.isArray(i)?i.map(e=>typeof e=="string"?DS(e):e):typeof i=="string"?CS(i):[i]:[],hM=({kind:i,label:e,language:t}={kind:"subtitles"})=>e?`${i==="captions"?"cc":"sb"}:${t}:${encodeURIComponent(e)}`:t,yf=(i=[])=>Array.prototype.map.call(i,hM).join(" "),fM=(i,e)=>t=>t[i]===e,MS=i=>{const e=Object.entries(i).map(([t,n])=>fM(t,n));return t=>e.every(n=>n(t))},Wa=(i,e=[],t=[])=>{const n=PS(t).map(MS),r=s=>n.some(a=>a(s));Array.from(e).filter(r).forEach(s=>{s.mode=i})},Vc=(i,e=()=>!0)=>{if(!(i!=null&&i.textTracks))return[];const t=typeof e=="function"?e:MS(e);return Array.from(i.textTracks).filter(t)},mM=i=>{var e;return!!((e=i.mediaSubtitlesShowing)!=null&&e.length)||i.hasAttribute(x.MEDIA_SUBTITLES_SHOWING)},pM=i=>{var e;const{media:t,fullscreenElement:n}=i,r=n&&"requestFullscreen"in n?"requestFullscreen":n&&"webkitRequestFullScreen"in n?"webkitRequestFullScreen":void 0;if(r){const s=(e=n[r])==null?void 0:e.call(n);if(s instanceof Promise)return s.catch(()=>{})}else t!=null&&t.webkitEnterFullscreen?t.webkitEnterFullscreen():t!=null&&t.requestFullscreen&&t.requestFullscreen()},gv="exitFullscreen"in ue?"exitFullscreen":"webkitExitFullscreen"in ue?"webkitExitFullscreen":"webkitCancelFullScreen"in ue?"webkitCancelFullScreen":void 0,gM=i=>{var e;const{documentElement:t}=i;if(gv){const n=(e=t==null?void 0:t[gv])==null?void 0:e.call(t);if(n instanceof Promise)return n.catch(()=>{})}},xa="fullscreenElement"in ue?"fullscreenElement":"webkitFullscreenElement"in ue?"webkitFullscreenElement":void 0,vM=i=>{const{documentElement:e,media:t}=i,n=e==null?void 0:e[xa];return!n&&"webkitDisplayingFullscreen"in t&&"webkitPresentationMode"in t&&t.webkitDisplayingFullscreen&&t.webkitPresentationMode===$P.FULLSCREEN?t:n},EM=i=>{var e;const{media:t,documentElement:n,fullscreenElement:r=t}=i;if(!t||!n)return!1;const s=vM(i);if(!s)return!1;if(s===r||s===t)return!0;if(s.localName.includes("-")){let a=s.shadowRoot;if(!(xa in a))return ea(s,r);for(;a!=null&&a[xa];){if(a[xa]===r)return!0;a=(e=a[xa])==null?void 0:e.shadowRoot}}return!1},yM="fullscreenEnabled"in ue?"fullscreenEnabled":"webkitFullscreenEnabled"in ue?"webkitFullscreenEnabled":void 0,TM=i=>{const{documentElement:e,media:t}=i;return!!(e!=null&&e[yM])||t&&"webkitSupportsFullscreen"in t};let fl;const cp=()=>{var i,e;return fl||(fl=(e=(i=ue)==null?void 0:i.createElement)==null?void 0:e.call(i,"video"),fl)},_M=async(i=cp())=>{if(!i)return!1;const e=i.volume;i.volume=e/2+.1;const t=new AbortController,n=await Promise.race([SM(i,t.signal),AM(i,e)]);return t.abort(),n},SM=(i,e)=>new Promise(t=>{i.addEventListener("volumechange",()=>t(!0),{signal:e})}),AM=async(i,e)=>{for(let t=0;t<10;t++){if(i.volume===e)return!1;await oS(10)}return i.volume!==e},xM=/.*Version\/.*Safari\/.*/.test(C.navigator.userAgent),OS=(i=cp())=>C.matchMedia("(display-mode: standalone)").matches&&xM?!1:typeof(i==null?void 0:i.requestPictureInPicture)=="function",NS=(i=cp())=>TM({documentElement:ue,media:i}),bM=NS(),RM=OS(),wM=!!C.WebKitPlaybackTargetAvailabilityEvent,IM=!!C.chrome,uc=i=>Vc(i.media,e=>[nn.SUBTITLES,nn.CAPTIONS].includes(e.kind)).sort((e,t)=>e.kind>=t.kind?1:-1),FS=i=>Vc(i.media,e=>e.mode===Ns.SHOWING&&[nn.SUBTITLES,nn.CAPTIONS].includes(e.kind)),US=(i,e)=>{const t=uc(i),n=FS(i),r=!!n.length;if(t.length){if(e===!1||r&&e!==!0)Wa(Ns.DISABLED,t,n);else if(e===!0||!r&&e!==!1){let s=t[0];const{options:a}=i;if(!(a!=null&&a.noSubtitlesLangPref)){const c=globalThis.localStorage.getItem("media-chrome-pref-subtitles-lang"),d=c?[c,...globalThis.navigator.languages]:globalThis.navigator.languages,h=t.filter(f=>d.some(m=>f.language.toLowerCase().startsWith(m.split("-")[0]))).sort((f,m)=>{const p=d.findIndex(g=>f.language.toLowerCase().startsWith(g.split("-")[0])),v=d.findIndex(g=>m.language.toLowerCase().startsWith(g.split("-")[0]));return p-v});h[0]&&(s=h[0])}const{language:o,label:l,kind:u}=s;Wa(Ns.DISABLED,t,n),Wa(Ns.SHOWING,t,[{language:o,label:l,kind:u}])}}},dp=(i,e)=>i===e?!0:i==null||e==null||typeof i!=typeof e?!1:typeof i=="number"&&Number.isNaN(i)&&Number.isNaN(e)?!0:typeof i!="object"?!1:Array.isArray(i)?LM(i,e):Object.entries(i).every(([t,n])=>t in e&&dp(n,e[t])),LM=(i,e)=>{const t=Array.isArray(i),n=Array.isArray(e);return t!==n?!1:t||n?i.length!==e.length?!1:i.every((r,s)=>dp(r,e[s])):!0},kM=Object.values(mn);let cc;const DM=_M().then(i=>(cc=i,cc)),CM=async(...i)=>{await Promise.all(i.filter(e=>e).map(async e=>{if(!("localName"in e&&e instanceof C.HTMLElement))return;const t=e.localName;if(!t.includes("-"))return;const n=C.customElements.get(t);n&&e instanceof n||(await C.customElements.whenDefined(t),C.customElements.upgrade(e))}))},ba={mediaError:{get(i,e){const{media:t}=i;if((e==null?void 0:e.type)!=="playing")return t==null?void 0:t.error},mediaEvents:["emptied","error","playing"]},mediaErrorCode:{get(i,e){var t;const{media:n}=i;if((e==null?void 0:e.type)!=="playing")return(t=n==null?void 0:n.error)==null?void 0:t.code},mediaEvents:["emptied","error","playing"]},mediaErrorMessage:{get(i,e){var t,n;const{media:r}=i;if((e==null?void 0:e.type)!=="playing")return(n=(t=r==null?void 0:r.error)==null?void 0:t.message)!=null?n:""},mediaEvents:["emptied","error","playing"]},mediaWidth:{get(i){var e;const{media:t}=i;return(e=t==null?void 0:t.videoWidth)!=null?e:0},mediaEvents:["resize"]},mediaHeight:{get(i){var e;const{media:t}=i;return(e=t==null?void 0:t.videoHeight)!=null?e:0},mediaEvents:["resize"]},mediaPaused:{get(i){var e;const{media:t}=i;return(e=t==null?void 0:t.paused)!=null?e:!0},set(i,e){var t;const{media:n}=e;n&&(i?n.pause():(t=n.play())==null||t.catch(()=>{}))},mediaEvents:["play","playing","pause","emptied"]},mediaHasPlayed:{get(i,e){const{media:t}=i;return t?e?e.type==="playing":!t.paused:!1},mediaEvents:["playing","emptied"]},mediaEnded:{get(i){var e;const{media:t}=i;return(e=t==null?void 0:t.ended)!=null?e:!1},mediaEvents:["seeked","ended","emptied"]},mediaPlaybackRate:{get(i){var e;const{media:t}=i;return(e=t==null?void 0:t.playbackRate)!=null?e:1},set(i,e){const{media:t}=e;t&&Number.isFinite(+i)&&(t.playbackRate=+i)},mediaEvents:["ratechange","loadstart"]},mediaMuted:{get(i){var e;const{media:t}=i;return(e=t==null?void 0:t.muted)!=null?e:!1},set(i,e){const{media:t}=e;if(t){try{C.localStorage.setItem("media-chrome-pref-muted",i?"true":"false")}catch(n){console.debug("Error setting muted pref",n)}t.muted=i}},mediaEvents:["volumechange"],stateOwnersUpdateHandlers:[(i,e)=>{const{options:{noMutedPref:t}}=e,{media:n}=e;if(!(!n||n.muted||t))try{const r=C.localStorage.getItem("media-chrome-pref-muted")==="true";ba.mediaMuted.set(r,e),i(r)}catch(r){console.debug("Error getting muted pref",r)}}]},mediaVolume:{get(i){var e;const{media:t}=i;return(e=t==null?void 0:t.volume)!=null?e:1},set(i,e){const{media:t}=e;if(t){try{i==null?C.localStorage.removeItem("media-chrome-pref-volume"):C.localStorage.setItem("media-chrome-pref-volume",i.toString())}catch(n){console.debug("Error setting volume pref",n)}Number.isFinite(+i)&&(t.volume=+i)}},mediaEvents:["volumechange"],stateOwnersUpdateHandlers:[(i,e)=>{const{options:{noVolumePref:t}}=e;if(!t)try{const{media:n}=e;if(!n)return;const r=C.localStorage.getItem("media-chrome-pref-volume");if(r==null)return;ba.mediaVolume.set(+r,e),i(+r)}catch(n){console.debug("Error getting volume pref",n)}}]},mediaVolumeLevel:{get(i){const{media:e}=i;return typeof(e==null?void 0:e.volume)>"u"?"high":e.muted||e.volume===0?"off":e.volume<.5?"low":e.volume<.75?"medium":"high"},mediaEvents:["volumechange"]},mediaCurrentTime:{get(i){var e;const{media:t}=i;return(e=t==null?void 0:t.currentTime)!=null?e:0},set(i,e){const{media:t}=e;!t||!sp(i)||(t.currentTime=i)},mediaEvents:["timeupdate","loadedmetadata"]},mediaDuration:{get(i){const{media:e,options:{defaultDuration:t}={}}=i;return t&&(!e||!e.duration||Number.isNaN(e.duration)||!Number.isFinite(e.duration))?t:Number.isFinite(e==null?void 0:e.duration)?e.duration:Number.NaN},mediaEvents:["durationchange","loadedmetadata","emptied"]},mediaLoading:{get(i){const{media:e}=i;return(e==null?void 0:e.readyState)<3},mediaEvents:["waiting","playing","emptied"]},mediaSeekable:{get(i){var e;const{media:t}=i;if(!((e=t==null?void 0:t.seekable)!=null&&e.length))return;const n=t.seekable.start(0),r=t.seekable.end(t.seekable.length-1);if(!(!n&&!r))return[Number(n.toFixed(3)),Number(r.toFixed(3))]},mediaEvents:["loadedmetadata","emptied","progress","seekablechange"]},mediaBuffered:{get(i){var e;const{media:t}=i,n=(e=t==null?void 0:t.buffered)!=null?e:[];return Array.from(n).map((r,s)=>[Number(n.start(s).toFixed(3)),Number(n.end(s).toFixed(3))])},mediaEvents:["progress","emptied"]},mediaStreamType:{get(i){const{media:e,options:{defaultStreamType:t}={}}=i,n=[mn.LIVE,mn.ON_DEMAND].includes(t)?t:void 0;if(!e)return n;const{streamType:r}=e;if(kM.includes(r))return r===mn.UNKNOWN?n:r;const s=e.duration;return s===1/0?mn.LIVE:Number.isFinite(s)?mn.ON_DEMAND:n},mediaEvents:["emptied","durationchange","loadedmetadata","streamtypechange"]},mediaTargetLiveWindow:{get(i){const{media:e}=i;if(!e)return Number.NaN;const{targetLiveWindow:t}=e,n=ba.mediaStreamType.get(i);return(t==null||Number.isNaN(t))&&n===mn.LIVE?0:t},mediaEvents:["emptied","durationchange","loadedmetadata","streamtypechange","targetlivewindowchange"]},mediaTimeIsLive:{get(i){const{media:e,options:{liveEdgeOffset:t=10}={}}=i;if(!e)return!1;if(typeof e.liveEdgeStart=="number")return Number.isNaN(e.liveEdgeStart)?!1:e.currentTime>=e.liveEdgeStart;if(!(ba.mediaStreamType.get(i)===mn.LIVE))return!1;const r=e.seekable;if(!r)return!0;if(!r.length)return!1;const s=r.end(r.length-1)-t;return e.currentTime>=s},mediaEvents:["playing","timeupdate","progress","waiting","emptied"]},mediaSubtitlesList:{get(i){return uc(i).map(({kind:e,label:t,language:n})=>({kind:e,label:t,language:n}))},mediaEvents:["loadstart"],textTracksEvents:["addtrack","removetrack"]},mediaSubtitlesShowing:{get(i){return FS(i).map(({kind:e,label:t,language:n})=>({kind:e,label:t,language:n}))},mediaEvents:["loadstart"],textTracksEvents:["addtrack","removetrack","change"],stateOwnersUpdateHandlers:[(i,e)=>{var t,n;const{media:r,options:s}=e;if(!r)return;const a=o=>{var l;!s.defaultSubtitles||o&&![nn.CAPTIONS,nn.SUBTITLES].includes((l=o==null?void 0:o.track)==null?void 0:l.kind)||US(e,!0)};return(t=r.textTracks)==null||t.addEventListener("addtrack",a),(n=r.textTracks)==null||n.addEventListener("removetrack",a),a(),()=>{var o,l;(o=r.textTracks)==null||o.removeEventListener("addtrack",a),(l=r.textTracks)==null||l.removeEventListener("removetrack",a)}}]},mediaChaptersCues:{get(i){var e;const{media:t}=i;if(!t)return[];const[n]=Vc(t,{kind:nn.CHAPTERS});return Array.from((e=n==null?void 0:n.cues)!=null?e:[]).map(({text:r,startTime:s,endTime:a})=>({text:r,startTime:s,endTime:a}))},mediaEvents:["loadstart","loadedmetadata"],textTracksEvents:["addtrack","removetrack","change"],stateOwnersUpdateHandlers:[(i,e)=>{var t;const{media:n}=e;if(!n)return;const r=n.querySelector('track[kind="chapters"][default][src]'),s=(t=n.shadowRoot)==null?void 0:t.querySelector(':is(video,audio) > track[kind="chapters"][default][src]');return r==null||r.addEventListener("load",i),s==null||s.addEventListener("load",i),()=>{r==null||r.removeEventListener("load",i),s==null||s.removeEventListener("load",i)}}]},mediaIsPip:{get(i){var e,t;const{media:n,documentElement:r}=i;if(!n||!r||!r.pictureInPictureElement)return!1;if(r.pictureInPictureElement===n)return!0;if(r.pictureInPictureElement instanceof HTMLMediaElement)return(e=n.localName)!=null&&e.includes("-")?ea(n,r.pictureInPictureElement):!1;if(r.pictureInPictureElement.localName.includes("-")){let s=r.pictureInPictureElement.shadowRoot;for(;s!=null&&s.pictureInPictureElement;){if(s.pictureInPictureElement===n)return!0;s=(t=s.pictureInPictureElement)==null?void 0:t.shadowRoot}}return!1},set(i,e){const{media:t}=e;if(t)if(i){if(!ue.pictureInPictureEnabled){console.warn("MediaChrome: Picture-in-picture is not enabled");return}if(!t.requestPictureInPicture){console.warn("MediaChrome: The current media does not support picture-in-picture");return}const n=()=>{console.warn("MediaChrome: The media is not ready for picture-in-picture. It must have a readyState > 0.")};t.requestPictureInPicture().catch(r=>{if(r.code===11){if(!t.src){console.warn("MediaChrome: The media is not ready for picture-in-picture. It must have a src set.");return}if(t.readyState===0&&t.preload==="none"){const s=()=>{t.removeEventListener("loadedmetadata",a),t.preload="none"},a=()=>{t.requestPictureInPicture().catch(n),s()};t.addEventListener("loadedmetadata",a),t.preload="metadata",setTimeout(()=>{t.readyState===0&&n(),s()},1e3)}else throw r}else throw r})}else ue.pictureInPictureElement&&ue.exitPictureInPicture()},mediaEvents:["enterpictureinpicture","leavepictureinpicture"]},mediaRenditionList:{get(i){var e;const{media:t}=i;return[...(e=t==null?void 0:t.videoRenditions)!=null?e:[]].map(n=>({...n}))},mediaEvents:["emptied","loadstart"],videoRenditionsEvents:["addrendition","removerendition"]},mediaRenditionSelected:{get(i){var e,t,n;const{media:r}=i;return(n=(t=r==null?void 0:r.videoRenditions)==null?void 0:t[(e=r.videoRenditions)==null?void 0:e.selectedIndex])==null?void 0:n.id},set(i,e){const{media:t}=e;if(!(t!=null&&t.videoRenditions)){console.warn("MediaController: Rendition selection not supported by this media.");return}const n=i,r=Array.prototype.findIndex.call(t.videoRenditions,s=>s.id==n);t.videoRenditions.selectedIndex!=r&&(t.videoRenditions.selectedIndex=r)},mediaEvents:["emptied"],videoRenditionsEvents:["addrendition","removerendition","change"]},mediaAudioTrackList:{get(i){var e;const{media:t}=i;return[...(e=t==null?void 0:t.audioTracks)!=null?e:[]]},mediaEvents:["emptied","loadstart"],audioTracksEvents:["addtrack","removetrack"]},mediaAudioTrackEnabled:{get(i){var e,t;const{media:n}=i;return(t=[...(e=n==null?void 0:n.audioTracks)!=null?e:[]].find(r=>r.enabled))==null?void 0:t.id},set(i,e){const{media:t}=e;if(!(t!=null&&t.audioTracks)){console.warn("MediaChrome: Audio track selection not supported by this media.");return}const n=i;for(const r of t.audioTracks)r.enabled=n==r.id},mediaEvents:["emptied"],audioTracksEvents:["addtrack","removetrack","change"]},mediaIsFullscreen:{get(i){return EM(i)},set(i,e){i?pM(e):gM(e)},rootEvents:["fullscreenchange","webkitfullscreenchange"],mediaEvents:["webkitbeginfullscreen","webkitendfullscreen","webkitpresentationmodechanged"]},mediaIsCasting:{get(i){var e;const{media:t}=i;return!(t!=null&&t.remote)||((e=t.remote)==null?void 0:e.state)==="disconnected"?!1:!!t.remote.state},set(i,e){var t,n;const{media:r}=e;if(r&&!(i&&((t=r.remote)==null?void 0:t.state)!=="disconnected")&&!(!i&&((n=r.remote)==null?void 0:n.state)!=="connected")){if(typeof r.remote.prompt!="function"){console.warn("MediaChrome: Casting is not supported in this environment");return}r.remote.prompt().catch(()=>{})}},remoteEvents:["connect","connecting","disconnect"]},mediaIsAirplaying:{get(){return!1},set(i,e){const{media:t}=e;if(t){if(!(t.webkitShowPlaybackTargetPicker&&C.WebKitPlaybackTargetAvailabilityEvent)){console.warn("MediaChrome: received a request to select AirPlay but AirPlay is not supported in this environment");return}t.webkitShowPlaybackTargetPicker()}},mediaEvents:["webkitcurrentplaybacktargetiswirelesschanged"]},mediaFullscreenUnavailable:{get(i){const{media:e}=i;if(!bM||!NS(e))return si.UNSUPPORTED}},mediaPipUnavailable:{get(i){const{media:e}=i;if(!RM||!OS(e))return si.UNSUPPORTED}},mediaVolumeUnavailable:{get(i){const{media:e}=i;if(cc===!1||(e==null?void 0:e.volume)==null)return si.UNSUPPORTED},stateOwnersUpdateHandlers:[i=>{cc==null&&DM.then(e=>i(e?void 0:si.UNSUPPORTED))}]},mediaCastUnavailable:{get(i,{availability:e="not-available"}={}){var t;const{media:n}=i;if(!IM||!((t=n==null?void 0:n.remote)!=null&&t.state))return si.UNSUPPORTED;if(!(e==null||e==="available"))return si.UNAVAILABLE},stateOwnersUpdateHandlers:[(i,e)=>{var t;const{media:n}=e;return n?(n.disableRemotePlayback||n.hasAttribute("disableremoteplayback")||(t=n==null?void 0:n.remote)==null||t.watchAvailability(s=>{i({availability:s?"available":"not-available"})}).catch(s=>{s.name==="NotSupportedError"?i({availability:null}):i({availability:"not-available"})}),()=>{var s;(s=n==null?void 0:n.remote)==null||s.cancelWatchAvailability().catch(()=>{})}):void 0}]},mediaAirplayUnavailable:{get(i,e){if(!wM)return si.UNSUPPORTED;if((e==null?void 0:e.availability)==="not-available")return si.UNAVAILABLE},mediaEvents:["webkitplaybacktargetavailabilitychanged"],stateOwnersUpdateHandlers:[(i,e)=>{var t;const{media:n}=e;return n?(n.disableRemotePlayback||n.hasAttribute("disableremoteplayback")||(t=n==null?void 0:n.remote)==null||t.watchAvailability(s=>{i({availability:s?"available":"not-available"})}).catch(s=>{s.name==="NotSupportedError"?i({availability:null}):i({availability:"not-available"})}),()=>{var s;(s=n==null?void 0:n.remote)==null||s.cancelWatchAvailability().catch(()=>{})}):void 0}]},mediaRenditionUnavailable:{get(i){var e;const{media:t}=i;if(!(t!=null&&t.videoRenditions))return si.UNSUPPORTED;if(!((e=t.videoRenditions)!=null&&e.length))return si.UNAVAILABLE},mediaEvents:["emptied","loadstart"],videoRenditionsEvents:["addrendition","removerendition"]},mediaAudioTrackUnavailable:{get(i){var e,t;const{media:n}=i;if(!(n!=null&&n.audioTracks))return si.UNSUPPORTED;if(((t=(e=n.audioTracks)==null?void 0:e.length)!=null?t:0)<=1)return si.UNAVAILABLE},mediaEvents:["emptied","loadstart"],audioTracksEvents:["addtrack","removetrack"]}},PM={[z.MEDIA_PREVIEW_REQUEST](i,e,{detail:t}){var n,r,s;const{media:a}=e,o=t??void 0;let l,u;if(a&&o!=null){const[f]=Vc(a,{kind:nn.METADATA,label:"thumbnails"}),m=Array.prototype.find.call((n=f==null?void 0:f.cues)!=null?n:[],(p,v,g)=>v===0?p.endTime>o:v===g.length-1?p.startTime<=o:p.startTime<=o&&p.endTime>o);if(m){const p=/'^(?:[a-z]+:)?\/\//i.test(m.text)||(r=a==null?void 0:a.querySelector('track[label="thumbnails"]'))==null?void 0:r.src,v=new URL(m.text,p);u=new URLSearchParams(v.hash).get("#xywh").split(",").map(E=>+E),l=v.href}}const c=i.mediaDuration.get(e);let h=(s=i.mediaChaptersCues.get(e).find((f,m,p)=>m===p.length-1&&c===f.endTime?f.startTime<=o&&f.endTime>=o:f.startTime<=o&&f.endTime>o))==null?void 0:s.text;return t!=null&&h==null&&(h=""),{mediaPreviewTime:o,mediaPreviewImage:l,mediaPreviewCoords:u,mediaPreviewChapter:h}},[z.MEDIA_PAUSE_REQUEST](i,e){i["mediaPaused"].set(!0,e)},[z.MEDIA_PLAY_REQUEST](i,e){var t;const n="mediaPaused";if(i.mediaStreamType.get(e)===mn.LIVE){const a=!(i.mediaTargetLiveWindow.get(e)>0),o=(t=i.mediaSeekable.get(e))==null?void 0:t[1];a&&o&&i.mediaCurrentTime.set(o,e)}i[n].set(!1,e)},[z.MEDIA_PLAYBACK_RATE_REQUEST](i,e,{detail:t}){const n="mediaPlaybackRate",r=t;i[n].set(r,e)},[z.MEDIA_MUTE_REQUEST](i,e){i["mediaMuted"].set(!0,e)},[z.MEDIA_UNMUTE_REQUEST](i,e){const t="mediaMuted";i.mediaVolume.get(e)||i.mediaVolume.set(.25,e),i[t].set(!1,e)},[z.MEDIA_VOLUME_REQUEST](i,e,{detail:t}){const n="mediaVolume",r=t;r&&i.mediaMuted.get(e)&&i.mediaMuted.set(!1,e),i[n].set(r,e)},[z.MEDIA_SEEK_REQUEST](i,e,{detail:t}){const n="mediaCurrentTime",r=t;i[n].set(r,e)},[z.MEDIA_SEEK_TO_LIVE_REQUEST](i,e){var t;const n="mediaCurrentTime",r=(t=i.mediaSeekable.get(e))==null?void 0:t[1];Number.isNaN(Number(r))||i[n].set(r,e)},[z.MEDIA_SHOW_SUBTITLES_REQUEST](i,e,{detail:t}){var n;const{options:r}=e,s=uc(e),a=PS(t),o=(n=a[0])==null?void 0:n.language;o&&!r.noSubtitlesLangPref&&C.localStorage.setItem("media-chrome-pref-subtitles-lang",o),Wa(Ns.SHOWING,s,a)},[z.MEDIA_DISABLE_SUBTITLES_REQUEST](i,e,{detail:t}){const n=uc(e),r=t??[];Wa(Ns.DISABLED,n,r)},[z.MEDIA_TOGGLE_SUBTITLES_REQUEST](i,e,{detail:t}){US(e,t)},[z.MEDIA_RENDITION_REQUEST](i,e,{detail:t}){const n="mediaRenditionSelected",r=t;i[n].set(r,e)},[z.MEDIA_AUDIO_TRACK_REQUEST](i,e,{detail:t}){const n="mediaAudioTrackEnabled",r=t;i[n].set(r,e)},[z.MEDIA_ENTER_PIP_REQUEST](i,e){const t="mediaIsPip";i.mediaIsFullscreen.get(e)&&i.mediaIsFullscreen.set(!1,e),i[t].set(!0,e)},[z.MEDIA_EXIT_PIP_REQUEST](i,e){i["mediaIsPip"].set(!1,e)},[z.MEDIA_ENTER_FULLSCREEN_REQUEST](i,e){const t="mediaIsFullscreen";i.mediaIsPip.get(e)&&i.mediaIsPip.set(!1,e),i[t].set(!0,e)},[z.MEDIA_EXIT_FULLSCREEN_REQUEST](i,e){i["mediaIsFullscreen"].set(!1,e)},[z.MEDIA_ENTER_CAST_REQUEST](i,e){const t="mediaIsCasting";i.mediaIsFullscreen.get(e)&&i.mediaIsFullscreen.set(!1,e),i[t].set(!0,e)},[z.MEDIA_EXIT_CAST_REQUEST](i,e){i["mediaIsCasting"].set(!1,e)},[z.MEDIA_AIRPLAY_REQUEST](i,e){i["mediaIsAirplaying"].set(!0,e)}},MM=({media:i,fullscreenElement:e,documentElement:t,stateMediator:n=ba,requestMap:r=PM,options:s={},monitorStateOwnersOnlyWithSubscriptions:a=!0})=>{const o=[],l={options:{...s}};let u=Object.freeze({mediaPreviewTime:void 0,mediaPreviewImage:void 0,mediaPreviewCoords:void 0,mediaPreviewChapter:void 0});const c=p=>{p!=null&&(dp(p,u)||(u=Object.freeze({...u,...p}),o.forEach(v=>v(u))))},d=()=>{const p=Object.entries(n).reduce((v,[g,{get:E}])=>(v[g]=E(l),v),{});c(p)},h={};let f;const m=async(p,v)=>{var g,E,y,_,S,b,A,w,P,R,D,j,$,X,q,W;const oe=!!f;if(f={...l,...f??{},...p},oe)return;await CM(...Object.values(p));const F=o.length>0&&v===0&&a,O=l.media!==f.media,M=((g=l.media)==null?void 0:g.textTracks)!==((E=f.media)==null?void 0:E.textTracks),G=((y=l.media)==null?void 0:y.videoRenditions)!==((_=f.media)==null?void 0:_.videoRenditions),Y=((S=l.media)==null?void 0:S.audioTracks)!==((b=f.media)==null?void 0:b.audioTracks),le=((A=l.media)==null?void 0:A.remote)!==((w=f.media)==null?void 0:w.remote),me=l.documentElement!==f.documentElement,we=!!l.media&&(O||F),be=!!((P=l.media)!=null&&P.textTracks)&&(M||F),ze=!!((R=l.media)!=null&&R.videoRenditions)&&(G||F),Rn=!!((D=l.media)!=null&&D.audioTracks)&&(Y||F),Kr=!!((j=l.media)!=null&&j.remote)&&(le||F),xp=!!l.documentElement&&(me||F),bp=we||be||ze||Rn||Kr||xp,Wr=o.length===0&&v===1&&a,Rp=!!f.media&&(O||Wr),wp=!!(($=f.media)!=null&&$.textTracks)&&(M||Wr),Ip=!!((X=f.media)!=null&&X.videoRenditions)&&(G||Wr),Lp=!!((q=f.media)!=null&&q.audioTracks)&&(Y||Wr),kp=!!((W=f.media)!=null&&W.remote)&&(le||Wr),Dp=!!f.documentElement&&(me||Wr),Cp=Rp||wp||Ip||Lp||kp||Dp;if(!(bp||Cp)){Object.entries(f).forEach(([Ie,ia])=>{l[Ie]=ia}),d(),f=void 0;return}Object.entries(n).forEach(([Ie,{get:ia,mediaEvents:rx=[],textTracksEvents:sx=[],videoRenditionsEvents:ax=[],audioTracksEvents:ox=[],remoteEvents:lx=[],rootEvents:ux=[],stateOwnersUpdateHandlers:cx=[]}])=>{h[Ie]||(h[Ie]={});const Wt=Ye=>{const qt=ia(l,Ye);c({[Ie]:qt})};let lt;lt=h[Ie].mediaEvents,rx.forEach(Ye=>{lt&&we&&(l.media.removeEventListener(Ye,lt),h[Ie].mediaEvents=void 0),Rp&&(f.media.addEventListener(Ye,Wt),h[Ie].mediaEvents=Wt)}),lt=h[Ie].textTracksEvents,sx.forEach(Ye=>{var qt,pi;lt&&be&&((qt=l.media.textTracks)==null||qt.removeEventListener(Ye,lt),h[Ie].textTracksEvents=void 0),wp&&((pi=f.media.textTracks)==null||pi.addEventListener(Ye,Wt),h[Ie].textTracksEvents=Wt)}),lt=h[Ie].videoRenditionsEvents,ax.forEach(Ye=>{var qt,pi;lt&&ze&&((qt=l.media.videoRenditions)==null||qt.removeEventListener(Ye,lt),h[Ie].videoRenditionsEvents=void 0),Ip&&((pi=f.media.videoRenditions)==null||pi.addEventListener(Ye,Wt),h[Ie].videoRenditionsEvents=Wt)}),lt=h[Ie].audioTracksEvents,ox.forEach(Ye=>{var qt,pi;lt&&Rn&&((qt=l.media.audioTracks)==null||qt.removeEventListener(Ye,lt),h[Ie].audioTracksEvents=void 0),Lp&&((pi=f.media.audioTracks)==null||pi.addEventListener(Ye,Wt),h[Ie].audioTracksEvents=Wt)}),lt=h[Ie].remoteEvents,lx.forEach(Ye=>{var qt,pi;lt&&Kr&&((qt=l.media.remote)==null||qt.removeEventListener(Ye,lt),h[Ie].remoteEvents=void 0),kp&&((pi=f.media.remote)==null||pi.addEventListener(Ye,Wt),h[Ie].remoteEvents=Wt)}),lt=h[Ie].rootEvents,ux.forEach(Ye=>{lt&&xp&&(l.documentElement.removeEventListener(Ye,lt),h[Ie].rootEvents=void 0),Dp&&(f.documentElement.addEventListener(Ye,Wt),h[Ie].rootEvents=Wt)});const Pp=h[Ie].stateOwnersUpdateHandlers;cx.forEach(Ye=>{Pp&&bp&&Pp(),Cp&&(h[Ie].stateOwnersUpdateHandlers=Ye(Wt,f))})}),Object.entries(f).forEach(([Ie,ia])=>{l[Ie]=ia}),d(),f=void 0};return m({media:i,fullscreenElement:e,documentElement:t,options:s}),{dispatch(p){const{type:v,detail:g}=p;if(r[v]&&u.mediaErrorCode==null){c(r[v](n,l,p));return}v==="mediaelementchangerequest"?m({media:g}):v==="fullscreenelementchangerequest"?m({fullscreenElement:g}):v==="documentelementchangerequest"?m({documentElement:g}):v==="optionschangerequest"&&Object.entries(g??{}).forEach(([E,y])=>{l.options[E]=y})},getState(){return u},subscribe(p){return m({},o.length+1),o.push(p),p(u),()=>{const v=o.indexOf(p);v>=0&&(m({},o.length-1),o.splice(v,1))}}}};var hp=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},de=(i,e,t)=>(hp(i,e,"read from private field"),t?t.call(i):e.get(i)),ln=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},kn=(i,e,t,n)=>(hp(i,e,"write to private field"),e.set(i,t),t),Bn=(i,e,t)=>(hp(i,e,"access private method"),t),br,Ra,Me,wa,Ui,Xl,Zl,Tf,Qs,So,Jl,_f;const $S=["ArrowLeft","ArrowRight","Enter"," ","f","m","k","c"],vv=10,Z={DEFAULT_SUBTITLES:"defaultsubtitles",DEFAULT_STREAM_TYPE:"defaultstreamtype",DEFAULT_DURATION:"defaultduration",FULLSCREEN_ELEMENT:"fullscreenelement",HOTKEYS:"hotkeys",KEYS_USED:"keysused",LIVE_EDGE_OFFSET:"liveedgeoffset",NO_AUTO_SEEK_TO_LIVE:"noautoseektolive",NO_HOTKEYS:"nohotkeys",NO_VOLUME_PREF:"novolumepref",NO_SUBTITLES_LANG_PREF:"nosubtitleslangpref",NO_DEFAULT_STORE:"nodefaultstore",KEYBOARD_FORWARD_SEEK_OFFSET:"keyboardforwardseekoffset",KEYBOARD_BACKWARD_SEEK_OFFSET:"keyboardbackwardseekoffset"};let BS=class extends up{constructor(){super(),ln(this,Zl),ln(this,Qs),ln(this,Jl),this.mediaStateReceivers=[],this.associatedElementSubscriptions=new Map,ln(this,br,new kS(this,Z.HOTKEYS)),ln(this,Ra,void 0),ln(this,Me,void 0),ln(this,wa,void 0),ln(this,Ui,void 0),ln(this,Xl,t=>{var n;(n=de(this,Me))==null||n.dispatch(t)}),this.associateElement(this);let e={};kn(this,wa,t=>{Object.entries(t).forEach(([n,r])=>{if(n in e&&e[n]===r)return;this.propagateMediaState(n,r);const s=n.toLowerCase(),a=new C.CustomEvent(UP[s],{composed:!0,detail:r});this.dispatchEvent(a)}),e=t}),this.enableHotkeys()}static get observedAttributes(){return super.observedAttributes.concat(Z.NO_HOTKEYS,Z.HOTKEYS,Z.DEFAULT_STREAM_TYPE,Z.DEFAULT_SUBTITLES,Z.DEFAULT_DURATION)}get mediaStore(){return de(this,Me)}set mediaStore(e){var t,n;if(de(this,Me)&&((t=de(this,Ui))==null||t.call(this),kn(this,Ui,void 0)),kn(this,Me,e),!de(this,Me)&&!this.hasAttribute(Z.NO_DEFAULT_STORE)){Bn(this,Zl,Tf).call(this);return}kn(this,Ui,(n=de(this,Me))==null?void 0:n.subscribe(de(this,wa)))}get fullscreenElement(){var e;return(e=de(this,Ra))!=null?e:this}set fullscreenElement(e){var t;this.hasAttribute(Z.FULLSCREEN_ELEMENT)&&this.removeAttribute(Z.FULLSCREEN_ELEMENT),kn(this,Ra,e),(t=de(this,Me))==null||t.dispatch({type:"fullscreenelementchangerequest",detail:this.fullscreenElement})}get defaultSubtitles(){return ge(this,Z.DEFAULT_SUBTITLES)}set defaultSubtitles(e){ve(this,Z.DEFAULT_SUBTITLES,e)}get defaultStreamType(){return We(this,Z.DEFAULT_STREAM_TYPE)}set defaultStreamType(e){qe(this,Z.DEFAULT_STREAM_TYPE,e)}get defaultDuration(){return Ke(this,Z.DEFAULT_DURATION)}set defaultDuration(e){pt(this,Z.DEFAULT_DURATION,e)}get noHotkeys(){return ge(this,Z.NO_HOTKEYS)}set noHotkeys(e){ve(this,Z.NO_HOTKEYS,e)}get keysUsed(){return We(this,Z.KEYS_USED)}set keysUsed(e){qe(this,Z.KEYS_USED,e)}get liveEdgeOffset(){return Ke(this,Z.LIVE_EDGE_OFFSET)}set liveEdgeOffset(e){pt(this,Z.LIVE_EDGE_OFFSET,e)}get noAutoSeekToLive(){return ge(this,Z.NO_AUTO_SEEK_TO_LIVE)}set noAutoSeekToLive(e){ve(this,Z.NO_AUTO_SEEK_TO_LIVE,e)}get noVolumePref(){return ge(this,Z.NO_VOLUME_PREF)}set noVolumePref(e){ve(this,Z.NO_VOLUME_PREF,e)}get noSubtitlesLangPref(){return ge(this,Z.NO_SUBTITLES_LANG_PREF)}set noSubtitlesLangPref(e){ve(this,Z.NO_SUBTITLES_LANG_PREF,e)}get noDefaultStore(){return ge(this,Z.NO_DEFAULT_STORE)}set noDefaultStore(e){ve(this,Z.NO_DEFAULT_STORE,e)}attributeChangedCallback(e,t,n){var r,s,a,o,l,u;if(super.attributeChangedCallback(e,t,n),e===Z.NO_HOTKEYS)n!==t&&n===""?(this.hasAttribute(Z.HOTKEYS)&&console.warn("Media Chrome: Both `hotkeys` and `nohotkeys` have been set. All hotkeys will be disabled."),this.disableHotkeys()):n!==t&&n===null&&this.enableHotkeys();else if(e===Z.HOTKEYS)de(this,br).value=n;else if(e===Z.DEFAULT_SUBTITLES&&n!==t)(r=de(this,Me))==null||r.dispatch({type:"optionschangerequest",detail:{defaultSubtitles:this.hasAttribute(Z.DEFAULT_SUBTITLES)}});else if(e===Z.DEFAULT_STREAM_TYPE)(a=de(this,Me))==null||a.dispatch({type:"optionschangerequest",detail:{defaultStreamType:(s=this.getAttribute(Z.DEFAULT_STREAM_TYPE))!=null?s:void 0}});else if(e===Z.LIVE_EDGE_OFFSET)(o=de(this,Me))==null||o.dispatch({type:"optionschangerequest",detail:{liveEdgeOffset:this.hasAttribute(Z.LIVE_EDGE_OFFSET)?+this.getAttribute(Z.LIVE_EDGE_OFFSET):void 0}});else if(e===Z.FULLSCREEN_ELEMENT){const c=n?(l=this.getRootNode())==null?void 0:l.getElementById(n):void 0;kn(this,Ra,c),(u=de(this,Me))==null||u.dispatch({type:"fullscreenelementchangerequest",detail:this.fullscreenElement})}}connectedCallback(){var e,t;!de(this,Me)&&!this.hasAttribute(Z.NO_DEFAULT_STORE)&&Bn(this,Zl,Tf).call(this),(e=de(this,Me))==null||e.dispatch({type:"documentelementchangerequest",detail:ue}),super.connectedCallback(),de(this,Me)&&!de(this,Ui)&&kn(this,Ui,(t=de(this,Me))==null?void 0:t.subscribe(de(this,wa))),this.enableHotkeys()}disconnectedCallback(){var e,t,n,r;(e=super.disconnectedCallback)==null||e.call(this),de(this,Me)&&((t=de(this,Me))==null||t.dispatch({type:"documentelementchangerequest",detail:void 0}),(n=de(this,Me))==null||n.dispatch({type:z.MEDIA_TOGGLE_SUBTITLES_REQUEST,detail:!1})),de(this,Ui)&&((r=de(this,Ui))==null||r.call(this),kn(this,Ui,void 0))}mediaSetCallback(e){var t;super.mediaSetCallback(e),(t=de(this,Me))==null||t.dispatch({type:"mediaelementchangerequest",detail:e}),e.hasAttribute("tabindex")||(e.tabIndex=-1)}mediaUnsetCallback(e){var t;super.mediaUnsetCallback(e),(t=de(this,Me))==null||t.dispatch({type:"mediaelementchangerequest",detail:void 0})}propagateMediaState(e,t){Tv(this.mediaStateReceivers,e,t)}associateElement(e){if(!e)return;const{associatedElementSubscriptions:t}=this;if(t.has(e))return;const n=this.registerMediaStateReceiver.bind(this),r=this.unregisterMediaStateReceiver.bind(this),s=BM(e,n,r);Object.values(z).forEach(a=>{e.addEventListener(a,de(this,Xl))}),t.set(e,s)}unassociateElement(e){if(!e)return;const{associatedElementSubscriptions:t}=this;if(!t.has(e))return;t.get(e)(),t.delete(e),Object.values(z).forEach(r=>{e.removeEventListener(r,de(this,Xl))})}registerMediaStateReceiver(e){if(!e)return;const t=this.mediaStateReceivers;t.indexOf(e)>-1||(t.push(e),de(this,Me)&&Object.entries(de(this,Me).getState()).forEach(([r,s])=>{Tv([e],r,s)}))}unregisterMediaStateReceiver(e){const t=this.mediaStateReceivers,n=t.indexOf(e);n<0||t.splice(n,1)}enableHotkeys(){this.addEventListener("keydown",Bn(this,Jl,_f))}disableHotkeys(){this.removeEventListener("keydown",Bn(this,Jl,_f)),this.removeEventListener("keyup",Bn(this,Qs,So))}get hotkeys(){return We(this,Z.HOTKEYS)}set hotkeys(e){qe(this,Z.HOTKEYS,e)}keyboardShortcutHandler(e){var t,n,r,s,a;const o=e.target;if(((r=(n=(t=o.getAttribute(Z.KEYS_USED))==null?void 0:t.split(" "))!=null?n:o==null?void 0:o.keysUsed)!=null?r:[]).map(h=>h==="Space"?" ":h).filter(Boolean).includes(e.key))return;let u,c,d;if(!de(this,br).contains(`no${e.key.toLowerCase()}`)&&!(e.key===" "&&de(this,br).contains("nospace")))switch(e.key){case" ":case"k":u=de(this,Me).getState().mediaPaused?z.MEDIA_PLAY_REQUEST:z.MEDIA_PAUSE_REQUEST,this.dispatchEvent(new C.CustomEvent(u,{composed:!0,bubbles:!0}));break;case"m":u=this.mediaStore.getState().mediaVolumeLevel==="off"?z.MEDIA_UNMUTE_REQUEST:z.MEDIA_MUTE_REQUEST,this.dispatchEvent(new C.CustomEvent(u,{composed:!0,bubbles:!0}));break;case"f":u=this.mediaStore.getState().mediaIsFullscreen?z.MEDIA_EXIT_FULLSCREEN_REQUEST:z.MEDIA_ENTER_FULLSCREEN_REQUEST,this.dispatchEvent(new C.CustomEvent(u,{composed:!0,bubbles:!0}));break;case"c":this.dispatchEvent(new C.CustomEvent(z.MEDIA_TOGGLE_SUBTITLES_REQUEST,{composed:!0,bubbles:!0}));break;case"ArrowLeft":{const h=this.hasAttribute(Z.KEYBOARD_BACKWARD_SEEK_OFFSET)?+this.getAttribute(Z.KEYBOARD_BACKWARD_SEEK_OFFSET):vv;c=Math.max(((s=this.mediaStore.getState().mediaCurrentTime)!=null?s:0)-h,0),d=new C.CustomEvent(z.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:c}),this.dispatchEvent(d);break}case"ArrowRight":{const h=this.hasAttribute(Z.KEYBOARD_FORWARD_SEEK_OFFSET)?+this.getAttribute(Z.KEYBOARD_FORWARD_SEEK_OFFSET):vv;c=Math.max(((a=this.mediaStore.getState().mediaCurrentTime)!=null?a:0)+h,0),d=new C.CustomEvent(z.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:c}),this.dispatchEvent(d);break}}}};br=new WeakMap;Ra=new WeakMap;Me=new WeakMap;wa=new WeakMap;Ui=new WeakMap;Xl=new WeakMap;Zl=new WeakSet;Tf=function(){var i;this.mediaStore=MM({media:this.media,fullscreenElement:this.fullscreenElement,options:{defaultSubtitles:this.hasAttribute(Z.DEFAULT_SUBTITLES),defaultDuration:this.hasAttribute(Z.DEFAULT_DURATION)?+this.getAttribute(Z.DEFAULT_DURATION):void 0,defaultStreamType:(i=this.getAttribute(Z.DEFAULT_STREAM_TYPE))!=null?i:void 0,liveEdgeOffset:this.hasAttribute(Z.LIVE_EDGE_OFFSET)?+this.getAttribute(Z.LIVE_EDGE_OFFSET):void 0,noVolumePref:this.hasAttribute(Z.NO_VOLUME_PREF),noSubtitlesLangPref:this.hasAttribute(Z.NO_SUBTITLES_LANG_PREF)}})};Qs=new WeakSet;So=function(i){const{key:e}=i;if(!$S.includes(e)){this.removeEventListener("keyup",Bn(this,Qs,So));return}this.keyboardShortcutHandler(i)};Jl=new WeakSet;_f=function(i){const{metaKey:e,altKey:t,key:n}=i;if(e||t||!$S.includes(n)){this.removeEventListener("keyup",Bn(this,Qs,So));return}[" ","ArrowLeft","ArrowRight"].includes(n)&&!(de(this,br).contains(`no${n.toLowerCase()}`)||n===" "&&de(this,br).contains("nospace"))&&i.preventDefault(),this.addEventListener("keyup",Bn(this,Qs,So),{once:!0})};const OM=Object.values(x),NM=Object.values(sS),GS=i=>{var e,t,n,r;let{observedAttributes:s}=i.constructor;!s&&((e=i.nodeName)!=null&&e.includes("-"))&&(C.customElements.upgrade(i),{observedAttributes:s}=i.constructor);const a=(r=(n=(t=i==null?void 0:i.getAttribute)==null?void 0:t.call(i,_e.MEDIA_CHROME_ATTRIBUTES))==null?void 0:n.split)==null?void 0:r.call(n,/\s+/);return Array.isArray(s||a)?(s||a).filter(o=>OM.includes(o)):[]},FM=i=>{var e,t;return(e=i.nodeName)!=null&&e.includes("-")&&C.customElements.get((t=i.nodeName)==null?void 0:t.toLowerCase())&&!(i instanceof C.customElements.get(i.nodeName.toLowerCase()))&&C.customElements.upgrade(i),NM.some(n=>n in i)},Sf=i=>FM(i)||!!GS(i).length,Ev=i=>{var e;return(e=i==null?void 0:i.join)==null?void 0:e.call(i,":")},yv={[x.MEDIA_SUBTITLES_LIST]:yf,[x.MEDIA_SUBTITLES_SHOWING]:yf,[x.MEDIA_SEEKABLE]:Ev,[x.MEDIA_BUFFERED]:i=>i==null?void 0:i.map(Ev).join(" "),[x.MEDIA_PREVIEW_COORDS]:i=>i==null?void 0:i.join(" "),[x.MEDIA_RENDITION_LIST]:BP,[x.MEDIA_AUDIO_TRACK_LIST]:HP},UM=async(i,e,t)=>{var n,r;if(i.isConnected||await oS(0),typeof t=="boolean"||t==null)return ve(i,e,t);if(typeof t=="number")return pt(i,e,t);if(typeof t=="string")return qe(i,e,t);if(Array.isArray(t)&&!t.length)return i.removeAttribute(e);const s=(r=(n=yv[e])==null?void 0:n.call(yv,t))!=null?r:t;return i.setAttribute(e,s)},$M=i=>{var e;return!!((e=i.closest)!=null&&e.call(i,'*[slot="media"]'))},pr=(i,e)=>{if($M(i))return;const t=(r,s)=>{var a,o;Sf(r)&&s(r);const{children:l=[]}=r??{},u=(o=(a=r==null?void 0:r.shadowRoot)==null?void 0:a.children)!=null?o:[];[...l,...u].forEach(d=>pr(d,s))},n=i==null?void 0:i.nodeName.toLowerCase();if(n.includes("-")&&!Sf(i)){C.customElements.whenDefined(n).then(()=>{t(i,e)});return}t(i,e)},Tv=(i,e,t)=>{i.forEach(n=>{if(e in n){n[e]=t;return}const r=GS(n),s=e.toLowerCase();r.includes(s)&&UM(n,s,t)})},BM=(i,e,t)=>{pr(i,e);const n=c=>{var d;const h=(d=c==null?void 0:c.composedPath()[0])!=null?d:c.target;e(h)},r=c=>{var d;const h=(d=c==null?void 0:c.composedPath()[0])!=null?d:c.target;t(h)};i.addEventListener(z.REGISTER_MEDIA_STATE_RECEIVER,n),i.addEventListener(z.UNREGISTER_MEDIA_STATE_RECEIVER,r);const s=c=>{c.forEach(d=>{const{addedNodes:h=[],removedNodes:f=[],type:m,target:p,attributeName:v}=d;m==="childList"?(Array.prototype.forEach.call(h,g=>pr(g,e)),Array.prototype.forEach.call(f,g=>pr(g,t))):m==="attributes"&&v===_e.MEDIA_CHROME_ATTRIBUTES&&(Sf(p)?e(p):t(p))})};let a=[];const o=c=>{const d=c.target;d.name!=="media"&&(a.forEach(h=>pr(h,t)),a=[...d.assignedElements({flatten:!0})],a.forEach(h=>pr(h,e)))};i.addEventListener("slotchange",o);const l=new MutationObserver(s);return l.observe(i,{childList:!0,attributes:!0,subtree:!0}),()=>{pr(i,t),i.removeEventListener("slotchange",o),l.disconnect(),i.removeEventListener(z.REGISTER_MEDIA_STATE_RECEIVER,n),i.removeEventListener(z.UNREGISTER_MEDIA_STATE_RECEIVER,r)}};C.customElements.get("media-controller")||C.customElements.define("media-controller",BS);var GM=BS,fp=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},Xe=(i,e,t)=>(fp(i,e,"read from private field"),t?t.call(i):e.get(i)),Xr=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},ml=(i,e,t,n)=>(fp(i,e,"write to private field"),e.set(i,t),t),HM=(i,e,t)=>(fp(i,e,"access private method"),t),$i,Is,Gn,ss,eu,Af,HS;const Dn={TOOLTIP_PLACEMENT:"tooltipplacement",DISABLED:"disabled",NO_TOOLTIP:"notooltip"},VS=ue.createElement("template");VS.innerHTML=`
<style>
  :host {
    position: relative;
    font: var(--media-font,
      var(--media-font-weight, bold)
      var(--media-font-size, 14px) /
      var(--media-text-content-height, var(--media-control-height, 24px))
      var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
    color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
    background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));
    padding: var(--media-button-padding, var(--media-control-padding, 10px));
    justify-content: var(--media-button-justify-content, center);
    display: inline-flex;
    align-items: center;
    vertical-align: middle;
    box-sizing: border-box;
    transition: background .15s linear;
    pointer-events: auto;
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
  }

  
  :host(:focus-visible) {
    box-shadow: inset 0 0 0 2px rgb(27 127 204 / .9);
    outline: 0;
  }
  
  :host(:where(:focus)) {
    box-shadow: none;
    outline: 0;
  }

  :host(:hover) {
    background: var(--media-control-hover-background, rgba(50 50 70 / .7));
  }

  svg, img, ::slotted(svg), ::slotted(img) {
    width: var(--media-button-icon-width);
    height: var(--media-button-icon-height, var(--media-control-height, 24px));
    transform: var(--media-button-icon-transform);
    transition: var(--media-button-icon-transition);
    fill: var(--media-icon-color, var(--media-primary-color, rgb(238 238 238)));
    vertical-align: middle;
    max-width: 100%;
    max-height: 100%;
    min-width: 100%;
  }

  media-tooltip {
    
    max-width: 0;
    overflow-x: clip;
    opacity: 0;
    transition: opacity .3s, max-width 0s 9s;
  }

  :host(:hover) media-tooltip,
  :host(:focus-visible) media-tooltip {
    max-width: 100vw;
    opacity: 1;
    transition: opacity .3s;
  }

  :host([notooltip]) slot[name="tooltip"] {
    display: none;
  }
</style>

<slot name="tooltip">
  <media-tooltip part="tooltip" aria-hidden="true">
    <slot name="tooltip-content"></slot>
  </media-tooltip>
</slot>
`;class ni extends C.HTMLElement{constructor(e={}){var t;if(super(),Xr(this,Af),Xr(this,$i,void 0),this.preventClick=!1,this.tooltipEl=null,this.tooltipContent="",Xr(this,Is,n=>{this.preventClick||this.handleClick(n),setTimeout(Xe(this,Gn),0)}),Xr(this,Gn,()=>{var n,r;(r=(n=this.tooltipEl)==null?void 0:n.updateXOffset)==null||r.call(n)}),Xr(this,ss,n=>{const{key:r}=n;if(!this.keysUsed.includes(r)){this.removeEventListener("keyup",Xe(this,ss));return}this.preventClick||this.handleClick(n)}),Xr(this,eu,n=>{const{metaKey:r,altKey:s,key:a}=n;if(r||s||!this.keysUsed.includes(a)){this.removeEventListener("keyup",Xe(this,ss));return}this.addEventListener("keyup",Xe(this,ss),{once:!0})}),!this.shadowRoot){this.attachShadow({mode:"open"});const n=VS.content.cloneNode(!0);this.nativeEl=n;let r=e.slotTemplate;r||(r=ue.createElement("template"),r.innerHTML=`<slot>${e.defaultContent||""}</slot>`),e.tooltipContent&&(n.querySelector('slot[name="tooltip-content"]').innerHTML=(t=e.tooltipContent)!=null?t:"",this.tooltipContent=e.tooltipContent),this.nativeEl.appendChild(r.content.cloneNode(!0)),this.shadowRoot.appendChild(n)}this.tooltipEl=this.shadowRoot.querySelector("media-tooltip")}static get observedAttributes(){return["disabled",Dn.TOOLTIP_PLACEMENT,_e.MEDIA_CONTROLLER]}enable(){this.addEventListener("click",Xe(this,Is)),this.addEventListener("keydown",Xe(this,eu)),this.tabIndex=0}disable(){this.removeEventListener("click",Xe(this,Is)),this.removeEventListener("keydown",Xe(this,eu)),this.removeEventListener("keyup",Xe(this,ss)),this.tabIndex=-1}attributeChangedCallback(e,t,n){var r,s,a,o,l;e===_e.MEDIA_CONTROLLER?(t&&((s=(r=Xe(this,$i))==null?void 0:r.unassociateElement)==null||s.call(r,this),ml(this,$i,null)),n&&this.isConnected&&(ml(this,$i,(a=this.getRootNode())==null?void 0:a.getElementById(n)),(l=(o=Xe(this,$i))==null?void 0:o.associateElement)==null||l.call(o,this))):e==="disabled"&&n!==t?n==null?this.enable():this.disable():e===Dn.TOOLTIP_PLACEMENT&&this.tooltipEl&&n!==t&&(this.tooltipEl.placement=n),Xe(this,Gn).call(this)}connectedCallback(){var e,t,n;const{style:r}=Je(this.shadowRoot,":host");r.setProperty("display",`var(--media-control-display, var(--${this.localName}-display, inline-flex))`),this.hasAttribute("disabled")?this.disable():this.enable(),this.setAttribute("role","button");const s=this.getAttribute(_e.MEDIA_CONTROLLER);s&&(ml(this,$i,(e=this.getRootNode())==null?void 0:e.getElementById(s)),(n=(t=Xe(this,$i))==null?void 0:t.associateElement)==null||n.call(t,this)),C.customElements.whenDefined("media-tooltip").then(()=>HM(this,Af,HS).call(this))}disconnectedCallback(){var e,t;this.disable(),(t=(e=Xe(this,$i))==null?void 0:e.unassociateElement)==null||t.call(e,this),ml(this,$i,null),this.removeEventListener("mouseenter",Xe(this,Gn)),this.removeEventListener("focus",Xe(this,Gn)),this.removeEventListener("click",Xe(this,Is))}get keysUsed(){return["Enter"," "]}get tooltipPlacement(){return We(this,Dn.TOOLTIP_PLACEMENT)}set tooltipPlacement(e){qe(this,Dn.TOOLTIP_PLACEMENT,e)}get mediaController(){return We(this,_e.MEDIA_CONTROLLER)}set mediaController(e){qe(this,_e.MEDIA_CONTROLLER,e)}get disabled(){return ge(this,Dn.DISABLED)}set disabled(e){ve(this,Dn.DISABLED,e)}get noTooltip(){return ge(this,Dn.NO_TOOLTIP)}set noTooltip(e){ve(this,Dn.NO_TOOLTIP,e)}handleClick(e){}}$i=new WeakMap;Is=new WeakMap;Gn=new WeakMap;ss=new WeakMap;eu=new WeakMap;Af=new WeakSet;HS=function(){this.addEventListener("mouseenter",Xe(this,Gn)),this.addEventListener("focus",Xe(this,Gn)),this.addEventListener("click",Xe(this,Is));const i=this.tooltipPlacement;i&&this.tooltipEl&&(this.tooltipEl.placement=i)};C.customElements.get("media-chrome-button")||C.customElements.define("media-chrome-button",ni);var VM=ni;const _v=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M22.13 3H3.87a.87.87 0 0 0-.87.87v13.26a.87.87 0 0 0 .87.87h3.4L9 16H5V5h16v11h-4l1.72 2h3.4a.87.87 0 0 0 .87-.87V3.87a.87.87 0 0 0-.86-.87Zm-8.75 11.44a.5.5 0 0 0-.76 0l-4.91 5.73a.5.5 0 0 0 .38.83h9.82a.501.501 0 0 0 .38-.83l-4.91-5.73Z"/>
</svg>
`,KS=ue.createElement("template");KS.innerHTML=`
  <style>
    :host([${x.MEDIA_IS_AIRPLAYING}]) slot[name=icon] slot:not([name=exit]) {
      display: none !important;
    }

    
    :host(:not([${x.MEDIA_IS_AIRPLAYING}])) slot[name=icon] slot:not([name=enter]) {
      display: none !important;
    }

    :host([${x.MEDIA_IS_AIRPLAYING}]) slot[name=tooltip-enter],
    :host(:not([${x.MEDIA_IS_AIRPLAYING}])) slot[name=tooltip-exit] {
      display: none;
    }
  </style>

  <slot name="icon">
    <slot name="enter">${_v}</slot>
    <slot name="exit">${_v}</slot>
  </slot>
`;const KM=`
  <slot name="tooltip-enter">${te("start airplay")}</slot>
  <slot name="tooltip-exit">${te("stop airplay")}</slot>
`,Sv=i=>{const e=i.mediaIsAirplaying?te("stop airplay"):te("start airplay");i.setAttribute("aria-label",e)};class WS extends ni{static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_IS_AIRPLAYING,x.MEDIA_AIRPLAY_UNAVAILABLE]}constructor(e={}){super({slotTemplate:KS,tooltipContent:KM,...e})}connectedCallback(){super.connectedCallback(),Sv(this)}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),e===x.MEDIA_IS_AIRPLAYING&&Sv(this)}get mediaIsAirplaying(){return ge(this,x.MEDIA_IS_AIRPLAYING)}set mediaIsAirplaying(e){ve(this,x.MEDIA_IS_AIRPLAYING,e)}get mediaAirplayUnavailable(){return We(this,x.MEDIA_AIRPLAY_UNAVAILABLE)}set mediaAirplayUnavailable(e){qe(this,x.MEDIA_AIRPLAY_UNAVAILABLE,e)}handleClick(){const e=new C.CustomEvent(z.MEDIA_AIRPLAY_REQUEST,{composed:!0,bubbles:!0});this.dispatchEvent(e)}}C.customElements.get("media-airplay-button")||C.customElements.define("media-airplay-button",WS);var WM=WS;const qM=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M22.83 5.68a2.58 2.58 0 0 0-2.3-2.5c-3.62-.24-11.44-.24-15.06 0a2.58 2.58 0 0 0-2.3 2.5c-.23 4.21-.23 8.43 0 12.64a2.58 2.58 0 0 0 2.3 2.5c3.62.24 11.44.24 15.06 0a2.58 2.58 0 0 0 2.3-2.5c.23-4.21.23-8.43 0-12.64Zm-11.39 9.45a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.92 3.92 0 0 1 .92-2.77 3.18 3.18 0 0 1 2.43-1 2.94 2.94 0 0 1 2.13.78c.364.359.62.813.74 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.17 1.61 1.61 0 0 0-1.29.58 2.79 2.79 0 0 0-.5 1.89 3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.48 1.48 0 0 0 1-.37 2.1 2.1 0 0 0 .59-1.14l1.4.44a3.23 3.23 0 0 1-1.07 1.69Zm7.22 0a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.88 3.88 0 0 1 .93-2.77 3.14 3.14 0 0 1 2.42-1 3 3 0 0 1 2.16.82 2.8 2.8 0 0 1 .73 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.21 1.61 1.61 0 0 0-1.29.58A2.79 2.79 0 0 0 15 12a3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.44 1.44 0 0 0 1-.37 2.1 2.1 0 0 0 .6-1.15l1.4.44a3.17 3.17 0 0 1-1.1 1.7Z"/>
</svg>`,YM=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M17.73 14.09a1.4 1.4 0 0 1-1 .37 1.579 1.579 0 0 1-1.27-.58A3 3 0 0 1 15 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34A2.89 2.89 0 0 0 19 9.07a3 3 0 0 0-2.14-.78 3.14 3.14 0 0 0-2.42 1 3.91 3.91 0 0 0-.93 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.17 3.17 0 0 0 1.07-1.74l-1.4-.45c-.083.43-.3.822-.62 1.12Zm-7.22 0a1.43 1.43 0 0 1-1 .37 1.58 1.58 0 0 1-1.27-.58A3 3 0 0 1 7.76 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34a2.81 2.81 0 0 0-.74-1.32 2.94 2.94 0 0 0-2.13-.78 3.18 3.18 0 0 0-2.43 1 4 4 0 0 0-.92 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.23 3.23 0 0 0 1.07-1.74l-1.4-.45a2.06 2.06 0 0 1-.6 1.07Zm12.32-8.41a2.59 2.59 0 0 0-2.3-2.51C18.72 3.05 15.86 3 13 3c-2.86 0-5.72.05-7.53.17a2.59 2.59 0 0 0-2.3 2.51c-.23 4.207-.23 8.423 0 12.63a2.57 2.57 0 0 0 2.3 2.5c1.81.13 4.67.19 7.53.19 2.86 0 5.72-.06 7.53-.19a2.57 2.57 0 0 0 2.3-2.5c.23-4.207.23-8.423 0-12.63Zm-1.49 12.53a1.11 1.11 0 0 1-.91 1.11c-1.67.11-4.45.18-7.43.18-2.98 0-5.76-.07-7.43-.18a1.11 1.11 0 0 1-.91-1.11c-.21-4.14-.21-8.29 0-12.43a1.11 1.11 0 0 1 .91-1.11C7.24 4.56 10 4.49 13 4.49s5.76.07 7.43.18a1.11 1.11 0 0 1 .91 1.11c.21 4.14.21 8.29 0 12.43Z"/>
</svg>`,qS=ue.createElement("template");qS.innerHTML=`
  <style>
    :host([aria-checked="true"]) slot[name=off] {
      display: none !important;
    }

    
    :host(:not([aria-checked="true"])) slot[name=on] {
      display: none !important;
    }

    :host([aria-checked="true"]) slot[name=tooltip-enable],
    :host(:not([aria-checked="true"])) slot[name=tooltip-disable] {
      display: none;
    }
  </style>

  <slot name="icon">
    <slot name="on">${qM}</slot>
    <slot name="off">${YM}</slot>
  </slot>
`;const jM=`
  <slot name="tooltip-enable">${te("Enable captions")}</slot>
  <slot name="tooltip-disable">${te("Disable captions")}</slot>
`,Av=i=>{i.setAttribute("aria-checked",mM(i).toString())};class YS extends ni{static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_SUBTITLES_LIST,x.MEDIA_SUBTITLES_SHOWING]}constructor(e={}){super({slotTemplate:qS,tooltipContent:jM,...e}),this._captionsReady=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","switch"),this.setAttribute("aria-label",te("closed captions")),Av(this)}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),e===x.MEDIA_SUBTITLES_SHOWING&&Av(this)}get mediaSubtitlesList(){return xv(this,x.MEDIA_SUBTITLES_LIST)}set mediaSubtitlesList(e){bv(this,x.MEDIA_SUBTITLES_LIST,e)}get mediaSubtitlesShowing(){return xv(this,x.MEDIA_SUBTITLES_SHOWING)}set mediaSubtitlesShowing(e){bv(this,x.MEDIA_SUBTITLES_SHOWING,e)}handleClick(){this.dispatchEvent(new C.CustomEvent(z.MEDIA_TOGGLE_SUBTITLES_REQUEST,{composed:!0,bubbles:!0}))}}const xv=(i,e)=>{const t=i.getAttribute(e);return t?CS(t):[]},bv=(i,e,t)=>{if(!(t!=null&&t.length)){i.removeAttribute(e);return}const n=yf(t);i.getAttribute(e)!==n&&i.setAttribute(e,n)};C.customElements.get("media-captions-button")||C.customElements.define("media-captions-button",YS);var zM=YS;const QM='<svg aria-hidden="true" viewBox="0 0 24 24"><g><path class="cast_caf_icon_arch0" d="M1,18 L1,21 L4,21 C4,19.3 2.66,18 1,18 L1,18 Z"/><path class="cast_caf_icon_arch1" d="M1,14 L1,16 C3.76,16 6,18.2 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z"/><path class="cast_caf_icon_arch2" d="M1,10 L1,12 C5.97,12 10,16.0 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z"/><path class="cast_caf_icon_box" d="M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"/></g></svg>',XM='<svg aria-hidden="true" viewBox="0 0 24 24"><g><path class="cast_caf_icon_arch0" d="M1,18 L1,21 L4,21 C4,19.3 2.66,18 1,18 L1,18 Z"/><path class="cast_caf_icon_arch1" d="M1,14 L1,16 C3.76,16 6,18.2 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z"/><path class="cast_caf_icon_arch2" d="M1,10 L1,12 C5.97,12 10,16.0 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z"/><path class="cast_caf_icon_box" d="M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"/><path class="cast_caf_icon_boxfill" d="M5,7 L5,8.63 C8,8.6 13.37,14 13.37,17 L19,17 L19,7 Z"/></g></svg>',jS=ue.createElement("template");jS.innerHTML=`
  <style>
  :host([${x.MEDIA_IS_CASTING}]) slot[name=icon] slot:not([name=exit]) {
    display: none !important;
  }

  
  :host(:not([${x.MEDIA_IS_CASTING}])) slot[name=icon] slot:not([name=enter]) {
    display: none !important;
  }

  :host([${x.MEDIA_IS_CASTING}]) slot[name=tooltip-enter],
    :host(:not([${x.MEDIA_IS_CASTING}])) slot[name=tooltip-exit] {
      display: none;
    }
  </style>

  <slot name="icon">
    <slot name="enter">${QM}</slot>
    <slot name="exit">${XM}</slot>
  </slot>
`;const ZM=`
  <slot name="tooltip-enter">${te("Start casting")}</slot>
  <slot name="tooltip-exit">${te("Stop casting")}</slot>
`,Rv=i=>{const e=i.mediaIsCasting?te("stop casting"):te("start casting");i.setAttribute("aria-label",e)};class zS extends ni{static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_IS_CASTING,x.MEDIA_CAST_UNAVAILABLE]}constructor(e={}){super({slotTemplate:jS,tooltipContent:ZM,...e})}connectedCallback(){super.connectedCallback(),Rv(this)}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),e===x.MEDIA_IS_CASTING&&Rv(this)}get mediaIsCasting(){return ge(this,x.MEDIA_IS_CASTING)}set mediaIsCasting(e){ve(this,x.MEDIA_IS_CASTING,e)}get mediaCastUnavailable(){return We(this,x.MEDIA_CAST_UNAVAILABLE)}set mediaCastUnavailable(e){qe(this,x.MEDIA_CAST_UNAVAILABLE,e)}handleClick(){const e=this.mediaIsCasting?z.MEDIA_EXIT_CAST_REQUEST:z.MEDIA_ENTER_CAST_REQUEST;this.dispatchEvent(new C.CustomEvent(e,{composed:!0,bubbles:!0}))}}C.customElements.get("media-cast-button")||C.customElements.define("media-cast-button",zS);var JM=zS,mp=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},Dr=(i,e,t)=>(mp(i,e,"read from private field"),e.get(i)),un=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},pp=(i,e,t,n)=>(mp(i,e,"write to private field"),e.set(i,t),t),lr=(i,e,t)=>(mp(i,e,"access private method"),t),dc,Ao,$r,tu,xf,bf,QS,Rf,XS,wf,ZS,If,JS,Lf,eA;function eO(i){return`
    <style>
      :host {
        font: var(--media-font,
          var(--media-font-weight, normal)
          var(--media-font-size, 14px) /
          var(--media-text-content-height, var(--media-control-height, 24px))
          var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
        color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
        display: var(--media-dialog-display, inline-flex);
        justify-content: center;
        align-items: center;
        
        transition-behavior: allow-discrete;
        visibility: hidden;
        opacity: 0;
        transform: translateY(2px) scale(.99);
        pointer-events: none;
      }

      :host([open]) {
        transition: display .2s, visibility 0s, opacity .2s ease-out, transform .15s ease-out;
        visibility: visible;
        opacity: 1;
        transform: translateY(0) scale(1);
        pointer-events: auto;
      }

      #content {
        display: flex;
        position: relative;
        box-sizing: border-box;
        width: min(320px, 100%);
        word-wrap: break-word;
        max-height: 100%;
        overflow: auto;
        text-align: center;
        line-height: 1.4;
      }
    </style>
    ${this.getSlotTemplateHTML(i)}
  `}function tO(i){return`
    <slot id="content"></slot>
  `}const pa={OPEN:"open",ANCHOR:"anchor"};class Po extends C.HTMLElement{constructor(){super(),un(this,tu),un(this,bf),un(this,Rf),un(this,wf),un(this,If),un(this,Lf),un(this,dc,!1),un(this,Ao,null),un(this,$r,null),this.addEventListener("invoke",this),this.addEventListener("focusout",this),this.addEventListener("keydown",this)}static get observedAttributes(){return[pa.OPEN,pa.ANCHOR]}get open(){return ge(this,pa.OPEN)}set open(e){ve(this,pa.OPEN,e)}handleEvent(e){switch(e.type){case"invoke":lr(this,wf,ZS).call(this,e);break;case"focusout":lr(this,If,JS).call(this,e);break;case"keydown":lr(this,Lf,eA).call(this,e);break}}connectedCallback(){lr(this,tu,xf).call(this),this.role||(this.role="dialog")}attributeChangedCallback(e,t,n){lr(this,tu,xf).call(this),e===pa.OPEN&&n!==t&&(this.open?lr(this,bf,QS).call(this):lr(this,Rf,XS).call(this))}focus(){pp(this,Ao,yS());const e=!this.dispatchEvent(new Event("focus",{composed:!0,cancelable:!0})),t=!this.dispatchEvent(new Event("focusin",{composed:!0,bubbles:!0,cancelable:!0}));if(e||t)return;const n=this.querySelector('[autofocus], [tabindex]:not([tabindex="-1"]), [role="menu"]');n==null||n.focus()}get keysUsed(){return["Escape","Tab"]}}dc=new WeakMap;Ao=new WeakMap;$r=new WeakMap;tu=new WeakSet;xf=function(){if(!Dr(this,dc)&&(pp(this,dc,!0),!this.shadowRoot)){this.attachShadow({mode:"open"});const i=jP(this.attributes);this.shadowRoot.innerHTML=`
        ${this.constructor.getTemplateHTML(i)}
      `,queueMicrotask(()=>{const{style:e}=Je(this.shadowRoot,":host");e.setProperty("transition","display .15s, visibility .15s, opacity .15s ease-in, transform .15s ease-in")})}};bf=new WeakSet;QS=function(){var i;(i=Dr(this,$r))==null||i.setAttribute("aria-expanded","true"),this.dispatchEvent(new Event("open",{composed:!0,bubbles:!0})),this.addEventListener("transitionend",()=>this.focus(),{once:!0})};Rf=new WeakSet;XS=function(){var i;(i=Dr(this,$r))==null||i.setAttribute("aria-expanded","false"),this.dispatchEvent(new Event("close",{composed:!0,bubbles:!0}))};wf=new WeakSet;ZS=function(i){pp(this,$r,i.relatedTarget),ea(this,i.relatedTarget)||(this.open=!this.open)};If=new WeakSet;JS=function(i){var e;ea(this,i.relatedTarget)||((e=Dr(this,Ao))==null||e.focus(),Dr(this,$r)&&Dr(this,$r)!==i.relatedTarget&&this.open&&(this.open=!1))};Lf=new WeakSet;eA=function(i){var e,t,n,r,s;const{key:a,ctrlKey:o,altKey:l,metaKey:u}=i;o||l||u||this.keysUsed.includes(a)&&(i.preventDefault(),i.stopPropagation(),a==="Tab"?(i.shiftKey?(t=(e=this.previousElementSibling)==null?void 0:e.focus)==null||t.call(e):(r=(n=this.nextElementSibling)==null?void 0:n.focus)==null||r.call(n),this.blur()):a==="Escape"&&((s=Dr(this,Ao))==null||s.focus(),this.open=!1))};Po.getTemplateHTML=eO;Po.getSlotTemplateHTML=tO;C.customElements.get("media-chrome-dialog")||C.customElements.define("media-chrome-dialog",Po);var iO=Po,gp=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},Ue=(i,e,t)=>(gp(i,e,"read from private field"),t?t.call(i):e.get(i)),yt=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},Mn=(i,e,t,n)=>(gp(i,e,"write to private field"),e.set(i,t),t),_i=(i,e,t)=>(gp(i,e,"access private method"),t),Bi,Kc,iu,nu,Ai,hc,ru,su,au,vp,tA,ou,kf,lu,Df,fc,Ep,Cf,iA,Pf,nA,Mf,rA,Of,sA;const aA=ue.createElement("template");aA.innerHTML=`
  <style>
    :host {
      --_focus-box-shadow: var(--media-focus-box-shadow, inset 0 0 0 2px rgb(27 127 204 / .9));
      --_media-range-padding: var(--media-range-padding, var(--media-control-padding, 10px));

      box-shadow: var(--_focus-visible-box-shadow, none);
      background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));
      height: calc(var(--media-control-height, 24px) + 2 * var(--_media-range-padding));
      display: inline-flex;
      align-items: center;
      
      vertical-align: middle;
      box-sizing: border-box;
      position: relative;
      width: 100px;
      transition: background .15s linear;
      cursor: pointer;
      pointer-events: auto;
      touch-action: none; 
    }

    
    input[type=range]:focus {
      outline: 0;
    }
    input[type=range]:focus::-webkit-slider-runnable-track {
      outline: 0;
    }

    :host(:hover) {
      background: var(--media-control-hover-background, rgb(50 50 70 / .7));
    }

    #leftgap {
      padding-left: var(--media-range-padding-left, var(--_media-range-padding));
    }

    #rightgap {
      padding-right: var(--media-range-padding-right, var(--_media-range-padding));
    }

    #startpoint,
    #endpoint {
      position: absolute;
    }

    #endpoint {
      right: 0;
    }

    #container {
      
      width: var(--media-range-track-width, 100%);
      transform: translate(var(--media-range-track-translate-x, 0px), var(--media-range-track-translate-y, 0px));
      position: relative;
      height: 100%;
      display: flex;
      align-items: center;
      min-width: 40px;
    }

    #range {
      
      display: var(--media-time-range-hover-display, block);
      bottom: var(--media-time-range-hover-bottom, -7px);
      height: var(--media-time-range-hover-height, max(100% + 7px, 25px));
      width: 100%;
      position: absolute;
      cursor: pointer;

      -webkit-appearance: none; 
      -webkit-tap-highlight-color: transparent;
      background: transparent; 
      margin: 0;
      z-index: 1;
    }

    @media (hover: hover) {
      #range {
        bottom: var(--media-time-range-hover-bottom, -5px);
        height: var(--media-time-range-hover-height, max(100% + 5px, 20px));
      }
    }

    
    
    #range::-webkit-slider-thumb {
      -webkit-appearance: none;
      background: transparent;
      width: .1px;
      height: .1px;
    }

    
    #range::-moz-range-thumb {
      background: transparent;
      border: transparent;
      width: .1px;
      height: .1px;
    }

    #appearance {
      height: var(--media-range-track-height, 4px);
      display: flex;
      flex-direction: column;
      justify-content: center;
      width: 100%;
      position: absolute;
      
      will-change: transform;
    }

    #track {
      background: var(--media-range-track-background, rgb(255 255 255 / .2));
      border-radius: var(--media-range-track-border-radius, 1px);
      border: var(--media-range-track-border, none);
      outline: var(--media-range-track-outline);
      outline-offset: var(--media-range-track-outline-offset);
      backdrop-filter: var(--media-range-track-backdrop-filter);
      -webkit-backdrop-filter: var(--media-range-track-backdrop-filter);
      box-shadow: var(--media-range-track-box-shadow, none);
      position: absolute;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }

    #progress,
    #pointer {
      position: absolute;
      height: 100%;
      will-change: width;
    }

    #progress {
      background: var(--media-range-bar-color, var(--media-primary-color, rgb(238 238 238)));
      transition: var(--media-range-track-transition);
    }

    #pointer {
      background: var(--media-range-track-pointer-background);
      border-right: var(--media-range-track-pointer-border-right);
      transition: visibility .25s, opacity .25s;
      visibility: hidden;
      opacity: 0;
    }

    @media (hover: hover) {
      :host(:hover) #pointer {
        transition: visibility .5s, opacity .5s;
        visibility: visible;
        opacity: 1;
      }
    }

    #thumb,
    ::slotted([slot=thumb]) {
      width: var(--media-range-thumb-width, 10px);
      height: var(--media-range-thumb-height, 10px);
      transition: var(--media-range-thumb-transition);
      transform: var(--media-range-thumb-transform, none);
      opacity: var(--media-range-thumb-opacity, 1);
      translate: -50%;
      position: absolute;
      left: 0;
      cursor: pointer;
    }

    #thumb {
      border-radius: var(--media-range-thumb-border-radius, 10px);
      background: var(--media-range-thumb-background, var(--media-primary-color, rgb(238 238 238)));
      box-shadow: var(--media-range-thumb-box-shadow, 1px 1px 1px transparent);
      border: var(--media-range-thumb-border, none);
    }

    :host([disabled]) #thumb {
      background-color: #777;
    }

    .segments #appearance {
      height: var(--media-range-segment-hover-height, 7px);
    }

    #track {
      clip-path: url(#segments-clipping);
    }

    #segments {
      --segments-gap: var(--media-range-segments-gap, 2px);
      position: absolute;
      width: 100%;
      height: 100%;
    }

    #segments-clipping {
      transform: translateX(calc(var(--segments-gap) / 2));
    }

    #segments-clipping:empty {
      display: none;
    }

    #segments-clipping rect {
      height: var(--media-range-track-height, 4px);
      y: calc((var(--media-range-segment-hover-height, 7px) - var(--media-range-track-height, 4px)) / 2);
      transition: var(--media-range-segment-transition, transform .1s ease-in-out);
      transform: var(--media-range-segment-transform, scaleY(1));
      transform-origin: center;
    }
  </style>
  <div id="leftgap"></div>
  <div id="container">
    <div id="startpoint"></div>
    <div id="endpoint"></div>
    <div id="appearance">
      <div id="track" part="track">
        <div id="pointer"></div>
        <div id="progress" part="progress"></div>
      </div>
      <slot name="thumb">
        <div id="thumb" part="thumb"></div>
      </slot>
      <svg id="segments"><clipPath id="segments-clipping"></clipPath></svg>
    </div>
    <input id="range" type="range" min="0" max="1" step="any" value="0">
  </div>
  <div id="rightgap"></div>
`;class Wc extends C.HTMLElement{constructor(){super(),yt(this,vp),yt(this,ou),yt(this,lu),yt(this,fc),yt(this,Cf),yt(this,Pf),yt(this,Mf),yt(this,Of),yt(this,Bi,void 0),yt(this,Kc,void 0),yt(this,iu,void 0),yt(this,nu,void 0),yt(this,Ai,{}),yt(this,hc,[]),yt(this,ru,()=>{if(this.range.matches(":focus-visible")){const{style:e}=Je(this.shadowRoot,":host");e.setProperty("--_focus-visible-box-shadow","var(--_focus-box-shadow)")}}),yt(this,su,()=>{const{style:e}=Je(this.shadowRoot,":host");e.removeProperty("--_focus-visible-box-shadow")}),yt(this,au,()=>{const e=this.shadowRoot.querySelector("#segments-clipping");e&&e.parentNode.append(e)}),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(aA.content.cloneNode(!0))),this.container=this.shadowRoot.querySelector("#container"),Mn(this,iu,this.shadowRoot.querySelector("#startpoint")),Mn(this,nu,this.shadowRoot.querySelector("#endpoint")),this.range=this.shadowRoot.querySelector("#range"),this.appearance=this.shadowRoot.querySelector("#appearance")}static get observedAttributes(){return["disabled","aria-disabled",_e.MEDIA_CONTROLLER]}attributeChangedCallback(e,t,n){var r,s,a,o,l;e===_e.MEDIA_CONTROLLER?(t&&((s=(r=Ue(this,Bi))==null?void 0:r.unassociateElement)==null||s.call(r,this),Mn(this,Bi,null)),n&&this.isConnected&&(Mn(this,Bi,(a=this.getRootNode())==null?void 0:a.getElementById(n)),(l=(o=Ue(this,Bi))==null?void 0:o.associateElement)==null||l.call(o,this))):(e==="disabled"||e==="aria-disabled"&&t!==n)&&(n==null?(this.range.removeAttribute(e),_i(this,ou,kf).call(this)):(this.range.setAttribute(e,n),_i(this,lu,Df).call(this)))}connectedCallback(){var e,t,n;const{style:r}=Je(this.shadowRoot,":host");r.setProperty("display",`var(--media-control-display, var(--${this.localName}-display, inline-flex))`),Ue(this,Ai).pointer=Je(this.shadowRoot,"#pointer"),Ue(this,Ai).progress=Je(this.shadowRoot,"#progress"),Ue(this,Ai).thumb=Je(this.shadowRoot,'#thumb, ::slotted([slot="thumb"])'),Ue(this,Ai).activeSegment=Je(this.shadowRoot,"#segments-clipping rect:nth-child(0)");const s=this.getAttribute(_e.MEDIA_CONTROLLER);s&&(Mn(this,Bi,(e=this.getRootNode())==null?void 0:e.getElementById(s)),(n=(t=Ue(this,Bi))==null?void 0:t.associateElement)==null||n.call(t,this)),this.updateBar(),this.shadowRoot.addEventListener("focusin",Ue(this,ru)),this.shadowRoot.addEventListener("focusout",Ue(this,su)),_i(this,ou,kf).call(this),pS(this.container,Ue(this,au))}disconnectedCallback(){var e,t;_i(this,lu,Df).call(this),(t=(e=Ue(this,Bi))==null?void 0:e.unassociateElement)==null||t.call(e,this),Mn(this,Bi,null),this.shadowRoot.removeEventListener("focusin",Ue(this,ru)),this.shadowRoot.removeEventListener("focusout",Ue(this,su)),gS(this.container,Ue(this,au))}updatePointerBar(e){var t;(t=Ue(this,Ai).pointer)==null||t.style.setProperty("width",`${this.getPointerRatio(e)*100}%`)}updateBar(){var e,t;const n=this.range.valueAsNumber*100;(e=Ue(this,Ai).progress)==null||e.style.setProperty("width",`${n}%`),(t=Ue(this,Ai).thumb)==null||t.style.setProperty("left",`${n}%`)}updateSegments(e){const t=this.shadowRoot.querySelector("#segments-clipping");if(t.textContent="",this.container.classList.toggle("segments",!!(e!=null&&e.length)),!(e!=null&&e.length))return;const n=[...new Set([+this.range.min,...e.flatMap(s=>[s.start,s.end]),+this.range.max])];Mn(this,hc,[...n]);const r=n.pop();for(const[s,a]of n.entries()){const[o,l]=[s===0,s===n.length-1],u=o?"calc(var(--segments-gap) / -1)":`${a*100}%`,d=`calc(${((l?r:n[s+1])-a)*100}%${o||l?"":" - var(--segments-gap)"})`,h=ue.createElementNS("http://www.w3.org/2000/svg","rect"),f=Je(this.shadowRoot,`#segments-clipping rect:nth-child(${s+1})`);f.style.setProperty("x",u),f.style.setProperty("width",d),t.append(h)}}getPointerRatio(e){const t=JP(e.clientX,e.clientY,Ue(this,iu).getBoundingClientRect(),Ue(this,nu).getBoundingClientRect());return Math.max(0,Math.min(1,t))}get dragging(){return this.hasAttribute("dragging")}handleEvent(e){switch(e.type){case"pointermove":_i(this,Of,sA).call(this,e);break;case"input":this.updateBar();break;case"pointerenter":_i(this,Cf,iA).call(this,e);break;case"pointerdown":_i(this,fc,Ep).call(this,e);break;case"pointerup":_i(this,Pf,nA).call(this);break;case"pointerleave":_i(this,Mf,rA).call(this);break}}get keysUsed(){return["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"]}}Bi=new WeakMap;Kc=new WeakMap;iu=new WeakMap;nu=new WeakMap;Ai=new WeakMap;hc=new WeakMap;ru=new WeakMap;su=new WeakMap;au=new WeakMap;vp=new WeakSet;tA=function(i){const e=Ue(this,Ai).activeSegment;if(!e)return;const t=this.getPointerRatio(i),r=`#segments-clipping rect:nth-child(${Ue(this,hc).findIndex((s,a,o)=>{const l=o[a+1];return l!=null&&t>=s&&t<=l})+1})`;(e.selectorText!=r||!e.style.transform)&&(e.selectorText=r,e.style.setProperty("transform","var(--media-range-segment-hover-transform, scaleY(2))"))};ou=new WeakSet;kf=function(){this.hasAttribute("disabled")||(this.addEventListener("input",this),this.addEventListener("pointerdown",this),this.addEventListener("pointerenter",this))};lu=new WeakSet;Df=function(){var i,e;this.removeEventListener("input",this),this.removeEventListener("pointerdown",this),this.removeEventListener("pointerenter",this),(i=C.window)==null||i.removeEventListener("pointerup",this),(e=C.window)==null||e.removeEventListener("pointermove",this)};fc=new WeakSet;Ep=function(i){var e;Mn(this,Kc,i.composedPath().includes(this.range)),(e=C.window)==null||e.addEventListener("pointerup",this)};Cf=new WeakSet;iA=function(i){var e;i.pointerType!=="mouse"&&_i(this,fc,Ep).call(this,i),this.addEventListener("pointerleave",this),(e=C.window)==null||e.addEventListener("pointermove",this)};Pf=new WeakSet;nA=function(){var i;(i=C.window)==null||i.removeEventListener("pointerup",this),this.toggleAttribute("dragging",!1),this.range.disabled=this.hasAttribute("disabled")};Mf=new WeakSet;rA=function(){var i,e;this.removeEventListener("pointerleave",this),(i=C.window)==null||i.removeEventListener("pointermove",this),this.toggleAttribute("dragging",!1),this.range.disabled=this.hasAttribute("disabled"),(e=Ue(this,Ai).activeSegment)==null||e.style.removeProperty("transform")};Of=new WeakSet;sA=function(i){this.toggleAttribute("dragging",i.buttons===1||i.pointerType!=="mouse"),this.updatePointerBar(i),_i(this,vp,tA).call(this,i),this.dragging&&(i.pointerType!=="mouse"||!Ue(this,Kc))&&(this.range.disabled=!0,this.range.valueAsNumber=this.getPointerRatio(i),this.range.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})))};C.customElements.get("media-chrome-range")||C.customElements.define("media-chrome-range",Wc);var nO=Wc,oA=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},pl=(i,e,t)=>(oA(i,e,"read from private field"),t?t.call(i):e.get(i)),rO=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},gl=(i,e,t,n)=>(oA(i,e,"write to private field"),e.set(i,t),t),Gi;const lA=ue.createElement("template");lA.innerHTML=`
  <style>
    :host {
      
      box-sizing: border-box;
      display: var(--media-control-display, var(--media-control-bar-display, inline-flex));
      color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
      --media-loading-indicator-icon-height: 44px;
    }

    ::slotted(media-time-range),
    ::slotted(media-volume-range) {
      min-height: 100%;
    }

    ::slotted(media-time-range),
    ::slotted(media-clip-selector) {
      flex-grow: 1;
    }

    ::slotted([role="menu"]) {
      position: absolute;
    }
  </style>

  <slot></slot>
`;class uA extends C.HTMLElement{constructor(){super(),rO(this,Gi,void 0),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(lA.content.cloneNode(!0)))}static get observedAttributes(){return[_e.MEDIA_CONTROLLER]}attributeChangedCallback(e,t,n){var r,s,a,o,l;e===_e.MEDIA_CONTROLLER&&(t&&((s=(r=pl(this,Gi))==null?void 0:r.unassociateElement)==null||s.call(r,this),gl(this,Gi,null)),n&&this.isConnected&&(gl(this,Gi,(a=this.getRootNode())==null?void 0:a.getElementById(n)),(l=(o=pl(this,Gi))==null?void 0:o.associateElement)==null||l.call(o,this)))}connectedCallback(){var e,t,n;const r=this.getAttribute(_e.MEDIA_CONTROLLER);r&&(gl(this,Gi,(e=this.getRootNode())==null?void 0:e.getElementById(r)),(n=(t=pl(this,Gi))==null?void 0:t.associateElement)==null||n.call(t,this))}disconnectedCallback(){var e,t;(t=(e=pl(this,Gi))==null?void 0:e.unassociateElement)==null||t.call(e,this),gl(this,Gi,null)}}Gi=new WeakMap;C.customElements.get("media-control-bar")||C.customElements.define("media-control-bar",uA);var sO=uA,cA=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},vl=(i,e,t)=>(cA(i,e,"read from private field"),t?t.call(i):e.get(i)),aO=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},El=(i,e,t,n)=>(cA(i,e,"write to private field"),e.set(i,t),t),Hi;const dA=ue.createElement("template");dA.innerHTML=`
  <style>
    :host {
      font: var(--media-font,
        var(--media-font-weight, normal)
        var(--media-font-size, 14px) /
        var(--media-text-content-height, var(--media-control-height, 24px))
        var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
      color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
      background: var(--media-text-background, var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7))));
      padding: var(--media-control-padding, 10px);
      display: inline-flex;
      justify-content: center;
      align-items: center;
      vertical-align: middle;
      box-sizing: border-box;
      text-align: center;
      pointer-events: auto;
    }

    
    :host(:focus-visible) {
      box-shadow: inset 0 0 0 2px rgb(27 127 204 / .9);
      outline: 0;
    }

    
    :host(:where(:focus)) {
      box-shadow: none;
      outline: 0;
    }
  </style>
  <slot></slot>
`;class ta extends C.HTMLElement{constructor(){super(),aO(this,Hi,void 0),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(dA.content.cloneNode(!0)))}static get observedAttributes(){return[_e.MEDIA_CONTROLLER]}attributeChangedCallback(e,t,n){var r,s,a,o,l;e===_e.MEDIA_CONTROLLER&&(t&&((s=(r=vl(this,Hi))==null?void 0:r.unassociateElement)==null||s.call(r,this),El(this,Hi,null)),n&&this.isConnected&&(El(this,Hi,(a=this.getRootNode())==null?void 0:a.getElementById(n)),(l=(o=vl(this,Hi))==null?void 0:o.associateElement)==null||l.call(o,this)))}connectedCallback(){var e,t,n;const{style:r}=Je(this.shadowRoot,":host");r.setProperty("display",`var(--media-control-display, var(--${this.localName}-display, inline-flex))`);const s=this.getAttribute(_e.MEDIA_CONTROLLER);s&&(El(this,Hi,(e=this.getRootNode())==null?void 0:e.getElementById(s)),(n=(t=vl(this,Hi))==null?void 0:t.associateElement)==null||n.call(t,this))}disconnectedCallback(){var e,t;(t=(e=vl(this,Hi))==null?void 0:e.unassociateElement)==null||t.call(e,this),El(this,Hi,null)}}Hi=new WeakMap;C.customElements.get("media-text-display")||C.customElements.define("media-text-display",ta);var oO=ta,hA=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},wv=(i,e,t)=>(hA(i,e,"read from private field"),t?t.call(i):e.get(i)),lO=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},uO=(i,e,t,n)=>(hA(i,e,"write to private field"),e.set(i,t),t),Ia;class fA extends ta{constructor(){super(),lO(this,Ia,void 0),uO(this,Ia,this.shadowRoot.querySelector("slot")),wv(this,Ia).textContent=kr(0)}static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_DURATION]}attributeChangedCallback(e,t,n){e===x.MEDIA_DURATION&&(wv(this,Ia).textContent=kr(+n)),super.attributeChangedCallback(e,t,n)}get mediaDuration(){return Ke(this,x.MEDIA_DURATION)}set mediaDuration(e){pt(this,x.MEDIA_DURATION,e)}}Ia=new WeakMap;C.customElements.get("media-duration-display")||C.customElements.define("media-duration-display",fA);var cO=fA;const dO={2:te("Network Error"),3:te("Decode Error"),4:te("Source Not Supported"),5:te("Encryption Error")},hO={2:te("A network error caused the media download to fail."),3:te("A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format."),4:te("An unsupported error occurred. The server or network failed, or your browser does not support this format."),5:te("The media is encrypted and there are no keys to decrypt it.")},mA=i=>{var e,t;return i.code===1?null:{title:(e=dO[i.code])!=null?e:`Error ${i.code}`,message:(t=hO[i.code])!=null?t:i.message}};var pA=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},fO=(i,e,t)=>(pA(i,e,"read from private field"),t?t.call(i):e.get(i)),mO=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},pO=(i,e,t,n)=>(pA(i,e,"write to private field"),e.set(i,t),t),uu;function gO(i){return`
    <style>
      :host {
        background: rgb(20 20 30 / .8);
      }

      #content {
        display: block;
        padding: 1.2em 1.5em;
      }

      h3,
      p {
        margin-block: 0 .3em;
      }
    </style>
    <slot name="error-${i.mediaerrorcode}" id="content">
      ${gA({code:+i.mediaerrorcode,message:i.mediaerrormessage})}
    </slot>
  `}function vO(i){return i.code&&mA(i)!==null}function gA(i){var e;const{title:t,message:n}=(e=mA(i))!=null?e:{};let r="";return t&&(r+=`<slot name="error-${i.code}-title"><h3>${t}</h3></slot>`),n&&(r+=`<slot name="error-${i.code}-message"><p>${n}</p></slot>`),r}const Iv=[x.MEDIA_ERROR_CODE,x.MEDIA_ERROR_MESSAGE];class qc extends Po{constructor(){super(...arguments),mO(this,uu,null)}static get observedAttributes(){return[...super.observedAttributes,...Iv]}formatErrorMessage(e){return this.constructor.formatErrorMessage(e)}attributeChangedCallback(e,t,n){var r;if(super.attributeChangedCallback(e,t,n),!Iv.includes(e))return;const s=(r=this.mediaError)!=null?r:{code:this.mediaErrorCode,message:this.mediaErrorMessage};this.open=vO(s),this.open&&(this.shadowRoot.querySelector("slot").name=`error-${this.mediaErrorCode}`,this.shadowRoot.querySelector("#content").innerHTML=this.formatErrorMessage(s))}get mediaError(){return fO(this,uu)}set mediaError(e){pO(this,uu,e)}get mediaErrorCode(){return Ke(this,"mediaerrorcode")}set mediaErrorCode(e){pt(this,"mediaerrorcode",e)}get mediaErrorMessage(){return We(this,"mediaerrormessage")}set mediaErrorMessage(e){qe(this,"mediaerrormessage",e)}}uu=new WeakMap;qc.getSlotTemplateHTML=gO;qc.formatErrorMessage=gA;C.customElements.get("media-error-dialog")||C.customElements.define("media-error-dialog",qc);var EO=qc;const yO=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M16 3v2.5h3.5V9H22V3h-6ZM4 9h2.5V5.5H10V3H4v6Zm15.5 9.5H16V21h6v-6h-2.5v3.5ZM6.5 15H4v6h6v-2.5H6.5V15Z"/>
</svg>`,TO=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M18.5 6.5V3H16v6h6V6.5h-3.5ZM16 21h2.5v-3.5H22V15h-6v6ZM4 17.5h3.5V21H10v-6H4v2.5Zm3.5-11H4V9h6V3H7.5v3.5Z"/>
</svg>`,vA=ue.createElement("template");vA.innerHTML=`
  <style>
    :host([${x.MEDIA_IS_FULLSCREEN}]) slot[name=icon] slot:not([name=exit]) {
      display: none !important;
    }

    
    :host(:not([${x.MEDIA_IS_FULLSCREEN}])) slot[name=icon] slot:not([name=enter]) {
      display: none !important;
    }

    :host([${x.MEDIA_IS_FULLSCREEN}]) slot[name=tooltip-enter],
    :host(:not([${x.MEDIA_IS_FULLSCREEN}])) slot[name=tooltip-exit] {
      display: none;
    }
  </style>

  <slot name="icon">
    <slot name="enter">${yO}</slot>
    <slot name="exit">${TO}</slot>
  </slot>
`;const _O=`
  <slot name="tooltip-enter">${te("Enter fullscreen mode")}</slot>
  <slot name="tooltip-exit">${te("Exit fullscreen mode")}</slot>
`,Lv=i=>{const e=i.mediaIsFullscreen?te("exit fullscreen mode"):te("enter fullscreen mode");i.setAttribute("aria-label",e)};class EA extends ni{static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_IS_FULLSCREEN,x.MEDIA_FULLSCREEN_UNAVAILABLE]}constructor(e={}){super({slotTemplate:vA,tooltipContent:_O,...e})}connectedCallback(){super.connectedCallback(),Lv(this)}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),e===x.MEDIA_IS_FULLSCREEN&&Lv(this)}get mediaFullscreenUnavailable(){return We(this,x.MEDIA_FULLSCREEN_UNAVAILABLE)}set mediaFullscreenUnavailable(e){qe(this,x.MEDIA_FULLSCREEN_UNAVAILABLE,e)}get mediaIsFullscreen(){return ge(this,x.MEDIA_IS_FULLSCREEN)}set mediaIsFullscreen(e){ve(this,x.MEDIA_IS_FULLSCREEN,e)}handleClick(){const e=this.mediaIsFullscreen?z.MEDIA_EXIT_FULLSCREEN_REQUEST:z.MEDIA_ENTER_FULLSCREEN_REQUEST;this.dispatchEvent(new C.CustomEvent(e,{composed:!0,bubbles:!0}))}}C.customElements.get("media-fullscreen-button")||C.customElements.define("media-fullscreen-button",EA);var SO=EA;const{MEDIA_TIME_IS_LIVE:cu,MEDIA_PAUSED:qa}=x,{MEDIA_SEEK_TO_LIVE_REQUEST:AO,MEDIA_PLAY_REQUEST:xO}=z,bO='<svg viewBox="0 0 6 12"><circle cx="3" cy="6" r="2"></circle></svg>',yA=ue.createElement("template");yA.innerHTML=`
  <style>
  :host { --media-tooltip-display: none; }
  
  slot[name=indicator] > *,
  :host ::slotted([slot=indicator]) {
    
    min-width: auto;
    fill: var(--media-live-button-icon-color, rgb(140, 140, 140));
    color: var(--media-live-button-icon-color, rgb(140, 140, 140));
  }

  :host([${cu}]:not([${qa}])) slot[name=indicator] > *,
  :host([${cu}]:not([${qa}])) ::slotted([slot=indicator]) {
    fill: var(--media-live-button-indicator-color, rgb(255, 0, 0));
    color: var(--media-live-button-indicator-color, rgb(255, 0, 0));
  }

  :host([${cu}]:not([${qa}])) {
    cursor: not-allowed;
  }

  slot[name=text]{
    text-transform: uppercase;
  }

  </style>

  <slot name="indicator">${bO}</slot>
  
  <slot name="spacer">&nbsp;</slot><slot name="text">${te("live")}</slot>
`;const kv=i=>{const e=i.mediaPaused||!i.mediaTimeIsLive,t=te(e?"seek to live":"playing live");i.setAttribute("aria-label",t),e?i.removeAttribute("aria-disabled"):i.setAttribute("aria-disabled","true")};class TA extends ni{static get observedAttributes(){return[...super.observedAttributes,qa,cu]}constructor(e={}){super({slotTemplate:yA,...e})}connectedCallback(){kv(this),super.connectedCallback()}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),kv(this)}get mediaPaused(){return ge(this,x.MEDIA_PAUSED)}set mediaPaused(e){ve(this,x.MEDIA_PAUSED,e)}get mediaTimeIsLive(){return ge(this,x.MEDIA_TIME_IS_LIVE)}set mediaTimeIsLive(e){ve(this,x.MEDIA_TIME_IS_LIVE,e)}handleClick(){!this.mediaPaused&&this.mediaTimeIsLive||(this.dispatchEvent(new C.CustomEvent(AO,{composed:!0,bubbles:!0})),this.hasAttribute(qa)&&this.dispatchEvent(new C.CustomEvent(xO,{composed:!0,bubbles:!0})))}}C.customElements.get("media-live-button")||C.customElements.define("media-live-button",TA);var RO=TA,_A=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},ga=(i,e,t)=>(_A(i,e,"read from private field"),t?t.call(i):e.get(i)),Dv=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},va=(i,e,t,n)=>(_A(i,e,"write to private field"),e.set(i,t),t),Vi,du;const yl={LOADING_DELAY:"loadingdelay",NO_AUTOHIDE:"noautohide"},SA=500,AA=ue.createElement("template"),wO=`
<svg aria-hidden="true" viewBox="0 0 100 100">
  <path d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50">
    <animateTransform
       attributeName="transform"
       attributeType="XML"
       type="rotate"
       dur="1s"
       from="0 50 50"
       to="360 50 50"
       repeatCount="indefinite" />
  </path>
</svg>
`;AA.innerHTML=`
<style>
:host {
  display: var(--media-control-display, var(--media-loading-indicator-display, inline-block));
  vertical-align: middle;
  box-sizing: border-box;
  --_loading-indicator-delay: var(--media-loading-indicator-transition-delay, ${SA}ms);
}

#status {
  color: rgba(0,0,0,0);
  width: 0px;
  height: 0px;
}

:host slot[name=icon] > *,
:host ::slotted([slot=icon]) {
  opacity: var(--media-loading-indicator-opacity, 0);
  transition: opacity 0.15s;
}

:host([${x.MEDIA_LOADING}]:not([${x.MEDIA_PAUSED}])) slot[name=icon] > *,
:host([${x.MEDIA_LOADING}]:not([${x.MEDIA_PAUSED}])) ::slotted([slot=icon]) {
  opacity: var(--media-loading-indicator-opacity, 1);
  transition: opacity 0.15s var(--_loading-indicator-delay);
}

:host #status {
  visibility: var(--media-loading-indicator-opacity, hidden);
  transition: visibility 0.15s;
}

:host([${x.MEDIA_LOADING}]:not([${x.MEDIA_PAUSED}])) #status {
  visibility: var(--media-loading-indicator-opacity, visible);
  transition: visibility 0.15s var(--_loading-indicator-delay);
}

svg, img, ::slotted(svg), ::slotted(img) {
  width: var(--media-loading-indicator-icon-width);
  height: var(--media-loading-indicator-icon-height, 100px);
  fill: var(--media-icon-color, var(--media-primary-color, rgb(238 238 238)));
  vertical-align: middle;
}
</style>

<slot name="icon">${wO}</slot>
<div id="status" role="status" aria-live="polite">${te("media loading")}</div>
`;class xA extends C.HTMLElement{constructor(){if(super(),Dv(this,Vi,void 0),Dv(this,du,SA),!this.shadowRoot){const e=this.attachShadow({mode:"open"}),t=AA.content.cloneNode(!0);e.appendChild(t)}}static get observedAttributes(){return[_e.MEDIA_CONTROLLER,x.MEDIA_PAUSED,x.MEDIA_LOADING,yl.LOADING_DELAY]}attributeChangedCallback(e,t,n){var r,s,a,o,l;e===yl.LOADING_DELAY&&t!==n?this.loadingDelay=Number(n):e===_e.MEDIA_CONTROLLER&&(t&&((s=(r=ga(this,Vi))==null?void 0:r.unassociateElement)==null||s.call(r,this),va(this,Vi,null)),n&&this.isConnected&&(va(this,Vi,(a=this.getRootNode())==null?void 0:a.getElementById(n)),(l=(o=ga(this,Vi))==null?void 0:o.associateElement)==null||l.call(o,this)))}connectedCallback(){var e,t,n;const r=this.getAttribute(_e.MEDIA_CONTROLLER);r&&(va(this,Vi,(e=this.getRootNode())==null?void 0:e.getElementById(r)),(n=(t=ga(this,Vi))==null?void 0:t.associateElement)==null||n.call(t,this))}disconnectedCallback(){var e,t;(t=(e=ga(this,Vi))==null?void 0:e.unassociateElement)==null||t.call(e,this),va(this,Vi,null)}get loadingDelay(){return ga(this,du)}set loadingDelay(e){va(this,du,e);const{style:t}=Je(this.shadowRoot,":host");t.setProperty("--_loading-indicator-delay",`var(--media-loading-indicator-transition-delay, ${e}ms)`)}get mediaPaused(){return ge(this,x.MEDIA_PAUSED)}set mediaPaused(e){ve(this,x.MEDIA_PAUSED,e)}get mediaLoading(){return ge(this,x.MEDIA_LOADING)}set mediaLoading(e){ve(this,x.MEDIA_LOADING,e)}get mediaController(){return We(this,_e.MEDIA_CONTROLLER)}set mediaController(e){qe(this,_e.MEDIA_CONTROLLER,e)}get noAutohide(){return ge(this,yl.NO_AUTOHIDE)}set noAutohide(e){ve(this,yl.NO_AUTOHIDE,e)}}Vi=new WeakMap;du=new WeakMap;C.customElements.get("media-loading-indicator")||C.customElements.define("media-loading-indicator",xA);var IO=xA;const{MEDIA_VOLUME_LEVEL:ur}=x,LO=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M16.5 12A4.5 4.5 0 0 0 14 8v2.18l2.45 2.45a4.22 4.22 0 0 0 .05-.63Zm2.5 0a6.84 6.84 0 0 1-.54 2.64L20 16.15A8.8 8.8 0 0 0 21 12a9 9 0 0 0-7-8.77v2.06A7 7 0 0 1 19 12ZM4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25A6.92 6.92 0 0 1 14 18.7v2.06A9 9 0 0 0 17.69 19l2 2.05L21 19.73l-9-9L4.27 3ZM12 4 9.91 6.09 12 8.18V4Z"/>
</svg>`,Cv=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M3 9v6h4l5 5V4L7 9H3Zm13.5 3A4.5 4.5 0 0 0 14 8v8a4.47 4.47 0 0 0 2.5-4Z"/>
</svg>`,kO=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M3 9v6h4l5 5V4L7 9H3Zm13.5 3A4.5 4.5 0 0 0 14 8v8a4.47 4.47 0 0 0 2.5-4ZM14 3.23v2.06a7 7 0 0 1 0 13.42v2.06a9 9 0 0 0 0-17.54Z"/>
</svg>`,bA=ue.createElement("template");bA.innerHTML=`
  <style>
  
  :host(:not([${ur}])) slot[name=icon] slot:not([name=high]), 
  :host([${ur}=high]) slot[name=icon] slot:not([name=high]) {
    display: none !important;
  }

  :host([${ur}=off]) slot[name=icon] slot:not([name=off]) {
    display: none !important;
  }

  :host([${ur}=low]) slot[name=icon] slot:not([name=low]) {
    display: none !important;
  }

  :host([${ur}=medium]) slot[name=icon] slot:not([name=medium]) {
    display: none !important;
  }

  :host(:not([${ur}=off])) slot[name=tooltip-unmute],
  :host([${ur}=off]) slot[name=tooltip-mute] {
    display: none;
  }
  </style>

  <slot name="icon">
    <slot name="off">${LO}</slot>
    <slot name="low">${Cv}</slot>
    <slot name="medium">${Cv}</slot>
    <slot name="high">${kO}</slot>
  </slot>
`;const DO=`
  <slot name="tooltip-mute">${te("Mute")}</slot>
  <slot name="tooltip-unmute">${te("Unmute")}</slot>
`,Pv=i=>{const e=i.mediaVolumeLevel==="off",t=te(e?"unmute":"mute");i.setAttribute("aria-label",t)};class RA extends ni{static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_VOLUME_LEVEL]}constructor(e={}){super({slotTemplate:bA,tooltipContent:DO,...e})}connectedCallback(){Pv(this),super.connectedCallback()}attributeChangedCallback(e,t,n){e===x.MEDIA_VOLUME_LEVEL&&Pv(this),super.attributeChangedCallback(e,t,n)}get mediaVolumeLevel(){return We(this,x.MEDIA_VOLUME_LEVEL)}set mediaVolumeLevel(e){qe(this,x.MEDIA_VOLUME_LEVEL,e)}handleClick(){const e=this.mediaVolumeLevel==="off"?z.MEDIA_UNMUTE_REQUEST:z.MEDIA_MUTE_REQUEST;this.dispatchEvent(new C.CustomEvent(e,{composed:!0,bubbles:!0}))}}C.customElements.get("media-mute-button")||C.customElements.define("media-mute-button",RA);var CO=RA;const Mv=`<svg aria-hidden="true" viewBox="0 0 28 24">
  <path d="M24 3H4a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h20a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1Zm-1 16H5V5h18v14Zm-3-8h-7v5h7v-5Z"/>
</svg>`,wA=ue.createElement("template");wA.innerHTML=`
  <style>
  :host([${x.MEDIA_IS_PIP}]) slot[name=icon] slot:not([name=exit]) {
    display: none !important;
  }

  
  :host(:not([${x.MEDIA_IS_PIP}])) slot[name=icon] slot:not([name=enter]) {
    display: none !important;
  }

  :host([${x.MEDIA_IS_PIP}]) slot[name=tooltip-enter],
  :host(:not([${x.MEDIA_IS_PIP}])) slot[name=tooltip-exit] {
    display: none;
  }
  </style>

  <slot name="icon">
    <slot name="enter">${Mv}</slot>
    <slot name="exit">${Mv}</slot>
  </slot>
`;const PO=`
  <slot name="tooltip-enter">${te("Enter picture in picture mode")}</slot>
  <slot name="tooltip-exit">${te("Exit picture in picture mode")}</slot>
`,Ov=i=>{const e=i.mediaIsPip?te("exit picture in picture mode"):te("enter picture in picture mode");i.setAttribute("aria-label",e)};class IA extends ni{static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_IS_PIP,x.MEDIA_PIP_UNAVAILABLE]}constructor(e={}){super({slotTemplate:wA,tooltipContent:PO,...e})}connectedCallback(){Ov(this),super.connectedCallback()}attributeChangedCallback(e,t,n){e===x.MEDIA_IS_PIP&&Ov(this),super.attributeChangedCallback(e,t,n)}get mediaPipUnavailable(){return We(this,x.MEDIA_PIP_UNAVAILABLE)}set mediaPipUnavailable(e){qe(this,x.MEDIA_PIP_UNAVAILABLE,e)}get mediaIsPip(){return ge(this,x.MEDIA_IS_PIP)}set mediaIsPip(e){ve(this,x.MEDIA_IS_PIP,e)}handleClick(){const e=this.mediaIsPip?z.MEDIA_EXIT_PIP_REQUEST:z.MEDIA_ENTER_PIP_REQUEST;this.dispatchEvent(new C.CustomEvent(e,{composed:!0,bubbles:!0}))}}C.customElements.get("media-pip-button")||C.customElements.define("media-pip-button",IA);var MO=IA,OO=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},Tl=(i,e,t)=>(OO(i,e,"read from private field"),t?t.call(i):e.get(i)),NO=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},as;const Zd={RATES:"rates"},FO=[1,1.2,1.5,1.7,2],_l=1,LA=ue.createElement("template");LA.innerHTML=`
  <style>
    :host {
      min-width: 5ch;
      padding: var(--media-button-padding, var(--media-control-padding, 10px 5px));
    }
  </style>
  <slot name="icon"></slot>
`;class kA extends ni{constructor(e={}){super({slotTemplate:LA,tooltipContent:te("Playback rate"),...e}),NO(this,as,new kS(this,Zd.RATES,{defaultValue:FO})),this.container=this.shadowRoot.querySelector('slot[name="icon"]'),this.container.innerHTML=`${_l}x`}static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_PLAYBACK_RATE,Zd.RATES]}attributeChangedCallback(e,t,n){if(super.attributeChangedCallback(e,t,n),e===Zd.RATES&&(Tl(this,as).value=n),e===x.MEDIA_PLAYBACK_RATE){const r=n?+n:Number.NaN,s=Number.isNaN(r)?_l:r;this.container.innerHTML=`${s}x`,this.setAttribute("aria-label",te("Playback rate {playbackRate}",{playbackRate:s}))}}get rates(){return Tl(this,as)}set rates(e){e?Array.isArray(e)&&(Tl(this,as).value=e.join(" ")):Tl(this,as).value=""}get mediaPlaybackRate(){return Ke(this,x.MEDIA_PLAYBACK_RATE,_l)}set mediaPlaybackRate(e){pt(this,x.MEDIA_PLAYBACK_RATE,e)}handleClick(){var e,t;const n=Array.from(this.rates.values(),a=>+a).sort((a,o)=>a-o),r=(t=(e=n.find(a=>a>this.mediaPlaybackRate))!=null?e:n[0])!=null?t:_l,s=new C.CustomEvent(z.MEDIA_PLAYBACK_RATE_REQUEST,{composed:!0,bubbles:!0,detail:r});this.dispatchEvent(s)}}as=new WeakMap;C.customElements.get("media-playback-rate-button")||C.customElements.define("media-playback-rate-button",kA);var UO=kA;const $O=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="m6 21 15-9L6 3v18Z"/>
</svg>`,BO=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M6 20h4V4H6v16Zm8-16v16h4V4h-4Z"/>
</svg>`,DA=ue.createElement("template");DA.innerHTML=`
  <style>
    :host([${x.MEDIA_PAUSED}]) slot[name=pause],
    :host(:not([${x.MEDIA_PAUSED}])) slot[name=play] {
      display: none !important;
    }

    :host([${x.MEDIA_PAUSED}]) slot[name=tooltip-pause],
    :host(:not([${x.MEDIA_PAUSED}])) slot[name=tooltip-play] {
      display: none;
    }
  </style>

  <slot name="icon">
    <slot name="play">${$O}</slot>
    <slot name="pause">${BO}</slot>
  </slot>
`;const GO=`
  <slot name="tooltip-play">${te("Play")}</slot>
  <slot name="tooltip-pause">${te("Pause")}</slot>
`,Nv=i=>{const e=i.mediaPaused?te("play"):te("pause");i.setAttribute("aria-label",e)};let CA=class extends ni{static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_PAUSED,x.MEDIA_ENDED]}constructor(e={}){super({slotTemplate:DA,tooltipContent:GO,...e})}connectedCallback(){Nv(this),super.connectedCallback()}attributeChangedCallback(e,t,n){e===x.MEDIA_PAUSED&&Nv(this),super.attributeChangedCallback(e,t,n)}get mediaPaused(){return ge(this,x.MEDIA_PAUSED)}set mediaPaused(e){ve(this,x.MEDIA_PAUSED,e)}handleClick(){const e=this.mediaPaused?z.MEDIA_PLAY_REQUEST:z.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new C.CustomEvent(e,{composed:!0,bubbles:!0}))}};C.customElements.get("media-play-button")||C.customElements.define("media-play-button",CA);var HO=CA;const Oi={PLACEHOLDER_SRC:"placeholdersrc",SRC:"src"},PA=ue.createElement("template");PA.innerHTML=`
  <style>
    :host {
      pointer-events: none;
      display: var(--media-poster-image-display, inline-block);
      box-sizing: border-box;
    }

    img {
      max-width: 100%;
      max-height: 100%;
      min-width: 100%;
      min-height: 100%;
      background-repeat: no-repeat;
      background-position: var(--media-poster-image-background-position, var(--media-object-position, center));
      background-size: var(--media-poster-image-background-size, var(--media-object-fit, contain));
      object-fit: var(--media-object-fit, contain);
      object-position: var(--media-object-position, center);
    }
  </style>

  <img part="poster img" aria-hidden="true" id="image"/>
`;const VO=i=>{i.style.removeProperty("background-image")},KO=(i,e)=>{i.style["background-image"]=`url('${e}')`};class MA extends C.HTMLElement{static get observedAttributes(){return[Oi.PLACEHOLDER_SRC,Oi.SRC]}constructor(){super(),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(PA.content.cloneNode(!0))),this.image=this.shadowRoot.querySelector("#image")}attributeChangedCallback(e,t,n){e===Oi.SRC&&(n==null?this.image.removeAttribute(Oi.SRC):this.image.setAttribute(Oi.SRC,n)),e===Oi.PLACEHOLDER_SRC&&(n==null?VO(this.image):KO(this.image,n))}get placeholderSrc(){return We(this,Oi.PLACEHOLDER_SRC)}set placeholderSrc(e){qe(this,Oi.SRC,e)}get src(){return We(this,Oi.SRC)}set src(e){qe(this,Oi.SRC,e)}}C.customElements.get("media-poster-image")||C.customElements.define("media-poster-image",MA);var WO=MA,OA=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},qO=(i,e,t)=>(OA(i,e,"read from private field"),t?t.call(i):e.get(i)),YO=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},jO=(i,e,t,n)=>(OA(i,e,"write to private field"),e.set(i,t),t),hu;class NA extends ta{constructor(){super(),YO(this,hu,void 0),jO(this,hu,this.shadowRoot.querySelector("slot"))}static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_PREVIEW_CHAPTER]}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),e===x.MEDIA_PREVIEW_CHAPTER&&n!==t&&n!=null&&(qO(this,hu).textContent=n,n!==""?this.setAttribute("aria-valuetext",`chapter: ${n}`):this.removeAttribute("aria-valuetext"))}get mediaPreviewChapter(){return We(this,x.MEDIA_PREVIEW_CHAPTER)}set mediaPreviewChapter(e){qe(this,x.MEDIA_PREVIEW_CHAPTER,e)}}hu=new WeakMap;C.customElements.get("media-preview-chapter-display")||C.customElements.define("media-preview-chapter-display",NA);var zO=NA,FA=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},Sl=(i,e,t)=>(FA(i,e,"read from private field"),t?t.call(i):e.get(i)),QO=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},Al=(i,e,t,n)=>(FA(i,e,"write to private field"),e.set(i,t),t),Ki;const UA=ue.createElement("template");UA.innerHTML=`
  <style>
    :host {
      box-sizing: border-box;
      display: var(--media-control-display, var(--media-preview-thumbnail-display, inline-block));
      overflow: hidden;
    }

    img {
      display: none;
      position: relative;
    }
  </style>
  <img crossorigin loading="eager" decoding="async">
`;class $A extends C.HTMLElement{constructor(){super(),QO(this,Ki,void 0),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(UA.content.cloneNode(!0)))}static get observedAttributes(){return[_e.MEDIA_CONTROLLER,x.MEDIA_PREVIEW_IMAGE,x.MEDIA_PREVIEW_COORDS]}connectedCallback(){var e,t,n;const r=this.getAttribute(_e.MEDIA_CONTROLLER);r&&(Al(this,Ki,(e=this.getRootNode())==null?void 0:e.getElementById(r)),(n=(t=Sl(this,Ki))==null?void 0:t.associateElement)==null||n.call(t,this))}disconnectedCallback(){var e,t;(t=(e=Sl(this,Ki))==null?void 0:e.unassociateElement)==null||t.call(e,this),Al(this,Ki,null)}attributeChangedCallback(e,t,n){var r,s,a,o,l;[x.MEDIA_PREVIEW_IMAGE,x.MEDIA_PREVIEW_COORDS].includes(e)&&this.update(),e===_e.MEDIA_CONTROLLER&&(t&&((s=(r=Sl(this,Ki))==null?void 0:r.unassociateElement)==null||s.call(r,this),Al(this,Ki,null)),n&&this.isConnected&&(Al(this,Ki,(a=this.getRootNode())==null?void 0:a.getElementById(n)),(l=(o=Sl(this,Ki))==null?void 0:o.associateElement)==null||l.call(o,this)))}get mediaPreviewImage(){return We(this,x.MEDIA_PREVIEW_IMAGE)}set mediaPreviewImage(e){qe(this,x.MEDIA_PREVIEW_IMAGE,e)}get mediaPreviewCoords(){const e=this.getAttribute(x.MEDIA_PREVIEW_COORDS);if(e)return e.split(/\s+/).map(t=>+t)}set mediaPreviewCoords(e){if(!e){this.removeAttribute(x.MEDIA_PREVIEW_COORDS);return}this.setAttribute(x.MEDIA_PREVIEW_COORDS,e.join(" "))}update(){const e=this.mediaPreviewCoords,t=this.mediaPreviewImage;if(!(e&&t))return;const[n,r,s,a]=e,o=t.split("#")[0],l=getComputedStyle(this),{maxWidth:u,maxHeight:c,minWidth:d,minHeight:h}=l,f=Math.min(parseInt(u)/s,parseInt(c)/a),m=Math.max(parseInt(d)/s,parseInt(h)/a),p=f<1,v=p?f:m>1?m:1,{style:g}=Je(this.shadowRoot,":host"),E=Je(this.shadowRoot,"img").style,y=this.shadowRoot.querySelector("img"),_=p?"min":"max";g.setProperty(`${_}-width`,"initial","important"),g.setProperty(`${_}-height`,"initial","important"),g.width=`${s*v}px`,g.height=`${a*v}px`;const S=()=>{E.width=`${this.imgWidth*v}px`,E.height=`${this.imgHeight*v}px`,E.display="block"};y.src!==o&&(y.onload=()=>{this.imgWidth=y.naturalWidth,this.imgHeight=y.naturalHeight,S()},y.src=o,S()),S(),E.transform=`translate(-${n*v}px, -${r*v}px)`}}Ki=new WeakMap;C.customElements.get("media-preview-thumbnail")||C.customElements.define("media-preview-thumbnail",$A);var XO=$A,BA=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},Fv=(i,e,t)=>(BA(i,e,"read from private field"),t?t.call(i):e.get(i)),ZO=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},JO=(i,e,t,n)=>(BA(i,e,"write to private field"),e.set(i,t),t),La;class GA extends ta{constructor(){super(),ZO(this,La,void 0),JO(this,La,this.shadowRoot.querySelector("slot")),Fv(this,La).textContent=kr(0)}static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_PREVIEW_TIME]}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),e===x.MEDIA_PREVIEW_TIME&&n!=null&&(Fv(this,La).textContent=kr(parseFloat(n)))}get mediaPreviewTime(){return Ke(this,x.MEDIA_PREVIEW_TIME)}set mediaPreviewTime(e){pt(this,x.MEDIA_PREVIEW_TIME,e)}}La=new WeakMap;C.customElements.get("media-preview-time-display")||C.customElements.define("media-preview-time-display",GA);var eN=GA;const Zr={SEEK_OFFSET:"seekoffset"},fu=30,tN=`<svg aria-hidden="true" viewBox="0 0 20 24"><defs><style>.text{font-size:8px;font-family:Arial-BoldMT, Arial;font-weight:700;}</style></defs><text class="text value" transform="translate(2.18 19.87)">${fu}</text><path d="M10 6V3L4.37 7 10 10.94V8a5.54 5.54 0 0 1 1.9 10.48v2.12A7.5 7.5 0 0 0 10 6Z"/></svg>`,HA=ue.createElement("template");HA.innerHTML=`
  <slot name="icon">${tN}</slot>
`;const iN=0;let VA=class extends ni{static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_CURRENT_TIME,Zr.SEEK_OFFSET]}constructor(e={}){super({slotTemplate:HA,tooltipContent:te("Seek backward"),...e})}connectedCallback(){this.seekOffset=Ke(this,Zr.SEEK_OFFSET,fu),super.connectedCallback()}attributeChangedCallback(e,t,n){e===Zr.SEEK_OFFSET&&(this.seekOffset=Ke(this,Zr.SEEK_OFFSET,fu)),super.attributeChangedCallback(e,t,n)}get seekOffset(){return Ke(this,Zr.SEEK_OFFSET,fu)}set seekOffset(e){pt(this,Zr.SEEK_OFFSET,e),this.setAttribute("aria-label",te("seek back {seekOffset} seconds",{seekOffset:this.seekOffset})),vS(ES(this,"icon"),this.seekOffset)}get mediaCurrentTime(){return Ke(this,x.MEDIA_CURRENT_TIME,iN)}set mediaCurrentTime(e){pt(this,x.MEDIA_CURRENT_TIME,e)}handleClick(){const e=Math.max(this.mediaCurrentTime-this.seekOffset,0),t=new C.CustomEvent(z.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)}};C.customElements.get("media-seek-backward-button")||C.customElements.define("media-seek-backward-button",VA);var nN=VA;const Jr={SEEK_OFFSET:"seekoffset"},mu=30,rN=`<svg aria-hidden="true" viewBox="0 0 20 24"><defs><style>.text{font-size:8px;font-family:Arial-BoldMT, Arial;font-weight:700;}</style></defs><text class="text value" transform="translate(8.9 19.87)">${mu}</text><path d="M10 6V3l5.61 4L10 10.94V8a5.54 5.54 0 0 0-1.9 10.48v2.12A7.5 7.5 0 0 1 10 6Z"/></svg>`,KA=ue.createElement("template");KA.innerHTML=`
  <slot name="icon">${rN}</slot>
`;const sN=0;let WA=class extends ni{static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_CURRENT_TIME,Jr.SEEK_OFFSET]}constructor(e={}){super({slotTemplate:KA,tooltipContent:te("Seek forward"),...e})}connectedCallback(){this.seekOffset=Ke(this,Jr.SEEK_OFFSET,mu),super.connectedCallback()}attributeChangedCallback(e,t,n){e===Jr.SEEK_OFFSET&&(this.seekOffset=Ke(this,Jr.SEEK_OFFSET,mu)),super.attributeChangedCallback(e,t,n)}get seekOffset(){return Ke(this,Jr.SEEK_OFFSET,mu)}set seekOffset(e){pt(this,Jr.SEEK_OFFSET,e),this.setAttribute("aria-label",te("seek forward {seekOffset} seconds",{seekOffset:this.seekOffset})),vS(ES(this,"icon"),this.seekOffset)}get mediaCurrentTime(){return Ke(this,x.MEDIA_CURRENT_TIME,sN)}set mediaCurrentTime(e){pt(this,x.MEDIA_CURRENT_TIME,e)}handleClick(){const e=this.mediaCurrentTime+this.seekOffset,t=new C.CustomEvent(z.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)}};C.customElements.get("media-seek-forward-button")||C.customElements.define("media-seek-forward-button",WA);var aN=WA,qA=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},Jd=(i,e,t)=>(qA(i,e,"read from private field"),t?t.call(i):e.get(i)),oN=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},lN=(i,e,t,n)=>(qA(i,e,"write to private field"),e.set(i,t),t),os;const Ii={REMAINING:"remaining",SHOW_DURATION:"showduration",NO_TOGGLE:"notoggle"},Uv=[...Object.values(Ii),x.MEDIA_CURRENT_TIME,x.MEDIA_DURATION,x.MEDIA_SEEKABLE],$v=["Enter"," "],uN="&nbsp;/&nbsp;",Bv=(i,{timesSep:e=uN}={})=>{var t,n;const r=i.hasAttribute(Ii.REMAINING),s=i.hasAttribute(Ii.SHOW_DURATION),a=(t=i.mediaCurrentTime)!=null?t:0,[,o]=(n=i.mediaSeekable)!=null?n:[];let l=0;Number.isFinite(i.mediaDuration)?l=i.mediaDuration:Number.isFinite(o)&&(l=o);const u=kr(r?0-(l-a):a);return s?`${u}${e}${kr(l)}`:u},cN="video not loaded, unknown time.",dN=i=>{var e;const t=i.mediaCurrentTime,[,n]=(e=i.mediaSeekable)!=null?e:[];let r=null;if(Number.isFinite(i.mediaDuration)?r=i.mediaDuration:Number.isFinite(n)&&(r=n),t==null||r===null){i.setAttribute("aria-valuetext",cN);return}const s=i.hasAttribute(Ii.REMAINING),a=i.hasAttribute(Ii.SHOW_DURATION),o=Ka(s?0-(r-t):t);if(!a){i.setAttribute("aria-valuetext",o);return}const l=Ka(r),u=`${o} of ${l}`;i.setAttribute("aria-valuetext",u)};let YA=class extends ta{constructor(){super(),oN(this,os,void 0),lN(this,os,this.shadowRoot.querySelector("slot")),Jd(this,os).innerHTML=`${Bv(this)}`}static get observedAttributes(){return[...super.observedAttributes,...Uv,"disabled"]}connectedCallback(){const{style:e}=Je(this.shadowRoot,":host(:hover:not([notoggle]))");e.setProperty("cursor","pointer"),e.setProperty("background","var(--media-control-hover-background, rgba(50 50 70 / .7))"),this.hasAttribute("disabled")||this.enable(),this.setAttribute("role","progressbar"),this.setAttribute("aria-label",te("playback time"));const t=n=>{const{key:r}=n;if(!$v.includes(r)){this.removeEventListener("keyup",t);return}this.toggleTimeDisplay()};this.addEventListener("keydown",n=>{const{metaKey:r,altKey:s,key:a}=n;if(r||s||!$v.includes(a)){this.removeEventListener("keyup",t);return}this.addEventListener("keyup",t)}),this.addEventListener("click",this.toggleTimeDisplay),super.connectedCallback()}toggleTimeDisplay(){this.noToggle||(this.hasAttribute("remaining")?this.removeAttribute("remaining"):this.setAttribute("remaining",""))}disconnectedCallback(){this.disable(),super.disconnectedCallback()}attributeChangedCallback(e,t,n){Uv.includes(e)?this.update():e==="disabled"&&n!==t&&(n==null?this.enable():this.disable()),super.attributeChangedCallback(e,t,n)}enable(){this.tabIndex=0}disable(){this.tabIndex=-1}get remaining(){return ge(this,Ii.REMAINING)}set remaining(e){ve(this,Ii.REMAINING,e)}get showDuration(){return ge(this,Ii.SHOW_DURATION)}set showDuration(e){ve(this,Ii.SHOW_DURATION,e)}get noToggle(){return ge(this,Ii.NO_TOGGLE)}set noToggle(e){ve(this,Ii.NO_TOGGLE,e)}get mediaDuration(){return Ke(this,x.MEDIA_DURATION)}set mediaDuration(e){pt(this,x.MEDIA_DURATION,e)}get mediaCurrentTime(){return Ke(this,x.MEDIA_CURRENT_TIME)}set mediaCurrentTime(e){pt(this,x.MEDIA_CURRENT_TIME,e)}get mediaSeekable(){const e=this.getAttribute(x.MEDIA_SEEKABLE);if(e)return e.split(":").map(t=>+t)}set mediaSeekable(e){if(e==null){this.removeAttribute(x.MEDIA_SEEKABLE);return}this.setAttribute(x.MEDIA_SEEKABLE,e.join(":"))}update(){const e=Bv(this);dN(this),e!==Jd(this,os).innerHTML&&(Jd(this,os).innerHTML=e)}};os=new WeakMap;C.customElements.get("media-time-display")||C.customElements.define("media-time-display",YA);var hN=YA,jA=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},dt=(i,e,t)=>(jA(i,e,"read from private field"),t?t.call(i):e.get(i)),Ni=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},jt=(i,e,t,n)=>(jA(i,e,"write to private field"),e.set(i,t),t),fN=(i,e,t,n)=>({set _(r){jt(i,e,r)},get _(){return dt(i,e,n)}}),ls,pu,us,ka,gu,vu,Eu,cs,gr,yu;class mN{constructor(e,t,n){Ni(this,ls,void 0),Ni(this,pu,void 0),Ni(this,us,void 0),Ni(this,ka,void 0),Ni(this,gu,void 0),Ni(this,vu,void 0),Ni(this,Eu,void 0),Ni(this,cs,void 0),Ni(this,gr,0),Ni(this,yu,(r=performance.now())=>{jt(this,gr,requestAnimationFrame(dt(this,yu))),jt(this,ka,performance.now()-dt(this,us));const s=1e3/this.fps;if(dt(this,ka)>s){jt(this,us,r-dt(this,ka)%s);const a=1e3/((r-dt(this,pu))/++fN(this,gu)._),o=(r-dt(this,vu))/1e3/this.duration;let l=dt(this,Eu)+o*this.playbackRate;l-dt(this,ls).valueAsNumber>0?jt(this,cs,this.playbackRate/this.duration/a):(jt(this,cs,.995*dt(this,cs)),l=dt(this,ls).valueAsNumber+dt(this,cs)),this.callback(l)}}),jt(this,ls,e),this.callback=t,this.fps=n}start(){dt(this,gr)===0&&(jt(this,us,performance.now()),jt(this,pu,dt(this,us)),jt(this,gu,0),dt(this,yu).call(this))}stop(){dt(this,gr)!==0&&(cancelAnimationFrame(dt(this,gr)),jt(this,gr,0))}update({start:e,duration:t,playbackRate:n}){const r=e-dt(this,ls).valueAsNumber,s=Math.abs(t-this.duration);(r>0||r<-.03||s>=.5)&&this.callback(e),jt(this,Eu,e),jt(this,vu,performance.now()),this.duration=t,this.playbackRate=n}}ls=new WeakMap;pu=new WeakMap;us=new WeakMap;ka=new WeakMap;gu=new WeakMap;vu=new WeakMap;Eu=new WeakMap;cs=new WeakMap;gr=new WeakMap;yu=new WeakMap;var yp=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},at=(i,e,t)=>(yp(i,e,"read from private field"),t?t.call(i):e.get(i)),ct=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},Wi=(i,e,t,n)=>(yp(i,e,"write to private field"),e.set(i,t),t),wt=(i,e,t)=>(yp(i,e,"access private method"),t),ds,Cr,mc,Ya,pc,Tu,xo,bo,hs,fs,Da,Tp,zA,Nf,gc,_p,vc,Sp,Ec,Ap,Ff,QA,Ro,yc,Uf,XA;const pN="video not loaded, unknown time.",gN=i=>{const e=i.range,t=Ka(+JA(i)),n=Ka(+i.mediaSeekableEnd),r=t&&n?`${t} of ${n}`:pN;e.setAttribute("aria-valuetext",r)},ZA=ue.createElement("template");ZA.innerHTML=`
  <style>
    :host {
      --media-box-border-radius: 4px;
      --media-box-padding-left: 10px;
      --media-box-padding-right: 10px;
      --media-preview-border-radius: var(--media-box-border-radius);
      --media-box-arrow-offset: var(--media-box-border-radius);
      --_control-background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));
      --_preview-background: var(--media-preview-background, var(--_control-background));

      
      contain: layout;
    }

    #buffered {
      background: var(--media-time-range-buffered-color, rgb(255 255 255 / .4));
      position: absolute;
      height: 100%;
      will-change: width;
    }

    #preview-rail,
    #current-rail {
      width: 100%;
      position: absolute;
      left: 0;
      bottom: 100%;
      pointer-events: none;
      will-change: transform;
    }

    [part~="box"] {
      width: min-content;
      
      position: absolute;
      bottom: 100%;
      flex-direction: column;
      align-items: center;
      transform: translateX(-50%);
    }

    [part~="current-box"] {
      display: var(--media-current-box-display, var(--media-box-display, flex));
      margin: var(--media-current-box-margin, var(--media-box-margin, 0 0 5px));
      visibility: hidden;
    }

    [part~="preview-box"] {
      display: var(--media-preview-box-display, var(--media-box-display, flex));
      margin: var(--media-preview-box-margin, var(--media-box-margin, 0 0 5px));
      transition-property: var(--media-preview-transition-property, visibility, opacity);
      transition-duration: var(--media-preview-transition-duration-out, .25s);
      transition-delay: var(--media-preview-transition-delay-out, 0s);
      visibility: hidden;
      opacity: 0;
    }

    :host(:is([${x.MEDIA_PREVIEW_IMAGE}], [${x.MEDIA_PREVIEW_TIME}])[dragging]) [part~="preview-box"] {
      transition-duration: var(--media-preview-transition-duration-in, .5s);
      transition-delay: var(--media-preview-transition-delay-in, .25s);
      visibility: visible;
      opacity: 1;
    }

    @media (hover: hover) {
      :host(:is([${x.MEDIA_PREVIEW_IMAGE}], [${x.MEDIA_PREVIEW_TIME}]):hover) [part~="preview-box"] {
        transition-duration: var(--media-preview-transition-duration-in, .5s);
        transition-delay: var(--media-preview-transition-delay-in, .25s);
        visibility: visible;
        opacity: 1;
      }
    }

    media-preview-thumbnail,
    ::slotted(media-preview-thumbnail) {
      visibility: hidden;
      
      transition: visibility 0s .25s;
      transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));
      background: var(--media-preview-thumbnail-background, var(--_preview-background));
      box-shadow: var(--media-preview-thumbnail-box-shadow, 0 0 4px rgb(0 0 0 / .2));
      max-width: var(--media-preview-thumbnail-max-width, 180px);
      max-height: var(--media-preview-thumbnail-max-height, 160px);
      min-width: var(--media-preview-thumbnail-min-width, 120px);
      min-height: var(--media-preview-thumbnail-min-height, 80px);
      border: var(--media-preview-thumbnail-border);
      border-radius: var(--media-preview-thumbnail-border-radius,
        var(--media-preview-border-radius) var(--media-preview-border-radius) 0 0);
    }

    :host([${x.MEDIA_PREVIEW_IMAGE}][dragging]) media-preview-thumbnail,
    :host([${x.MEDIA_PREVIEW_IMAGE}][dragging]) ::slotted(media-preview-thumbnail) {
      transition-delay: var(--media-preview-transition-delay-in, .25s);
      visibility: visible;
    }

    @media (hover: hover) {
      :host([${x.MEDIA_PREVIEW_IMAGE}]:hover) media-preview-thumbnail,
      :host([${x.MEDIA_PREVIEW_IMAGE}]:hover) ::slotted(media-preview-thumbnail) {
        transition-delay: var(--media-preview-transition-delay-in, .25s);
        visibility: visible;
      }

      :host([${x.MEDIA_PREVIEW_TIME}]:hover) {
        --media-time-range-hover-display: block;
      }
    }

    media-preview-chapter-display,
    ::slotted(media-preview-chapter-display) {
      font-size: var(--media-font-size, 13px);
      line-height: 17px;
      min-width: 0;
      visibility: hidden;
      
      transition: min-width 0s, border-radius 0s, margin 0s, padding 0s, visibility 0s;
      transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));
      background: var(--media-preview-chapter-background, var(--_preview-background));
      border-radius: var(--media-preview-chapter-border-radius,
        var(--media-preview-border-radius) var(--media-preview-border-radius)
        var(--media-preview-border-radius) var(--media-preview-border-radius));
      padding: var(--media-preview-chapter-padding, 3.5px 9px);
      margin: var(--media-preview-chapter-margin, 0 0 5px);
      text-shadow: var(--media-preview-chapter-text-shadow, 0 0 4px rgb(0 0 0 / .75));
    }

    :host([${x.MEDIA_PREVIEW_IMAGE}]) media-preview-chapter-display,
    :host([${x.MEDIA_PREVIEW_IMAGE}]) ::slotted(media-preview-chapter-display) {
      transition-delay: var(--media-preview-transition-delay-in, .25s);
      border-radius: var(--media-preview-chapter-border-radius, 0);
      padding: var(--media-preview-chapter-padding, 3.5px 9px 0);
      margin: var(--media-preview-chapter-margin, 0);
      min-width: 100%;
    }

    media-preview-chapter-display[${x.MEDIA_PREVIEW_CHAPTER}],
    ::slotted(media-preview-chapter-display[${x.MEDIA_PREVIEW_CHAPTER}]) {
      visibility: visible;
    }

    media-preview-chapter-display:not([aria-valuetext]),
    ::slotted(media-preview-chapter-display:not([aria-valuetext])) {
      display: none;
    }

    media-preview-time-display,
    ::slotted(media-preview-time-display),
    media-time-display,
    ::slotted(media-time-display) {
      font-size: var(--media-font-size, 13px);
      line-height: 17px;
      min-width: 0;
      
      transition: min-width 0s, border-radius 0s;
      transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));
      background: var(--media-preview-time-background, var(--_preview-background));
      border-radius: var(--media-preview-time-border-radius,
        var(--media-preview-border-radius) var(--media-preview-border-radius)
        var(--media-preview-border-radius) var(--media-preview-border-radius));
      padding: var(--media-preview-time-padding, 3.5px 9px);
      margin: var(--media-preview-time-margin, 0);
      text-shadow: var(--media-preview-time-text-shadow, 0 0 4px rgb(0 0 0 / .75));
      transform: translateX(min(
        max(calc(50% - var(--_box-width) / 2),
        calc(var(--_box-shift, 0))),
        calc(var(--_box-width) / 2 - 50%)
      ));
    }

    :host([${x.MEDIA_PREVIEW_IMAGE}]) media-preview-time-display,
    :host([${x.MEDIA_PREVIEW_IMAGE}]) ::slotted(media-preview-time-display) {
      transition-delay: var(--media-preview-transition-delay-in, .25s);
      border-radius: var(--media-preview-time-border-radius,
        0 0 var(--media-preview-border-radius) var(--media-preview-border-radius));
      min-width: 100%;
    }

    :host([${x.MEDIA_PREVIEW_TIME}]:hover) {
      --media-time-range-hover-display: block;
    }

    [part~="arrow"],
    ::slotted([part~="arrow"]) {
      display: var(--media-box-arrow-display, inline-block);
      transform: translateX(min(
        max(calc(50% - var(--_box-width) / 2 + var(--media-box-arrow-offset)),
        calc(var(--_box-shift, 0))),
        calc(var(--_box-width) / 2 - 50% - var(--media-box-arrow-offset))
      ));
      
      border-color: transparent;
      border-top-color: var(--media-box-arrow-background, var(--_control-background));
      border-width: var(--media-box-arrow-border-width,
        var(--media-box-arrow-height, 5px) var(--media-box-arrow-width, 6px) 0);
      border-style: solid;
      justify-content: center;
      height: 0;
    }
  </style>
  <div id="preview-rail">
    <slot name="preview" part="box preview-box">
      <media-preview-thumbnail></media-preview-thumbnail>
      <media-preview-chapter-display></media-preview-chapter-display>
      <media-preview-time-display></media-preview-time-display>
      <slot name="preview-arrow"><div part="arrow"></div></slot>
    </slot>
  </div>
  <div id="current-rail">
    <slot name="current" part="box current-box">
      
    </slot>
  </div>
`;const xl=(i,e=i.mediaCurrentTime)=>{const t=Number.isFinite(i.mediaSeekableStart)?i.mediaSeekableStart:0,n=Number.isFinite(i.mediaDuration)?i.mediaDuration:i.mediaSeekableEnd;if(Number.isNaN(n))return 0;const r=(e-t)/(n-t);return Math.max(0,Math.min(r,1))},JA=(i,e=i.range.valueAsNumber)=>{const t=Number.isFinite(i.mediaSeekableStart)?i.mediaSeekableStart:0,n=Number.isFinite(i.mediaDuration)?i.mediaDuration:i.mediaSeekableEnd;return Number.isNaN(n)?0:e*(n-t)+t};class ex extends Wc{constructor(){super(),ct(this,fs),ct(this,Tp),ct(this,gc),ct(this,vc),ct(this,Ec),ct(this,Ff),ct(this,Ro),ct(this,Uf),ct(this,ds,void 0),ct(this,Cr,void 0),ct(this,mc,void 0),ct(this,Ya,void 0),ct(this,pc,void 0),ct(this,Tu,void 0),ct(this,xo,void 0),ct(this,bo,void 0),ct(this,hs,void 0),ct(this,Nf,n=>{this.dragging||(sp(n)&&(this.range.valueAsNumber=n),this.updateBar())}),this.container.appendChild(ZA.content.cloneNode(!0)),this.shadowRoot.querySelector("#track").insertAdjacentHTML("afterbegin",'<div id="buffered" part="buffered"></div>'),Wi(this,mc,this.shadowRoot.querySelectorAll('[part~="box"]')),Wi(this,pc,this.shadowRoot.querySelector('[part~="preview-box"]')),Wi(this,Tu,this.shadowRoot.querySelector('[part~="current-box"]'));const t=getComputedStyle(this);Wi(this,xo,parseInt(t.getPropertyValue("--media-box-padding-left"))),Wi(this,bo,parseInt(t.getPropertyValue("--media-box-padding-right"))),Wi(this,Cr,new mN(this.range,at(this,Nf),60))}static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_PAUSED,x.MEDIA_DURATION,x.MEDIA_SEEKABLE,x.MEDIA_CURRENT_TIME,x.MEDIA_PREVIEW_IMAGE,x.MEDIA_PREVIEW_TIME,x.MEDIA_PREVIEW_CHAPTER,x.MEDIA_BUFFERED,x.MEDIA_PLAYBACK_RATE,x.MEDIA_LOADING,x.MEDIA_ENDED]}connectedCallback(){var e;super.connectedCallback(),this.range.setAttribute("aria-label",te("seek")),wt(this,fs,Da).call(this),Wi(this,ds,this.getRootNode()),(e=at(this,ds))==null||e.addEventListener("transitionstart",this)}disconnectedCallback(){var e;super.disconnectedCallback(),wt(this,fs,Da).call(this),(e=at(this,ds))==null||e.removeEventListener("transitionstart",this),Wi(this,ds,null)}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),t!=n&&(e===x.MEDIA_CURRENT_TIME||e===x.MEDIA_PAUSED||e===x.MEDIA_ENDED||e===x.MEDIA_LOADING||e===x.MEDIA_DURATION||e===x.MEDIA_SEEKABLE?(at(this,Cr).update({start:xl(this),duration:this.mediaSeekableEnd-this.mediaSeekableStart,playbackRate:this.mediaPlaybackRate}),wt(this,fs,Da).call(this),gN(this)):e===x.MEDIA_BUFFERED&&this.updateBufferedBar(),(e===x.MEDIA_DURATION||e===x.MEDIA_SEEKABLE)&&(this.mediaChaptersCues=at(this,hs),this.updateBar()))}get mediaChaptersCues(){return at(this,hs)}set mediaChaptersCues(e){var t;Wi(this,hs,e),this.updateSegments((t=at(this,hs))==null?void 0:t.map(n=>({start:xl(this,n.startTime),end:xl(this,n.endTime)})))}get mediaPaused(){return ge(this,x.MEDIA_PAUSED)}set mediaPaused(e){ve(this,x.MEDIA_PAUSED,e)}get mediaLoading(){return ge(this,x.MEDIA_LOADING)}set mediaLoading(e){ve(this,x.MEDIA_LOADING,e)}get mediaDuration(){return Ke(this,x.MEDIA_DURATION)}set mediaDuration(e){pt(this,x.MEDIA_DURATION,e)}get mediaCurrentTime(){return Ke(this,x.MEDIA_CURRENT_TIME)}set mediaCurrentTime(e){pt(this,x.MEDIA_CURRENT_TIME,e)}get mediaPlaybackRate(){return Ke(this,x.MEDIA_PLAYBACK_RATE,1)}set mediaPlaybackRate(e){pt(this,x.MEDIA_PLAYBACK_RATE,e)}get mediaBuffered(){const e=this.getAttribute(x.MEDIA_BUFFERED);return e?e.split(" ").map(t=>t.split(":").map(n=>+n)):[]}set mediaBuffered(e){if(!e){this.removeAttribute(x.MEDIA_BUFFERED);return}const t=e.map(n=>n.join(":")).join(" ");this.setAttribute(x.MEDIA_BUFFERED,t)}get mediaSeekable(){const e=this.getAttribute(x.MEDIA_SEEKABLE);if(e)return e.split(":").map(t=>+t)}set mediaSeekable(e){if(e==null){this.removeAttribute(x.MEDIA_SEEKABLE);return}this.setAttribute(x.MEDIA_SEEKABLE,e.join(":"))}get mediaSeekableEnd(){var e;const[,t=this.mediaDuration]=(e=this.mediaSeekable)!=null?e:[];return t}get mediaSeekableStart(){var e;const[t=0]=(e=this.mediaSeekable)!=null?e:[];return t}get mediaPreviewImage(){return We(this,x.MEDIA_PREVIEW_IMAGE)}set mediaPreviewImage(e){qe(this,x.MEDIA_PREVIEW_IMAGE,e)}get mediaPreviewTime(){return Ke(this,x.MEDIA_PREVIEW_TIME)}set mediaPreviewTime(e){pt(this,x.MEDIA_PREVIEW_TIME,e)}get mediaEnded(){return ge(this,x.MEDIA_ENDED)}set mediaEnded(e){ve(this,x.MEDIA_ENDED,e)}updateBar(){super.updateBar(),this.updateBufferedBar(),this.updateCurrentBox()}updateBufferedBar(){var e;const t=this.mediaBuffered;if(!t.length)return;let n;if(this.mediaEnded)n=1;else{const s=this.mediaCurrentTime,[,a=this.mediaSeekableStart]=(e=t.find(([o,l])=>o<=s&&s<=l))!=null?e:[];n=xl(this,a)}const{style:r}=Je(this.shadowRoot,"#buffered");r.setProperty("width",`${n*100}%`)}updateCurrentBox(){if(!this.shadowRoot.querySelector('slot[name="current"]').assignedElements().length)return;const t=Je(this.shadowRoot,"#current-rail"),n=Je(this.shadowRoot,'[part~="current-box"]'),r=wt(this,gc,_p).call(this,at(this,Tu)),s=wt(this,vc,Sp).call(this,r,this.range.valueAsNumber),a=wt(this,Ec,Ap).call(this,r,this.range.valueAsNumber);t.style.transform=`translateX(${s})`,t.style.setProperty("--_range-width",`${r.range.width}`),n.style.setProperty("--_box-shift",`${a}`),n.style.setProperty("--_box-width",`${r.box.width}px`),n.style.setProperty("visibility","initial")}handleEvent(e){switch(super.handleEvent(e),e.type){case"input":wt(this,Uf,XA).call(this);break;case"pointermove":wt(this,Ff,QA).call(this,e);break;case"pointerup":case"pointerleave":wt(this,Ro,yc).call(this,null);break;case"transitionstart":ea(e.target,this)&&setTimeout(()=>wt(this,fs,Da).call(this),0);break}}}ds=new WeakMap;Cr=new WeakMap;mc=new WeakMap;Ya=new WeakMap;pc=new WeakMap;Tu=new WeakMap;xo=new WeakMap;bo=new WeakMap;hs=new WeakMap;fs=new WeakSet;Da=function(){wt(this,Tp,zA).call(this)?at(this,Cr).start():at(this,Cr).stop()};Tp=new WeakSet;zA=function(){return this.isConnected&&!this.mediaPaused&&!this.mediaLoading&&!this.mediaEnded&&this.mediaSeekableEnd>0&&TS(this)};Nf=new WeakMap;gc=new WeakSet;_p=function(i){var e;const n=((e=this.getAttribute("bounds")?Co(this,`#${this.getAttribute("bounds")}`):this.parentElement)!=null?e:this).getBoundingClientRect(),r=this.range.getBoundingClientRect(),s=i.offsetWidth,a=-(r.left-n.left-s/2),o=n.right-r.left-s/2;return{box:{width:s,min:a,max:o},bounds:n,range:r}};vc=new WeakSet;Sp=function(i,e){let t=`${e*100}%`;const{width:n,min:r,max:s}=i.box;if(!n)return t;if(Number.isNaN(r)||(t=`max(${`calc(1 / var(--_range-width) * 100 * ${r}% + var(--media-box-padding-left))`}, ${t})`),!Number.isNaN(s)){const o=`calc(1 / var(--_range-width) * 100 * ${s}% - var(--media-box-padding-right))`;t=`min(${t}, ${o})`}return t};Ec=new WeakSet;Ap=function(i,e){const{width:t,min:n,max:r}=i.box,s=e*i.range.width;if(s<n+at(this,xo)){const a=i.range.left-i.bounds.left-at(this,xo);return`${s-t/2+a}px`}if(s>r-at(this,bo)){const a=i.bounds.right-i.range.right-at(this,bo);return`${s+t/2-a-i.range.width}px`}return 0};Ff=new WeakSet;QA=function(i){const e=[...at(this,mc)].some(c=>i.composedPath().includes(c));if(!this.dragging&&(e||!i.composedPath().includes(this))){wt(this,Ro,yc).call(this,null);return}const t=this.mediaSeekableEnd;if(!t)return;const n=Je(this.shadowRoot,"#preview-rail"),r=Je(this.shadowRoot,'[part~="preview-box"]'),s=wt(this,gc,_p).call(this,at(this,pc));let a=(i.clientX-s.range.left)/s.range.width;a=Math.max(0,Math.min(1,a));const o=wt(this,vc,Sp).call(this,s,a),l=wt(this,Ec,Ap).call(this,s,a);n.style.transform=`translateX(${o})`,n.style.setProperty("--_range-width",`${s.range.width}`),r.style.setProperty("--_box-shift",`${l}`),r.style.setProperty("--_box-width",`${s.box.width}px`);const u=Math.round(at(this,Ya))-Math.round(a*t);Math.abs(u)<1&&a>.01&&a<.99||(Wi(this,Ya,a*t),wt(this,Ro,yc).call(this,at(this,Ya)))};Ro=new WeakSet;yc=function(i){this.dispatchEvent(new C.CustomEvent(z.MEDIA_PREVIEW_REQUEST,{composed:!0,bubbles:!0,detail:i}))};Uf=new WeakSet;XA=function(){at(this,Cr).stop();const i=JA(this);this.dispatchEvent(new C.CustomEvent(z.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:i}))};C.customElements.get("media-time-range")||C.customElements.define("media-time-range",ex);var vN=ex;const es={PLACEMENT:"placement",BOUNDS:"bounds"},tx=ue.createElement("template");tx.innerHTML=`
  <style>
    :host {
      --_tooltip-background-color: var(--media-tooltip-background-color, var(--media-secondary-color, rgba(20, 20, 30, .7)));
      --_tooltip-background: var(--media-tooltip-background, var(--_tooltip-background-color));
      --_tooltip-arrow-half-width: calc(var(--media-tooltip-arrow-width, 12px) / 2);
      --_tooltip-arrow-height: var(--media-tooltip-arrow-height, 5px);
      --_tooltip-arrow-background: var(--media-tooltip-arrow-color, var(--_tooltip-background-color));
      position: relative;
      pointer-events: none;
      display: var(--media-tooltip-display, inline-flex);
      justify-content: center;
      align-items: center;
      box-sizing: border-box;
      z-index: var(--media-tooltip-z-index, 1);
      background: var(--_tooltip-background);
      color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
      font: var(--media-font,
        var(--media-font-weight, 400)
        var(--media-font-size, 13px) /
        var(--media-text-content-height, var(--media-control-height, 18px))
        var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
      padding: var(--media-tooltip-padding, .35em .7em);
      border: var(--media-tooltip-border, none);
      border-radius: var(--media-tooltip-border-radius, 5px);
      filter: var(--media-tooltip-filter, drop-shadow(0 0 4px rgba(0, 0, 0, .2)));
      white-space: var(--media-tooltip-white-space, nowrap);
    }

    :host([hidden]) {
      display: none;
    }

    img, svg {
      display: inline-block;
    }

    #arrow {
      position: absolute;
      width: 0px;
      height: 0px;
      border-style: solid;
      display: var(--media-tooltip-arrow-display, block);
    }

    :host(:not([placement])),
    :host([placement="top"]) {
      position: absolute;
      bottom: calc(100% + var(--media-tooltip-distance, 12px));
      left: 50%;
      transform: translate(calc(-50% - var(--media-tooltip-offset-x, 0px)), 0);
    }
    :host(:not([placement])) #arrow,
    :host([placement="top"]) #arrow {
      top: 100%;
      left: 50%;
      border-width: var(--_tooltip-arrow-height) var(--_tooltip-arrow-half-width) 0 var(--_tooltip-arrow-half-width);
      border-color: var(--_tooltip-arrow-background) transparent transparent transparent;
      transform: translate(calc(-50% + var(--media-tooltip-offset-x, 0px)), 0);
    }

    :host([placement="right"]) {
      position: absolute;
      left: calc(100% + var(--media-tooltip-distance, 12px));
      top: 50%;
      transform: translate(0, -50%);
    }
    :host([placement="right"]) #arrow {
      top: 50%;
      right: 100%;
      border-width: var(--_tooltip-arrow-half-width) var(--_tooltip-arrow-height) var(--_tooltip-arrow-half-width) 0;
      border-color: transparent var(--_tooltip-arrow-background) transparent transparent;
      transform: translate(0, -50%);
    }

    :host([placement="bottom"]) {
      position: absolute;
      top: calc(100% + var(--media-tooltip-distance, 12px));
      left: 50%;
      transform: translate(calc(-50% - var(--media-tooltip-offset-x, 0px)), 0);
    }
    :host([placement="bottom"]) #arrow {
      bottom: 100%;
      left: 50%;
      border-width: 0 var(--_tooltip-arrow-half-width) var(--_tooltip-arrow-height) var(--_tooltip-arrow-half-width);
      border-color: transparent transparent var(--_tooltip-arrow-background) transparent;
      transform: translate(calc(-50% + var(--media-tooltip-offset-x, 0px)), 0);
    }

    :host([placement="left"]) {
      position: absolute;
      right: calc(100% + var(--media-tooltip-distance, 12px));
      top: 50%;
      transform: translate(0, -50%);
    }
    :host([placement="left"]) #arrow {
      top: 50%;
      left: 100%;
      border-width: var(--_tooltip-arrow-half-width) 0 var(--_tooltip-arrow-half-width) var(--_tooltip-arrow-height);
      border-color: transparent transparent transparent var(--_tooltip-arrow-background);
      transform: translate(0, -50%);
    }
    
    :host([placement="none"]) #arrow {
      display: none;
    }

  </style>
  <slot></slot>
  <div id="arrow"></div>
`;class ix extends C.HTMLElement{constructor(){if(super(),this.updateXOffset=()=>{var e;if(!TS(this,{checkOpacity:!1,checkVisibilityCSS:!1}))return;const t=this.placement;if(t==="left"||t==="right"){this.style.removeProperty("--media-tooltip-offset-x");return}const n=getComputedStyle(this),r=(e=Co(this,"#"+this.bounds))!=null?e:zP(this);if(!r)return;const{x:s,width:a}=r.getBoundingClientRect(),{x:o,width:l}=this.getBoundingClientRect(),u=o+l,c=s+a,d=n.getPropertyValue("--media-tooltip-offset-x"),h=d?parseFloat(d.replace("px","")):0,f=n.getPropertyValue("--media-tooltip-container-margin"),m=f?parseFloat(f.replace("px","")):0,p=o-s+h-m,v=u-c+h+m;if(p<0){this.style.setProperty("--media-tooltip-offset-x",`${p}px`);return}if(v>0){this.style.setProperty("--media-tooltip-offset-x",`${v}px`);return}this.style.removeProperty("--media-tooltip-offset-x")},this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(tx.content.cloneNode(!0))),this.arrowEl=this.shadowRoot.querySelector("#arrow"),Object.prototype.hasOwnProperty.call(this,"placement")){const e=this.placement;delete this.placement,this.placement=e}}static get observedAttributes(){return[es.PLACEMENT,es.BOUNDS]}get placement(){return We(this,es.PLACEMENT)}set placement(e){qe(this,es.PLACEMENT,e)}get bounds(){return We(this,es.BOUNDS)}set bounds(e){qe(this,es.BOUNDS,e)}}C.customElements.get("media-tooltip")||C.customElements.define("media-tooltip",ix);var EN=ix;const yN=1,TN=i=>i.mediaMuted?0:i.mediaVolume,_N=i=>`${Math.round(i*100)}%`;class nx extends Wc{static get observedAttributes(){return[...super.observedAttributes,x.MEDIA_VOLUME,x.MEDIA_MUTED,x.MEDIA_VOLUME_UNAVAILABLE]}constructor(){super(),this.range.addEventListener("input",()=>{const e=this.range.value,t=new C.CustomEvent(z.MEDIA_VOLUME_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)})}connectedCallback(){super.connectedCallback(),this.range.setAttribute("aria-label",te("volume"))}attributeChangedCallback(e,t,n){super.attributeChangedCallback(e,t,n),(e===x.MEDIA_VOLUME||e===x.MEDIA_MUTED)&&(this.range.valueAsNumber=TN(this),this.range.setAttribute("aria-valuetext",_N(this.range.valueAsNumber)),this.updateBar())}get mediaVolume(){return Ke(this,x.MEDIA_VOLUME,yN)}set mediaVolume(e){pt(this,x.MEDIA_VOLUME,e)}get mediaMuted(){return ge(this,x.MEDIA_MUTED)}set mediaMuted(e){ve(this,x.MEDIA_MUTED,e)}get mediaVolumeUnavailable(){return We(this,x.MEDIA_VOLUME_UNAVAILABLE)}set mediaVolumeUnavailable(e){qe(this,x.MEDIA_VOLUME_UNAVAILABLE,e)}}C.customElements.get("media-volume-range")||C.customElements.define("media-volume-range",nx);var SN=nx;Se({tagName:"media-gesture-receiver",elementClass:rM,react:ye});Se({tagName:"media-container",elementClass:cM,react:ye});const AN=Se({tagName:"media-controller",elementClass:GM,react:ye});Se({tagName:"media-chrome-button",elementClass:VM,react:ye});Se({tagName:"media-airplay-button",elementClass:WM,react:ye});Se({tagName:"media-captions-button",elementClass:zM,react:ye});Se({tagName:"media-cast-button",elementClass:JM,react:ye});Se({tagName:"media-chrome-dialog",elementClass:iO,react:ye});Se({tagName:"media-chrome-range",elementClass:nO,react:ye});Se({tagName:"media-control-bar",elementClass:sO,react:ye});Se({tagName:"media-text-display",elementClass:oO,react:ye});Se({tagName:"media-duration-display",elementClass:cO,react:ye});Se({tagName:"media-error-dialog",elementClass:EO,react:ye});Se({tagName:"media-fullscreen-button",elementClass:SO,react:ye});Se({tagName:"media-live-button",elementClass:RO,react:ye});Se({tagName:"media-loading-indicator",elementClass:IO,react:ye});Se({tagName:"media-mute-button",elementClass:CO,react:ye});Se({tagName:"media-pip-button",elementClass:MO,react:ye});Se({tagName:"media-playback-rate-button",elementClass:UO,react:ye});const xN=Se({tagName:"media-play-button",elementClass:HO,react:ye});Se({tagName:"media-poster-image",elementClass:WO,react:ye});Se({tagName:"media-preview-chapter-display",elementClass:zO,react:ye});Se({tagName:"media-preview-thumbnail",elementClass:XO,react:ye});Se({tagName:"media-preview-time-display",elementClass:eN,react:ye});const bN=Se({tagName:"media-seek-backward-button",elementClass:nN,react:ye}),RN=Se({tagName:"media-seek-forward-button",elementClass:aN,react:ye}),wN=Se({tagName:"media-time-display",elementClass:hN,react:ye});Se({tagName:"media-time-range",elementClass:vN,react:ye});Se({tagName:"media-tooltip",elementClass:EN,react:ye});Se({tagName:"media-volume-range",elementClass:SN,react:ye});const Yc=1e3,jc=1500,Gv=({isFlying:i,isPaused:e})=>V.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 64 64",className:`transition-transform duration-300 ${i?"scale-95 rotate-12":"scale-100"} ${i?"animate-glow":""}`,children:[V.jsx("path",{d:"M32 40c8-2 16-8 20-14 4-6 4-12 0-16s-12-4-20 0c-8 4-12 12-12 20s4 12 12 10z",fill:"#FF6B6B",className:"drop-shadow-lg"}),V.jsx("path",{className:`transform-origin-center ${i?"animate-wing-flap":""}`,d:"M28 30c-6-2-12-8-14-14-2-6 0-10 4-12s10 0 14 6c4 6 4 12 2 16s-4 6-6 4z",fill:"#4ECDC4"}),V.jsx("path",{d:"M52 26c2-2 4-2 6 0s2 4 0 6-4 2-6 0-2-4 0-6z",fill:"#FFE66D"}),e?V.jsxs("g",{fill:"white",className:"drop-shadow-md",children:[V.jsx("rect",{x:"28",y:"26",width:"3",height:"12"}),V.jsx("rect",{x:"33",y:"26",width:"3",height:"12"})]}):V.jsx("path",{d:"M30 28l8 4-8 4z",fill:"white",className:"drop-shadow-md"})]}),IN=()=>{const[i,e]=re.useState({x:100,y:100}),[t,n]=re.useState(!1),[r,s]=re.useState(!1),a=re.useCallback(()=>{if(r)return;const o=window.innerWidth-100,l=window.innerHeight-200,u=64,c=Math.random()*o,d=Math.min(l,Math.max(u,Math.random()*l));re.startTransition(()=>{n(!0),e({x:c,y:d}),s(!0)}),setTimeout(()=>{re.startTransition(()=>{n(!1)})},Yc),setTimeout(()=>s(!1),jc)},[r]);return re.useEffect(()=>{setTimeout(()=>{a()},Math.random()*1e3)},[]),V.jsx("div",{className:"z-50 fixed cursor-pointer transition-all duration-300 ease-in-out",style:{left:i.x,top:i.y},onMouseOver:a,children:V.jsxs(xN,{mediaController:"player",children:[V.jsx("span",{slot:"play",children:V.jsx(Gv,{isFlying:t,isPaused:!1})}),V.jsx("span",{slot:"pause",children:V.jsx(Gv,{isFlying:t,isPaused:!0})})]})})},LN=({isFlying:i})=>V.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 80 80",className:`transition-transform duration-300 ${i?"scale-95 rotate-12":"scale-100"} ${i?"animate-glow":""}`,children:[V.jsx("path",{d:"M40 50c-10-3-18-10-22-16-4-6-4-12 0-16s14-4 22 0c8 4 12 12 12 20s-4 12-12 12z",fill:"#1E90FF",className:"drop-shadow-lg"}),V.jsx("path",{className:`transform-origin-center ${i?"animate-wing-flap":""}`,d:"M46 40c10-3 18-10 20-16 2-6 0-12-4-14s-12 0-20 8c-4 6-4 12-2 16s4 6 6 6z",fill:"#1E90FF"}),V.jsx("path",{d:"M40 50c2 4 6 8 10 10s8-2 10-6-2-8-6-10-8-2-10 0z",fill:"#1E90FF"}),V.jsx("path",{d:"M20 32c-2-2-4-2-6 0s-2 4 0 6 4 2 6 0 2-4 0-6z",fill:"#FF4500"}),V.jsx("path",{d:"M44 36l-8 4 8 4z M36 36l-8 4 8 4z",fill:"white",className:"drop-shadow-md"})]}),kN=()=>{const[i,e]=re.useState({x:200,y:100}),[t,n]=re.useState(!1),[r,s]=re.useState(!1),a=re.useCallback(()=>{if(r)return;const o=window.innerWidth-100,l=window.innerHeight-200,u=64,c=Math.random()*o,d=Math.min(l,Math.max(u,Math.random()*l));re.startTransition(()=>{n(!0),e({x:c,y:d}),s(!0)}),setTimeout(()=>{re.startTransition(()=>{n(!1)})},Yc),setTimeout(()=>s(!1),jc)},[r]);return re.useEffect(()=>{setTimeout(()=>{a()},Math.random()*1e3)},[]),V.jsx("div",{className:"z-10 fixed cursor-pointer transition-all duration-300 ease-in-out",style:{left:i.x,top:i.y},onMouseOver:a,children:V.jsx(bN,{seekOffset:3,mediaController:"player",children:V.jsx("span",{slot:"icon",children:V.jsx(LN,{isFlying:t})})})})},DN=({isFlying:i})=>V.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 80 80",className:`transition-transform duration-300 ${i?"scale-95 rotate-12":"scale-100"} ${i?"animate-glow":""}`,children:[V.jsx("path",{d:"M40 50c14-4 24-14 28-22 4-8 4-16 0-20s-18-4-28 0c-10 4-16 16-16 26s6 16 16 16z",fill:"#2F2F2F",className:"drop-shadow-lg"}),V.jsx("path",{className:`transform-origin-center ${i?"animate-wing-flap":""}`,d:"M34 40c-12-4-20-14-22-22-2-8 0-14 4-16s14 0 22 10c4 8 4 16 2 20s-4 8-6 8z",fill:"#1A1A1A"}),V.jsx("path",{d:"M60 32c2-2 4-2 6 0s2 4 0 6-4 2-6 0-2-4 0-6z",fill:"#FFD700"}),V.jsx("path",{d:"M36 36l8 4-8 4z M44 36l8 4-8 4z",fill:"white",className:"drop-shadow-md"})]}),CN=()=>{const[i,e]=re.useState({x:200,y:100}),[t,n]=re.useState(!1),[r,s]=re.useState(!1),a=re.useCallback(()=>{if(r)return;const o=window.innerWidth-100,l=window.innerHeight-200,u=64,c=Math.random()*o,d=Math.min(l,Math.max(u,Math.random()*l));re.startTransition(()=>{n(!0),e({x:c,y:d}),s(!0)}),setTimeout(()=>{re.startTransition(()=>{n(!1)})},Yc),setTimeout(()=>s(!1),jc)},[r]);return re.useEffect(()=>{setTimeout(()=>{a()},Math.random()*1e3)},[]),V.jsx("div",{className:"z-50 fixed cursor-pointer transition-all duration-300 ease-in-out",style:{left:i.x,top:i.y},onMouseOver:a,children:V.jsx(RN,{seekOffset:3,mediaController:"player",children:V.jsx("span",{slot:"icon",children:V.jsx(DN,{isFlying:t})})})})},PN=({isFlying:i})=>V.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 80 80",className:`transition-transform duration-300 ${i?"scale-95 rotate-12":"scale-100"} ${i?"animate-glow":""}`,children:[V.jsx("path",{d:"M20 20c-2-2-4-2-6 0s-2 4 0 6 4 2 6 0 2-4 0-6z",fill:"#FF4500"}),V.jsx("rect",{x:"20",y:"30",width:"40",height:"40",fill:"#FFD700",className:"drop-shadow-lg"}),V.jsx("path",{className:`transform-origin-center ${i?"animate-wing-flap":""}`,d:"M30 40c10-3 18-10 20-16 2-6 0-12-4-14s-12 0-20 8c-4 6-4 12-2 16s4 6 6 6z",fill:"#FFD700"}),V.jsx("path",{d:"M40 50c2 4 6 8 10 10s8-2 10-6-2-8-6-10-8-2-10 0z",fill:"#FFD700"}),V.jsx("path",{d:"M20 32c-2-2-4-2-6 0s-2 4 0 6 4 2 6 0 2-4 0-6z",fill:"#FF4500"})]}),MN=()=>{const[i,e]=re.useState({x:200,y:100}),[t,n]=re.useState(!1),[r,s]=re.useState(!1),a=re.useCallback(()=>{if(r)return;const o=window.innerWidth-100,l=window.innerHeight-200,u=64,c=Math.random()*o,d=Math.min(l,Math.max(u,Math.random()*l));re.startTransition(()=>{n(!0),e({x:c,y:d}),s(!0)}),setTimeout(()=>{re.startTransition(()=>{n(!1)})},Yc),setTimeout(()=>s(!1),jc)},[r]);return re.useEffect(()=>{setTimeout(()=>{a()},Math.random()*1e3)},[]),V.jsxs("div",{className:"z-10 fixed cursor-pointer transition-all duration-300 ease-in-out",style:{left:i.x,top:i.y},onMouseOver:a,children:[V.jsx(PN,{isFlying:t}),V.jsx(wN,{className:"absolute top-[30px] left-[14px]"})]})},ON="/assets/tree-Boum9Lcb.svg",NN=({videoRef:i})=>{const[e,t]=re.useState(25);return re.useEffect(()=>{const n=i.current;if(!n)return;const r=()=>{const s=n.currentTime;t(s/23*100)};return n.addEventListener("timeupdate",r),()=>{n.removeEventListener("timeupdate",r)}},[]),V.jsx("div",{className:"relative left-[25%] bottom-[0px] h-screen w-screen z-100",children:V.jsx("div",{className:"absolute",style:{bottom:`${e}%`,transform:"rotate(0deg)",position:"relative",backgroundImage:`url(${ON})`,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"bottom",height:`${e}%`,maxWidth:"100%"}})})},FN="/assets/cloud-y_TOpQ0w.svg",Fi="/assets/bush-D809tNK4.svg";function UN(){const i=re.useRef(null);return V.jsxs("div",{className:"w-full h-screen flex justify-center items-center bg-blue-200 relative",children:[V.jsx("img",{className:"clouds",src:FN,alt:"clouds"}),V.jsxs(AN,{id:"player",className:"absolute inset-0 flex flex-col justify-center items-center bg-blue-200",children:[V.jsx(CP,{ref:i,playbackId:"C00OH5HO3jiNjENMkT1lqxoaT4hlAmQhV5JiR010101uX9g",slot:"media",muted:!0,loop:!0,className:"content-center w-[600px] h-[400px]"}),V.jsx(MN,{})]}),V.jsx(IN,{}),V.jsx(kN,{}),V.jsx(CN,{}),V.jsxs("div",{className:"fixed bottom-0 w-full h-16 bg-brown-500",children:[V.jsx(NN,{videoRef:i}),V.jsx("img",{className:"absolute left-[10%] bottom-0 w-10 h-10",src:Fi,alt:"plant1"}),V.jsx("img",{className:"absolute left-[20%] bottom-30 w-24 h-24",src:Fi,alt:"plant1"}),V.jsx("img",{className:"absolute left-[40%] bottom-0 w-20 h-20",src:Fi,alt:"plant2"}),V.jsx("img",{className:"absolute left-[70%] bottom-0 w-32 h-32",src:Fi,alt:"plant3"}),V.jsx("img",{className:"absolute left-[20%] bottom-0 w-48 h-48",src:Fi,alt:"bush1"}),V.jsx("img",{className:"absolute left-[60%] bottom-0 w-48 h-48",src:Fi,alt:"bush2"}),V.jsx("img",{className:"absolute left-[90%] bottom-0 w-16 h-16",src:Fi,alt:"bush2"}),V.jsx("img",{className:"absolute left-[50%] bottom-10 w-8 h-8",src:Fi,alt:"bush1"}),V.jsx("img",{className:"absolute left-[25%] bottom-30 w-24 h-44",src:Fi,alt:"bush1"}),V.jsx("img",{className:"absolute left-[80%] bottom-30 w-24 h-24",src:Fi,alt:"bush1"})]})]})}tT(document.getElementById("root")).render(V.jsx(re.StrictMode,{children:V.jsx(UN,{})}));
